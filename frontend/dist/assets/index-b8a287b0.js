(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();var Kb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fB(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hv={},iH={get exports(){return hv},set exports(n){hv=n}},SM={},$t={},rH={get exports(){return $t},set exports(n){$t=n}},Vi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1=Symbol.for("react.element"),sH=Symbol.for("react.portal"),oH=Symbol.for("react.fragment"),aH=Symbol.for("react.strict_mode"),lH=Symbol.for("react.profiler"),cH=Symbol.for("react.provider"),uH=Symbol.for("react.context"),hH=Symbol.for("react.forward_ref"),dH=Symbol.for("react.suspense"),fH=Symbol.for("react.memo"),pH=Symbol.for("react.lazy"),p3=Symbol.iterator;function mH(n){return n===null||typeof n!="object"?null:(n=p3&&n[p3]||n["@@iterator"],typeof n=="function"?n:null)}var pB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},mB=Object.assign,gB={};function Zy(n,e,t){this.props=n,this.context=e,this.refs=gB,this.updater=t||pB}Zy.prototype.isReactComponent={};Zy.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Zy.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function _B(){}_B.prototype=Zy.prototype;function LI(n,e,t){this.props=n,this.context=e,this.refs=gB,this.updater=t||pB}var kI=LI.prototype=new _B;kI.constructor=LI;mB(kI,Zy.prototype);kI.isPureReactComponent=!0;var m3=Array.isArray,yB=Object.prototype.hasOwnProperty,DI={current:null},xB={key:!0,ref:!0,__self:!0,__source:!0};function vB(n,e,t){var i,r={},o=null,l=null;if(e!=null)for(i in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(o=""+e.key),e)yB.call(e,i)&&!xB.hasOwnProperty(i)&&(r[i]=e[i]);var s=arguments.length-2;if(s===1)r.children=t;else if(1<s){for(var d=Array(s),p=0;p<s;p++)d[p]=arguments[p+2];r.children=d}if(n&&n.defaultProps)for(i in s=n.defaultProps,s)r[i]===void 0&&(r[i]=s[i]);return{$$typeof:e1,type:n,key:o,ref:l,props:r,_owner:DI.current}}function gH(n,e){return{$$typeof:e1,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function RI(n){return typeof n=="object"&&n!==null&&n.$$typeof===e1}function _H(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var g3=/\/+/g;function gE(n,e){return typeof n=="object"&&n!==null&&n.key!=null?_H(""+n.key):e.toString(36)}function Jb(n,e,t,i,r){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var l=!1;if(n===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(n.$$typeof){case e1:case sH:l=!0}}if(l)return l=n,r=r(l),n=i===""?"."+gE(l,0):i,m3(r)?(t="",n!=null&&(t=n.replace(g3,"$&/")+"/"),Jb(r,e,t,"",function(p){return p})):r!=null&&(RI(r)&&(r=gH(r,t+(!r.key||l&&l.key===r.key?"":(""+r.key).replace(g3,"$&/")+"/")+n)),e.push(r)),1;if(l=0,i=i===""?".":i+":",m3(n))for(var s=0;s<n.length;s++){o=n[s];var d=i+gE(o,s);l+=Jb(o,e,t,d,r)}else if(d=mH(n),typeof d=="function")for(n=d.call(n),s=0;!(o=n.next()).done;)o=o.value,d=i+gE(o,s++),l+=Jb(o,e,t,d,r);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Cw(n,e,t){if(n==null)return n;var i=[],r=0;return Jb(n,i,"","",function(o){return e.call(t,o,r++)}),i}function yH(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var La={current:null},Qb={transition:null},xH={ReactCurrentDispatcher:La,ReactCurrentBatchConfig:Qb,ReactCurrentOwner:DI};Vi.Children={map:Cw,forEach:function(n,e,t){Cw(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Cw(n,function(){e++}),e},toArray:function(n){return Cw(n,function(e){return e})||[]},only:function(n){if(!RI(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Vi.Component=Zy;Vi.Fragment=oH;Vi.Profiler=lH;Vi.PureComponent=LI;Vi.StrictMode=aH;Vi.Suspense=dH;Vi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xH;Vi.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=mB({},n.props),r=n.key,o=n.ref,l=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,l=DI.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var s=n.type.defaultProps;for(d in e)yB.call(e,d)&&!xB.hasOwnProperty(d)&&(i[d]=e[d]===void 0&&s!==void 0?s[d]:e[d])}var d=arguments.length-2;if(d===1)i.children=t;else if(1<d){s=Array(d);for(var p=0;p<d;p++)s[p]=arguments[p+2];i.children=s}return{$$typeof:e1,type:n.type,key:r,ref:o,props:i,_owner:l}};Vi.createContext=function(n){return n={$$typeof:uH,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:cH,_context:n},n.Consumer=n};Vi.createElement=vB;Vi.createFactory=function(n){var e=vB.bind(null,n);return e.type=n,e};Vi.createRef=function(){return{current:null}};Vi.forwardRef=function(n){return{$$typeof:hH,render:n}};Vi.isValidElement=RI;Vi.lazy=function(n){return{$$typeof:pH,_payload:{_status:-1,_result:n},_init:yH}};Vi.memo=function(n,e){return{$$typeof:fH,type:n,compare:e===void 0?null:e}};Vi.startTransition=function(n){var e=Qb.transition;Qb.transition={};try{n()}finally{Qb.transition=e}};Vi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Vi.useCallback=function(n,e){return La.current.useCallback(n,e)};Vi.useContext=function(n){return La.current.useContext(n)};Vi.useDebugValue=function(){};Vi.useDeferredValue=function(n){return La.current.useDeferredValue(n)};Vi.useEffect=function(n,e){return La.current.useEffect(n,e)};Vi.useId=function(){return La.current.useId()};Vi.useImperativeHandle=function(n,e,t){return La.current.useImperativeHandle(n,e,t)};Vi.useInsertionEffect=function(n,e){return La.current.useInsertionEffect(n,e)};Vi.useLayoutEffect=function(n,e){return La.current.useLayoutEffect(n,e)};Vi.useMemo=function(n,e){return La.current.useMemo(n,e)};Vi.useReducer=function(n,e,t){return La.current.useReducer(n,e,t)};Vi.useRef=function(n){return La.current.useRef(n)};Vi.useState=function(n){return La.current.useState(n)};Vi.useSyncExternalStore=function(n,e,t){return La.current.useSyncExternalStore(n,e,t)};Vi.useTransition=function(){return La.current.useTransition()};Vi.version="18.2.0";(function(n){n.exports=Vi})(rH);const zI=fB($t);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vH=$t,wH=Symbol.for("react.element"),bH=Symbol.for("react.fragment"),SH=Object.prototype.hasOwnProperty,MH=vH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,TH={key:!0,ref:!0,__self:!0,__source:!0};function wB(n,e,t){var i,r={},o=null,l=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(l=e.ref);for(i in e)SH.call(e,i)&&!TH.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:wH,type:n,key:o,ref:l,props:r,_owner:MH.current}}SM.Fragment=bH;SM.jsx=wB;SM.jsxs=wB;(function(n){n.exports=SM})(iH);const EH=hv.Fragment,yr=hv.jsx,Ea=hv.jsxs;var aA={},lA={},AH={get exports(){return lA},set exports(n){lA=n}},Vl={},cA={},CH={get exports(){return cA},set exports(n){cA=n}},bB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ce,Te){var Pe=ce.length;ce.push(Te);e:for(;0<Pe;){var Qe=Pe-1>>>1,Ne=ce[Qe];if(0<r(Ne,Te))ce[Qe]=Te,ce[Pe]=Ne,Pe=Qe;else break e}}function t(ce){return ce.length===0?null:ce[0]}function i(ce){if(ce.length===0)return null;var Te=ce[0],Pe=ce.pop();if(Pe!==Te){ce[0]=Pe;e:for(var Qe=0,Ne=ce.length,nt=Ne>>>1;Qe<nt;){var ze=2*(Qe+1)-1,et=ce[ze],Et=ze+1,Nt=ce[Et];if(0>r(et,Pe))Et<Ne&&0>r(Nt,et)?(ce[Qe]=Nt,ce[Et]=Pe,Qe=Et):(ce[Qe]=et,ce[ze]=Pe,Qe=ze);else if(Et<Ne&&0>r(Nt,Pe))ce[Qe]=Nt,ce[Et]=Pe,Qe=Et;else break e}}return Te}function r(ce,Te){var Pe=ce.sortIndex-Te.sortIndex;return Pe!==0?Pe:ce.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,s=l.now();n.unstable_now=function(){return l.now()-s}}var d=[],p=[],_=1,w=null,M=3,A=!1,P=!1,L=!1,D=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ce){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=ce)i(p),Te.sortIndex=Te.expirationTime,e(d,Te);else break;Te=t(p)}}function V(ce){if(L=!1,N(ce),!P)if(t(d)!==null)P=!0,Oe(j);else{var Te=t(p);Te!==null&&We(V,Te.startTime-ce)}}function j(ce,Te){P=!1,L&&(L=!1,z(Z),Z=-1),A=!0;var Pe=M;try{for(N(Te),w=t(d);w!==null&&(!(w.expirationTime>Te)||ce&&!De());){var Qe=w.callback;if(typeof Qe=="function"){w.callback=null,M=w.priorityLevel;var Ne=Qe(w.expirationTime<=Te);Te=n.unstable_now(),typeof Ne=="function"?w.callback=Ne:w===t(d)&&i(d),N(Te)}else i(d);w=t(d)}if(w!==null)var nt=!0;else{var ze=t(p);ze!==null&&We(V,ze.startTime-Te),nt=!1}return nt}finally{w=null,M=Pe,A=!1}}var Q=!1,re=null,Z=-1,ne=5,he=-1;function De(){return!(n.unstable_now()-he<ne)}function He(){if(re!==null){var ce=n.unstable_now();he=ce;var Te=!0;try{Te=re(!0,ce)}finally{Te?ae():(Q=!1,re=null)}}else Q=!1}var ae;if(typeof F=="function")ae=function(){F(He)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,fe=le.port2;le.port1.onmessage=He,ae=function(){fe.postMessage(null)}}else ae=function(){D(He,0)};function Oe(ce){re=ce,Q||(Q=!0,ae())}function We(ce,Te){Z=D(function(){ce(n.unstable_now())},Te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){P||A||(P=!0,Oe(j))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return M},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ce){switch(M){case 1:case 2:case 3:var Te=3;break;default:Te=M}var Pe=M;M=Te;try{return ce()}finally{M=Pe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Te){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Pe=M;M=ce;try{return Te()}finally{M=Pe}},n.unstable_scheduleCallback=function(ce,Te,Pe){var Qe=n.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?Qe+Pe:Qe):Pe=Qe,ce){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=Pe+Ne,ce={id:_++,callback:Te,priorityLevel:ce,startTime:Pe,expirationTime:Ne,sortIndex:-1},Pe>Qe?(ce.sortIndex=Pe,e(p,ce),t(d)===null&&ce===t(p)&&(L?(z(Z),Z=-1):L=!0,We(V,Pe-Qe))):(ce.sortIndex=Ne,e(d,ce),P||A||(P=!0,Oe(j))),ce},n.unstable_shouldYield=De,n.unstable_wrapCallback=function(ce){var Te=M;return function(){var Pe=M;M=Te;try{return ce.apply(this,arguments)}finally{M=Pe}}}})(bB);(function(n){n.exports=bB})(CH);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SB=$t,Bl=cA;function on(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var MB=new Set,dv={};function Ag(n,e){xy(n,e),xy(n+"Capture",e)}function xy(n,e){for(dv[n]=e,n=0;n<e.length;n++)MB.add(e[n])}var Hd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uA=Object.prototype.hasOwnProperty,IH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_3={},y3={};function PH(n){return uA.call(y3,n)?!0:uA.call(_3,n)?!1:IH.test(n)?y3[n]=!0:(_3[n]=!0,!1)}function LH(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function kH(n,e,t,i){if(e===null||typeof e>"u"||LH(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ka(n,e,t,i,r,o,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=l}var Go={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Go[n]=new ka(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Go[e]=new ka(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Go[n]=new ka(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Go[n]=new ka(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Go[n]=new ka(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Go[n]=new ka(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Go[n]=new ka(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Go[n]=new ka(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Go[n]=new ka(n,5,!1,n.toLowerCase(),null,!1,!1)});var OI=/[\-:]([a-z])/g;function FI(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(OI,FI);Go[e]=new ka(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(OI,FI);Go[e]=new ka(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(OI,FI);Go[e]=new ka(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Go[n]=new ka(n,1,!1,n.toLowerCase(),null,!1,!1)});Go.xlinkHref=new ka("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Go[n]=new ka(n,1,!1,n.toLowerCase(),null,!0,!0)});function BI(n,e,t,i){var r=Go.hasOwnProperty(e)?Go[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kH(e,t,r,i)&&(t=null),i||r===null?PH(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var ef=SB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Iw=Symbol.for("react.element"),U_=Symbol.for("react.portal"),V_=Symbol.for("react.fragment"),NI=Symbol.for("react.strict_mode"),hA=Symbol.for("react.profiler"),TB=Symbol.for("react.provider"),EB=Symbol.for("react.context"),UI=Symbol.for("react.forward_ref"),dA=Symbol.for("react.suspense"),fA=Symbol.for("react.suspense_list"),VI=Symbol.for("react.memo"),qf=Symbol.for("react.lazy"),AB=Symbol.for("react.offscreen"),x3=Symbol.iterator;function Y0(n){return n===null||typeof n!="object"?null:(n=x3&&n[x3]||n["@@iterator"],typeof n=="function"?n:null)}var fs=Object.assign,_E;function Lx(n){if(_E===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);_E=e&&e[1]||""}return`
`+_E+n}var yE=!1;function xE(n,e){if(!n||yE)return"";yE=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var i=p}Reflect.construct(n,[],e)}else{try{e.call()}catch(p){i=p}n.call(e.prototype)}else{try{throw Error()}catch(p){i=p}n()}}catch(p){if(p&&i&&typeof p.stack=="string"){for(var r=p.stack.split(`
`),o=i.stack.split(`
`),l=r.length-1,s=o.length-1;1<=l&&0<=s&&r[l]!==o[s];)s--;for(;1<=l&&0<=s;l--,s--)if(r[l]!==o[s]){if(l!==1||s!==1)do if(l--,s--,0>s||r[l]!==o[s]){var d=`
`+r[l].replace(" at new "," at ");return n.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",n.displayName)),d}while(1<=l&&0<=s);break}}}finally{yE=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Lx(n):""}function DH(n){switch(n.tag){case 5:return Lx(n.type);case 16:return Lx("Lazy");case 13:return Lx("Suspense");case 19:return Lx("SuspenseList");case 0:case 2:case 15:return n=xE(n.type,!1),n;case 11:return n=xE(n.type.render,!1),n;case 1:return n=xE(n.type,!0),n;default:return""}}function pA(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case V_:return"Fragment";case U_:return"Portal";case hA:return"Profiler";case NI:return"StrictMode";case dA:return"Suspense";case fA:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case EB:return(n.displayName||"Context")+".Consumer";case TB:return(n._context.displayName||"Context")+".Provider";case UI:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case VI:return e=n.displayName||null,e!==null?e:pA(n.type)||"Memo";case qf:e=n._payload,n=n._init;try{return pA(n(e))}catch{}}return null}function RH(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pA(e);case 8:return e===NI?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Mp(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function CB(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zH(n){var e=CB(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(l){i=""+l,o.call(this,l)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(l){i=""+l},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Pw(n){n._valueTracker||(n._valueTracker=zH(n))}function IB(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=CB(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function MS(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function mA(n,e){var t=e.checked;return fs({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function v3(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Mp(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function PB(n,e){e=e.checked,e!=null&&BI(n,"checked",e,!1)}function gA(n,e){PB(n,e);var t=Mp(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?_A(n,e.type,t):e.hasOwnProperty("defaultValue")&&_A(n,e.type,Mp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function w3(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function _A(n,e,t){(e!=="number"||MS(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var kx=Array.isArray;function iy(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Mp(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function yA(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(on(91));return fs({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function b3(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(on(92));if(kx(t)){if(1<t.length)throw Error(on(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Mp(t)}}function LB(n,e){var t=Mp(e.value),i=Mp(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function S3(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function kB(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xA(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?kB(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Lw,DB=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Lw=Lw||document.createElement("div"),Lw.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Lw.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function fv(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Gx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OH=["Webkit","ms","Moz","O"];Object.keys(Gx).forEach(function(n){OH.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Gx[e]=Gx[n]})});function RB(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Gx.hasOwnProperty(n)&&Gx[n]?(""+e).trim():e+"px"}function zB(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=RB(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var FH=fs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vA(n,e){if(e){if(FH[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(on(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(on(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(on(61))}if(e.style!=null&&typeof e.style!="object")throw Error(on(62))}}function wA(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bA=null;function GI(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var SA=null,ry=null,sy=null;function M3(n){if(n=i1(n)){if(typeof SA!="function")throw Error(on(280));var e=n.stateNode;e&&(e=CM(e),SA(n.stateNode,n.type,e))}}function OB(n){ry?sy?sy.push(n):sy=[n]:ry=n}function FB(){if(ry){var n=ry,e=sy;if(sy=ry=null,M3(n),e)for(n=0;n<e.length;n++)M3(e[n])}}function BB(n,e){return n(e)}function NB(){}var vE=!1;function UB(n,e,t){if(vE)return n(e,t);vE=!0;try{return BB(n,e,t)}finally{vE=!1,(ry!==null||sy!==null)&&(NB(),FB())}}function pv(n,e){var t=n.stateNode;if(t===null)return null;var i=CM(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(on(231,e,typeof t));return t}var MA=!1;if(Hd)try{var K0={};Object.defineProperty(K0,"passive",{get:function(){MA=!0}}),window.addEventListener("test",K0,K0),window.removeEventListener("test",K0,K0)}catch{MA=!1}function BH(n,e,t,i,r,o,l,s,d){var p=Array.prototype.slice.call(arguments,3);try{e.apply(t,p)}catch(_){this.onError(_)}}var Wx=!1,TS=null,ES=!1,TA=null,NH={onError:function(n){Wx=!0,TS=n}};function UH(n,e,t,i,r,o,l,s,d){Wx=!1,TS=null,BH.apply(NH,arguments)}function VH(n,e,t,i,r,o,l,s,d){if(UH.apply(this,arguments),Wx){if(Wx){var p=TS;Wx=!1,TS=null}else throw Error(on(198));ES||(ES=!0,TA=p)}}function Cg(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function VB(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function T3(n){if(Cg(n)!==n)throw Error(on(188))}function GH(n){var e=n.alternate;if(!e){if(e=Cg(n),e===null)throw Error(on(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var o=r.alternate;if(o===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===t)return T3(r),n;if(o===i)return T3(r),e;o=o.sibling}throw Error(on(188))}if(t.return!==i.return)t=r,i=o;else{for(var l=!1,s=r.child;s;){if(s===t){l=!0,t=r,i=o;break}if(s===i){l=!0,i=r,t=o;break}s=s.sibling}if(!l){for(s=o.child;s;){if(s===t){l=!0,t=o,i=r;break}if(s===i){l=!0,i=o,t=r;break}s=s.sibling}if(!l)throw Error(on(189))}}if(t.alternate!==i)throw Error(on(190))}if(t.tag!==3)throw Error(on(188));return t.stateNode.current===t?n:e}function GB(n){return n=GH(n),n!==null?WB(n):null}function WB(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=WB(n);if(e!==null)return e;n=n.sibling}return null}var HB=Bl.unstable_scheduleCallback,E3=Bl.unstable_cancelCallback,WH=Bl.unstable_shouldYield,HH=Bl.unstable_requestPaint,Os=Bl.unstable_now,jH=Bl.unstable_getCurrentPriorityLevel,WI=Bl.unstable_ImmediatePriority,jB=Bl.unstable_UserBlockingPriority,AS=Bl.unstable_NormalPriority,qH=Bl.unstable_LowPriority,qB=Bl.unstable_IdlePriority,MM=null,Sh=null;function ZH(n){if(Sh&&typeof Sh.onCommitFiberRoot=="function")try{Sh.onCommitFiberRoot(MM,n,void 0,(n.current.flags&128)===128)}catch{}}var Au=Math.clz32?Math.clz32:YH,XH=Math.log,$H=Math.LN2;function YH(n){return n>>>=0,n===0?32:31-(XH(n)/$H|0)|0}var kw=64,Dw=4194304;function Dx(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function CS(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,o=n.pingedLanes,l=t&268435455;if(l!==0){var s=l&~r;s!==0?i=Dx(s):(o&=l,o!==0&&(i=Dx(o)))}else l=t&~r,l!==0?i=Dx(l):o!==0&&(i=Dx(o));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Au(e),r=1<<t,i|=n[t],e&=~r;return i}function KH(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JH(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,o=n.pendingLanes;0<o;){var l=31-Au(o),s=1<<l,d=r[l];d===-1?(!(s&t)||s&i)&&(r[l]=KH(s,e)):d<=e&&(n.expiredLanes|=s),o&=~s}}function EA(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function ZB(){var n=kw;return kw<<=1,!(kw&4194240)&&(kw=64),n}function wE(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function t1(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Au(e),n[e]=t}function QH(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Au(t),o=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~o}}function HI(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Au(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var Er=0;function XB(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var $B,jI,YB,KB,JB,AA=!1,Rw=[],dp=null,fp=null,pp=null,mv=new Map,gv=new Map,Jf=[],ej="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function A3(n,e){switch(n){case"focusin":case"focusout":dp=null;break;case"dragenter":case"dragleave":fp=null;break;case"mouseover":case"mouseout":pp=null;break;case"pointerover":case"pointerout":mv.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gv.delete(e.pointerId)}}function J0(n,e,t,i,r,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},e!==null&&(e=i1(e),e!==null&&jI(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function tj(n,e,t,i,r){switch(e){case"focusin":return dp=J0(dp,n,e,t,i,r),!0;case"dragenter":return fp=J0(fp,n,e,t,i,r),!0;case"mouseover":return pp=J0(pp,n,e,t,i,r),!0;case"pointerover":var o=r.pointerId;return mv.set(o,J0(mv.get(o)||null,n,e,t,i,r)),!0;case"gotpointercapture":return o=r.pointerId,gv.set(o,J0(gv.get(o)||null,n,e,t,i,r)),!0}return!1}function QB(n){var e=jm(n.target);if(e!==null){var t=Cg(e);if(t!==null){if(e=t.tag,e===13){if(e=VB(t),e!==null){n.blockedOn=e,JB(n.priority,function(){YB(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function eS(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=CA(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);bA=i,t.target.dispatchEvent(i),bA=null}else return e=i1(t),e!==null&&jI(e),n.blockedOn=t,!1;e.shift()}return!0}function C3(n,e,t){eS(n)&&t.delete(e)}function nj(){AA=!1,dp!==null&&eS(dp)&&(dp=null),fp!==null&&eS(fp)&&(fp=null),pp!==null&&eS(pp)&&(pp=null),mv.forEach(C3),gv.forEach(C3)}function Q0(n,e){n.blockedOn===e&&(n.blockedOn=null,AA||(AA=!0,Bl.unstable_scheduleCallback(Bl.unstable_NormalPriority,nj)))}function _v(n){function e(r){return Q0(r,n)}if(0<Rw.length){Q0(Rw[0],n);for(var t=1;t<Rw.length;t++){var i=Rw[t];i.blockedOn===n&&(i.blockedOn=null)}}for(dp!==null&&Q0(dp,n),fp!==null&&Q0(fp,n),pp!==null&&Q0(pp,n),mv.forEach(e),gv.forEach(e),t=0;t<Jf.length;t++)i=Jf[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Jf.length&&(t=Jf[0],t.blockedOn===null);)QB(t),t.blockedOn===null&&Jf.shift()}var oy=ef.ReactCurrentBatchConfig,IS=!0;function ij(n,e,t,i){var r=Er,o=oy.transition;oy.transition=null;try{Er=1,qI(n,e,t,i)}finally{Er=r,oy.transition=o}}function rj(n,e,t,i){var r=Er,o=oy.transition;oy.transition=null;try{Er=4,qI(n,e,t,i)}finally{Er=r,oy.transition=o}}function qI(n,e,t,i){if(IS){var r=CA(n,e,t,i);if(r===null)LE(n,e,i,PS,t),A3(n,i);else if(tj(r,n,e,t,i))i.stopPropagation();else if(A3(n,i),e&4&&-1<ej.indexOf(n)){for(;r!==null;){var o=i1(r);if(o!==null&&$B(o),o=CA(n,e,t,i),o===null&&LE(n,e,i,PS,t),o===r)break;r=o}r!==null&&i.stopPropagation()}else LE(n,e,i,null,t)}}var PS=null;function CA(n,e,t,i){if(PS=null,n=GI(i),n=jm(n),n!==null)if(e=Cg(n),e===null)n=null;else if(t=e.tag,t===13){if(n=VB(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return PS=n,null}function eN(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jH()){case WI:return 1;case jB:return 4;case AS:case qH:return 16;case qB:return 536870912;default:return 16}default:return 16}}var tp=null,ZI=null,tS=null;function tN(){if(tS)return tS;var n,e=ZI,t=e.length,i,r="value"in tp?tp.value:tp.textContent,o=r.length;for(n=0;n<t&&e[n]===r[n];n++);var l=t-n;for(i=1;i<=l&&e[t-i]===r[o-i];i++);return tS=r.slice(n,1<i?1-i:void 0)}function nS(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function zw(){return!0}function I3(){return!1}function Gl(n){function e(t,i,r,o,l){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var s in n)n.hasOwnProperty(s)&&(t=n[s],this[s]=t?t(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?zw:I3,this.isPropagationStopped=I3,this}return fs(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=zw)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=zw)},persist:function(){},isPersistent:zw}),e}var Xy={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},XI=Gl(Xy),n1=fs({},Xy,{view:0,detail:0}),sj=Gl(n1),bE,SE,ex,TM=fs({},n1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$I,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ex&&(ex&&n.type==="mousemove"?(bE=n.screenX-ex.screenX,SE=n.screenY-ex.screenY):SE=bE=0,ex=n),bE)},movementY:function(n){return"movementY"in n?n.movementY:SE}}),P3=Gl(TM),oj=fs({},TM,{dataTransfer:0}),aj=Gl(oj),lj=fs({},n1,{relatedTarget:0}),ME=Gl(lj),cj=fs({},Xy,{animationName:0,elapsedTime:0,pseudoElement:0}),uj=Gl(cj),hj=fs({},Xy,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),dj=Gl(hj),fj=fs({},Xy,{data:0}),L3=Gl(fj),pj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _j(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=gj[n])?!!e[n]:!1}function $I(){return _j}var yj=fs({},n1,{key:function(n){if(n.key){var e=pj[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=nS(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?mj[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$I,charCode:function(n){return n.type==="keypress"?nS(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?nS(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),xj=Gl(yj),vj=fs({},TM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),k3=Gl(vj),wj=fs({},n1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$I}),bj=Gl(wj),Sj=fs({},Xy,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mj=Gl(Sj),Tj=fs({},TM,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ej=Gl(Tj),Aj=[9,13,27,32],YI=Hd&&"CompositionEvent"in window,Hx=null;Hd&&"documentMode"in document&&(Hx=document.documentMode);var Cj=Hd&&"TextEvent"in window&&!Hx,nN=Hd&&(!YI||Hx&&8<Hx&&11>=Hx),D3=String.fromCharCode(32),R3=!1;function iN(n,e){switch(n){case"keyup":return Aj.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rN(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var G_=!1;function Ij(n,e){switch(n){case"compositionend":return rN(e);case"keypress":return e.which!==32?null:(R3=!0,D3);case"textInput":return n=e.data,n===D3&&R3?null:n;default:return null}}function Pj(n,e){if(G_)return n==="compositionend"||!YI&&iN(n,e)?(n=tN(),tS=ZI=tp=null,G_=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nN&&e.locale!=="ko"?null:e.data;default:return null}}var Lj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function z3(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Lj[n.type]:e==="textarea"}function sN(n,e,t,i){OB(i),e=LS(e,"onChange"),0<e.length&&(t=new XI("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var jx=null,yv=null;function kj(n){gN(n,0)}function EM(n){var e=j_(n);if(IB(e))return n}function Dj(n,e){if(n==="change")return e}var oN=!1;if(Hd){var TE;if(Hd){var EE="oninput"in document;if(!EE){var O3=document.createElement("div");O3.setAttribute("oninput","return;"),EE=typeof O3.oninput=="function"}TE=EE}else TE=!1;oN=TE&&(!document.documentMode||9<document.documentMode)}function F3(){jx&&(jx.detachEvent("onpropertychange",aN),yv=jx=null)}function aN(n){if(n.propertyName==="value"&&EM(yv)){var e=[];sN(e,yv,n,GI(n)),UB(kj,e)}}function Rj(n,e,t){n==="focusin"?(F3(),jx=e,yv=t,jx.attachEvent("onpropertychange",aN)):n==="focusout"&&F3()}function zj(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return EM(yv)}function Oj(n,e){if(n==="click")return EM(e)}function Fj(n,e){if(n==="input"||n==="change")return EM(e)}function Bj(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Lu=typeof Object.is=="function"?Object.is:Bj;function xv(n,e){if(Lu(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!uA.call(e,r)||!Lu(n[r],e[r]))return!1}return!0}function B3(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function N3(n,e){var t=B3(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=B3(t)}}function lN(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?lN(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function cN(){for(var n=window,e=MS();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=MS(n.document)}return e}function KI(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Nj(n){var e=cN(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&lN(t.ownerDocument.documentElement,t)){if(i!==null&&KI(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,o=Math.min(i.start,r);i=i.end===void 0?o:Math.min(i.end,r),!n.extend&&o>i&&(r=i,i=o,o=r),r=N3(t,o);var l=N3(t,i);r&&l&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==l.node||n.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),o>i?(n.addRange(e),n.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Uj=Hd&&"documentMode"in document&&11>=document.documentMode,W_=null,IA=null,qx=null,PA=!1;function U3(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;PA||W_==null||W_!==MS(i)||(i=W_,"selectionStart"in i&&KI(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),qx&&xv(qx,i)||(qx=i,i=LS(IA,"onSelect"),0<i.length&&(e=new XI("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=W_)))}function Ow(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var H_={animationend:Ow("Animation","AnimationEnd"),animationiteration:Ow("Animation","AnimationIteration"),animationstart:Ow("Animation","AnimationStart"),transitionend:Ow("Transition","TransitionEnd")},AE={},uN={};Hd&&(uN=document.createElement("div").style,"AnimationEvent"in window||(delete H_.animationend.animation,delete H_.animationiteration.animation,delete H_.animationstart.animation),"TransitionEvent"in window||delete H_.transitionend.transition);function AM(n){if(AE[n])return AE[n];if(!H_[n])return n;var e=H_[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in uN)return AE[n]=e[t];return n}var hN=AM("animationend"),dN=AM("animationiteration"),fN=AM("animationstart"),pN=AM("transitionend"),mN=new Map,V3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zp(n,e){mN.set(n,e),Ag(e,[n])}for(var CE=0;CE<V3.length;CE++){var IE=V3[CE],Vj=IE.toLowerCase(),Gj=IE[0].toUpperCase()+IE.slice(1);zp(Vj,"on"+Gj)}zp(hN,"onAnimationEnd");zp(dN,"onAnimationIteration");zp(fN,"onAnimationStart");zp("dblclick","onDoubleClick");zp("focusin","onFocus");zp("focusout","onBlur");zp(pN,"onTransitionEnd");xy("onMouseEnter",["mouseout","mouseover"]);xy("onMouseLeave",["mouseout","mouseover"]);xy("onPointerEnter",["pointerout","pointerover"]);xy("onPointerLeave",["pointerout","pointerover"]);Ag("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ag("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ag("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ag("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ag("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ag("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rx));function G3(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,VH(i,e,void 0,n),n.currentTarget=null}function gN(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var o=void 0;if(e)for(var l=i.length-1;0<=l;l--){var s=i[l],d=s.instance,p=s.currentTarget;if(s=s.listener,d!==o&&r.isPropagationStopped())break e;G3(r,s,p),o=d}else for(l=0;l<i.length;l++){if(s=i[l],d=s.instance,p=s.currentTarget,s=s.listener,d!==o&&r.isPropagationStopped())break e;G3(r,s,p),o=d}}}if(ES)throw n=TA,ES=!1,TA=null,n}function Wr(n,e){var t=e[zA];t===void 0&&(t=e[zA]=new Set);var i=n+"__bubble";t.has(i)||(_N(e,n,2,!1),t.add(i))}function PE(n,e,t){var i=0;e&&(i|=4),_N(t,n,i,e)}var Fw="_reactListening"+Math.random().toString(36).slice(2);function vv(n){if(!n[Fw]){n[Fw]=!0,MB.forEach(function(t){t!=="selectionchange"&&(Wj.has(t)||PE(t,!1,n),PE(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Fw]||(e[Fw]=!0,PE("selectionchange",!1,e))}}function _N(n,e,t,i){switch(eN(e)){case 1:var r=ij;break;case 4:r=rj;break;default:r=qI}t=r.bind(null,e,t,n),r=void 0,!MA||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function LE(n,e,t,i,r){var o=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var l=i.tag;if(l===3||l===4){var s=i.stateNode.containerInfo;if(s===r||s.nodeType===8&&s.parentNode===r)break;if(l===4)for(l=i.return;l!==null;){var d=l.tag;if((d===3||d===4)&&(d=l.stateNode.containerInfo,d===r||d.nodeType===8&&d.parentNode===r))return;l=l.return}for(;s!==null;){if(l=jm(s),l===null)return;if(d=l.tag,d===5||d===6){i=o=l;continue e}s=s.parentNode}}i=i.return}UB(function(){var p=o,_=GI(t),w=[];e:{var M=mN.get(n);if(M!==void 0){var A=XI,P=n;switch(n){case"keypress":if(nS(t)===0)break e;case"keydown":case"keyup":A=xj;break;case"focusin":P="focus",A=ME;break;case"focusout":P="blur",A=ME;break;case"beforeblur":case"afterblur":A=ME;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=P3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=aj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=bj;break;case hN:case dN:case fN:A=uj;break;case pN:A=Mj;break;case"scroll":A=sj;break;case"wheel":A=Ej;break;case"copy":case"cut":case"paste":A=dj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=k3}var L=(e&4)!==0,D=!L&&n==="scroll",z=L?M!==null?M+"Capture":null:M;L=[];for(var F=p,N;F!==null;){N=F;var V=N.stateNode;if(N.tag===5&&V!==null&&(N=V,z!==null&&(V=pv(F,z),V!=null&&L.push(wv(F,V,N)))),D)break;F=F.return}0<L.length&&(M=new A(M,P,null,t,_),w.push({event:M,listeners:L}))}}if(!(e&7)){e:{if(M=n==="mouseover"||n==="pointerover",A=n==="mouseout"||n==="pointerout",M&&t!==bA&&(P=t.relatedTarget||t.fromElement)&&(jm(P)||P[jd]))break e;if((A||M)&&(M=_.window===_?_:(M=_.ownerDocument)?M.defaultView||M.parentWindow:window,A?(P=t.relatedTarget||t.toElement,A=p,P=P?jm(P):null,P!==null&&(D=Cg(P),P!==D||P.tag!==5&&P.tag!==6)&&(P=null)):(A=null,P=p),A!==P)){if(L=P3,V="onMouseLeave",z="onMouseEnter",F="mouse",(n==="pointerout"||n==="pointerover")&&(L=k3,V="onPointerLeave",z="onPointerEnter",F="pointer"),D=A==null?M:j_(A),N=P==null?M:j_(P),M=new L(V,F+"leave",A,t,_),M.target=D,M.relatedTarget=N,V=null,jm(_)===p&&(L=new L(z,F+"enter",P,t,_),L.target=N,L.relatedTarget=D,V=L),D=V,A&&P)t:{for(L=A,z=P,F=0,N=L;N;N=p_(N))F++;for(N=0,V=z;V;V=p_(V))N++;for(;0<F-N;)L=p_(L),F--;for(;0<N-F;)z=p_(z),N--;for(;F--;){if(L===z||z!==null&&L===z.alternate)break t;L=p_(L),z=p_(z)}L=null}else L=null;A!==null&&W3(w,M,A,L,!1),P!==null&&D!==null&&W3(w,D,P,L,!0)}}e:{if(M=p?j_(p):window,A=M.nodeName&&M.nodeName.toLowerCase(),A==="select"||A==="input"&&M.type==="file")var j=Dj;else if(z3(M))if(oN)j=Fj;else{j=zj;var Q=Rj}else(A=M.nodeName)&&A.toLowerCase()==="input"&&(M.type==="checkbox"||M.type==="radio")&&(j=Oj);if(j&&(j=j(n,p))){sN(w,j,t,_);break e}Q&&Q(n,M,p),n==="focusout"&&(Q=M._wrapperState)&&Q.controlled&&M.type==="number"&&_A(M,"number",M.value)}switch(Q=p?j_(p):window,n){case"focusin":(z3(Q)||Q.contentEditable==="true")&&(W_=Q,IA=p,qx=null);break;case"focusout":qx=IA=W_=null;break;case"mousedown":PA=!0;break;case"contextmenu":case"mouseup":case"dragend":PA=!1,U3(w,t,_);break;case"selectionchange":if(Uj)break;case"keydown":case"keyup":U3(w,t,_)}var re;if(YI)e:{switch(n){case"compositionstart":var Z="onCompositionStart";break e;case"compositionend":Z="onCompositionEnd";break e;case"compositionupdate":Z="onCompositionUpdate";break e}Z=void 0}else G_?iN(n,t)&&(Z="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(Z="onCompositionStart");Z&&(nN&&t.locale!=="ko"&&(G_||Z!=="onCompositionStart"?Z==="onCompositionEnd"&&G_&&(re=tN()):(tp=_,ZI="value"in tp?tp.value:tp.textContent,G_=!0)),Q=LS(p,Z),0<Q.length&&(Z=new L3(Z,n,null,t,_),w.push({event:Z,listeners:Q}),re?Z.data=re:(re=rN(t),re!==null&&(Z.data=re)))),(re=Cj?Ij(n,t):Pj(n,t))&&(p=LS(p,"onBeforeInput"),0<p.length&&(_=new L3("onBeforeInput","beforeinput",null,t,_),w.push({event:_,listeners:p}),_.data=re))}gN(w,e)})}function wv(n,e,t){return{instance:n,listener:e,currentTarget:t}}function LS(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=pv(n,t),o!=null&&i.unshift(wv(n,o,r)),o=pv(n,e),o!=null&&i.push(wv(n,o,r))),n=n.return}return i}function p_(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function W3(n,e,t,i,r){for(var o=e._reactName,l=[];t!==null&&t!==i;){var s=t,d=s.alternate,p=s.stateNode;if(d!==null&&d===i)break;s.tag===5&&p!==null&&(s=p,r?(d=pv(t,o),d!=null&&l.unshift(wv(t,d,s))):r||(d=pv(t,o),d!=null&&l.push(wv(t,d,s)))),t=t.return}l.length!==0&&n.push({event:e,listeners:l})}var Hj=/\r\n?/g,jj=/\u0000|\uFFFD/g;function H3(n){return(typeof n=="string"?n:""+n).replace(Hj,`
`).replace(jj,"")}function Bw(n,e,t){if(e=H3(e),H3(n)!==e&&t)throw Error(on(425))}function kS(){}var LA=null,kA=null;function DA(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var RA=typeof setTimeout=="function"?setTimeout:void 0,qj=typeof clearTimeout=="function"?clearTimeout:void 0,j3=typeof Promise=="function"?Promise:void 0,Zj=typeof queueMicrotask=="function"?queueMicrotask:typeof j3<"u"?function(n){return j3.resolve(null).then(n).catch(Xj)}:RA;function Xj(n){setTimeout(function(){throw n})}function kE(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),_v(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);_v(e)}function mp(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function q3(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var $y=Math.random().toString(36).slice(2),vh="__reactFiber$"+$y,bv="__reactProps$"+$y,jd="__reactContainer$"+$y,zA="__reactEvents$"+$y,$j="__reactListeners$"+$y,Yj="__reactHandles$"+$y;function jm(n){var e=n[vh];if(e)return e;for(var t=n.parentNode;t;){if(e=t[jd]||t[vh]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=q3(n);n!==null;){if(t=n[vh])return t;n=q3(n)}return e}n=t,t=n.parentNode}return null}function i1(n){return n=n[vh]||n[jd],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function j_(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(on(33))}function CM(n){return n[bv]||null}var OA=[],q_=-1;function Op(n){return{current:n}}function Zr(n){0>q_||(n.current=OA[q_],OA[q_]=null,q_--)}function Nr(n,e){q_++,OA[q_]=n.current,n.current=e}var Tp={},pa=Op(Tp),Ka=Op(!1),pg=Tp;function vy(n,e){var t=n.type.contextTypes;if(!t)return Tp;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in t)r[o]=e[o];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Ja(n){return n=n.childContextTypes,n!=null}function DS(){Zr(Ka),Zr(pa)}function Z3(n,e,t){if(pa.current!==Tp)throw Error(on(168));Nr(pa,e),Nr(Ka,t)}function yN(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(on(108,RH(n)||"Unknown",r));return fs({},t,i)}function RS(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Tp,pg=pa.current,Nr(pa,n),Nr(Ka,Ka.current),!0}function X3(n,e,t){var i=n.stateNode;if(!i)throw Error(on(169));t?(n=yN(n,e,pg),i.__reactInternalMemoizedMergedChildContext=n,Zr(Ka),Zr(pa),Nr(pa,n)):Zr(Ka),Nr(Ka,t)}var Cd=null,IM=!1,DE=!1;function xN(n){Cd===null?Cd=[n]:Cd.push(n)}function Kj(n){IM=!0,xN(n)}function Fp(){if(!DE&&Cd!==null){DE=!0;var n=0,e=Er;try{var t=Cd;for(Er=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Cd=null,IM=!1}catch(r){throw Cd!==null&&(Cd=Cd.slice(n+1)),HB(WI,Fp),r}finally{Er=e,DE=!1}}return null}var Z_=[],X_=0,zS=null,OS=0,_c=[],yc=0,mg=null,Rd=1,zd="";function zm(n,e){Z_[X_++]=OS,Z_[X_++]=zS,zS=n,OS=e}function vN(n,e,t){_c[yc++]=Rd,_c[yc++]=zd,_c[yc++]=mg,mg=n;var i=Rd;n=zd;var r=32-Au(i)-1;i&=~(1<<r),t+=1;var o=32-Au(e)+r;if(30<o){var l=r-r%5;o=(i&(1<<l)-1).toString(32),i>>=l,r-=l,Rd=1<<32-Au(e)+r|t<<r|i,zd=o+n}else Rd=1<<o|t<<r|i,zd=n}function JI(n){n.return!==null&&(zm(n,1),vN(n,1,0))}function QI(n){for(;n===zS;)zS=Z_[--X_],Z_[X_]=null,OS=Z_[--X_],Z_[X_]=null;for(;n===mg;)mg=_c[--yc],_c[yc]=null,zd=_c[--yc],_c[yc]=null,Rd=_c[--yc],_c[yc]=null}var Rl=null,kl=null,Kr=!1,bu=null;function wN(n,e){var t=bc(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function $3(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Rl=n,kl=mp(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Rl=n,kl=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=mg!==null?{id:Rd,overflow:zd}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=bc(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Rl=n,kl=null,!0):!1;default:return!1}}function FA(n){return(n.mode&1)!==0&&(n.flags&128)===0}function BA(n){if(Kr){var e=kl;if(e){var t=e;if(!$3(n,e)){if(FA(n))throw Error(on(418));e=mp(t.nextSibling);var i=Rl;e&&$3(n,e)?wN(i,t):(n.flags=n.flags&-4097|2,Kr=!1,Rl=n)}}else{if(FA(n))throw Error(on(418));n.flags=n.flags&-4097|2,Kr=!1,Rl=n}}}function Y3(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Rl=n}function Nw(n){if(n!==Rl)return!1;if(!Kr)return Y3(n),Kr=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!DA(n.type,n.memoizedProps)),e&&(e=kl)){if(FA(n))throw bN(),Error(on(418));for(;e;)wN(n,e),e=mp(e.nextSibling)}if(Y3(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(on(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){kl=mp(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}kl=null}}else kl=Rl?mp(n.stateNode.nextSibling):null;return!0}function bN(){for(var n=kl;n;)n=mp(n.nextSibling)}function wy(){kl=Rl=null,Kr=!1}function eP(n){bu===null?bu=[n]:bu.push(n)}var Jj=ef.ReactCurrentBatchConfig;function yu(n,e){if(n&&n.defaultProps){e=fs({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var FS=Op(null),BS=null,$_=null,tP=null;function nP(){tP=$_=BS=null}function iP(n){var e=FS.current;Zr(FS),n._currentValue=e}function NA(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function ay(n,e){BS=n,tP=$_=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Ya=!0),n.firstContext=null)}function Ic(n){var e=n._currentValue;if(tP!==n)if(n={context:n,memoizedValue:e,next:null},$_===null){if(BS===null)throw Error(on(308));$_=n,BS.dependencies={lanes:0,firstContext:n}}else $_=$_.next=n;return e}var qm=null;function rP(n){qm===null?qm=[n]:qm.push(n)}function SN(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,rP(e)):(t.next=r.next,r.next=t),e.interleaved=t,qd(n,i)}function qd(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Zf=!1;function sP(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function MN(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Vd(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function gp(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,cr&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,qd(n,t)}return r=i.interleaved,r===null?(e.next=e,rP(i)):(e.next=r.next,r.next=e),i.interleaved=e,qd(n,t)}function iS(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,HI(n,t)}}function K3(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var l={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?r=o=l:o=o.next=l,t=t.next}while(t!==null);o===null?r=o=e:o=o.next=e}else r=o=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function NS(n,e,t,i){var r=n.updateQueue;Zf=!1;var o=r.firstBaseUpdate,l=r.lastBaseUpdate,s=r.shared.pending;if(s!==null){r.shared.pending=null;var d=s,p=d.next;d.next=null,l===null?o=p:l.next=p,l=d;var _=n.alternate;_!==null&&(_=_.updateQueue,s=_.lastBaseUpdate,s!==l&&(s===null?_.firstBaseUpdate=p:s.next=p,_.lastBaseUpdate=d))}if(o!==null){var w=r.baseState;l=0,_=p=d=null,s=o;do{var M=s.lane,A=s.eventTime;if((i&M)===M){_!==null&&(_=_.next={eventTime:A,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var P=n,L=s;switch(M=e,A=t,L.tag){case 1:if(P=L.payload,typeof P=="function"){w=P.call(A,w,M);break e}w=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=L.payload,M=typeof P=="function"?P.call(A,w,M):P,M==null)break e;w=fs({},w,M);break e;case 2:Zf=!0}}s.callback!==null&&s.lane!==0&&(n.flags|=64,M=r.effects,M===null?r.effects=[s]:M.push(s))}else A={eventTime:A,lane:M,tag:s.tag,payload:s.payload,callback:s.callback,next:null},_===null?(p=_=A,d=w):_=_.next=A,l|=M;if(s=s.next,s===null){if(s=r.shared.pending,s===null)break;M=s,s=M.next,M.next=null,r.lastBaseUpdate=M,r.shared.pending=null}}while(1);if(_===null&&(d=w),r.baseState=d,r.firstBaseUpdate=p,r.lastBaseUpdate=_,e=r.shared.interleaved,e!==null){r=e;do l|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);_g|=l,n.lanes=l,n.memoizedState=w}}function J3(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(on(191,r));r.call(i)}}}var TN=new SB.Component().refs;function UA(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:fs({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var PM={isMounted:function(n){return(n=n._reactInternals)?Cg(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=Pa(),r=yp(n),o=Vd(i,r);o.payload=e,t!=null&&(o.callback=t),e=gp(n,o,r),e!==null&&(Cu(e,n,r,i),iS(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=Pa(),r=yp(n),o=Vd(i,r);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=gp(n,o,r),e!==null&&(Cu(e,n,r,i),iS(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Pa(),i=yp(n),r=Vd(t,i);r.tag=2,e!=null&&(r.callback=e),e=gp(n,r,i),e!==null&&(Cu(e,n,i,t),iS(e,n,i))}};function Q3(n,e,t,i,r,o,l){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,o,l):e.prototype&&e.prototype.isPureReactComponent?!xv(t,i)||!xv(r,o):!0}function EN(n,e,t){var i=!1,r=Tp,o=e.contextType;return typeof o=="object"&&o!==null?o=Ic(o):(r=Ja(e)?pg:pa.current,i=e.contextTypes,o=(i=i!=null)?vy(n,r):Tp),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=PM,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=o),e}function eR(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&PM.enqueueReplaceState(e,e.state,null)}function VA(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs=TN,sP(n);var o=e.contextType;typeof o=="object"&&o!==null?r.context=Ic(o):(o=Ja(e)?pg:pa.current,r.context=vy(n,o)),r.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(UA(n,e,o,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&PM.enqueueReplaceState(r,r.state,null),NS(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function tx(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(on(309));var i=t.stateNode}if(!i)throw Error(on(147,n));var r=i,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(l){var s=r.refs;s===TN&&(s=r.refs={}),l===null?delete s[o]:s[o]=l},e._stringRef=o,e)}if(typeof n!="string")throw Error(on(284));if(!t._owner)throw Error(on(290,n))}return n}function Uw(n,e){throw n=Object.prototype.toString.call(e),Error(on(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function tR(n){var e=n._init;return e(n._payload)}function AN(n){function e(z,F){if(n){var N=z.deletions;N===null?(z.deletions=[F],z.flags|=16):N.push(F)}}function t(z,F){if(!n)return null;for(;F!==null;)e(z,F),F=F.sibling;return null}function i(z,F){for(z=new Map;F!==null;)F.key!==null?z.set(F.key,F):z.set(F.index,F),F=F.sibling;return z}function r(z,F){return z=xp(z,F),z.index=0,z.sibling=null,z}function o(z,F,N){return z.index=N,n?(N=z.alternate,N!==null?(N=N.index,N<F?(z.flags|=2,F):N):(z.flags|=2,F)):(z.flags|=1048576,F)}function l(z){return n&&z.alternate===null&&(z.flags|=2),z}function s(z,F,N,V){return F===null||F.tag!==6?(F=UE(N,z.mode,V),F.return=z,F):(F=r(F,N),F.return=z,F)}function d(z,F,N,V){var j=N.type;return j===V_?_(z,F,N.props.children,V,N.key):F!==null&&(F.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===qf&&tR(j)===F.type)?(V=r(F,N.props),V.ref=tx(z,F,N),V.return=z,V):(V=cS(N.type,N.key,N.props,null,z.mode,V),V.ref=tx(z,F,N),V.return=z,V)}function p(z,F,N,V){return F===null||F.tag!==4||F.stateNode.containerInfo!==N.containerInfo||F.stateNode.implementation!==N.implementation?(F=VE(N,z.mode,V),F.return=z,F):(F=r(F,N.children||[]),F.return=z,F)}function _(z,F,N,V,j){return F===null||F.tag!==7?(F=ng(N,z.mode,V,j),F.return=z,F):(F=r(F,N),F.return=z,F)}function w(z,F,N){if(typeof F=="string"&&F!==""||typeof F=="number")return F=UE(""+F,z.mode,N),F.return=z,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case Iw:return N=cS(F.type,F.key,F.props,null,z.mode,N),N.ref=tx(z,null,F),N.return=z,N;case U_:return F=VE(F,z.mode,N),F.return=z,F;case qf:var V=F._init;return w(z,V(F._payload),N)}if(kx(F)||Y0(F))return F=ng(F,z.mode,N,null),F.return=z,F;Uw(z,F)}return null}function M(z,F,N,V){var j=F!==null?F.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return j!==null?null:s(z,F,""+N,V);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Iw:return N.key===j?d(z,F,N,V):null;case U_:return N.key===j?p(z,F,N,V):null;case qf:return j=N._init,M(z,F,j(N._payload),V)}if(kx(N)||Y0(N))return j!==null?null:_(z,F,N,V,null);Uw(z,N)}return null}function A(z,F,N,V,j){if(typeof V=="string"&&V!==""||typeof V=="number")return z=z.get(N)||null,s(F,z,""+V,j);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Iw:return z=z.get(V.key===null?N:V.key)||null,d(F,z,V,j);case U_:return z=z.get(V.key===null?N:V.key)||null,p(F,z,V,j);case qf:var Q=V._init;return A(z,F,N,Q(V._payload),j)}if(kx(V)||Y0(V))return z=z.get(N)||null,_(F,z,V,j,null);Uw(F,V)}return null}function P(z,F,N,V){for(var j=null,Q=null,re=F,Z=F=0,ne=null;re!==null&&Z<N.length;Z++){re.index>Z?(ne=re,re=null):ne=re.sibling;var he=M(z,re,N[Z],V);if(he===null){re===null&&(re=ne);break}n&&re&&he.alternate===null&&e(z,re),F=o(he,F,Z),Q===null?j=he:Q.sibling=he,Q=he,re=ne}if(Z===N.length)return t(z,re),Kr&&zm(z,Z),j;if(re===null){for(;Z<N.length;Z++)re=w(z,N[Z],V),re!==null&&(F=o(re,F,Z),Q===null?j=re:Q.sibling=re,Q=re);return Kr&&zm(z,Z),j}for(re=i(z,re);Z<N.length;Z++)ne=A(re,z,Z,N[Z],V),ne!==null&&(n&&ne.alternate!==null&&re.delete(ne.key===null?Z:ne.key),F=o(ne,F,Z),Q===null?j=ne:Q.sibling=ne,Q=ne);return n&&re.forEach(function(De){return e(z,De)}),Kr&&zm(z,Z),j}function L(z,F,N,V){var j=Y0(N);if(typeof j!="function")throw Error(on(150));if(N=j.call(N),N==null)throw Error(on(151));for(var Q=j=null,re=F,Z=F=0,ne=null,he=N.next();re!==null&&!he.done;Z++,he=N.next()){re.index>Z?(ne=re,re=null):ne=re.sibling;var De=M(z,re,he.value,V);if(De===null){re===null&&(re=ne);break}n&&re&&De.alternate===null&&e(z,re),F=o(De,F,Z),Q===null?j=De:Q.sibling=De,Q=De,re=ne}if(he.done)return t(z,re),Kr&&zm(z,Z),j;if(re===null){for(;!he.done;Z++,he=N.next())he=w(z,he.value,V),he!==null&&(F=o(he,F,Z),Q===null?j=he:Q.sibling=he,Q=he);return Kr&&zm(z,Z),j}for(re=i(z,re);!he.done;Z++,he=N.next())he=A(re,z,Z,he.value,V),he!==null&&(n&&he.alternate!==null&&re.delete(he.key===null?Z:he.key),F=o(he,F,Z),Q===null?j=he:Q.sibling=he,Q=he);return n&&re.forEach(function(He){return e(z,He)}),Kr&&zm(z,Z),j}function D(z,F,N,V){if(typeof N=="object"&&N!==null&&N.type===V_&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Iw:e:{for(var j=N.key,Q=F;Q!==null;){if(Q.key===j){if(j=N.type,j===V_){if(Q.tag===7){t(z,Q.sibling),F=r(Q,N.props.children),F.return=z,z=F;break e}}else if(Q.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===qf&&tR(j)===Q.type){t(z,Q.sibling),F=r(Q,N.props),F.ref=tx(z,Q,N),F.return=z,z=F;break e}t(z,Q);break}else e(z,Q);Q=Q.sibling}N.type===V_?(F=ng(N.props.children,z.mode,V,N.key),F.return=z,z=F):(V=cS(N.type,N.key,N.props,null,z.mode,V),V.ref=tx(z,F,N),V.return=z,z=V)}return l(z);case U_:e:{for(Q=N.key;F!==null;){if(F.key===Q)if(F.tag===4&&F.stateNode.containerInfo===N.containerInfo&&F.stateNode.implementation===N.implementation){t(z,F.sibling),F=r(F,N.children||[]),F.return=z,z=F;break e}else{t(z,F);break}else e(z,F);F=F.sibling}F=VE(N,z.mode,V),F.return=z,z=F}return l(z);case qf:return Q=N._init,D(z,F,Q(N._payload),V)}if(kx(N))return P(z,F,N,V);if(Y0(N))return L(z,F,N,V);Uw(z,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,F!==null&&F.tag===6?(t(z,F.sibling),F=r(F,N),F.return=z,z=F):(t(z,F),F=UE(N,z.mode,V),F.return=z,z=F),l(z)):t(z,F)}return D}var by=AN(!0),CN=AN(!1),r1={},Mh=Op(r1),Sv=Op(r1),Mv=Op(r1);function Zm(n){if(n===r1)throw Error(on(174));return n}function oP(n,e){switch(Nr(Mv,e),Nr(Sv,n),Nr(Mh,r1),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xA(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=xA(e,n)}Zr(Mh),Nr(Mh,e)}function Sy(){Zr(Mh),Zr(Sv),Zr(Mv)}function IN(n){Zm(Mv.current);var e=Zm(Mh.current),t=xA(e,n.type);e!==t&&(Nr(Sv,n),Nr(Mh,t))}function aP(n){Sv.current===n&&(Zr(Mh),Zr(Sv))}var as=Op(0);function US(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var RE=[];function lP(){for(var n=0;n<RE.length;n++)RE[n]._workInProgressVersionPrimary=null;RE.length=0}var rS=ef.ReactCurrentDispatcher,zE=ef.ReactCurrentBatchConfig,gg=0,ds=null,io=null,Mo=null,VS=!1,Zx=!1,Tv=0,Qj=0;function na(){throw Error(on(321))}function cP(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Lu(n[t],e[t]))return!1;return!0}function uP(n,e,t,i,r,o){if(gg=o,ds=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rS.current=n===null||n.memoizedState===null?i9:r9,n=t(i,r),Zx){o=0;do{if(Zx=!1,Tv=0,25<=o)throw Error(on(301));o+=1,Mo=io=null,e.updateQueue=null,rS.current=s9,n=t(i,r)}while(Zx)}if(rS.current=GS,e=io!==null&&io.next!==null,gg=0,Mo=io=ds=null,VS=!1,e)throw Error(on(300));return n}function hP(){var n=Tv!==0;return Tv=0,n}function xh(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mo===null?ds.memoizedState=Mo=n:Mo=Mo.next=n,Mo}function Pc(){if(io===null){var n=ds.alternate;n=n!==null?n.memoizedState:null}else n=io.next;var e=Mo===null?ds.memoizedState:Mo.next;if(e!==null)Mo=e,io=n;else{if(n===null)throw Error(on(310));io=n,n={memoizedState:io.memoizedState,baseState:io.baseState,baseQueue:io.baseQueue,queue:io.queue,next:null},Mo===null?ds.memoizedState=Mo=n:Mo=Mo.next=n}return Mo}function Ev(n,e){return typeof e=="function"?e(n):e}function OE(n){var e=Pc(),t=e.queue;if(t===null)throw Error(on(311));t.lastRenderedReducer=n;var i=io,r=i.baseQueue,o=t.pending;if(o!==null){if(r!==null){var l=r.next;r.next=o.next,o.next=l}i.baseQueue=r=o,t.pending=null}if(r!==null){o=r.next,i=i.baseState;var s=l=null,d=null,p=o;do{var _=p.lane;if((gg&_)===_)d!==null&&(d=d.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),i=p.hasEagerState?p.eagerState:n(i,p.action);else{var w={lane:_,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};d===null?(s=d=w,l=i):d=d.next=w,ds.lanes|=_,_g|=_}p=p.next}while(p!==null&&p!==o);d===null?l=i:d.next=s,Lu(i,e.memoizedState)||(Ya=!0),e.memoizedState=i,e.baseState=l,e.baseQueue=d,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do o=r.lane,ds.lanes|=o,_g|=o,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function FE(n){var e=Pc(),t=e.queue;if(t===null)throw Error(on(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,o=e.memoizedState;if(r!==null){t.pending=null;var l=r=r.next;do o=n(o,l.action),l=l.next;while(l!==r);Lu(o,e.memoizedState)||(Ya=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,i]}function PN(){}function LN(n,e){var t=ds,i=Pc(),r=e(),o=!Lu(i.memoizedState,r);if(o&&(i.memoizedState=r,Ya=!0),i=i.queue,dP(RN.bind(null,t,i,n),[n]),i.getSnapshot!==e||o||Mo!==null&&Mo.memoizedState.tag&1){if(t.flags|=2048,Av(9,DN.bind(null,t,i,r,e),void 0,null),Eo===null)throw Error(on(349));gg&30||kN(t,e,r)}return r}function kN(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=ds.updateQueue,e===null?(e={lastEffect:null,stores:null},ds.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function DN(n,e,t,i){e.value=t,e.getSnapshot=i,zN(e)&&ON(n)}function RN(n,e,t){return t(function(){zN(e)&&ON(n)})}function zN(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Lu(n,t)}catch{return!0}}function ON(n){var e=qd(n,1);e!==null&&Cu(e,n,1,-1)}function nR(n){var e=xh();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ev,lastRenderedState:n},e.queue=n,n=n.dispatch=n9.bind(null,ds,n),[e.memoizedState,n]}function Av(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=ds.updateQueue,e===null?(e={lastEffect:null,stores:null},ds.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function FN(){return Pc().memoizedState}function sS(n,e,t,i){var r=xh();ds.flags|=n,r.memoizedState=Av(1|e,t,void 0,i===void 0?null:i)}function LM(n,e,t,i){var r=Pc();i=i===void 0?null:i;var o=void 0;if(io!==null){var l=io.memoizedState;if(o=l.destroy,i!==null&&cP(i,l.deps)){r.memoizedState=Av(e,t,o,i);return}}ds.flags|=n,r.memoizedState=Av(1|e,t,o,i)}function iR(n,e){return sS(8390656,8,n,e)}function dP(n,e){return LM(2048,8,n,e)}function BN(n,e){return LM(4,2,n,e)}function NN(n,e){return LM(4,4,n,e)}function UN(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function VN(n,e,t){return t=t!=null?t.concat([n]):null,LM(4,4,UN.bind(null,e,n),t)}function fP(){}function GN(n,e){var t=Pc();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&cP(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function WN(n,e){var t=Pc();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&cP(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function HN(n,e,t){return gg&21?(Lu(t,e)||(t=ZB(),ds.lanes|=t,_g|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Ya=!0),n.memoizedState=t)}function e9(n,e){var t=Er;Er=t!==0&&4>t?t:4,n(!0);var i=zE.transition;zE.transition={};try{n(!1),e()}finally{Er=t,zE.transition=i}}function jN(){return Pc().memoizedState}function t9(n,e,t){var i=yp(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},qN(n))ZN(e,t);else if(t=SN(n,e,t,i),t!==null){var r=Pa();Cu(t,n,i,r),XN(t,e,i)}}function n9(n,e,t){var i=yp(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(qN(n))ZN(e,r);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var l=e.lastRenderedState,s=o(l,t);if(r.hasEagerState=!0,r.eagerState=s,Lu(s,l)){var d=e.interleaved;d===null?(r.next=r,rP(e)):(r.next=d.next,d.next=r),e.interleaved=r;return}}catch{}finally{}t=SN(n,e,r,i),t!==null&&(r=Pa(),Cu(t,n,i,r),XN(t,e,i))}}function qN(n){var e=n.alternate;return n===ds||e!==null&&e===ds}function ZN(n,e){Zx=VS=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function XN(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,HI(n,t)}}var GS={readContext:Ic,useCallback:na,useContext:na,useEffect:na,useImperativeHandle:na,useInsertionEffect:na,useLayoutEffect:na,useMemo:na,useReducer:na,useRef:na,useState:na,useDebugValue:na,useDeferredValue:na,useTransition:na,useMutableSource:na,useSyncExternalStore:na,useId:na,unstable_isNewReconciler:!1},i9={readContext:Ic,useCallback:function(n,e){return xh().memoizedState=[n,e===void 0?null:e],n},useContext:Ic,useEffect:iR,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,sS(4194308,4,UN.bind(null,e,n),t)},useLayoutEffect:function(n,e){return sS(4194308,4,n,e)},useInsertionEffect:function(n,e){return sS(4,2,n,e)},useMemo:function(n,e){var t=xh();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=xh();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=t9.bind(null,ds,n),[i.memoizedState,n]},useRef:function(n){var e=xh();return n={current:n},e.memoizedState=n},useState:nR,useDebugValue:fP,useDeferredValue:function(n){return xh().memoizedState=n},useTransition:function(){var n=nR(!1),e=n[0];return n=e9.bind(null,n[1]),xh().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=ds,r=xh();if(Kr){if(t===void 0)throw Error(on(407));t=t()}else{if(t=e(),Eo===null)throw Error(on(349));gg&30||kN(i,e,t)}r.memoizedState=t;var o={value:t,getSnapshot:e};return r.queue=o,iR(RN.bind(null,i,o,n),[n]),i.flags|=2048,Av(9,DN.bind(null,i,o,t,e),void 0,null),t},useId:function(){var n=xh(),e=Eo.identifierPrefix;if(Kr){var t=zd,i=Rd;t=(i&~(1<<32-Au(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Tv++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Qj++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},r9={readContext:Ic,useCallback:GN,useContext:Ic,useEffect:dP,useImperativeHandle:VN,useInsertionEffect:BN,useLayoutEffect:NN,useMemo:WN,useReducer:OE,useRef:FN,useState:function(){return OE(Ev)},useDebugValue:fP,useDeferredValue:function(n){var e=Pc();return HN(e,io.memoizedState,n)},useTransition:function(){var n=OE(Ev)[0],e=Pc().memoizedState;return[n,e]},useMutableSource:PN,useSyncExternalStore:LN,useId:jN,unstable_isNewReconciler:!1},s9={readContext:Ic,useCallback:GN,useContext:Ic,useEffect:dP,useImperativeHandle:VN,useInsertionEffect:BN,useLayoutEffect:NN,useMemo:WN,useReducer:FE,useRef:FN,useState:function(){return FE(Ev)},useDebugValue:fP,useDeferredValue:function(n){var e=Pc();return io===null?e.memoizedState=n:HN(e,io.memoizedState,n)},useTransition:function(){var n=FE(Ev)[0],e=Pc().memoizedState;return[n,e]},useMutableSource:PN,useSyncExternalStore:LN,useId:jN,unstable_isNewReconciler:!1};function My(n,e){try{var t="",i=e;do t+=DH(i),i=i.return;while(i);var r=t}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:r,digest:null}}function BE(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function GA(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var o9=typeof WeakMap=="function"?WeakMap:Map;function $N(n,e,t){t=Vd(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){HS||(HS=!0,JA=i),GA(n,e)},t}function YN(n,e,t){t=Vd(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){GA(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){GA(n,e),typeof i!="function"&&(_p===null?_p=new Set([this]):_p.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),t}function rR(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new o9;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=v9.bind(null,n,e,t),e.then(n,n))}function sR(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function oR(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Vd(-1,1),e.tag=2,gp(t,e,1))),t.lanes|=1),n)}var a9=ef.ReactCurrentOwner,Ya=!1;function Aa(n,e,t,i){e.child=n===null?CN(e,null,t,i):by(e,n.child,t,i)}function aR(n,e,t,i,r){t=t.render;var o=e.ref;return ay(e,r),i=uP(n,e,t,i,o,r),t=hP(),n!==null&&!Ya?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Zd(n,e,r)):(Kr&&t&&JI(e),e.flags|=1,Aa(n,e,i,r),e.child)}function lR(n,e,t,i,r){if(n===null){var o=t.type;return typeof o=="function"&&!wP(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,KN(n,e,o,i,r)):(n=cS(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&r)){var l=o.memoizedProps;if(t=t.compare,t=t!==null?t:xv,t(l,i)&&n.ref===e.ref)return Zd(n,e,r)}return e.flags|=1,n=xp(o,i),n.ref=e.ref,n.return=e,e.child=n}function KN(n,e,t,i,r){if(n!==null){var o=n.memoizedProps;if(xv(o,i)&&n.ref===e.ref)if(Ya=!1,e.pendingProps=i=o,(n.lanes&r)!==0)n.flags&131072&&(Ya=!0);else return e.lanes=n.lanes,Zd(n,e,r)}return WA(n,e,t,i,r)}function JN(n,e,t){var i=e.pendingProps,r=i.children,o=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nr(K_,Il),Il|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Nr(K_,Il),Il|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=o!==null?o.baseLanes:t,Nr(K_,Il),Il|=i}else o!==null?(i=o.baseLanes|t,e.memoizedState=null):i=t,Nr(K_,Il),Il|=i;return Aa(n,e,r,t),e.child}function QN(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function WA(n,e,t,i,r){var o=Ja(t)?pg:pa.current;return o=vy(e,o),ay(e,r),t=uP(n,e,t,i,o,r),i=hP(),n!==null&&!Ya?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Zd(n,e,r)):(Kr&&i&&JI(e),e.flags|=1,Aa(n,e,t,r),e.child)}function cR(n,e,t,i,r){if(Ja(t)){var o=!0;RS(e)}else o=!1;if(ay(e,r),e.stateNode===null)oS(n,e),EN(e,t,i),VA(e,t,i,r),i=!0;else if(n===null){var l=e.stateNode,s=e.memoizedProps;l.props=s;var d=l.context,p=t.contextType;typeof p=="object"&&p!==null?p=Ic(p):(p=Ja(t)?pg:pa.current,p=vy(e,p));var _=t.getDerivedStateFromProps,w=typeof _=="function"||typeof l.getSnapshotBeforeUpdate=="function";w||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(s!==i||d!==p)&&eR(e,l,i,p),Zf=!1;var M=e.memoizedState;l.state=M,NS(e,i,l,r),d=e.memoizedState,s!==i||M!==d||Ka.current||Zf?(typeof _=="function"&&(UA(e,t,_,i),d=e.memoizedState),(s=Zf||Q3(e,t,s,i,M,d,p))?(w||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=d),l.props=i,l.state=d,l.context=p,i=s):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{l=e.stateNode,MN(n,e),s=e.memoizedProps,p=e.type===e.elementType?s:yu(e.type,s),l.props=p,w=e.pendingProps,M=l.context,d=t.contextType,typeof d=="object"&&d!==null?d=Ic(d):(d=Ja(t)?pg:pa.current,d=vy(e,d));var A=t.getDerivedStateFromProps;(_=typeof A=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(s!==w||M!==d)&&eR(e,l,i,d),Zf=!1,M=e.memoizedState,l.state=M,NS(e,i,l,r);var P=e.memoizedState;s!==w||M!==P||Ka.current||Zf?(typeof A=="function"&&(UA(e,t,A,i),P=e.memoizedState),(p=Zf||Q3(e,t,p,i,M,P,d)||!1)?(_||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(i,P,d),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(i,P,d)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||s===n.memoizedProps&&M===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||s===n.memoizedProps&&M===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=P),l.props=i,l.state=P,l.context=d,i=p):(typeof l.componentDidUpdate!="function"||s===n.memoizedProps&&M===n.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||s===n.memoizedProps&&M===n.memoizedState||(e.flags|=1024),i=!1)}return HA(n,e,t,i,o,r)}function HA(n,e,t,i,r,o){QN(n,e);var l=(e.flags&128)!==0;if(!i&&!l)return r&&X3(e,t,!1),Zd(n,e,o);i=e.stateNode,a9.current=e;var s=l&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&l?(e.child=by(e,n.child,null,o),e.child=by(e,null,s,o)):Aa(n,e,s,o),e.memoizedState=i.state,r&&X3(e,t,!0),e.child}function e4(n){var e=n.stateNode;e.pendingContext?Z3(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Z3(n,e.context,!1),oP(n,e.containerInfo)}function uR(n,e,t,i,r){return wy(),eP(r),e.flags|=256,Aa(n,e,t,i),e.child}var jA={dehydrated:null,treeContext:null,retryLane:0};function qA(n){return{baseLanes:n,cachePool:null,transitions:null}}function t4(n,e,t){var i=e.pendingProps,r=as.current,o=!1,l=(e.flags&128)!==0,s;if((s=l)||(s=n!==null&&n.memoizedState===null?!1:(r&2)!==0),s?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Nr(as,r&1),n===null)return BA(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=i.children,n=i.fallback,o?(i=e.mode,o=e.child,l={mode:"hidden",children:l},!(i&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=RM(l,i,0,null),n=ng(n,i,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=qA(t),e.memoizedState=jA,n):pP(e,l));if(r=n.memoizedState,r!==null&&(s=r.dehydrated,s!==null))return l9(n,e,l,i,s,r,t);if(o){o=i.fallback,l=e.mode,r=n.child,s=r.sibling;var d={mode:"hidden",children:i.children};return!(l&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=d,e.deletions=null):(i=xp(r,d),i.subtreeFlags=r.subtreeFlags&14680064),s!==null?o=xp(s,o):(o=ng(o,l,t,null),o.flags|=2),o.return=e,i.return=e,i.sibling=o,e.child=i,i=o,o=e.child,l=n.child.memoizedState,l=l===null?qA(t):{baseLanes:l.baseLanes|t,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=n.childLanes&~t,e.memoizedState=jA,i}return o=n.child,n=o.sibling,i=xp(o,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function pP(n,e){return e=RM({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Vw(n,e,t,i){return i!==null&&eP(i),by(e,n.child,null,t),n=pP(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function l9(n,e,t,i,r,o,l){if(t)return e.flags&256?(e.flags&=-257,i=BE(Error(on(422))),Vw(n,e,l,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=i.fallback,r=e.mode,i=RM({mode:"visible",children:i.children},r,0,null),o=ng(o,r,l,null),o.flags|=2,i.return=e,o.return=e,i.sibling=o,e.child=i,e.mode&1&&by(e,n.child,null,l),e.child.memoizedState=qA(l),e.memoizedState=jA,o);if(!(e.mode&1))return Vw(n,e,l,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var s=i.dgst;return i=s,o=Error(on(419)),i=BE(o,i,void 0),Vw(n,e,l,i)}if(s=(l&n.childLanes)!==0,Ya||s){if(i=Eo,i!==null){switch(l&-l){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|l)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,qd(n,r),Cu(i,n,r,-1))}return vP(),i=BE(Error(on(421))),Vw(n,e,l,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=w9.bind(null,n),r._reactRetry=e,null):(n=o.treeContext,kl=mp(r.nextSibling),Rl=e,Kr=!0,bu=null,n!==null&&(_c[yc++]=Rd,_c[yc++]=zd,_c[yc++]=mg,Rd=n.id,zd=n.overflow,mg=e),e=pP(e,i.children),e.flags|=4096,e)}function hR(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),NA(n.return,e,t)}function NE(n,e,t,i,r){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=t,o.tailMode=r)}function n4(n,e,t){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(Aa(n,e,i.children,t),i=as.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&hR(n,t,e);else if(n.tag===19)hR(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Nr(as,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&US(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),NE(e,!1,r,t,o);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&US(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}NE(e,!0,t,null,o);break;case"together":NE(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oS(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Zd(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),_g|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(on(153));if(e.child!==null){for(n=e.child,t=xp(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=xp(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function c9(n,e,t){switch(e.tag){case 3:e4(e),wy();break;case 5:IN(e);break;case 1:Ja(e.type)&&RS(e);break;case 4:oP(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Nr(FS,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Nr(as,as.current&1),e.flags|=128,null):t&e.child.childLanes?t4(n,e,t):(Nr(as,as.current&1),n=Zd(n,e,t),n!==null?n.sibling:null);Nr(as,as.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return n4(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Nr(as,as.current),i)break;return null;case 22:case 23:return e.lanes=0,JN(n,e,t)}return Zd(n,e,t)}var i4,ZA,r4,s4;i4=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};ZA=function(){};r4=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,Zm(Mh.current);var o=null;switch(t){case"input":r=mA(n,r),i=mA(n,i),o=[];break;case"select":r=fs({},r,{value:void 0}),i=fs({},i,{value:void 0}),o=[];break;case"textarea":r=yA(n,r),i=yA(n,i),o=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=kS)}vA(t,i);var l;t=null;for(p in r)if(!i.hasOwnProperty(p)&&r.hasOwnProperty(p)&&r[p]!=null)if(p==="style"){var s=r[p];for(l in s)s.hasOwnProperty(l)&&(t||(t={}),t[l]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(dv.hasOwnProperty(p)?o||(o=[]):(o=o||[]).push(p,null));for(p in i){var d=i[p];if(s=r!=null?r[p]:void 0,i.hasOwnProperty(p)&&d!==s&&(d!=null||s!=null))if(p==="style")if(s){for(l in s)!s.hasOwnProperty(l)||d&&d.hasOwnProperty(l)||(t||(t={}),t[l]="");for(l in d)d.hasOwnProperty(l)&&s[l]!==d[l]&&(t||(t={}),t[l]=d[l])}else t||(o||(o=[]),o.push(p,t)),t=d;else p==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,s=s?s.__html:void 0,d!=null&&s!==d&&(o=o||[]).push(p,d)):p==="children"?typeof d!="string"&&typeof d!="number"||(o=o||[]).push(p,""+d):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(dv.hasOwnProperty(p)?(d!=null&&p==="onScroll"&&Wr("scroll",n),o||s===d||(o=[])):(o=o||[]).push(p,d))}t&&(o=o||[]).push("style",t);var p=o;(e.updateQueue=p)&&(e.flags|=4)}};s4=function(n,e,t,i){t!==i&&(e.flags|=4)};function nx(n,e){if(!Kr)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function ia(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function u9(n,e,t){var i=e.pendingProps;switch(QI(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ia(e),null;case 1:return Ja(e.type)&&DS(),ia(e),null;case 3:return i=e.stateNode,Sy(),Zr(Ka),Zr(pa),lP(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Nw(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bu!==null&&(tC(bu),bu=null))),ZA(n,e),ia(e),null;case 5:aP(e);var r=Zm(Mv.current);if(t=e.type,n!==null&&e.stateNode!=null)r4(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(on(166));return ia(e),null}if(n=Zm(Mh.current),Nw(e)){i=e.stateNode,t=e.type;var o=e.memoizedProps;switch(i[vh]=e,i[bv]=o,n=(e.mode&1)!==0,t){case"dialog":Wr("cancel",i),Wr("close",i);break;case"iframe":case"object":case"embed":Wr("load",i);break;case"video":case"audio":for(r=0;r<Rx.length;r++)Wr(Rx[r],i);break;case"source":Wr("error",i);break;case"img":case"image":case"link":Wr("error",i),Wr("load",i);break;case"details":Wr("toggle",i);break;case"input":v3(i,o),Wr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!o.multiple},Wr("invalid",i);break;case"textarea":b3(i,o),Wr("invalid",i)}vA(t,o),r=null;for(var l in o)if(o.hasOwnProperty(l)){var s=o[l];l==="children"?typeof s=="string"?i.textContent!==s&&(o.suppressHydrationWarning!==!0&&Bw(i.textContent,s,n),r=["children",s]):typeof s=="number"&&i.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&Bw(i.textContent,s,n),r=["children",""+s]):dv.hasOwnProperty(l)&&s!=null&&l==="onScroll"&&Wr("scroll",i)}switch(t){case"input":Pw(i),w3(i,o,!0);break;case"textarea":Pw(i),S3(i);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(i.onclick=kS)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{l=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=kB(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=l.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=l.createElement(t,{is:i.is}):(n=l.createElement(t),t==="select"&&(l=n,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):n=l.createElementNS(n,t),n[vh]=e,n[bv]=i,i4(n,e,!1,!1),e.stateNode=n;e:{switch(l=wA(t,i),t){case"dialog":Wr("cancel",n),Wr("close",n),r=i;break;case"iframe":case"object":case"embed":Wr("load",n),r=i;break;case"video":case"audio":for(r=0;r<Rx.length;r++)Wr(Rx[r],n);r=i;break;case"source":Wr("error",n),r=i;break;case"img":case"image":case"link":Wr("error",n),Wr("load",n),r=i;break;case"details":Wr("toggle",n),r=i;break;case"input":v3(n,i),r=mA(n,i),Wr("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=fs({},i,{value:void 0}),Wr("invalid",n);break;case"textarea":b3(n,i),r=yA(n,i),Wr("invalid",n);break;default:r=i}vA(t,r),s=r;for(o in s)if(s.hasOwnProperty(o)){var d=s[o];o==="style"?zB(n,d):o==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&DB(n,d)):o==="children"?typeof d=="string"?(t!=="textarea"||d!=="")&&fv(n,d):typeof d=="number"&&fv(n,""+d):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(dv.hasOwnProperty(o)?d!=null&&o==="onScroll"&&Wr("scroll",n):d!=null&&BI(n,o,d,l))}switch(t){case"input":Pw(n),w3(n,i,!1);break;case"textarea":Pw(n),S3(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Mp(i.value));break;case"select":n.multiple=!!i.multiple,o=i.value,o!=null?iy(n,!!i.multiple,o,!1):i.defaultValue!=null&&iy(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=kS)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ia(e),null;case 6:if(n&&e.stateNode!=null)s4(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(on(166));if(t=Zm(Mv.current),Zm(Mh.current),Nw(e)){if(i=e.stateNode,t=e.memoizedProps,i[vh]=e,(o=i.nodeValue!==t)&&(n=Rl,n!==null))switch(n.tag){case 3:Bw(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Bw(i.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[vh]=e,e.stateNode=i}return ia(e),null;case 13:if(Zr(as),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Kr&&kl!==null&&e.mode&1&&!(e.flags&128))bN(),wy(),e.flags|=98560,o=!1;else if(o=Nw(e),i!==null&&i.dehydrated!==null){if(n===null){if(!o)throw Error(on(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(on(317));o[vh]=e}else wy(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ia(e),o=!1}else bu!==null&&(tC(bu),bu=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||as.current&1?so===0&&(so=3):vP())),e.updateQueue!==null&&(e.flags|=4),ia(e),null);case 4:return Sy(),ZA(n,e),n===null&&vv(e.stateNode.containerInfo),ia(e),null;case 10:return iP(e.type._context),ia(e),null;case 17:return Ja(e.type)&&DS(),ia(e),null;case 19:if(Zr(as),o=e.memoizedState,o===null)return ia(e),null;if(i=(e.flags&128)!==0,l=o.rendering,l===null)if(i)nx(o,!1);else{if(so!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(l=US(n),l!==null){for(e.flags|=128,nx(o,!1),i=l.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)o=t,n=i,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,n=l.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Nr(as,as.current&1|2),e.child}n=n.sibling}o.tail!==null&&Os()>Ty&&(e.flags|=128,i=!0,nx(o,!1),e.lanes=4194304)}else{if(!i)if(n=US(l),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),nx(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!Kr)return ia(e),null}else 2*Os()-o.renderingStartTime>Ty&&t!==1073741824&&(e.flags|=128,i=!0,nx(o,!1),e.lanes=4194304);o.isBackwards?(l.sibling=e.child,e.child=l):(t=o.last,t!==null?t.sibling=l:e.child=l,o.last=l)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Os(),e.sibling=null,t=as.current,Nr(as,i?t&1|2:t&1),e):(ia(e),null);case 22:case 23:return xP(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Il&1073741824&&(ia(e),e.subtreeFlags&6&&(e.flags|=8192)):ia(e),null;case 24:return null;case 25:return null}throw Error(on(156,e.tag))}function h9(n,e){switch(QI(e),e.tag){case 1:return Ja(e.type)&&DS(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Sy(),Zr(Ka),Zr(pa),lP(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return aP(e),null;case 13:if(Zr(as),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(on(340));wy()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Zr(as),null;case 4:return Sy(),null;case 10:return iP(e.type._context),null;case 22:case 23:return xP(),null;case 24:return null;default:return null}}var Gw=!1,la=!1,d9=typeof WeakSet=="function"?WeakSet:Set,Bn=null;function Y_(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){bs(n,e,i)}else t.current=null}function XA(n,e,t){try{t()}catch(i){bs(n,e,i)}}var dR=!1;function f9(n,e){if(LA=IS,n=cN(),KI(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var l=0,s=-1,d=-1,p=0,_=0,w=n,M=null;t:for(;;){for(var A;w!==t||r!==0&&w.nodeType!==3||(s=l+r),w!==o||i!==0&&w.nodeType!==3||(d=l+i),w.nodeType===3&&(l+=w.nodeValue.length),(A=w.firstChild)!==null;)M=w,w=A;for(;;){if(w===n)break t;if(M===t&&++p===r&&(s=l),M===o&&++_===i&&(d=l),(A=w.nextSibling)!==null)break;w=M,M=w.parentNode}w=A}t=s===-1||d===-1?null:{start:s,end:d}}else t=null}t=t||{start:0,end:0}}else t=null;for(kA={focusedElem:n,selectionRange:t},IS=!1,Bn=e;Bn!==null;)if(e=Bn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Bn=n;else for(;Bn!==null;){e=Bn;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var L=P.memoizedProps,D=P.memoizedState,z=e.stateNode,F=z.getSnapshotBeforeUpdate(e.elementType===e.type?L:yu(e.type,L),D);z.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(on(163))}}catch(V){bs(e,e.return,V)}if(n=e.sibling,n!==null){n.return=e.return,Bn=n;break}Bn=e.return}return P=dR,dR=!1,P}function Xx(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var o=r.destroy;r.destroy=void 0,o!==void 0&&XA(e,t,o)}r=r.next}while(r!==i)}}function kM(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function $A(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function o4(n){var e=n.alternate;e!==null&&(n.alternate=null,o4(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[vh],delete e[bv],delete e[zA],delete e[$j],delete e[Yj])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function a4(n){return n.tag===5||n.tag===3||n.tag===4}function fR(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||a4(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function YA(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=kS));else if(i!==4&&(n=n.child,n!==null))for(YA(n,e,t),n=n.sibling;n!==null;)YA(n,e,t),n=n.sibling}function KA(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(KA(n,e,t),n=n.sibling;n!==null;)KA(n,e,t),n=n.sibling}var Fo=null,xu=!1;function zf(n,e,t){for(t=t.child;t!==null;)l4(n,e,t),t=t.sibling}function l4(n,e,t){if(Sh&&typeof Sh.onCommitFiberUnmount=="function")try{Sh.onCommitFiberUnmount(MM,t)}catch{}switch(t.tag){case 5:la||Y_(t,e);case 6:var i=Fo,r=xu;Fo=null,zf(n,e,t),Fo=i,xu=r,Fo!==null&&(xu?(n=Fo,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Fo.removeChild(t.stateNode));break;case 18:Fo!==null&&(xu?(n=Fo,t=t.stateNode,n.nodeType===8?kE(n.parentNode,t):n.nodeType===1&&kE(n,t),_v(n)):kE(Fo,t.stateNode));break;case 4:i=Fo,r=xu,Fo=t.stateNode.containerInfo,xu=!0,zf(n,e,t),Fo=i,xu=r;break;case 0:case 11:case 14:case 15:if(!la&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var o=r,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&XA(t,e,l),r=r.next}while(r!==i)}zf(n,e,t);break;case 1:if(!la&&(Y_(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(s){bs(t,e,s)}zf(n,e,t);break;case 21:zf(n,e,t);break;case 22:t.mode&1?(la=(i=la)||t.memoizedState!==null,zf(n,e,t),la=i):zf(n,e,t);break;default:zf(n,e,t)}}function pR(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new d9),e.forEach(function(i){var r=b9.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function du(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var o=n,l=e,s=l;e:for(;s!==null;){switch(s.tag){case 5:Fo=s.stateNode,xu=!1;break e;case 3:Fo=s.stateNode.containerInfo,xu=!0;break e;case 4:Fo=s.stateNode.containerInfo,xu=!0;break e}s=s.return}if(Fo===null)throw Error(on(160));l4(o,l,r),Fo=null,xu=!1;var d=r.alternate;d!==null&&(d.return=null),r.return=null}catch(p){bs(r,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)c4(e,n),e=e.sibling}function c4(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(du(e,n),gh(n),i&4){try{Xx(3,n,n.return),kM(3,n)}catch(L){bs(n,n.return,L)}try{Xx(5,n,n.return)}catch(L){bs(n,n.return,L)}}break;case 1:du(e,n),gh(n),i&512&&t!==null&&Y_(t,t.return);break;case 5:if(du(e,n),gh(n),i&512&&t!==null&&Y_(t,t.return),n.flags&32){var r=n.stateNode;try{fv(r,"")}catch(L){bs(n,n.return,L)}}if(i&4&&(r=n.stateNode,r!=null)){var o=n.memoizedProps,l=t!==null?t.memoizedProps:o,s=n.type,d=n.updateQueue;if(n.updateQueue=null,d!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&PB(r,o),wA(s,l);var p=wA(s,o);for(l=0;l<d.length;l+=2){var _=d[l],w=d[l+1];_==="style"?zB(r,w):_==="dangerouslySetInnerHTML"?DB(r,w):_==="children"?fv(r,w):BI(r,_,w,p)}switch(s){case"input":gA(r,o);break;case"textarea":LB(r,o);break;case"select":var M=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var A=o.value;A!=null?iy(r,!!o.multiple,A,!1):M!==!!o.multiple&&(o.defaultValue!=null?iy(r,!!o.multiple,o.defaultValue,!0):iy(r,!!o.multiple,o.multiple?[]:"",!1))}r[bv]=o}catch(L){bs(n,n.return,L)}}break;case 6:if(du(e,n),gh(n),i&4){if(n.stateNode===null)throw Error(on(162));r=n.stateNode,o=n.memoizedProps;try{r.nodeValue=o}catch(L){bs(n,n.return,L)}}break;case 3:if(du(e,n),gh(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{_v(e.containerInfo)}catch(L){bs(n,n.return,L)}break;case 4:du(e,n),gh(n);break;case 13:du(e,n),gh(n),r=n.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(_P=Os())),i&4&&pR(n);break;case 22:if(_=t!==null&&t.memoizedState!==null,n.mode&1?(la=(p=la)||_,du(e,n),la=p):du(e,n),gh(n),i&8192){if(p=n.memoizedState!==null,(n.stateNode.isHidden=p)&&!_&&n.mode&1)for(Bn=n,_=n.child;_!==null;){for(w=Bn=_;Bn!==null;){switch(M=Bn,A=M.child,M.tag){case 0:case 11:case 14:case 15:Xx(4,M,M.return);break;case 1:Y_(M,M.return);var P=M.stateNode;if(typeof P.componentWillUnmount=="function"){i=M,t=M.return;try{e=i,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(L){bs(i,t,L)}}break;case 5:Y_(M,M.return);break;case 22:if(M.memoizedState!==null){gR(w);continue}}A!==null?(A.return=M,Bn=A):gR(w)}_=_.sibling}e:for(_=null,w=n;;){if(w.tag===5){if(_===null){_=w;try{r=w.stateNode,p?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=w.stateNode,d=w.memoizedProps.style,l=d!=null&&d.hasOwnProperty("display")?d.display:null,s.style.display=RB("display",l))}catch(L){bs(n,n.return,L)}}}else if(w.tag===6){if(_===null)try{w.stateNode.nodeValue=p?"":w.memoizedProps}catch(L){bs(n,n.return,L)}}else if((w.tag!==22&&w.tag!==23||w.memoizedState===null||w===n)&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===n)break e;for(;w.sibling===null;){if(w.return===null||w.return===n)break e;_===w&&(_=null),w=w.return}_===w&&(_=null),w.sibling.return=w.return,w=w.sibling}}break;case 19:du(e,n),gh(n),i&4&&pR(n);break;case 21:break;default:du(e,n),gh(n)}}function gh(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(a4(t)){var i=t;break e}t=t.return}throw Error(on(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(fv(r,""),i.flags&=-33);var o=fR(n);KA(n,o,r);break;case 3:case 4:var l=i.stateNode.containerInfo,s=fR(n);YA(n,s,l);break;default:throw Error(on(161))}}catch(d){bs(n,n.return,d)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function p9(n,e,t){Bn=n,u4(n)}function u4(n,e,t){for(var i=(n.mode&1)!==0;Bn!==null;){var r=Bn,o=r.child;if(r.tag===22&&i){var l=r.memoizedState!==null||Gw;if(!l){var s=r.alternate,d=s!==null&&s.memoizedState!==null||la;s=Gw;var p=la;if(Gw=l,(la=d)&&!p)for(Bn=r;Bn!==null;)l=Bn,d=l.child,l.tag===22&&l.memoizedState!==null?_R(r):d!==null?(d.return=l,Bn=d):_R(r);for(;o!==null;)Bn=o,u4(o),o=o.sibling;Bn=r,Gw=s,la=p}mR(n)}else r.subtreeFlags&8772&&o!==null?(o.return=r,Bn=o):mR(n)}}function mR(n){for(;Bn!==null;){var e=Bn;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:la||kM(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!la)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:yu(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&J3(e,o,i);break;case 3:var l=e.updateQueue;if(l!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}J3(e,l,t)}break;case 5:var s=e.stateNode;if(t===null&&e.flags&4){t=s;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&t.focus();break;case"img":d.src&&(t.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var _=p.memoizedState;if(_!==null){var w=_.dehydrated;w!==null&&_v(w)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(on(163))}la||e.flags&512&&$A(e)}catch(M){bs(e,e.return,M)}}if(e===n){Bn=null;break}if(t=e.sibling,t!==null){t.return=e.return,Bn=t;break}Bn=e.return}}function gR(n){for(;Bn!==null;){var e=Bn;if(e===n){Bn=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Bn=t;break}Bn=e.return}}function _R(n){for(;Bn!==null;){var e=Bn;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{kM(4,e)}catch(d){bs(e,t,d)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(d){bs(e,r,d)}}var o=e.return;try{$A(e)}catch(d){bs(e,o,d)}break;case 5:var l=e.return;try{$A(e)}catch(d){bs(e,l,d)}}}catch(d){bs(e,e.return,d)}if(e===n){Bn=null;break}var s=e.sibling;if(s!==null){s.return=e.return,Bn=s;break}Bn=e.return}}var m9=Math.ceil,WS=ef.ReactCurrentDispatcher,mP=ef.ReactCurrentOwner,Cc=ef.ReactCurrentBatchConfig,cr=0,Eo=null,qs=null,Vo=0,Il=0,K_=Op(0),so=0,Cv=null,_g=0,DM=0,gP=0,$x=null,qa=null,_P=0,Ty=1/0,Ed=null,HS=!1,JA=null,_p=null,Ww=!1,np=null,jS=0,Yx=0,QA=null,aS=-1,lS=0;function Pa(){return cr&6?Os():aS!==-1?aS:aS=Os()}function yp(n){return n.mode&1?cr&2&&Vo!==0?Vo&-Vo:Jj.transition!==null?(lS===0&&(lS=ZB()),lS):(n=Er,n!==0||(n=window.event,n=n===void 0?16:eN(n.type)),n):1}function Cu(n,e,t,i){if(50<Yx)throw Yx=0,QA=null,Error(on(185));t1(n,t,i),(!(cr&2)||n!==Eo)&&(n===Eo&&(!(cr&2)&&(DM|=t),so===4&&Qf(n,Vo)),Qa(n,i),t===1&&cr===0&&!(e.mode&1)&&(Ty=Os()+500,IM&&Fp()))}function Qa(n,e){var t=n.callbackNode;JH(n,e);var i=CS(n,n===Eo?Vo:0);if(i===0)t!==null&&E3(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&E3(t),e===1)n.tag===0?Kj(yR.bind(null,n)):xN(yR.bind(null,n)),Zj(function(){!(cr&6)&&Fp()}),t=null;else{switch(XB(i)){case 1:t=WI;break;case 4:t=jB;break;case 16:t=AS;break;case 536870912:t=qB;break;default:t=AS}t=y4(t,h4.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function h4(n,e){if(aS=-1,lS=0,cr&6)throw Error(on(327));var t=n.callbackNode;if(ly()&&n.callbackNode!==t)return null;var i=CS(n,n===Eo?Vo:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=qS(n,i);else{e=i;var r=cr;cr|=2;var o=f4();(Eo!==n||Vo!==e)&&(Ed=null,Ty=Os()+500,tg(n,e));do try{y9();break}catch(s){d4(n,s)}while(1);nP(),WS.current=o,cr=r,qs!==null?e=0:(Eo=null,Vo=0,e=so)}if(e!==0){if(e===2&&(r=EA(n),r!==0&&(i=r,e=eC(n,r))),e===1)throw t=Cv,tg(n,0),Qf(n,i),Qa(n,Os()),t;if(e===6)Qf(n,i);else{if(r=n.current.alternate,!(i&30)&&!g9(r)&&(e=qS(n,i),e===2&&(o=EA(n),o!==0&&(i=o,e=eC(n,o))),e===1))throw t=Cv,tg(n,0),Qf(n,i),Qa(n,Os()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(on(345));case 2:Om(n,qa,Ed);break;case 3:if(Qf(n,i),(i&130023424)===i&&(e=_P+500-Os(),10<e)){if(CS(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){Pa(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=RA(Om.bind(null,n,qa,Ed),e);break}Om(n,qa,Ed);break;case 4:if(Qf(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var l=31-Au(i);o=1<<l,l=e[l],l>r&&(r=l),i&=~o}if(i=r,i=Os()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*m9(i/1960))-i,10<i){n.timeoutHandle=RA(Om.bind(null,n,qa,Ed),i);break}Om(n,qa,Ed);break;case 5:Om(n,qa,Ed);break;default:throw Error(on(329))}}}return Qa(n,Os()),n.callbackNode===t?h4.bind(null,n):null}function eC(n,e){var t=$x;return n.current.memoizedState.isDehydrated&&(tg(n,e).flags|=256),n=qS(n,e),n!==2&&(e=qa,qa=t,e!==null&&tC(e)),n}function tC(n){qa===null?qa=n:qa.push.apply(qa,n)}function g9(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],o=r.getSnapshot;r=r.value;try{if(!Lu(o(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qf(n,e){for(e&=~gP,e&=~DM,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Au(e),i=1<<t;n[t]=-1,e&=~i}}function yR(n){if(cr&6)throw Error(on(327));ly();var e=CS(n,0);if(!(e&1))return Qa(n,Os()),null;var t=qS(n,e);if(n.tag!==0&&t===2){var i=EA(n);i!==0&&(e=i,t=eC(n,i))}if(t===1)throw t=Cv,tg(n,0),Qf(n,e),Qa(n,Os()),t;if(t===6)throw Error(on(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Om(n,qa,Ed),Qa(n,Os()),null}function yP(n,e){var t=cr;cr|=1;try{return n(e)}finally{cr=t,cr===0&&(Ty=Os()+500,IM&&Fp())}}function yg(n){np!==null&&np.tag===0&&!(cr&6)&&ly();var e=cr;cr|=1;var t=Cc.transition,i=Er;try{if(Cc.transition=null,Er=1,n)return n()}finally{Er=i,Cc.transition=t,cr=e,!(cr&6)&&Fp()}}function xP(){Il=K_.current,Zr(K_)}function tg(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,qj(t)),qs!==null)for(t=qs.return;t!==null;){var i=t;switch(QI(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&DS();break;case 3:Sy(),Zr(Ka),Zr(pa),lP();break;case 5:aP(i);break;case 4:Sy();break;case 13:Zr(as);break;case 19:Zr(as);break;case 10:iP(i.type._context);break;case 22:case 23:xP()}t=t.return}if(Eo=n,qs=n=xp(n.current,null),Vo=Il=e,so=0,Cv=null,gP=DM=_g=0,qa=$x=null,qm!==null){for(e=0;e<qm.length;e++)if(t=qm[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,o=t.pending;if(o!==null){var l=o.next;o.next=r,i.next=l}t.pending=i}qm=null}return n}function d4(n,e){do{var t=qs;try{if(nP(),rS.current=GS,VS){for(var i=ds.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}VS=!1}if(gg=0,Mo=io=ds=null,Zx=!1,Tv=0,mP.current=null,t===null||t.return===null){so=1,Cv=e,qs=null;break}e:{var o=n,l=t.return,s=t,d=e;if(e=Vo,s.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var p=d,_=s,w=_.tag;if(!(_.mode&1)&&(w===0||w===11||w===15)){var M=_.alternate;M?(_.updateQueue=M.updateQueue,_.memoizedState=M.memoizedState,_.lanes=M.lanes):(_.updateQueue=null,_.memoizedState=null)}var A=sR(l);if(A!==null){A.flags&=-257,oR(A,l,s,o,e),A.mode&1&&rR(o,p,e),e=A,d=p;var P=e.updateQueue;if(P===null){var L=new Set;L.add(d),e.updateQueue=L}else P.add(d);break e}else{if(!(e&1)){rR(o,p,e),vP();break e}d=Error(on(426))}}else if(Kr&&s.mode&1){var D=sR(l);if(D!==null){!(D.flags&65536)&&(D.flags|=256),oR(D,l,s,o,e),eP(My(d,s));break e}}o=d=My(d,s),so!==4&&(so=2),$x===null?$x=[o]:$x.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var z=$N(o,d,e);K3(o,z);break e;case 1:s=d;var F=o.type,N=o.stateNode;if(!(o.flags&128)&&(typeof F.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(_p===null||!_p.has(N)))){o.flags|=65536,e&=-e,o.lanes|=e;var V=YN(o,s,e);K3(o,V);break e}}o=o.return}while(o!==null)}m4(t)}catch(j){e=j,qs===t&&t!==null&&(qs=t=t.return);continue}break}while(1)}function f4(){var n=WS.current;return WS.current=GS,n===null?GS:n}function vP(){(so===0||so===3||so===2)&&(so=4),Eo===null||!(_g&268435455)&&!(DM&268435455)||Qf(Eo,Vo)}function qS(n,e){var t=cr;cr|=2;var i=f4();(Eo!==n||Vo!==e)&&(Ed=null,tg(n,e));do try{_9();break}catch(r){d4(n,r)}while(1);if(nP(),cr=t,WS.current=i,qs!==null)throw Error(on(261));return Eo=null,Vo=0,so}function _9(){for(;qs!==null;)p4(qs)}function y9(){for(;qs!==null&&!WH();)p4(qs)}function p4(n){var e=_4(n.alternate,n,Il);n.memoizedProps=n.pendingProps,e===null?m4(n):qs=e,mP.current=null}function m4(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=h9(t,e),t!==null){t.flags&=32767,qs=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{so=6,qs=null;return}}else if(t=u9(t,e,Il),t!==null){qs=t;return}if(e=e.sibling,e!==null){qs=e;return}qs=e=n}while(e!==null);so===0&&(so=5)}function Om(n,e,t){var i=Er,r=Cc.transition;try{Cc.transition=null,Er=1,x9(n,e,t,i)}finally{Cc.transition=r,Er=i}return null}function x9(n,e,t,i){do ly();while(np!==null);if(cr&6)throw Error(on(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(on(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(QH(n,o),n===Eo&&(qs=Eo=null,Vo=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ww||(Ww=!0,y4(AS,function(){return ly(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=Cc.transition,Cc.transition=null;var l=Er;Er=1;var s=cr;cr|=4,mP.current=null,f9(n,t),c4(t,n),Nj(kA),IS=!!LA,kA=LA=null,n.current=t,p9(t),HH(),cr=s,Er=l,Cc.transition=o}else n.current=t;if(Ww&&(Ww=!1,np=n,jS=r),o=n.pendingLanes,o===0&&(_p=null),ZH(t.stateNode),Qa(n,Os()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(HS)throw HS=!1,n=JA,JA=null,n;return jS&1&&n.tag!==0&&ly(),o=n.pendingLanes,o&1?n===QA?Yx++:(Yx=0,QA=n):Yx=0,Fp(),null}function ly(){if(np!==null){var n=XB(jS),e=Cc.transition,t=Er;try{if(Cc.transition=null,Er=16>n?16:n,np===null)var i=!1;else{if(n=np,np=null,jS=0,cr&6)throw Error(on(331));var r=cr;for(cr|=4,Bn=n.current;Bn!==null;){var o=Bn,l=o.child;if(Bn.flags&16){var s=o.deletions;if(s!==null){for(var d=0;d<s.length;d++){var p=s[d];for(Bn=p;Bn!==null;){var _=Bn;switch(_.tag){case 0:case 11:case 15:Xx(8,_,o)}var w=_.child;if(w!==null)w.return=_,Bn=w;else for(;Bn!==null;){_=Bn;var M=_.sibling,A=_.return;if(o4(_),_===p){Bn=null;break}if(M!==null){M.return=A,Bn=M;break}Bn=A}}}var P=o.alternate;if(P!==null){var L=P.child;if(L!==null){P.child=null;do{var D=L.sibling;L.sibling=null,L=D}while(L!==null)}}Bn=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,Bn=l;else e:for(;Bn!==null;){if(o=Bn,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Xx(9,o,o.return)}var z=o.sibling;if(z!==null){z.return=o.return,Bn=z;break e}Bn=o.return}}var F=n.current;for(Bn=F;Bn!==null;){l=Bn;var N=l.child;if(l.subtreeFlags&2064&&N!==null)N.return=l,Bn=N;else e:for(l=F;Bn!==null;){if(s=Bn,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:kM(9,s)}}catch(j){bs(s,s.return,j)}if(s===l){Bn=null;break e}var V=s.sibling;if(V!==null){V.return=s.return,Bn=V;break e}Bn=s.return}}if(cr=r,Fp(),Sh&&typeof Sh.onPostCommitFiberRoot=="function")try{Sh.onPostCommitFiberRoot(MM,n)}catch{}i=!0}return i}finally{Er=t,Cc.transition=e}}return!1}function xR(n,e,t){e=My(t,e),e=$N(n,e,1),n=gp(n,e,1),e=Pa(),n!==null&&(t1(n,1,e),Qa(n,e))}function bs(n,e,t){if(n.tag===3)xR(n,n,t);else for(;e!==null;){if(e.tag===3){xR(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(_p===null||!_p.has(i))){n=My(t,n),n=YN(e,n,1),e=gp(e,n,1),n=Pa(),e!==null&&(t1(e,1,n),Qa(e,n));break}}e=e.return}}function v9(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=Pa(),n.pingedLanes|=n.suspendedLanes&t,Eo===n&&(Vo&t)===t&&(so===4||so===3&&(Vo&130023424)===Vo&&500>Os()-_P?tg(n,0):gP|=t),Qa(n,e)}function g4(n,e){e===0&&(n.mode&1?(e=Dw,Dw<<=1,!(Dw&130023424)&&(Dw=4194304)):e=1);var t=Pa();n=qd(n,e),n!==null&&(t1(n,e,t),Qa(n,t))}function w9(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),g4(n,t)}function b9(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(on(314))}i!==null&&i.delete(e),g4(n,t)}var _4;_4=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ka.current)Ya=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Ya=!1,c9(n,e,t);Ya=!!(n.flags&131072)}else Ya=!1,Kr&&e.flags&1048576&&vN(e,OS,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;oS(n,e),n=e.pendingProps;var r=vy(e,pa.current);ay(e,t),r=uP(null,e,i,n,r,t);var o=hP();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ja(i)?(o=!0,RS(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,sP(e),r.updater=PM,e.stateNode=r,r._reactInternals=e,VA(e,i,n,t),e=HA(null,e,i,!0,o,t)):(e.tag=0,Kr&&o&&JI(e),Aa(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(oS(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=M9(i),n=yu(i,n),r){case 0:e=WA(null,e,i,n,t);break e;case 1:e=cR(null,e,i,n,t);break e;case 11:e=aR(null,e,i,n,t);break e;case 14:e=lR(null,e,i,yu(i.type,n),t);break e}throw Error(on(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:yu(i,r),WA(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:yu(i,r),cR(n,e,i,r,t);case 3:e:{if(e4(e),n===null)throw Error(on(387));i=e.pendingProps,o=e.memoizedState,r=o.element,MN(n,e),NS(e,i,null,t);var l=e.memoizedState;if(i=l.element,o.isDehydrated)if(o={element:i,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=My(Error(on(423)),e),e=uR(n,e,i,t,r);break e}else if(i!==r){r=My(Error(on(424)),e),e=uR(n,e,i,t,r);break e}else for(kl=mp(e.stateNode.containerInfo.firstChild),Rl=e,Kr=!0,bu=null,t=CN(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(wy(),i===r){e=Zd(n,e,t);break e}Aa(n,e,i,t)}e=e.child}return e;case 5:return IN(e),n===null&&BA(e),i=e.type,r=e.pendingProps,o=n!==null?n.memoizedProps:null,l=r.children,DA(i,r)?l=null:o!==null&&DA(i,o)&&(e.flags|=32),QN(n,e),Aa(n,e,l,t),e.child;case 6:return n===null&&BA(e),null;case 13:return t4(n,e,t);case 4:return oP(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=by(e,null,i,t):Aa(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:yu(i,r),aR(n,e,i,r,t);case 7:return Aa(n,e,e.pendingProps,t),e.child;case 8:return Aa(n,e,e.pendingProps.children,t),e.child;case 12:return Aa(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,o=e.memoizedProps,l=r.value,Nr(FS,i._currentValue),i._currentValue=l,o!==null)if(Lu(o.value,l)){if(o.children===r.children&&!Ka.current){e=Zd(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var s=o.dependencies;if(s!==null){l=o.child;for(var d=s.firstContext;d!==null;){if(d.context===i){if(o.tag===1){d=Vd(-1,t&-t),d.tag=2;var p=o.updateQueue;if(p!==null){p=p.shared;var _=p.pending;_===null?d.next=d:(d.next=_.next,_.next=d),p.pending=d}}o.lanes|=t,d=o.alternate,d!==null&&(d.lanes|=t),NA(o.return,t,e),s.lanes|=t;break}d=d.next}}else if(o.tag===10)l=o.type===e.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(on(341));l.lanes|=t,s=l.alternate,s!==null&&(s.lanes|=t),NA(l,t,e),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===e){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}Aa(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,ay(e,t),r=Ic(r),i=i(r),e.flags|=1,Aa(n,e,i,t),e.child;case 14:return i=e.type,r=yu(i,e.pendingProps),r=yu(i.type,r),lR(n,e,i,r,t);case 15:return KN(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:yu(i,r),oS(n,e),e.tag=1,Ja(i)?(n=!0,RS(e)):n=!1,ay(e,t),EN(e,i,r),VA(e,i,r,t),HA(null,e,i,!0,n,t);case 19:return n4(n,e,t);case 22:return JN(n,e,t)}throw Error(on(156,e.tag))};function y4(n,e){return HB(n,e)}function S9(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bc(n,e,t,i){return new S9(n,e,t,i)}function wP(n){return n=n.prototype,!(!n||!n.isReactComponent)}function M9(n){if(typeof n=="function")return wP(n)?1:0;if(n!=null){if(n=n.$$typeof,n===UI)return 11;if(n===VI)return 14}return 2}function xp(n,e){var t=n.alternate;return t===null?(t=bc(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function cS(n,e,t,i,r,o){var l=2;if(i=n,typeof n=="function")wP(n)&&(l=1);else if(typeof n=="string")l=5;else e:switch(n){case V_:return ng(t.children,r,o,e);case NI:l=8,r|=8;break;case hA:return n=bc(12,t,e,r|2),n.elementType=hA,n.lanes=o,n;case dA:return n=bc(13,t,e,r),n.elementType=dA,n.lanes=o,n;case fA:return n=bc(19,t,e,r),n.elementType=fA,n.lanes=o,n;case AB:return RM(t,r,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case TB:l=10;break e;case EB:l=9;break e;case UI:l=11;break e;case VI:l=14;break e;case qf:l=16,i=null;break e}throw Error(on(130,n==null?n:typeof n,""))}return e=bc(l,t,e,r),e.elementType=n,e.type=i,e.lanes=o,e}function ng(n,e,t,i){return n=bc(7,n,i,e),n.lanes=t,n}function RM(n,e,t,i){return n=bc(22,n,i,e),n.elementType=AB,n.lanes=t,n.stateNode={isHidden:!1},n}function UE(n,e,t){return n=bc(6,n,null,e),n.lanes=t,n}function VE(n,e,t){return e=bc(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function T9(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wE(0),this.expirationTimes=wE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wE(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function bP(n,e,t,i,r,o,l,s,d){return n=new T9(n,e,t,s,d),e===1?(e=1,o===!0&&(e|=8)):e=0,o=bc(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},sP(o),n}function E9(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U_,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function x4(n){if(!n)return Tp;n=n._reactInternals;e:{if(Cg(n)!==n||n.tag!==1)throw Error(on(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ja(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(on(171))}if(n.tag===1){var t=n.type;if(Ja(t))return yN(n,t,e)}return e}function v4(n,e,t,i,r,o,l,s,d){return n=bP(t,i,!0,n,r,o,l,s,d),n.context=x4(null),t=n.current,i=Pa(),r=yp(t),o=Vd(i,r),o.callback=e??null,gp(t,o,r),n.current.lanes=r,t1(n,r,i),Qa(n,i),n}function zM(n,e,t,i){var r=e.current,o=Pa(),l=yp(r);return t=x4(t),e.context===null?e.context=t:e.pendingContext=t,e=Vd(o,l),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=gp(r,e,l),n!==null&&(Cu(n,r,l,o),iS(n,r,l)),l}function ZS(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function vR(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function SP(n,e){vR(n,e),(n=n.alternate)&&vR(n,e)}function A9(){return null}var w4=typeof reportError=="function"?reportError:function(n){console.error(n)};function MP(n){this._internalRoot=n}OM.prototype.render=MP.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(on(409));zM(n,e,null,null)};OM.prototype.unmount=MP.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;yg(function(){zM(null,n,null,null)}),e[jd]=null}};function OM(n){this._internalRoot=n}OM.prototype.unstable_scheduleHydration=function(n){if(n){var e=KB();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Jf.length&&e!==0&&e<Jf[t].priority;t++);Jf.splice(t,0,n),t===0&&QB(n)}};function TP(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function FM(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function wR(){}function C9(n,e,t,i,r){if(r){if(typeof i=="function"){var o=i;i=function(){var p=ZS(l);o.call(p)}}var l=v4(e,i,n,0,null,!1,!1,"",wR);return n._reactRootContainer=l,n[jd]=l.current,vv(n.nodeType===8?n.parentNode:n),yg(),l}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var s=i;i=function(){var p=ZS(d);s.call(p)}}var d=bP(n,0,!1,null,null,!1,!1,"",wR);return n._reactRootContainer=d,n[jd]=d.current,vv(n.nodeType===8?n.parentNode:n),yg(function(){zM(e,d,t,i)}),d}function BM(n,e,t,i,r){var o=t._reactRootContainer;if(o){var l=o;if(typeof r=="function"){var s=r;r=function(){var d=ZS(l);s.call(d)}}zM(e,l,n,r)}else l=C9(t,e,n,r,i);return ZS(l)}$B=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Dx(e.pendingLanes);t!==0&&(HI(e,t|1),Qa(e,Os()),!(cr&6)&&(Ty=Os()+500,Fp()))}break;case 13:yg(function(){var i=qd(n,1);if(i!==null){var r=Pa();Cu(i,n,1,r)}}),SP(n,1)}};jI=function(n){if(n.tag===13){var e=qd(n,134217728);if(e!==null){var t=Pa();Cu(e,n,134217728,t)}SP(n,134217728)}};YB=function(n){if(n.tag===13){var e=yp(n),t=qd(n,e);if(t!==null){var i=Pa();Cu(t,n,e,i)}SP(n,e)}};KB=function(){return Er};JB=function(n,e){var t=Er;try{return Er=n,e()}finally{Er=t}};SA=function(n,e,t){switch(e){case"input":if(gA(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=CM(i);if(!r)throw Error(on(90));IB(i),gA(i,r)}}}break;case"textarea":LB(n,t);break;case"select":e=t.value,e!=null&&iy(n,!!t.multiple,e,!1)}};BB=yP;NB=yg;var I9={usingClientEntryPoint:!1,Events:[i1,j_,CM,OB,FB,yP]},ix={findFiberByHostInstance:jm,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},P9={bundleType:ix.bundleType,version:ix.version,rendererPackageName:ix.rendererPackageName,rendererConfig:ix.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ef.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=GB(n),n===null?null:n.stateNode},findFiberByHostInstance:ix.findFiberByHostInstance||A9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hw.isDisabled&&Hw.supportsFiber)try{MM=Hw.inject(P9),Sh=Hw}catch{}}Vl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I9;Vl.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!TP(e))throw Error(on(200));return E9(n,e,null,t)};Vl.createRoot=function(n,e){if(!TP(n))throw Error(on(299));var t=!1,i="",r=w4;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=bP(n,1,!1,null,null,t,!1,i,r),n[jd]=e.current,vv(n.nodeType===8?n.parentNode:n),new MP(e)};Vl.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(on(188)):(n=Object.keys(n).join(","),Error(on(268,n)));return n=GB(e),n=n===null?null:n.stateNode,n};Vl.flushSync=function(n){return yg(n)};Vl.hydrate=function(n,e,t){if(!FM(e))throw Error(on(200));return BM(null,n,e,!0,t)};Vl.hydrateRoot=function(n,e,t){if(!TP(n))throw Error(on(405));var i=t!=null&&t.hydratedSources||null,r=!1,o="",l=w4;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),e=v4(e,null,n,1,t??null,r,!1,o,l),n[jd]=e.current,vv(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new OM(e)};Vl.render=function(n,e,t){if(!FM(e))throw Error(on(200));return BM(null,n,e,!1,t)};Vl.unmountComponentAtNode=function(n){if(!FM(n))throw Error(on(40));return n._reactRootContainer?(yg(function(){BM(null,null,n,!1,function(){n._reactRootContainer=null,n[jd]=null})}),!0):!1};Vl.unstable_batchedUpdates=yP;Vl.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!FM(t))throw Error(on(200));if(n==null||n._reactInternals===void 0)throw Error(on(38));return BM(n,e,t,!1,i)};Vl.version="18.2.0-next-9e3b772b8-20220608";(function(n){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),n.exports=Vl})(AH);var bR=lA;aA.createRoot=bR.createRoot,aA.hydrateRoot=bR.hydrateRoot;var nC={},L9={get exports(){return nC},set exports(n){nC=n}};(function(n,e){(function(i,r){n.exports=r()})(Kb,function(){var i=function(r){var o="@VERSION@-@BUILDLEVEL@",l=r.localStorage||function(){var ae={};return{setItem:function(le,fe){ae[le]=fe},getItem:function(le){return ae[le]},removeItem:function(le){delete ae[le]}}}(),s={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},d=function(ae,le){for(var fe in ae)if(ae.hasOwnProperty(fe))if(le.hasOwnProperty(fe)){if(typeof ae[fe]!==le[fe])throw new Error(M(_.INVALID_TYPE,[typeof ae[fe],fe]))}else{var Oe="Unknown property, "+fe+". Valid properties are:";for(var We in le)le.hasOwnProperty(We)&&(Oe=Oe+" "+We);throw new Error(Oe)}},p=function(ae,le){return function(){return ae.apply(le,arguments)}},_={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},w={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},M=function(ae,le){var fe=ae.text;if(le){for(var Oe,We,ce=0;ce<le.length;ce++)if(Oe="{"+ce+"}",We=fe.indexOf(Oe),We>0){var Te=fe.substring(0,We),Pe=fe.substring(We+Oe.length);fe=Te+le[ce]+Pe}}return fe},A=[0,6,77,81,73,115,100,112,3],P=[0,4,77,81,84,84,4],L=function(ae,le){this.type=ae;for(var fe in le)le.hasOwnProperty(fe)&&(this[fe]=le[fe])};L.prototype.encode=function(){var ae=(this.type&15)<<4,le=0,fe=[],Oe=0,We;switch(this.messageIdentifier!==void 0&&(le+=2),this.type){case s.CONNECT:switch(this.mqttVersion){case 3:le+=A.length+3;break;case 4:le+=P.length+3;break}le+=j(this.clientId)+2,this.willMessage!==void 0&&(le+=j(this.willMessage.destinationName)+2,We=this.willMessage.payloadBytes,We instanceof Uint8Array||(We=new Uint8Array(Te)),le+=We.byteLength+2),this.userName!==void 0&&(le+=j(this.userName)+2),this.password!==void 0&&(le+=j(this.password)+2);break;case s.SUBSCRIBE:ae|=2;for(var ce=0;ce<this.topics.length;ce++)fe[ce]=j(this.topics[ce]),le+=fe[ce]+2;le+=this.requestedQos.length;break;case s.UNSUBSCRIBE:ae|=2;for(var ce=0;ce<this.topics.length;ce++)fe[ce]=j(this.topics[ce]),le+=fe[ce]+2;break;case s.PUBREL:ae|=2;break;case s.PUBLISH:this.payloadMessage.duplicate&&(ae|=8),ae=ae|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(ae|=1),Oe=j(this.payloadMessage.destinationName),le+=Oe+2;var Te=this.payloadMessage.payloadBytes;le+=Te.byteLength,Te instanceof ArrayBuffer?Te=new Uint8Array(Te):Te instanceof Uint8Array||(Te=new Uint8Array(Te.buffer));break}var Pe=V(le),Qe=Pe.length+1,Ne=new ArrayBuffer(le+Qe),nt=new Uint8Array(Ne);if(nt[0]=ae,nt.set(Pe,1),this.type==s.PUBLISH)Qe=F(this.payloadMessage.destinationName,Oe,nt,Qe);else if(this.type==s.CONNECT){switch(this.mqttVersion){case 3:nt.set(A,Qe),Qe+=A.length;break;case 4:nt.set(P,Qe),Qe+=P.length;break}var ze=0;this.cleanSession&&(ze=2),this.willMessage!==void 0&&(ze|=4,ze|=this.willMessage.qos<<3,this.willMessage.retained&&(ze|=32)),this.userName!==void 0&&(ze|=128),this.password!==void 0&&(ze|=64),nt[Qe++]=ze,Qe=z(this.keepAliveInterval,nt,Qe)}switch(this.messageIdentifier!==void 0&&(Qe=z(this.messageIdentifier,nt,Qe)),this.type){case s.CONNECT:Qe=F(this.clientId,j(this.clientId),nt,Qe),this.willMessage!==void 0&&(Qe=F(this.willMessage.destinationName,j(this.willMessage.destinationName),nt,Qe),Qe=z(We.byteLength,nt,Qe),nt.set(We,Qe),Qe+=We.byteLength),this.userName!==void 0&&(Qe=F(this.userName,j(this.userName),nt,Qe)),this.password!==void 0&&(Qe=F(this.password,j(this.password),nt,Qe));break;case s.PUBLISH:nt.set(Te,Qe);break;case s.SUBSCRIBE:for(var ce=0;ce<this.topics.length;ce++)Qe=F(this.topics[ce],fe[ce],nt,Qe),nt[Qe++]=this.requestedQos[ce];break;case s.UNSUBSCRIBE:for(var ce=0;ce<this.topics.length;ce++)Qe=F(this.topics[ce],fe[ce],nt,Qe);break}return Ne};function D(ae,le){var fe=le,Oe=ae[le],We=Oe>>4,ce=Oe&=15;le+=1;var Te,Pe=0,Qe=1;do{if(le==ae.length)return[null,fe];Te=ae[le++],Pe+=(Te&127)*Qe,Qe*=128}while(Te&128);var Ne=le+Pe;if(Ne>ae.length)return[null,fe];var nt=new L(We);switch(We){case s.CONNACK:var ze=ae[le++];ze&1&&(nt.sessionPresent=!0),nt.returnCode=ae[le++];break;case s.PUBLISH:var et=ce>>1&3,Et=N(ae,le);le+=2;var Nt=re(ae,le,Et);le+=Et,et>0&&(nt.messageIdentifier=N(ae,le),le+=2);var qt=new He(ae.subarray(le,Ne));(ce&1)==1&&(qt.retained=!0),(ce&8)==8&&(qt.duplicate=!0),qt.qos=et,qt.destinationName=Nt,nt.payloadMessage=qt;break;case s.PUBACK:case s.PUBREC:case s.PUBREL:case s.PUBCOMP:case s.UNSUBACK:nt.messageIdentifier=N(ae,le);break;case s.SUBACK:nt.messageIdentifier=N(ae,le),le+=2,nt.returnCode=ae.subarray(le,Ne);break}return[nt,Ne]}function z(ae,le,fe){return le[fe++]=ae>>8,le[fe++]=ae%256,fe}function F(ae,le,fe,Oe){return Oe=z(le,fe,Oe),Q(ae,fe,Oe),Oe+le}function N(ae,le){return 256*ae[le]+ae[le+1]}function V(ae){var le=new Array(1),fe=0;do{var Oe=ae%128;ae=ae>>7,ae>0&&(Oe|=128),le[fe++]=Oe}while(ae>0&&fe<4);return le}function j(ae){for(var le=0,fe=0;fe<ae.length;fe++){var Oe=ae.charCodeAt(fe);Oe>2047?(55296<=Oe&&Oe<=56319&&(fe++,le++),le+=3):Oe>127?le+=2:le++}return le}function Q(ae,le,fe){for(var Oe=fe,We=0;We<ae.length;We++){var ce=ae.charCodeAt(We);if(55296<=ce&&ce<=56319){var Te=ae.charCodeAt(++We);if(isNaN(Te))throw new Error(M(_.MALFORMED_UNICODE,[ce,Te]));ce=(ce-55296<<10)+(Te-56320)+65536}ce<=127?le[Oe++]=ce:ce<=2047?(le[Oe++]=ce>>6&31|192,le[Oe++]=ce&63|128):ce<=65535?(le[Oe++]=ce>>12&15|224,le[Oe++]=ce>>6&63|128,le[Oe++]=ce&63|128):(le[Oe++]=ce>>18&7|240,le[Oe++]=ce>>12&63|128,le[Oe++]=ce>>6&63|128,le[Oe++]=ce&63|128)}return le}function re(ae,le,fe){for(var Oe="",We,ce=le;ce<le+fe;){var Te=ae[ce++];if(Te<128)We=Te;else{var Pe=ae[ce++]-128;if(Pe<0)throw new Error(M(_.MALFORMED_UTF,[Te.toString(16),Pe.toString(16),""]));if(Te<224)We=64*(Te-192)+Pe;else{var Qe=ae[ce++]-128;if(Qe<0)throw new Error(M(_.MALFORMED_UTF,[Te.toString(16),Pe.toString(16),Qe.toString(16)]));if(Te<240)We=4096*(Te-224)+64*Pe+Qe;else{var Ne=ae[ce++]-128;if(Ne<0)throw new Error(M(_.MALFORMED_UTF,[Te.toString(16),Pe.toString(16),Qe.toString(16),Ne.toString(16)]));if(Te<248)We=262144*(Te-240)+4096*Pe+64*Qe+Ne;else throw new Error(M(_.MALFORMED_UTF,[Te.toString(16),Pe.toString(16),Qe.toString(16),Ne.toString(16)]))}}}We>65535&&(We-=65536,Oe+=String.fromCharCode(55296+(We>>10)),We=56320+(We&1023)),Oe+=String.fromCharCode(We)}return Oe}var Z=function(ae,le){this._client=ae,this._keepAliveInterval=le*1e3,this.isReset=!1;var fe=new L(s.PINGREQ).encode(),Oe=function(ce){return function(){return We.apply(ce)}},We=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(fe),this.timeout=setTimeout(Oe(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(_.PING_TIMEOUT.code,M(_.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(Oe(this),this._keepAliveInterval))},this.cancel=function(){clearTimeout(this.timeout)}},ne=function(ae,le,fe,Oe){le||(le=30);var We=function(ce,Te,Pe){return function(){return ce.apply(Te,Pe)}};this.timeout=setTimeout(We(fe,ae,Oe),le*1e3),this.cancel=function(){clearTimeout(this.timeout)}},he=function(ae,le,fe,Oe,We){if(!("WebSocket"in r&&r.WebSocket!==null))throw new Error(M(_.UNSUPPORTED,["WebSocket"]));if(!("ArrayBuffer"in r&&r.ArrayBuffer!==null))throw new Error(M(_.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.Client",ae,le,fe,Oe,We),this.host=le,this.port=fe,this.path=Oe,this.uri=ae,this.clientId=We,this._wsuri=null,this._localKey=le+":"+fe+(Oe!="/mqtt"?":"+Oe:"")+":"+We+":",this._msg_queue=[],this._buffered_msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var ce in l)(ce.indexOf("Sent:"+this._localKey)===0||ce.indexOf("Received:"+this._localKey)===0)&&this.restore(ce)};he.prototype.host=null,he.prototype.port=null,he.prototype.path=null,he.prototype.uri=null,he.prototype.clientId=null,he.prototype.socket=null,he.prototype.connected=!1,he.prototype.maxMessageIdentifier=65536,he.prototype.connectOptions=null,he.prototype.hostIndex=null,he.prototype.onConnected=null,he.prototype.onConnectionLost=null,he.prototype.onMessageDelivered=null,he.prototype.onMessageArrived=null,he.prototype.traceFunction=null,he.prototype._msg_queue=null,he.prototype._buffered_msg_queue=null,he.prototype._connectTimeout=null,he.prototype.sendPinger=null,he.prototype.receivePinger=null,he.prototype._reconnectInterval=1,he.prototype._reconnecting=!1,he.prototype._reconnectTimeout=null,he.prototype.disconnectedPublishing=!1,he.prototype.disconnectedBufferSize=5e3,he.prototype.receiveBuffer=null,he.prototype._traceBuffer=null,he.prototype._MAX_TRACE_ENTRIES=100,he.prototype.connect=function(ae){var le=this._traceMask(ae,"password");if(this._trace("Client.connect",le,this.socket,this.connected),this.connected)throw new Error(M(_.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(M(_.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),this.connectOptions=ae,this._reconnectInterval=1,this._reconnecting=!1,ae.uris?(this.hostIndex=0,this._doConnect(ae.uris[0])):this._doConnect(this.uri)},he.prototype.subscribe=function(ae,le){if(this._trace("Client.subscribe",ae,le),!this.connected)throw new Error(M(_.INVALID_STATE,["not connected"]));var fe=new L(s.SUBSCRIBE);fe.topics=ae.constructor===Array?ae:[ae],le.qos===void 0&&(le.qos=0),fe.requestedQos=[];for(var Oe=0;Oe<fe.topics.length;Oe++)fe.requestedQos[Oe]=le.qos;le.onSuccess&&(fe.onSuccess=function(We){le.onSuccess({invocationContext:le.invocationContext,grantedQos:We})}),le.onFailure&&(fe.onFailure=function(We){le.onFailure({invocationContext:le.invocationContext,errorCode:We,errorMessage:M(We)})}),le.timeout&&(fe.timeOut=new ne(this,le.timeout,le.onFailure,[{invocationContext:le.invocationContext,errorCode:_.SUBSCRIBE_TIMEOUT.code,errorMessage:M(_.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(fe),this._schedule_message(fe)},he.prototype.unsubscribe=function(ae,le){if(this._trace("Client.unsubscribe",ae,le),!this.connected)throw new Error(M(_.INVALID_STATE,["not connected"]));var fe=new L(s.UNSUBSCRIBE);fe.topics=ae.constructor===Array?ae:[ae],le.onSuccess&&(fe.callback=function(){le.onSuccess({invocationContext:le.invocationContext})}),le.timeout&&(fe.timeOut=new ne(this,le.timeout,le.onFailure,[{invocationContext:le.invocationContext,errorCode:_.UNSUBSCRIBE_TIMEOUT.code,errorMessage:M(_.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(fe),this._schedule_message(fe)},he.prototype.send=function(ae){this._trace("Client.send",ae);var le=new L(s.PUBLISH);if(le.payloadMessage=ae,this.connected)ae.qos>0?this._requires_ack(le):this.onMessageDelivered&&(this._notify_msg_sent[le]=this.onMessageDelivered(le.payloadMessage)),this._schedule_message(le);else if(this._reconnecting&&this.disconnectedPublishing){var fe=Object.keys(this._sentMessages).length+this._buffered_msg_queue.length;if(fe>this.disconnectedBufferSize)throw new Error(M(_.BUFFER_FULL,[this.disconnectedBufferSize]));ae.qos>0?this._requires_ack(le):(le.sequence=++this._sequence,this._buffered_msg_queue.unshift(le))}else throw new Error(M(_.INVALID_STATE,["not connected"]))},he.prototype.disconnect=function(){if(this._trace("Client.disconnect"),this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1),!this.socket)throw new Error(M(_.INVALID_STATE,["not connecting or connected"]));var ae=new L(s.DISCONNECT);this._notify_msg_sent[ae]=p(this._disconnected,this),this._schedule_message(ae)},he.prototype.getTraceLog=function(){if(this._traceBuffer!==null){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var ae in this._sentMessages)this._trace("_sentMessages ",ae,this._sentMessages[ae]);for(var ae in this._receivedMessages)this._trace("_receivedMessages ",ae,this._receivedMessages[ae]);return this._traceBuffer}},he.prototype.startTrace=function(){this._traceBuffer===null&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,o)},he.prototype.stopTrace=function(){delete this._traceBuffer},he.prototype._doConnect=function(ae){if(this.connectOptions.useSSL){var le=ae.split(":");le[0]="wss",ae=le.join(":")}this._wsuri=ae,this.connected=!1,this.connectOptions.mqttVersion<4?this.socket=new WebSocket(ae,["mqttv3.1"]):this.socket=new WebSocket(ae,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=p(this._on_socket_open,this),this.socket.onmessage=p(this._on_socket_message,this),this.socket.onerror=p(this._on_socket_error,this),this.socket.onclose=p(this._on_socket_close,this),this.sendPinger=new Z(this,this.connectOptions.keepAliveInterval),this.receivePinger=new Z(this,this.connectOptions.keepAliveInterval),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._connectTimeout=new ne(this,this.connectOptions.timeout,this._disconnected,[_.CONNECT_TIMEOUT.code,M(_.CONNECT_TIMEOUT)])},he.prototype._schedule_message=function(ae){this._msg_queue.unshift(ae),this.connected&&this._process_queue()},he.prototype.store=function(ae,le){var fe={type:le.type,messageIdentifier:le.messageIdentifier,version:1};switch(le.type){case s.PUBLISH:le.pubRecReceived&&(fe.pubRecReceived=!0),fe.payloadMessage={};for(var Oe="",We=le.payloadMessage.payloadBytes,ce=0;ce<We.length;ce++)We[ce]<=15?Oe=Oe+"0"+We[ce].toString(16):Oe=Oe+We[ce].toString(16);fe.payloadMessage.payloadHex=Oe,fe.payloadMessage.qos=le.payloadMessage.qos,fe.payloadMessage.destinationName=le.payloadMessage.destinationName,le.payloadMessage.duplicate&&(fe.payloadMessage.duplicate=!0),le.payloadMessage.retained&&(fe.payloadMessage.retained=!0),ae.indexOf("Sent:")===0&&(le.sequence===void 0&&(le.sequence=++this._sequence),fe.sequence=le.sequence);break;default:throw Error(M(_.INVALID_STORED_DATA,[ae+this._localKey+le.messageIdentifier,fe]))}l.setItem(ae+this._localKey+le.messageIdentifier,JSON.stringify(fe))},he.prototype.restore=function(ae){var le=l.getItem(ae),fe=JSON.parse(le),Oe=new L(fe.type,fe);switch(fe.type){case s.PUBLISH:for(var We=fe.payloadMessage.payloadHex,ce=new ArrayBuffer(We.length/2),Te=new Uint8Array(ce),Pe=0;We.length>=2;){var Qe=parseInt(We.substring(0,2),16);We=We.substring(2,We.length),Te[Pe++]=Qe}var Ne=new He(Te);Ne.qos=fe.payloadMessage.qos,Ne.destinationName=fe.payloadMessage.destinationName,fe.payloadMessage.duplicate&&(Ne.duplicate=!0),fe.payloadMessage.retained&&(Ne.retained=!0),Oe.payloadMessage=Ne;break;default:throw Error(M(_.INVALID_STORED_DATA,[ae,le]))}ae.indexOf("Sent:"+this._localKey)===0?(Oe.payloadMessage.duplicate=!0,this._sentMessages[Oe.messageIdentifier]=Oe):ae.indexOf("Received:"+this._localKey)===0&&(this._receivedMessages[Oe.messageIdentifier]=Oe)},he.prototype._process_queue=function(){for(var ae=null;ae=this._msg_queue.pop();)this._socket_send(ae),this._notify_msg_sent[ae]&&(this._notify_msg_sent[ae](),delete this._notify_msg_sent[ae])},he.prototype._requires_ack=function(ae){var le=Object.keys(this._sentMessages).length;if(le>this.maxMessageIdentifier)throw Error("Too many messages:"+le);for(;this._sentMessages[this._message_identifier]!==void 0;)this._message_identifier++;ae.messageIdentifier=this._message_identifier,this._sentMessages[ae.messageIdentifier]=ae,ae.type===s.PUBLISH&&this.store("Sent:",ae),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},he.prototype._on_socket_open=function(){var ae=new L(s.CONNECT,this.connectOptions);ae.clientId=this.clientId,this._socket_send(ae)},he.prototype._on_socket_message=function(ae){this._trace("Client._on_socket_message",ae.data);for(var le=this._deframeMessages(ae.data),fe=0;fe<le.length;fe+=1)this._handleMessage(le[fe])},he.prototype._deframeMessages=function(ae){var le=new Uint8Array(ae),fe=[];if(this.receiveBuffer){var Oe=new Uint8Array(this.receiveBuffer.length+le.length);Oe.set(this.receiveBuffer),Oe.set(le,this.receiveBuffer.length),le=Oe,delete this.receiveBuffer}try{for(var We=0;We<le.length;){var ce=D(le,We),Te=ce[0];if(We=ce[1],Te!==null)fe.push(Te);else break}We<le.length&&(this.receiveBuffer=le.subarray(We))}catch(Qe){var Pe=Qe.hasOwnProperty("stack")=="undefined"?Qe.stack.toString():"No Error Stack Available";this._disconnected(_.INTERNAL_ERROR.code,M(_.INTERNAL_ERROR,[Qe.message,Pe]));return}return fe},he.prototype._handleMessage=function(ae){this._trace("Client._handleMessage",ae);try{switch(ae.type){case s.CONNACK:if(this._connectTimeout.cancel(),this._reconnectTimeout&&this._reconnectTimeout.cancel(),this.connectOptions.cleanSession){for(var le in this._sentMessages){var ze=this._sentMessages[le];l.removeItem("Sent:"+this._localKey+ze.messageIdentifier)}this._sentMessages={};for(var le in this._receivedMessages){var Ne=this._receivedMessages[le];l.removeItem("Received:"+this._localKey+Ne.messageIdentifier)}this._receivedMessages={}}if(ae.returnCode===0)this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);else{this._disconnected(_.CONNACK_RETURNCODE.code,M(_.CONNACK_RETURNCODE,[ae.returnCode,w[ae.returnCode]]));break}var We=[];for(var fe in this._sentMessages)this._sentMessages.hasOwnProperty(fe)&&We.push(this._sentMessages[fe]);if(this._buffered_msg_queue.length>0)for(var Oe=null;Oe=this._buffered_msg_queue.pop();)We.push(Oe),this.onMessageDelivered&&(this._notify_msg_sent[Oe]=this.onMessageDelivered(Oe.payloadMessage));for(var We=We.sort(function(Et,Nt){return Et.sequence-Nt.sequence}),ce=0,Te=We.length;ce<Te;ce++){var ze=We[ce];if(ze.type==s.PUBLISH&&ze.pubRecReceived){var Pe=new L(s.PUBREL,{messageIdentifier:ze.messageIdentifier});this._schedule_message(Pe)}else this._schedule_message(ze)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});var Qe=!1;this._reconnecting&&(Qe=!0,this._reconnectInterval=1,this._reconnecting=!1),this._connected(Qe,this._wsuri),this._process_queue();break;case s.PUBLISH:this._receivePublish(ae);break;case s.PUBACK:var ze=this._sentMessages[ae.messageIdentifier];ze&&(delete this._sentMessages[ae.messageIdentifier],l.removeItem("Sent:"+this._localKey+ae.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(ze.payloadMessage));break;case s.PUBREC:var ze=this._sentMessages[ae.messageIdentifier];if(ze){ze.pubRecReceived=!0;var Pe=new L(s.PUBREL,{messageIdentifier:ae.messageIdentifier});this.store("Sent:",ze),this._schedule_message(Pe)}break;case s.PUBREL:var Ne=this._receivedMessages[ae.messageIdentifier];l.removeItem("Received:"+this._localKey+ae.messageIdentifier),Ne&&(this._receiveMessage(Ne),delete this._receivedMessages[ae.messageIdentifier]);var nt=new L(s.PUBCOMP,{messageIdentifier:ae.messageIdentifier});this._schedule_message(nt);break;case s.PUBCOMP:var ze=this._sentMessages[ae.messageIdentifier];delete this._sentMessages[ae.messageIdentifier],l.removeItem("Sent:"+this._localKey+ae.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(ze.payloadMessage);break;case s.SUBACK:var ze=this._sentMessages[ae.messageIdentifier];ze&&(ze.timeOut&&ze.timeOut.cancel(),ae.returnCode[0]===128?ze.onFailure&&ze.onFailure(ae.returnCode):ze.onSuccess&&ze.onSuccess(ae.returnCode),delete this._sentMessages[ae.messageIdentifier]);break;case s.UNSUBACK:var ze=this._sentMessages[ae.messageIdentifier];ze&&(ze.timeOut&&ze.timeOut.cancel(),ze.callback&&ze.callback(),delete this._sentMessages[ae.messageIdentifier]);break;case s.PINGRESP:this.sendPinger.reset();break;case s.DISCONNECT:this._disconnected(_.INVALID_MQTT_MESSAGE_TYPE.code,M(_.INVALID_MQTT_MESSAGE_TYPE,[ae.type]));break;default:this._disconnected(_.INVALID_MQTT_MESSAGE_TYPE.code,M(_.INVALID_MQTT_MESSAGE_TYPE,[ae.type]))}}catch(Et){var et=Et.hasOwnProperty("stack")=="undefined"?Et.stack.toString():"No Error Stack Available";this._disconnected(_.INTERNAL_ERROR.code,M(_.INTERNAL_ERROR,[Et.message,et]));return}},he.prototype._on_socket_error=function(ae){this._reconnecting||this._disconnected(_.SOCKET_ERROR.code,M(_.SOCKET_ERROR,[ae.data]))},he.prototype._on_socket_close=function(){this._reconnecting||this._disconnected(_.SOCKET_CLOSE.code,M(_.SOCKET_CLOSE))},he.prototype._socket_send=function(ae){if(ae.type==1){var le=this._traceMask(ae,"password");this._trace("Client._socket_send",le)}else this._trace("Client._socket_send",ae);this.socket.send(ae.encode()),this.sendPinger.reset()},he.prototype._receivePublish=function(ae){switch(ae.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(ae);break;case 1:var le=new L(s.PUBACK,{messageIdentifier:ae.messageIdentifier});this._schedule_message(le),this._receiveMessage(ae);break;case 2:this._receivedMessages[ae.messageIdentifier]=ae,this.store("Received:",ae);var fe=new L(s.PUBREC,{messageIdentifier:ae.messageIdentifier});this._schedule_message(fe);break;default:throw Error("Invaild qos="+ae.payloadMessage.qos)}},he.prototype._receiveMessage=function(ae){this.onMessageArrived&&this.onMessageArrived(ae.payloadMessage)},he.prototype._connected=function(ae,le){this.onConnected&&this.onConnected(ae,le)},he.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=this._reconnectInterval*2),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))},he.prototype._disconnected=function(ae,le){if(this._trace("Client._disconnected",ae,le),ae!==void 0&&this._reconnecting){this._reconnectTimeout=new ne(this,this._reconnectInterval,this._reconnect);return}if(this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null),this._msg_queue=[],this._buffered_msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.readyState===1&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else if(ae===void 0&&(ae=_.OK.code,le=M(_.OK)),this.connected){if(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:ae,errorMessage:le,reconnect:this.connectOptions.reconnect,uri:this._wsuri}),ae!==_.OK.code&&this.connectOptions.reconnect){this._reconnectInterval=1,this._reconnect();return}}else this.connectOptions.mqttVersion===4&&this.connectOptions.mqttVersionExplicit===!1?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:ae,errorMessage:le})},he.prototype._trace=function(){if(this.traceFunction){var ae=Array.prototype.slice.call(arguments);for(var le in ae)typeof ae[le]<"u"&&ae.splice(le,1,JSON.stringify(ae[le]));var fe=ae.join("");this.traceFunction({severity:"Debug",message:fe})}if(this._traceBuffer!==null)for(var le=0,Oe=arguments.length;le<Oe;le++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),le===0?this._traceBuffer.push(arguments[le]):typeof arguments[le]>"u"?this._traceBuffer.push(arguments[le]):this._traceBuffer.push("  "+JSON.stringify(arguments[le]))},he.prototype._traceMask=function(ae,le){var fe={};for(var Oe in ae)ae.hasOwnProperty(Oe)&&(Oe==le?fe[Oe]="******":fe[Oe]=ae[Oe]);return fe};var De=function(ae,le,fe,Oe){var We;if(typeof ae!="string")throw new Error(M(_.INVALID_TYPE,[typeof ae,"host"]));if(arguments.length==2){Oe=le,We=ae;var ce=We.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(ce)ae=ce[4]||ce[2],le=parseInt(ce[7]),fe=ce[8];else throw new Error(M(_.INVALID_ARGUMENT,[ae,"host"]))}else{if(arguments.length==3&&(Oe=fe,fe="/mqtt"),typeof le!="number"||le<0)throw new Error(M(_.INVALID_TYPE,[typeof le,"port"]));if(typeof fe!="string")throw new Error(M(_.INVALID_TYPE,[typeof fe,"path"]));var Te=ae.indexOf(":")!==-1&&ae.slice(0,1)!=="["&&ae.slice(-1)!=="]";We="ws://"+(Te?"["+ae+"]":ae)+":"+le+fe}for(var Pe=0,Qe=0;Qe<Oe.length;Qe++){var Ne=Oe.charCodeAt(Qe);55296<=Ne&&Ne<=56319&&Qe++,Pe++}if(typeof Oe!="string"||Pe>65535)throw new Error(M(_.INVALID_ARGUMENT,[Oe,"clientId"]));var nt=new he(We,ae,le,fe,Oe);Object.defineProperties(this,{host:{get:function(){return ae},set:function(){throw new Error(M(_.UNSUPPORTED_OPERATION))}},port:{get:function(){return le},set:function(){throw new Error(M(_.UNSUPPORTED_OPERATION))}},path:{get:function(){return fe},set:function(){throw new Error(M(_.UNSUPPORTED_OPERATION))}},uri:{get:function(){return We},set:function(){throw new Error(M(_.UNSUPPORTED_OPERATION))}},clientId:{get:function(){return nt.clientId},set:function(){throw new Error(M(_.UNSUPPORTED_OPERATION))}},onConnected:{get:function(){return nt.onConnected},set:function(ze){if(typeof ze=="function")nt.onConnected=ze;else throw new Error(M(_.INVALID_TYPE,[typeof ze,"onConnected"]))}},disconnectedPublishing:{get:function(){return nt.disconnectedPublishing},set:function(ze){nt.disconnectedPublishing=ze}},disconnectedBufferSize:{get:function(){return nt.disconnectedBufferSize},set:function(ze){nt.disconnectedBufferSize=ze}},onConnectionLost:{get:function(){return nt.onConnectionLost},set:function(ze){if(typeof ze=="function")nt.onConnectionLost=ze;else throw new Error(M(_.INVALID_TYPE,[typeof ze,"onConnectionLost"]))}},onMessageDelivered:{get:function(){return nt.onMessageDelivered},set:function(ze){if(typeof ze=="function")nt.onMessageDelivered=ze;else throw new Error(M(_.INVALID_TYPE,[typeof ze,"onMessageDelivered"]))}},onMessageArrived:{get:function(){return nt.onMessageArrived},set:function(ze){if(typeof ze=="function")nt.onMessageArrived=ze;else throw new Error(M(_.INVALID_TYPE,[typeof ze,"onMessageArrived"]))}},trace:{get:function(){return nt.traceFunction},set:function(ze){if(typeof ze=="function")nt.traceFunction=ze;else throw new Error(M(_.INVALID_TYPE,[typeof ze,"onTrace"]))}}}),this.connect=function(ze){if(ze=ze||{},d(ze,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),ze.keepAliveInterval===void 0&&(ze.keepAliveInterval=60),ze.mqttVersion>4||ze.mqttVersion<3)throw new Error(M(_.INVALID_ARGUMENT,[ze.mqttVersion,"connectOptions.mqttVersion"]));if(ze.mqttVersion===void 0?(ze.mqttVersionExplicit=!1,ze.mqttVersion=4):ze.mqttVersionExplicit=!0,ze.password!==void 0&&ze.userName===void 0)throw new Error(M(_.INVALID_ARGUMENT,[ze.password,"connectOptions.password"]));if(ze.willMessage){if(!(ze.willMessage instanceof He))throw new Error(M(_.INVALID_TYPE,[ze.willMessage,"connectOptions.willMessage"]));if(ze.willMessage.stringPayload=null,typeof ze.willMessage.destinationName>"u")throw new Error(M(_.INVALID_TYPE,[typeof ze.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if(typeof ze.cleanSession>"u"&&(ze.cleanSession=!0),ze.hosts){if(!(ze.hosts instanceof Array))throw new Error(M(_.INVALID_ARGUMENT,[ze.hosts,"connectOptions.hosts"]));if(ze.hosts.length<1)throw new Error(M(_.INVALID_ARGUMENT,[ze.hosts,"connectOptions.hosts"]));for(var et=!1,Et=0;Et<ze.hosts.length;Et++){if(typeof ze.hosts[Et]!="string")throw new Error(M(_.INVALID_TYPE,[typeof ze.hosts[Et],"connectOptions.hosts["+Et+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(ze.hosts[Et])){if(Et===0)et=!0;else if(!et)throw new Error(M(_.INVALID_ARGUMENT,[ze.hosts[Et],"connectOptions.hosts["+Et+"]"]))}else if(et)throw new Error(M(_.INVALID_ARGUMENT,[ze.hosts[Et],"connectOptions.hosts["+Et+"]"]))}if(et)ze.uris=ze.hosts;else{if(!ze.ports)throw new Error(M(_.INVALID_ARGUMENT,[ze.ports,"connectOptions.ports"]));if(!(ze.ports instanceof Array))throw new Error(M(_.INVALID_ARGUMENT,[ze.ports,"connectOptions.ports"]));if(ze.hosts.length!==ze.ports.length)throw new Error(M(_.INVALID_ARGUMENT,[ze.ports,"connectOptions.ports"]));ze.uris=[];for(var Et=0;Et<ze.hosts.length;Et++){if(typeof ze.ports[Et]!="number"||ze.ports[Et]<0)throw new Error(M(_.INVALID_TYPE,[typeof ze.ports[Et],"connectOptions.ports["+Et+"]"]));var Nt=ze.hosts[Et],qt=ze.ports[Et],wn=Nt.indexOf(":")!==-1;We="ws://"+(wn?"["+Nt+"]":Nt)+":"+qt+fe,ze.uris.push(We)}}}nt.connect(ze)},this.subscribe=function(ze,et){if(typeof ze!="string"&&ze.constructor!==Array)throw new Error("Invalid argument:"+ze);if(et=et||{},d(et,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),et.timeout&&!et.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(typeof et.qos<"u"&&!(et.qos===0||et.qos===1||et.qos===2))throw new Error(M(_.INVALID_ARGUMENT,[et.qos,"subscribeOptions.qos"]));nt.subscribe(ze,et)},this.unsubscribe=function(ze,et){if(typeof ze!="string"&&ze.constructor!==Array)throw new Error("Invalid argument:"+ze);if(et=et||{},d(et,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),et.timeout&&!et.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");nt.unsubscribe(ze,et)},this.send=function(ze,et,Et,Nt){var qt;if(arguments.length===0)throw new Error("Invalid argument.length");if(arguments.length==1){if(!(ze instanceof He)&&typeof ze!="string")throw new Error("Invalid argument:"+typeof ze);if(qt=ze,typeof qt.destinationName>"u")throw new Error(M(_.INVALID_ARGUMENT,[qt.destinationName,"Message.destinationName"]));nt.send(qt)}else qt=new He(et),qt.destinationName=ze,arguments.length>=3&&(qt.qos=Et),arguments.length>=4&&(qt.retained=Nt),nt.send(qt)},this.publish=function(ze,et,Et,Nt){var qt;if(arguments.length===0)throw new Error("Invalid argument.length");if(arguments.length==1){if(!(ze instanceof He)&&typeof ze!="string")throw new Error("Invalid argument:"+typeof ze);if(qt=ze,typeof qt.destinationName>"u")throw new Error(M(_.INVALID_ARGUMENT,[qt.destinationName,"Message.destinationName"]));nt.send(qt)}else qt=new He(et),qt.destinationName=ze,arguments.length>=3&&(qt.qos=Et),arguments.length>=4&&(qt.retained=Nt),nt.send(qt)},this.disconnect=function(){nt.disconnect()},this.getTraceLog=function(){return nt.getTraceLog()},this.startTrace=function(){nt.startTrace()},this.stopTrace=function(){nt.stopTrace()},this.isConnected=function(){return nt.connected}},He=function(ae){var le;if(typeof ae=="string"||ae instanceof ArrayBuffer||ArrayBuffer.isView(ae)&&!(ae instanceof DataView))le=ae;else throw M(_.INVALID_ARGUMENT,[ae,"newPayload"]);var fe,Oe=0,We=!1,ce=!1;Object.defineProperties(this,{payloadString:{enumerable:!0,get:function(){return typeof le=="string"?le:re(le,0,le.length)}},payloadBytes:{enumerable:!0,get:function(){if(typeof le=="string"){var Te=new ArrayBuffer(j(le)),Pe=new Uint8Array(Te);return Q(le,Pe,0),Pe}else return le}},destinationName:{enumerable:!0,get:function(){return fe},set:function(Te){if(typeof Te=="string")fe=Te;else throw new Error(M(_.INVALID_ARGUMENT,[Te,"newDestinationName"]))}},qos:{enumerable:!0,get:function(){return Oe},set:function(Te){if(Te===0||Te===1||Te===2)Oe=Te;else throw new Error("Invalid argument:"+Te)}},retained:{enumerable:!0,get:function(){return We},set:function(Te){if(typeof Te=="boolean")We=Te;else throw new Error(M(_.INVALID_ARGUMENT,[Te,"newRetained"]))}},topic:{enumerable:!0,get:function(){return fe},set:function(Te){fe=Te}},duplicate:{enumerable:!0,get:function(){return ce},set:function(Te){ce=Te}}})};return{Client:De,Message:He}}(typeof Kb<"u"?Kb:typeof self<"u"?self:typeof window<"u"?window:{});return i})})(L9);const k9=nC;/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */function ja(){}const D9=function(){let n=0;return function(){return n++}}();function xr(n){return n===null||typeof n>"u"}function zr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function ur(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}const ao=n=>(typeof n=="number"||n instanceof Number)&&isFinite(+n);function dc(n,e){return ao(n)?n:e}function Mi(n,e){return typeof n>"u"?e:n}const R9=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:n/e,b4=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function _r(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function yi(n,e,t,i){let r,o,l;if(zr(n))if(o=n.length,i)for(r=o-1;r>=0;r--)e.call(t,n[r],r);else for(r=0;r<o;r++)e.call(t,n[r],r);else if(ur(n))for(l=Object.keys(n),o=l.length,r=0;r<o;r++)e.call(t,n[l[r]],l[r])}function XS(n,e){let t,i,r,o;if(!n||!e||n.length!==e.length)return!1;for(t=0,i=n.length;t<i;++t)if(r=n[t],o=e[t],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function $S(n){if(zr(n))return n.map($S);if(ur(n)){const e=Object.create(null),t=Object.keys(n),i=t.length;let r=0;for(;r<i;++r)e[t[r]]=$S(n[t[r]]);return e}return n}function S4(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function z9(n,e,t,i){if(!S4(n))return;const r=e[n],o=t[n];ur(r)&&ur(o)?Iv(r,o,i):e[n]=$S(o)}function Iv(n,e,t){const i=zr(e)?e:[e],r=i.length;if(!ur(n))return n;t=t||{};const o=t.merger||z9;for(let l=0;l<r;++l){if(e=i[l],!ur(e))continue;const s=Object.keys(e);for(let d=0,p=s.length;d<p;++d)o(s[d],n,e,t)}return n}function Kx(n,e){return Iv(n,e,{merger:O9})}function O9(n,e,t){if(!S4(n))return;const i=e[n],r=t[n];ur(i)&&ur(r)?Kx(i,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=$S(r))}const SR={"":n=>n,x:n=>n.x,y:n=>n.y};function Ep(n,e){return(SR[e]||(SR[e]=F9(e)))(n)}function F9(n){const e=B9(n);return t=>{for(const i of e){if(i==="")break;t=t&&t[i]}return t}}function B9(n){const e=n.split("."),t=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(t.push(i),i="");return t}function EP(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Lc=n=>typeof n<"u",Ap=n=>typeof n=="function",MR=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function N9(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Qr=Math.PI,Or=2*Qr,U9=Or+Qr,YS=Number.POSITIVE_INFINITY,V9=Qr/180,Ms=Qr/2,rx=Qr/4,TR=Qr*2/3,vc=Math.log10,Th=Math.sign;function ER(n){const e=Math.round(n);n=Jx(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(vc(n))),i=n/t;return(i<=1?1:i<=2?2:i<=5?5:10)*t}function G9(n){const e=[],t=Math.sqrt(n);let i;for(i=1;i<t;i++)n%i===0&&(e.push(i),e.push(n/i));return t===(t|0)&&e.push(t),e.sort((r,o)=>r-o).pop(),e}function xg(n){return!isNaN(parseFloat(n))&&isFinite(n)}function Jx(n,e,t){return Math.abs(n-e)<t}function W9(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function M4(n,e,t){let i,r,o;for(i=0,r=n.length;i<r;i++)o=n[i][t],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Tu(n){return n*(Qr/180)}function AP(n){return n*(180/Qr)}function AR(n){if(!ao(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function T4(n,e){const t=e.x-n.x,i=e.y-n.y,r=Math.sqrt(t*t+i*i);let o=Math.atan2(i,t);return o<-.5*Qr&&(o+=Or),{angle:o,distance:r}}function iC(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function H9(n,e){return(n-e+U9)%Or-Qr}function vu(n){return(n%Or+Or)%Or}function Pv(n,e,t,i){const r=vu(n),o=vu(e),l=vu(t),s=vu(o-r),d=vu(l-r),p=vu(r-o),_=vu(r-l);return r===o||r===l||i&&o===l||s>d&&p<_}function ha(n,e,t){return Math.max(e,Math.min(t,n))}function j9(n){return ha(n,-32768,32767)}function ip(n,e,t,i=1e-6){return n>=Math.min(e,t)-i&&n<=Math.max(e,t)+i}function NM(n,e,t){t=t||(l=>n[l]<e);let i=n.length-1,r=0,o;for(;i-r>1;)o=r+i>>1,t(o)?r=o:i=o;return{lo:r,hi:i}}const Xm=(n,e,t,i)=>NM(n,t,i?r=>n[r][e]<=t:r=>n[r][e]<t),q9=(n,e,t)=>NM(n,t,i=>n[i][e]>=t);function Z9(n,e,t){let i=0,r=n.length;for(;i<r&&n[i]<e;)i++;for(;r>i&&n[r-1]>t;)r--;return i>0||r<n.length?n.slice(i,r):n}const E4=["push","pop","shift","splice","unshift"];function X9(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),E4.forEach(t=>{const i="_onData"+EP(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...o){const l=r.apply(this,o);return n._chartjs.listeners.forEach(s=>{typeof s[i]=="function"&&s[i](...o)}),l}})})}function CR(n,e){const t=n._chartjs;if(!t)return;const i=t.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(E4.forEach(o=>{delete n[o]}),delete n._chartjs)}function A4(n){const e=new Set;let t,i;for(t=0,i=n.length;t<i;++t)e.add(n[t]);return e.size===i?n:Array.from(e)}const KS=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function C4(n,e,t){const i=t||(l=>Array.prototype.slice.call(l));let r=!1,o=[];return function(...l){o=i(l),r||(r=!0,KS.call(window,()=>{r=!1,n.apply(e,o)}))}}function $9(n,e){let t;return function(...i){return e?(clearTimeout(t),t=setTimeout(n,e,i)):n.apply(this,i),e}}const CP=n=>n==="start"?"left":n==="end"?"right":"center",aa=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Y9=(n,e,t,i)=>n===(i?"left":"right")?t:n==="center"?(e+t)/2:e;function I4(n,e,t){const i=e.length;let r=0,o=i;if(n._sorted){const{iScale:l,_parsed:s}=n,d=l.axis,{min:p,max:_,minDefined:w,maxDefined:M}=l.getUserBounds();w&&(r=ha(Math.min(Xm(s,l.axis,p).lo,t?i:Xm(e,d,l.getPixelForValue(p)).lo),0,i-1)),M?o=ha(Math.max(Xm(s,l.axis,_,!0).hi+1,t?0:Xm(e,d,l.getPixelForValue(_),!0).hi+1),r,i)-r:o=i-r}return{start:r,count:o}}function P4(n){const{xScale:e,yScale:t,_scaleRanges:i}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!i)return n._scaleRanges=r,!0;const o=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==t.min||i.ymax!==t.max;return Object.assign(i,r),o}const jw=n=>n===0||n===1,IR=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*Or/t)),PR=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*Or/t)+1,Qx={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Ms)+1,easeOutSine:n=>Math.sin(n*Ms),easeInOutSine:n=>-.5*(Math.cos(Qr*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>jw(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>jw(n)?n:IR(n,.075,.3),easeOutElastic:n=>jw(n)?n:PR(n,.075,.3),easeInOutElastic(n){return jw(n)?n:n<.5?.5*IR(n*2,.1125,.45):.5+.5*PR(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Qx.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Qx.easeInBounce(n*2)*.5:Qx.easeOutBounce(n*2-1)*.5+.5};/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function s1(n){return n+.5|0}const rp=(n,e,t)=>Math.max(Math.min(n,t),e);function zx(n){return rp(s1(n*2.55),0,255)}function vp(n){return rp(s1(n*255),0,255)}function Id(n){return rp(s1(n/2.55)/100,0,1)}function LR(n){return rp(s1(n*100),0,100)}const cc={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},rC=[..."0123456789ABCDEF"],K9=n=>rC[n&15],J9=n=>rC[(n&240)>>4]+rC[n&15],qw=n=>(n&240)>>4===(n&15),Q9=n=>qw(n.r)&&qw(n.g)&&qw(n.b)&&qw(n.a);function e7(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&cc[n[1]]*17,g:255&cc[n[2]]*17,b:255&cc[n[3]]*17,a:e===5?cc[n[4]]*17:255}:(e===7||e===9)&&(t={r:cc[n[1]]<<4|cc[n[2]],g:cc[n[3]]<<4|cc[n[4]],b:cc[n[5]]<<4|cc[n[6]],a:e===9?cc[n[7]]<<4|cc[n[8]]:255})),t}const t7=(n,e)=>n<255?e(n):"";function n7(n){var e=Q9(n)?K9:J9;return n?"#"+e(n.r)+e(n.g)+e(n.b)+t7(n.a,e):void 0}const i7=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function L4(n,e,t){const i=e*Math.min(t,1-t),r=(o,l=(o+n/30)%12)=>t-i*Math.max(Math.min(l-3,9-l,1),-1);return[r(0),r(8),r(4)]}function r7(n,e,t){const i=(r,o=(r+n/60)%6)=>t-t*e*Math.max(Math.min(o,4-o,1),0);return[i(5),i(3),i(1)]}function s7(n,e,t){const i=L4(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)i[r]*=1-e-t,i[r]+=e;return i}function o7(n,e,t,i,r){return n===r?(e-t)/i+(e<t?6:0):e===r?(t-n)/i+2:(n-e)/i+4}function IP(n){const t=n.r/255,i=n.g/255,r=n.b/255,o=Math.max(t,i,r),l=Math.min(t,i,r),s=(o+l)/2;let d,p,_;return o!==l&&(_=o-l,p=s>.5?_/(2-o-l):_/(o+l),d=o7(t,i,r,_,o),d=d*60+.5),[d|0,p||0,s]}function PP(n,e,t,i){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,i)).map(vp)}function LP(n,e,t){return PP(L4,n,e,t)}function a7(n,e,t){return PP(s7,n,e,t)}function l7(n,e,t){return PP(r7,n,e,t)}function k4(n){return(n%360+360)%360}function c7(n){const e=i7.exec(n);let t=255,i;if(!e)return;e[5]!==i&&(t=e[6]?zx(+e[5]):vp(+e[5]));const r=k4(+e[2]),o=+e[3]/100,l=+e[4]/100;return e[1]==="hwb"?i=a7(r,o,l):e[1]==="hsv"?i=l7(r,o,l):i=LP(r,o,l),{r:i[0],g:i[1],b:i[2],a:t}}function u7(n,e){var t=IP(n);t[0]=k4(t[0]+e),t=LP(t),n.r=t[0],n.g=t[1],n.b=t[2]}function h7(n){if(!n)return;const e=IP(n),t=e[0],i=LR(e[1]),r=LR(e[2]);return n.a<255?`hsla(${t}, ${i}%, ${r}%, ${Id(n.a)})`:`hsl(${t}, ${i}%, ${r}%)`}const kR={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},DR={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function d7(){const n={},e=Object.keys(DR),t=Object.keys(kR);let i,r,o,l,s;for(i=0;i<e.length;i++){for(l=s=e[i],r=0;r<t.length;r++)o=t[r],s=s.replace(o,kR[o]);o=parseInt(DR[l],16),n[s]=[o>>16&255,o>>8&255,o&255]}return n}let Zw;function f7(n){Zw||(Zw=d7(),Zw.transparent=[0,0,0,0]);const e=Zw[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const p7=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function m7(n){const e=p7.exec(n);let t=255,i,r,o;if(e){if(e[7]!==i){const l=+e[7];t=e[8]?zx(l):rp(l*255,0,255)}return i=+e[1],r=+e[3],o=+e[5],i=255&(e[2]?zx(i):rp(i,0,255)),r=255&(e[4]?zx(r):rp(r,0,255)),o=255&(e[6]?zx(o):rp(o,0,255)),{r:i,g:r,b:o,a:t}}}function g7(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Id(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const GE=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,m_=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function _7(n,e,t){const i=m_(Id(n.r)),r=m_(Id(n.g)),o=m_(Id(n.b));return{r:vp(GE(i+t*(m_(Id(e.r))-i))),g:vp(GE(r+t*(m_(Id(e.g))-r))),b:vp(GE(o+t*(m_(Id(e.b))-o))),a:n.a+t*(e.a-n.a)}}function Xw(n,e,t){if(n){let i=IP(n);i[e]=Math.max(0,Math.min(i[e]+i[e]*t,e===0?360:1)),i=LP(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function D4(n,e){return n&&Object.assign(e||{},n)}function RR(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=vp(n[3]))):(e=D4(n,{r:0,g:0,b:0,a:1}),e.a=vp(e.a)),e}function y7(n){return n.charAt(0)==="r"?m7(n):c7(n)}let x7=class sC{constructor(e){if(e instanceof sC)return e;const t=typeof e;let i;t==="object"?i=RR(e):t==="string"&&(i=e7(e)||f7(e)||y7(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=D4(this._rgb);return e&&(e.a=Id(e.a)),e}set rgb(e){this._rgb=RR(e)}rgbString(){return this._valid?g7(this._rgb):void 0}hexString(){return this._valid?n7(this._rgb):void 0}hslString(){return this._valid?h7(this._rgb):void 0}mix(e,t){if(e){const i=this.rgb,r=e.rgb;let o;const l=t===o?.5:t,s=2*l-1,d=i.a-r.a,p=((s*d===-1?s:(s+d)/(1+s*d))+1)/2;o=1-p,i.r=255&p*i.r+o*r.r+.5,i.g=255&p*i.g+o*r.g+.5,i.b=255&p*i.b+o*r.b+.5,i.a=l*i.a+(1-l)*r.a,this.rgb=i}return this}interpolate(e,t){return e&&(this._rgb=_7(this._rgb,e._rgb,t)),this}clone(){return new sC(this.rgb)}alpha(e){return this._rgb.a=vp(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=s1(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Xw(this._rgb,2,e),this}darken(e){return Xw(this._rgb,2,-e),this}saturate(e){return Xw(this._rgb,1,e),this}desaturate(e){return Xw(this._rgb,1,-e),this}rotate(e){return u7(this._rgb,e),this}};function R4(n){return new x7(n)}function z4(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function zR(n){return z4(n)?n:R4(n)}function WE(n){return z4(n)?n:R4(n).saturate(.5).darken(.1).hexString()}const vg=Object.create(null),oC=Object.create(null);function ev(n,e){if(!e)return n;const t=e.split(".");for(let i=0,r=t.length;i<r;++i){const o=t[i];n=n[o]||(n[o]=Object.create(null))}return n}function HE(n,e,t){return typeof e=="string"?Iv(ev(n,e),t):Iv(ev(n,""),e)}class v7{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,i)=>WE(i.backgroundColor),this.hoverBorderColor=(t,i)=>WE(i.borderColor),this.hoverColor=(t,i)=>WE(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e)}set(e,t){return HE(this,e,t)}get(e){return ev(this,e)}describe(e,t){return HE(oC,e,t)}override(e,t){return HE(vg,e,t)}route(e,t,i,r){const o=ev(this,e),l=ev(this,i),s="_"+t;Object.defineProperties(o,{[s]:{value:o[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[s],p=l[r];return ur(d)?Object.assign({},p,d):Mi(d,p)},set(d){this[s]=d}}})}}var Fi=new v7({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function w7(n){return!n||xr(n.size)||xr(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function JS(n,e,t,i,r){let o=e[r];return o||(o=e[r]=n.measureText(r).width,t.push(r)),o>i&&(i=o),i}function b7(n,e,t,i){i=i||{};let r=i.data=i.data||{},o=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},o=i.garbageCollect=[],i.font=e),n.save(),n.font=e;let l=0;const s=t.length;let d,p,_,w,M;for(d=0;d<s;d++)if(w=t[d],w!=null&&zr(w)!==!0)l=JS(n,r,o,l,w);else if(zr(w))for(p=0,_=w.length;p<_;p++)M=w[p],M!=null&&!zr(M)&&(l=JS(n,r,o,l,M));n.restore();const A=o.length/2;if(A>t.length){for(d=0;d<A;d++)delete r[o[d]];o.splice(0,A)}return l}function bm(n,e,t){const i=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*i)/i+r}function OR(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function aC(n,e,t,i){O4(n,e,t,i,null)}function O4(n,e,t,i,r){let o,l,s,d,p,_;const w=e.pointStyle,M=e.rotation,A=e.radius;let P=(M||0)*V9;if(w&&typeof w=="object"&&(o=w.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){n.save(),n.translate(t,i),n.rotate(P),n.drawImage(w,-w.width/2,-w.height/2,w.width,w.height),n.restore();return}if(!(isNaN(A)||A<=0)){switch(n.beginPath(),w){default:r?n.ellipse(t,i,r/2,A,0,0,Or):n.arc(t,i,A,0,Or),n.closePath();break;case"triangle":n.moveTo(t+Math.sin(P)*A,i-Math.cos(P)*A),P+=TR,n.lineTo(t+Math.sin(P)*A,i-Math.cos(P)*A),P+=TR,n.lineTo(t+Math.sin(P)*A,i-Math.cos(P)*A),n.closePath();break;case"rectRounded":p=A*.516,d=A-p,l=Math.cos(P+rx)*d,s=Math.sin(P+rx)*d,n.arc(t-l,i-s,p,P-Qr,P-Ms),n.arc(t+s,i-l,p,P-Ms,P),n.arc(t+l,i+s,p,P,P+Ms),n.arc(t-s,i+l,p,P+Ms,P+Qr),n.closePath();break;case"rect":if(!M){d=Math.SQRT1_2*A,_=r?r/2:d,n.rect(t-_,i-d,2*_,2*d);break}P+=rx;case"rectRot":l=Math.cos(P)*A,s=Math.sin(P)*A,n.moveTo(t-l,i-s),n.lineTo(t+s,i-l),n.lineTo(t+l,i+s),n.lineTo(t-s,i+l),n.closePath();break;case"crossRot":P+=rx;case"cross":l=Math.cos(P)*A,s=Math.sin(P)*A,n.moveTo(t-l,i-s),n.lineTo(t+l,i+s),n.moveTo(t+s,i-l),n.lineTo(t-s,i+l);break;case"star":l=Math.cos(P)*A,s=Math.sin(P)*A,n.moveTo(t-l,i-s),n.lineTo(t+l,i+s),n.moveTo(t+s,i-l),n.lineTo(t-s,i+l),P+=rx,l=Math.cos(P)*A,s=Math.sin(P)*A,n.moveTo(t-l,i-s),n.lineTo(t+l,i+s),n.moveTo(t+s,i-l),n.lineTo(t-s,i+l);break;case"line":l=r?r/2:Math.cos(P)*A,s=Math.sin(P)*A,n.moveTo(t-l,i-s),n.lineTo(t+l,i+s);break;case"dash":n.moveTo(t,i),n.lineTo(t+Math.cos(P)*A,i+Math.sin(P)*A);break}n.fill(),e.borderWidth>0&&n.stroke()}}function Lv(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function o1(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function a1(n){n.restore()}function S7(n,e,t,i,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const o=(e.x+t.x)/2;n.lineTo(o,e.y),n.lineTo(o,t.y)}else r==="after"!=!!i?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function M7(n,e,t,i){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?t.cp2x:t.cp1x,i?t.cp2y:t.cp1y,t.x,t.y)}function wg(n,e,t,i,r,o={}){const l=zr(e)?e:[e],s=o.strokeWidth>0&&o.strokeColor!=="";let d,p;for(n.save(),n.font=r.string,T7(n,o),d=0;d<l.length;++d)p=l[d],s&&(o.strokeColor&&(n.strokeStyle=o.strokeColor),xr(o.strokeWidth)||(n.lineWidth=o.strokeWidth),n.strokeText(p,t,i,o.maxWidth)),n.fillText(p,t,i,o.maxWidth),E7(n,t,i,p,o),i+=r.lineHeight;n.restore()}function T7(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),xr(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function E7(n,e,t,i,r){if(r.strikethrough||r.underline){const o=n.measureText(i),l=e-o.actualBoundingBoxLeft,s=e+o.actualBoundingBoxRight,d=t-o.actualBoundingBoxAscent,p=t+o.actualBoundingBoxDescent,_=r.strikethrough?(d+p)/2:p;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(l,_),n.lineTo(s,_),n.stroke()}}function kv(n,e){const{x:t,y:i,w:r,h:o,radius:l}=e;n.arc(t+l.topLeft,i+l.topLeft,l.topLeft,-Ms,Qr,!0),n.lineTo(t,i+o-l.bottomLeft),n.arc(t+l.bottomLeft,i+o-l.bottomLeft,l.bottomLeft,Qr,Ms,!0),n.lineTo(t+r-l.bottomRight,i+o),n.arc(t+r-l.bottomRight,i+o-l.bottomRight,l.bottomRight,Ms,0,!0),n.lineTo(t+r,i+l.topRight),n.arc(t+r-l.topRight,i+l.topRight,l.topRight,0,-Ms,!0),n.lineTo(t+l.topLeft,i)}const A7=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),C7=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function I7(n,e){const t=(""+n).match(A7);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const P7=n=>+n||0;function kP(n,e){const t={},i=ur(e),r=i?Object.keys(e):e,o=ur(n)?i?l=>Mi(n[l],n[e[l]]):l=>n[l]:()=>n;for(const l of r)t[l]=P7(o(l));return t}function F4(n){return kP(n,{top:"y",right:"x",bottom:"y",left:"x"})}function ig(n){return kP(n,["topLeft","topRight","bottomLeft","bottomRight"])}function ma(n){const e=F4(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function oo(n,e){n=n||{},e=e||Fi.font;let t=Mi(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let i=Mi(n.style,e.style);i&&!(""+i).match(C7)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const r={family:Mi(n.family,e.family),lineHeight:I7(Mi(n.lineHeight,e.lineHeight),t),size:t,style:i,weight:Mi(n.weight,e.weight),string:""};return r.string=w7(r),r}function $w(n,e,t,i){let r=!0,o,l,s;for(o=0,l=n.length;o<l;++o)if(s=n[o],s!==void 0&&(e!==void 0&&typeof s=="function"&&(s=s(e),r=!1),t!==void 0&&zr(s)&&(s=s[t%s.length],r=!1),s!==void 0))return i&&!r&&(i.cacheable=!1),s}function L7(n,e,t){const{min:i,max:r}=n,o=b4(e,(r-i)/2),l=(s,d)=>t&&s===0?0:s+d;return{min:l(i,-Math.abs(o)),max:l(r,o)}}function Bp(n,e){return Object.assign(Object.create(n),e)}function DP(n,e=[""],t=n,i,r=()=>n[0]){Lc(i)||(i=V4("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:t,_fallback:i,_getTarget:r,override:l=>DP([l,...n],e,t,i)};return new Proxy(o,{deleteProperty(l,s){return delete l[s],delete l._keys,delete n[0][s],!0},get(l,s){return N4(l,s,()=>N7(s,e,n,l))},getOwnPropertyDescriptor(l,s){return Reflect.getOwnPropertyDescriptor(l._scopes[0],s)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,s){return BR(l).includes(s)},ownKeys(l){return BR(l)},set(l,s,d){const p=l._storage||(l._storage=r());return l[s]=p[s]=d,delete l._keys,!0}})}function Ey(n,e,t,i){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:B4(n,i),setContext:o=>Ey(n,o,t,i),override:o=>Ey(n.override(o),e,t,i)};return new Proxy(r,{deleteProperty(o,l){return delete o[l],delete n[l],!0},get(o,l,s){return N4(o,l,()=>D7(o,l,s))},getOwnPropertyDescriptor(o,l){return o._descriptors.allKeys?Reflect.has(n,l)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,l)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(o,l){return Reflect.has(n,l)},ownKeys(){return Reflect.ownKeys(n)},set(o,l,s){return n[l]=s,delete o[l],!0}})}function B4(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:i,isScriptable:Ap(t)?t:()=>t,isIndexable:Ap(i)?i:()=>i}}const k7=(n,e)=>n?n+EP(e):e,RP=(n,e)=>ur(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function N4(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const i=t();return n[e]=i,i}function D7(n,e,t){const{_proxy:i,_context:r,_subProxy:o,_descriptors:l}=n;let s=i[e];return Ap(s)&&l.isScriptable(e)&&(s=R7(e,s,n,t)),zr(s)&&s.length&&(s=z7(e,s,n,l.isIndexable)),RP(e,s)&&(s=Ey(s,r,o&&o[e],l)),s}function R7(n,e,t,i){const{_proxy:r,_context:o,_subProxy:l,_stack:s}=t;if(s.has(n))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+n);return s.add(n),e=e(o,l||i),s.delete(n),RP(n,e)&&(e=zP(r._scopes,r,n,e)),e}function z7(n,e,t,i){const{_proxy:r,_context:o,_subProxy:l,_descriptors:s}=t;if(Lc(o.index)&&i(n))e=e[o.index%e.length];else if(ur(e[0])){const d=e,p=r._scopes.filter(_=>_!==d);e=[];for(const _ of d){const w=zP(p,r,n,_);e.push(Ey(w,o,l&&l[n],s))}}return e}function U4(n,e,t){return Ap(n)?n(e,t):n}const O7=(n,e)=>n===!0?e:typeof n=="string"?Ep(e,n):void 0;function F7(n,e,t,i,r){for(const o of e){const l=O7(t,o);if(l){n.add(l);const s=U4(l._fallback,t,r);if(Lc(s)&&s!==t&&s!==i)return s}else if(l===!1&&Lc(i)&&t!==i)return null}return!1}function zP(n,e,t,i){const r=e._rootScopes,o=U4(e._fallback,t,i),l=[...n,...r],s=new Set;s.add(i);let d=FR(s,l,t,o||t,i);return d===null||Lc(o)&&o!==t&&(d=FR(s,l,o,d,i),d===null)?!1:DP(Array.from(s),[""],r,o,()=>B7(e,t,i))}function FR(n,e,t,i,r){for(;t;)t=F7(n,e,t,i,r);return t}function B7(n,e,t){const i=n._getTarget();e in i||(i[e]={});const r=i[e];return zr(r)&&ur(t)?t:r}function N7(n,e,t,i){let r;for(const o of e)if(r=V4(k7(o,n),t),Lc(r))return RP(n,r)?zP(t,i,n,r):r}function V4(n,e){for(const t of e){if(!t)continue;const i=t[n];if(Lc(i))return i}}function BR(n){let e=n._keys;return e||(e=n._keys=U7(n._scopes)),e}function U7(n){const e=new Set;for(const t of n)for(const i of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function G4(n,e,t,i){const{iScale:r}=n,{key:o="r"}=this._parsing,l=new Array(i);let s,d,p,_;for(s=0,d=i;s<d;++s)p=s+t,_=e[p],l[s]={r:r.parse(Ep(_,o),p)};return l}const V7=Number.EPSILON||1e-14,Ay=(n,e)=>e<n.length&&!n[e].skip&&n[e],W4=n=>n==="x"?"y":"x";function G7(n,e,t,i){const r=n.skip?e:n,o=e,l=t.skip?e:t,s=iC(o,r),d=iC(l,o);let p=s/(s+d),_=d/(s+d);p=isNaN(p)?0:p,_=isNaN(_)?0:_;const w=i*p,M=i*_;return{previous:{x:o.x-w*(l.x-r.x),y:o.y-w*(l.y-r.y)},next:{x:o.x+M*(l.x-r.x),y:o.y+M*(l.y-r.y)}}}function W7(n,e,t){const i=n.length;let r,o,l,s,d,p=Ay(n,0);for(let _=0;_<i-1;++_)if(d=p,p=Ay(n,_+1),!(!d||!p)){if(Jx(e[_],0,V7)){t[_]=t[_+1]=0;continue}r=t[_]/e[_],o=t[_+1]/e[_],s=Math.pow(r,2)+Math.pow(o,2),!(s<=9)&&(l=3/Math.sqrt(s),t[_]=r*l*e[_],t[_+1]=o*l*e[_])}}function H7(n,e,t="x"){const i=W4(t),r=n.length;let o,l,s,d=Ay(n,0);for(let p=0;p<r;++p){if(l=s,s=d,d=Ay(n,p+1),!s)continue;const _=s[t],w=s[i];l&&(o=(_-l[t])/3,s[`cp1${t}`]=_-o,s[`cp1${i}`]=w-o*e[p]),d&&(o=(d[t]-_)/3,s[`cp2${t}`]=_+o,s[`cp2${i}`]=w+o*e[p])}}function j7(n,e="x"){const t=W4(e),i=n.length,r=Array(i).fill(0),o=Array(i);let l,s,d,p=Ay(n,0);for(l=0;l<i;++l)if(s=d,d=p,p=Ay(n,l+1),!!d){if(p){const _=p[e]-d[e];r[l]=_!==0?(p[t]-d[t])/_:0}o[l]=s?p?Th(r[l-1])!==Th(r[l])?0:(r[l-1]+r[l])/2:r[l-1]:r[l]}W7(n,r,o),H7(n,o,e)}function Yw(n,e,t){return Math.max(Math.min(n,t),e)}function q7(n,e){let t,i,r,o,l,s=Lv(n[0],e);for(t=0,i=n.length;t<i;++t)l=o,o=s,s=t<i-1&&Lv(n[t+1],e),o&&(r=n[t],l&&(r.cp1x=Yw(r.cp1x,e.left,e.right),r.cp1y=Yw(r.cp1y,e.top,e.bottom)),s&&(r.cp2x=Yw(r.cp2x,e.left,e.right),r.cp2y=Yw(r.cp2y,e.top,e.bottom)))}function Z7(n,e,t,i,r){let o,l,s,d;if(e.spanGaps&&(n=n.filter(p=>!p.skip)),e.cubicInterpolationMode==="monotone")j7(n,r);else{let p=i?n[n.length-1]:n[0];for(o=0,l=n.length;o<l;++o)s=n[o],d=G7(p,s,n[Math.min(o+1,l-(i?0:1))%l],e.tension),s.cp1x=d.previous.x,s.cp1y=d.previous.y,s.cp2x=d.next.x,s.cp2y=d.next.y,p=s}e.capBezierPoints&&q7(n,t)}function H4(){return typeof window<"u"&&typeof document<"u"}function OP(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function QS(n,e,t){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*e.parentNode[t])):i=n,i}const UM=n=>window.getComputedStyle(n,null);function X7(n,e){return UM(n).getPropertyValue(e)}const $7=["top","right","bottom","left"];function rg(n,e,t){const i={};t=t?"-"+t:"";for(let r=0;r<4;r++){const o=$7[r];i[o]=parseFloat(n[e+"-"+o+t])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Y7=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function K7(n,e){const t=n.touches,i=t&&t.length?t[0]:n,{offsetX:r,offsetY:o}=i;let l=!1,s,d;if(Y7(r,o,n.target))s=r,d=o;else{const p=e.getBoundingClientRect();s=i.clientX-p.left,d=i.clientY-p.top,l=!0}return{x:s,y:d,box:l}}function Xf(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:i}=e,r=UM(t),o=r.boxSizing==="border-box",l=rg(r,"padding"),s=rg(r,"border","width"),{x:d,y:p,box:_}=K7(n,t),w=l.left+(_&&s.left),M=l.top+(_&&s.top);let{width:A,height:P}=e;return o&&(A-=l.width+s.width,P-=l.height+s.height),{x:Math.round((d-w)/A*t.width/i),y:Math.round((p-M)/P*t.height/i)}}function J7(n,e,t){let i,r;if(e===void 0||t===void 0){const o=OP(n);if(!o)e=n.clientWidth,t=n.clientHeight;else{const l=o.getBoundingClientRect(),s=UM(o),d=rg(s,"border","width"),p=rg(s,"padding");e=l.width-p.width-d.width,t=l.height-p.height-d.height,i=QS(s.maxWidth,o,"clientWidth"),r=QS(s.maxHeight,o,"clientHeight")}}return{width:e,height:t,maxWidth:i||YS,maxHeight:r||YS}}const jE=n=>Math.round(n*10)/10;function Q7(n,e,t,i){const r=UM(n),o=rg(r,"margin"),l=QS(r.maxWidth,n,"clientWidth")||YS,s=QS(r.maxHeight,n,"clientHeight")||YS,d=J7(n,e,t);let{width:p,height:_}=d;if(r.boxSizing==="content-box"){const w=rg(r,"border","width"),M=rg(r,"padding");p-=M.width+w.width,_-=M.height+w.height}return p=Math.max(0,p-o.width),_=Math.max(0,i?Math.floor(p/i):_-o.height),p=jE(Math.min(p,l,d.maxWidth)),_=jE(Math.min(_,s,d.maxHeight)),p&&!_&&(_=jE(p/2)),{width:p,height:_}}function NR(n,e,t){const i=e||1,r=Math.floor(n.height*i),o=Math.floor(n.width*i);n.height=r/i,n.width=o/i;const l=n.canvas;return l.style&&(t||!l.style.height&&!l.style.width)&&(l.style.height=`${n.height}px`,l.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||l.height!==r||l.width!==o?(n.currentDevicePixelRatio=i,l.height=r,l.width=o,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const eq=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n}();function UR(n,e){const t=X7(n,e),i=t&&t.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Fm(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function tq(n,e,t,i){return{x:n.x+t*(e.x-n.x),y:i==="middle"?t<.5?n.y:e.y:i==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function nq(n,e,t,i){const r={x:n.cp2x,y:n.cp2y},o={x:e.cp1x,y:e.cp1y},l=Fm(n,r,t),s=Fm(r,o,t),d=Fm(o,e,t),p=Fm(l,s,t),_=Fm(s,d,t);return Fm(p,_,t)}const VR=new Map;function iq(n,e){e=e||{};const t=n+JSON.stringify(e);let i=VR.get(t);return i||(i=new Intl.NumberFormat(n,e),VR.set(t,i)),i}function l1(n,e,t){return iq(e,t).format(n)}const rq=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,i){return t-i},leftForLtr(t,i){return t-i}}},sq=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function cy(n,e,t){return n?rq(e,t):sq()}function j4(n,e){let t,i;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,i=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=i)}function q4(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function Z4(n){return n==="angle"?{between:Pv,compare:H9,normalize:vu}:{between:ip,compare:(e,t)=>e-t,normalize:e=>e}}function GR({start:n,end:e,count:t,loop:i,style:r}){return{start:n%t,end:e%t,loop:i&&(e-n+1)%t===0,style:r}}function oq(n,e,t){const{property:i,start:r,end:o}=t,{between:l,normalize:s}=Z4(i),d=e.length;let{start:p,end:_,loop:w}=n,M,A;if(w){for(p+=d,_+=d,M=0,A=d;M<A&&l(s(e[p%d][i]),r,o);++M)p--,_--;p%=d,_%=d}return _<p&&(_+=d),{start:p,end:_,loop:w,style:n.style}}function aq(n,e,t){if(!t)return[n];const{property:i,start:r,end:o}=t,l=e.length,{compare:s,between:d,normalize:p}=Z4(i),{start:_,end:w,loop:M,style:A}=oq(n,e,t),P=[];let L=!1,D=null,z,F,N;const V=()=>d(r,N,z)&&s(r,N)!==0,j=()=>s(o,z)===0||d(o,N,z),Q=()=>L||V(),re=()=>!L||j();for(let Z=_,ne=_;Z<=w;++Z)F=e[Z%l],!F.skip&&(z=p(F[i]),z!==N&&(L=d(z,r,o),D===null&&Q()&&(D=s(z,r)===0?Z:ne),D!==null&&re()&&(P.push(GR({start:D,end:Z,loop:M,count:l,style:A})),D=null),ne=Z,N=z));return D!==null&&P.push(GR({start:D,end:w,loop:M,count:l,style:A})),P}function lq(n,e){const t=[],i=n.segments;for(let r=0;r<i.length;r++){const o=aq(i[r],n.points,e);o.length&&t.push(...o)}return t}function cq(n,e,t,i){let r=0,o=e-1;if(t&&!i)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(o+=r);o>r&&n[o%e].skip;)o--;return o%=e,{start:r,end:o}}function uq(n,e,t,i){const r=n.length,o=[];let l=e,s=n[e],d;for(d=e+1;d<=t;++d){const p=n[d%r];p.skip||p.stop?s.skip||(i=!1,o.push({start:e%r,end:(d-1)%r,loop:i}),e=l=p.stop?d:null):(l=d,s.skip&&(e=d)),s=p}return l!==null&&o.push({start:e%r,end:l%r,loop:i}),o}function hq(n,e){const t=n.points,i=n.options.spanGaps,r=t.length;if(!r)return[];const o=!!n._loop,{start:l,end:s}=cq(t,r,o,i);if(i===!0)return WR(n,[{start:l,end:s,loop:o}],t,e);const d=s<l?s+r:s,p=!!n._fullLoop&&l===0&&s===r-1;return WR(n,uq(t,l,d,p),t,e)}function WR(n,e,t,i){return!i||!i.setContext||!t?e:dq(n,e,t,i)}function dq(n,e,t,i){const r=n._chart.getContext(),o=HR(n.options),{_datasetIndex:l,options:{spanGaps:s}}=n,d=t.length,p=[];let _=o,w=e[0].start,M=w;function A(P,L,D,z){const F=s?-1:1;if(P!==L){for(P+=d;t[P%d].skip;)P-=F;for(;t[L%d].skip;)L+=F;P%d!==L%d&&(p.push({start:P%d,end:L%d,loop:D,style:z}),_=z,w=L%d)}}for(const P of e){w=s?w:P.start;let L=t[w%d],D;for(M=w+1;M<=P.end;M++){const z=t[M%d];D=HR(i.setContext(Bp(r,{type:"segment",p0:L,p1:z,p0DataIndex:(M-1)%d,p1DataIndex:M%d,datasetIndex:l}))),fq(D,_)&&A(w,M-1,P.loop,_),L=z,_=D}w<M-1&&A(w,M-1,P.loop,_)}return p}function HR(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function fq(n,e){return e&&JSON.stringify(n)!==JSON.stringify(e)}/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class pq{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,i,r){const o=t.listeners[r],l=t.duration;o.forEach(s=>s({chart:e,initial:t.initial,numSteps:l,currentStep:Math.min(i-t.start,l)}))}_refresh(){this._request||(this._running=!0,this._request=KS.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const o=i.items;let l=o.length-1,s=!1,d;for(;l>=0;--l)d=o[l],d._active?(d._total>i.duration&&(i.duration=d._total),d.tick(e),s=!0):(o[l]=o[o.length-1],o.pop());s&&(r.draw(),this._notify(r,i,e,"progress")),o.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),t+=o.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let i=t.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,i)),i}listen(e,t,i){this._getAnims(e).listeners[t].push(i)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const i=t.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Md=new pq;const jR="transparent",mq={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const i=zR(n||jR),r=i.valid&&zR(e||jR);return r&&r.valid?r.mix(i,t).hexString():e},number(n,e,t){return n+(e-n)*t}};let gq=class{constructor(e,t,i,r){const o=t[i];r=$w([e.to,r,o,e.from]);const l=$w([e.from,o,r]);this._active=!0,this._fn=e.fn||mq[e.type||typeof l],this._easing=Qx[e.easing]||Qx.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=i,this._from=l,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,i){if(this._active){this._notify(!1);const r=this._target[this._prop],o=i-this._start,l=this._duration-o;this._start=i,this._duration=Math.floor(Math.max(l,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=$w([e.to,t,r,e.from]),this._from=$w([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,i=this._duration,r=this._prop,o=this._from,l=this._loop,s=this._to;let d;if(this._active=o!==s&&(l||t<i),!this._active){this._target[r]=s,this._notify(!0);return}if(t<0){this._target[r]=o;return}d=t/i%2,d=l&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[r]=this._fn(o,s,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,i)=>{e.push({res:t,rej:i})})}_notify(e){const t=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][t]()}};const _q=["x","y","borderWidth","radius","tension"],yq=["color","borderColor","backgroundColor"];Fi.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const xq=Object.keys(Fi.animation);Fi.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:n=>n!=="onProgress"&&n!=="onComplete"&&n!=="fn"});Fi.set("animations",{colors:{type:"color",properties:yq},numbers:{type:"number",properties:_q}});Fi.describe("animations",{_fallback:"animation"});Fi.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:n=>n|0}}}});class X4{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!ur(e))return;const t=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const r=e[i];if(!ur(r))return;const o={};for(const l of xq)o[l]=r[l];(zr(r.properties)&&r.properties||[i]).forEach(l=>{(l===i||!t.has(l))&&t.set(l,o)})})}_animateOptions(e,t){const i=t.options,r=wq(e,i);if(!r)return[];const o=this._createAnimations(r,i);return i.$shared&&vq(e.options.$animations,i).then(()=>{e.options=i},()=>{}),o}_createAnimations(e,t){const i=this._properties,r=[],o=e.$animations||(e.$animations={}),l=Object.keys(t),s=Date.now();let d;for(d=l.length-1;d>=0;--d){const p=l[d];if(p.charAt(0)==="$")continue;if(p==="options"){r.push(...this._animateOptions(e,t));continue}const _=t[p];let w=o[p];const M=i.get(p);if(w)if(M&&w.active()){w.update(M,_,s);continue}else w.cancel();if(!M||!M.duration){e[p]=_;continue}o[p]=w=new gq(M,e,p,_),r.push(w)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const i=this._createAnimations(e,t);if(i.length)return Md.add(this._chart,i),!0}}function vq(n,e){const t=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const o=n[i[r]];o&&o.active()&&t.push(o.wait())}return Promise.all(t)}function wq(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function qR(n,e){const t=n&&n.options||{},i=t.reverse,r=t.min===void 0?e:0,o=t.max===void 0?e:0;return{start:i?o:r,end:i?r:o}}function bq(n,e,t){if(t===!1)return!1;const i=qR(n,t),r=qR(e,t);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function Sq(n){let e,t,i,r;return ur(n)?(e=n.top,t=n.right,i=n.bottom,r=n.left):e=t=i=r=n,{top:e,right:t,bottom:i,left:r,disabled:n===!1}}function $4(n,e){const t=[],i=n._getSortedDatasetMetas(e);let r,o;for(r=0,o=i.length;r<o;++r)t.push(i[r].index);return t}function ZR(n,e,t,i={}){const r=n.keys,o=i.mode==="single";let l,s,d,p;if(e!==null){for(l=0,s=r.length;l<s;++l){if(d=+r[l],d===t){if(i.all)continue;break}p=n.values[d],ao(p)&&(o||e===0||Th(e)===Th(p))&&(e+=p)}return e}}function Mq(n){const e=Object.keys(n),t=new Array(e.length);let i,r,o;for(i=0,r=e.length;i<r;++i)o=e[i],t[i]={x:o,y:n[o]};return t}function XR(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Tq(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Eq(n){const{min:e,max:t,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function Aq(n,e,t){const i=n[e]||(n[e]={});return i[t]||(i[t]={})}function $R(n,e,t,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const o=n[r.index];if(t&&o>0||!t&&o<0)return r.index}return null}function YR(n,e){const{chart:t,_cachedMeta:i}=n,r=t._stacks||(t._stacks={}),{iScale:o,vScale:l,index:s}=i,d=o.axis,p=l.axis,_=Tq(o,l,i),w=e.length;let M;for(let A=0;A<w;++A){const P=e[A],{[d]:L,[p]:D}=P,z=P._stacks||(P._stacks={});M=z[p]=Aq(r,_,L),M[s]=D,M._top=$R(M,l,!0,i.type),M._bottom=$R(M,l,!1,i.type)}}function qE(n,e){const t=n.scales;return Object.keys(t).filter(i=>t[i].axis===e).shift()}function Cq(n,e){return Bp(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Iq(n,e,t){return Bp(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function sx(n,e){const t=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){e=e||n._parsed;for(const r of e){const o=r._stacks;if(!o||o[i]===void 0||o[i][t]===void 0)return;delete o[i][t]}}}const ZE=n=>n==="reset"||n==="none",KR=(n,e)=>e?n:Object.assign({},n),Pq=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:$4(t,!0),values:null};class Dc{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=XR(e.vScale,e),this.addElements()}updateIndex(e){this.index!==e&&sx(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,i=this.getDataset(),r=(w,M,A,P)=>w==="x"?M:w==="r"?P:A,o=t.xAxisID=Mi(i.xAxisID,qE(e,"x")),l=t.yAxisID=Mi(i.yAxisID,qE(e,"y")),s=t.rAxisID=Mi(i.rAxisID,qE(e,"r")),d=t.indexAxis,p=t.iAxisID=r(d,o,l,s),_=t.vAxisID=r(d,l,o,s);t.xScale=this.getScaleForId(o),t.yScale=this.getScaleForId(l),t.rScale=this.getScaleForId(s),t.iScale=this.getScaleForId(p),t.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&CR(this._data,this),e._stacked&&sx(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),i=this._data;if(ur(t))this._data=Mq(t);else if(i!==t){if(i){CR(i,this);const r=this._cachedMeta;sx(r),r._parsed=[]}t&&Object.isExtensible(t)&&X9(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const o=t._stacked;t._stacked=XR(t.vScale,t),t.stack!==i.stack&&(r=!0,sx(t),t.stack=i.stack),this._resyncElements(e),(r||o!==t._stacked)&&YR(this,t._parsed)}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:i,_data:r}=this,{iScale:o,_stacked:l}=i,s=o.axis;let d=e===0&&t===r.length?!0:i._sorted,p=e>0&&i._parsed[e-1],_,w,M;if(this._parsing===!1)i._parsed=r,i._sorted=!0,M=r;else{zr(r[e])?M=this.parseArrayData(i,r,e,t):ur(r[e])?M=this.parseObjectData(i,r,e,t):M=this.parsePrimitiveData(i,r,e,t);const A=()=>w[s]===null||p&&w[s]<p[s];for(_=0;_<t;++_)i._parsed[_+e]=w=M[_],d&&(A()&&(d=!1),p=w);i._sorted=d}l&&YR(this,M)}parsePrimitiveData(e,t,i,r){const{iScale:o,vScale:l}=e,s=o.axis,d=l.axis,p=o.getLabels(),_=o===l,w=new Array(r);let M,A,P;for(M=0,A=r;M<A;++M)P=M+i,w[M]={[s]:_||o.parse(p[P],P),[d]:l.parse(t[P],P)};return w}parseArrayData(e,t,i,r){const{xScale:o,yScale:l}=e,s=new Array(r);let d,p,_,w;for(d=0,p=r;d<p;++d)_=d+i,w=t[_],s[d]={x:o.parse(w[0],_),y:l.parse(w[1],_)};return s}parseObjectData(e,t,i,r){const{xScale:o,yScale:l}=e,{xAxisKey:s="x",yAxisKey:d="y"}=this._parsing,p=new Array(r);let _,w,M,A;for(_=0,w=r;_<w;++_)M=_+i,A=t[M],p[_]={x:o.parse(Ep(A,s),M),y:l.parse(Ep(A,d),M)};return p}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,i){const r=this.chart,o=this._cachedMeta,l=t[e.axis],s={keys:$4(r,!0),values:t._stacks[e.axis]};return ZR(s,l,o.index,{mode:i})}updateRangeFromParsed(e,t,i,r){const o=i[t.axis];let l=o===null?NaN:o;const s=r&&i._stacks[t.axis];r&&s&&(r.values=s,l=ZR(r,o,this._cachedMeta.index)),e.min=Math.min(e.min,l),e.max=Math.max(e.max,l)}getMinMax(e,t){const i=this._cachedMeta,r=i._parsed,o=i._sorted&&e===i.iScale,l=r.length,s=this._getOtherScale(e),d=Pq(t,i,this.chart),p={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:w}=Eq(s);let M,A;function P(){A=r[M];const L=A[s.axis];return!ao(A[e.axis])||_>L||w<L}for(M=0;M<l&&!(!P()&&(this.updateRangeFromParsed(p,e,A,d),o));++M);if(o){for(M=l-1;M>=0;--M)if(!P()){this.updateRangeFromParsed(p,e,A,d);break}}return p}getAllParsedValues(e){const t=this._cachedMeta._parsed,i=[];let r,o,l;for(r=0,o=t.length;r<o;++r)l=t[r][e.axis],ao(l)&&i.push(l);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,i=t.iScale,r=t.vScale,o=this.getParsed(e);return{label:i?""+i.getLabelForValue(o[i.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Sq(Mi(this.options.clip,bq(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,i=this._cachedMeta,r=i.data||[],o=t.chartArea,l=[],s=this._drawStart||0,d=this._drawCount||r.length-s,p=this.options.drawActiveElementsOnTop;let _;for(i.dataset&&i.dataset.draw(e,o,s,d),_=s;_<s+d;++_){const w=r[_];w.hidden||(w.active&&p?l.push(w):w.draw(e,o))}for(_=0;_<l.length;++_)l[_].draw(e,o)}getStyle(e,t){const i=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,t,i){const r=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const l=this._cachedMeta.data[e];o=l.$context||(l.$context=Iq(this.getContext(),e,l)),o.parsed=this.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=Cq(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!t,o.mode=i,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",i){const r=t==="active",o=this._cachedDataOpts,l=e+"-"+t,s=o[l],d=this.enableOptionSharing&&Lc(i);if(s)return KR(s,d);const p=this.chart.config,_=p.datasetElementScopeKeys(this._type,e),w=r?[`${e}Hover`,"hover",e,""]:[e,""],M=p.getOptionScopes(this.getDataset(),_),A=Object.keys(Fi.elements[e]),P=()=>this.getContext(i,r),L=p.resolveNamedOptions(M,A,P,w);return L.$shared&&(L.$shared=d,o[l]=Object.freeze(KR(L,d))),L}_resolveAnimations(e,t,i){const r=this.chart,o=this._cachedDataOpts,l=`animation-${t}`,s=o[l];if(s)return s;let d;if(r.options.animation!==!1){const _=this.chart.config,w=_.datasetAnimationScopeKeys(this._type,t),M=_.getOptionScopes(this.getDataset(),w);d=_.createResolver(M,this.getContext(e,i,t))}const p=new X4(r,d&&d.animations);return d&&d._cacheable&&(o[l]=Object.freeze(p)),p}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||ZE(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const i=this.resolveDataElementOptions(e,t),r=this._sharedOptions,o=this.getSharedOptions(i),l=this.includeOptions(t,o)||o!==r;return this.updateSharedOptions(o,t,i),{sharedOptions:o,includeOptions:l}}updateElement(e,t,i,r){ZE(r)?Object.assign(e,i):this._resolveAnimations(t,r).update(e,i)}updateSharedOptions(e,t,i){e&&!ZE(t)&&this._resolveAnimations(void 0,t).update(e,i)}_setStyle(e,t,i,r){e.active=r;const o=this.getStyle(t,r);this._resolveAnimations(t,i,r).update(e,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(e,t,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,t,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,i=this._cachedMeta.data;for(const[s,d,p]of this._syncList)this[s](d,p);this._syncList=[];const r=i.length,o=t.length,l=Math.min(o,r);l&&this.parse(0,l),o>r?this._insertElements(r,o-r,e):o<r&&this._removeElements(o,r-o)}_insertElements(e,t,i=!0){const r=this._cachedMeta,o=r.data,l=e+t;let s;const d=p=>{for(p.length+=t,s=p.length-1;s>=l;s--)p[s]=p[s-t]};for(d(o),s=e;s<l;++s)o[s]=new this.dataElementType;this._parsing&&d(r._parsed),this.parse(e,t),i&&this.updateElements(o,e,t,"reset")}updateElements(e,t,i,r){}_removeElements(e,t){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,t);i._stacked&&sx(i,r)}i.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,i,r]=e;this[t](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Dc.defaults={};Dc.prototype.datasetElementType=null;Dc.prototype.dataElementType=null;function Lq(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let i=[];for(let r=0,o=t.length;r<o;r++)i=i.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=A4(i.sort((r,o)=>r-o))}return n._cache.$bar}function kq(n){const e=n.iScale,t=Lq(e,n.type);let i=e._length,r,o,l,s;const d=()=>{l===32767||l===-32768||(Lc(s)&&(i=Math.min(i,Math.abs(l-s)||i)),s=l)};for(r=0,o=t.length;r<o;++r)l=e.getPixelForValue(t[r]),d();for(s=void 0,r=0,o=e.ticks.length;r<o;++r)l=e.getPixelForTick(r),d();return i}function Dq(n,e,t,i){const r=t.barThickness;let o,l;return xr(r)?(o=e.min*t.categoryPercentage,l=t.barPercentage):(o=r*i,l=1),{chunk:o/i,ratio:l,start:e.pixels[n]-o/2}}function Rq(n,e,t,i){const r=e.pixels,o=r[n];let l=n>0?r[n-1]:null,s=n<r.length-1?r[n+1]:null;const d=t.categoryPercentage;l===null&&(l=o-(s===null?e.end-e.start:s-o)),s===null&&(s=o+o-l);const p=o-(o-Math.min(l,s))/2*d;return{chunk:Math.abs(s-l)/2*d/i,ratio:t.barPercentage,start:p}}function zq(n,e,t,i){const r=t.parse(n[0],i),o=t.parse(n[1],i),l=Math.min(r,o),s=Math.max(r,o);let d=l,p=s;Math.abs(l)>Math.abs(s)&&(d=s,p=l),e[t.axis]=p,e._custom={barStart:d,barEnd:p,start:r,end:o,min:l,max:s}}function Y4(n,e,t,i){return zr(n)?zq(n,e,t,i):e[t.axis]=t.parse(n,i),e}function JR(n,e,t,i){const r=n.iScale,o=n.vScale,l=r.getLabels(),s=r===o,d=[];let p,_,w,M;for(p=t,_=t+i;p<_;++p)M=e[p],w={},w[r.axis]=s||r.parse(l[p],p),d.push(Y4(M,w,o,p));return d}function XE(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Oq(n,e,t){return n!==0?Th(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Fq(n){let e,t,i,r,o;return n.horizontal?(e=n.base>n.x,t="left",i="right"):(e=n.base<n.y,t="bottom",i="top"),e?(r="end",o="start"):(r="start",o="end"),{start:t,end:i,reverse:e,top:r,bottom:o}}function Bq(n,e,t,i){let r=e.borderSkipped;const o={};if(!r){n.borderSkipped=o;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:l,end:s,reverse:d,top:p,bottom:_}=Fq(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===i?r=p:(t._bottom||0)===i?r=_:(o[QR(_,l,s,d)]=!0,r=p)),o[QR(r,l,s,d)]=!0,n.borderSkipped=o}function QR(n,e,t,i){return i?(n=Nq(n,e,t),n=ez(n,t,e)):n=ez(n,e,t),n}function Nq(n,e,t){return n===e?t:n===t?e:n}function ez(n,e,t){return n==="start"?e:n==="end"?t:n}function Uq(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class FP extends Dc{parsePrimitiveData(e,t,i,r){return JR(e,t,i,r)}parseArrayData(e,t,i,r){return JR(e,t,i,r)}parseObjectData(e,t,i,r){const{iScale:o,vScale:l}=e,{xAxisKey:s="x",yAxisKey:d="y"}=this._parsing,p=o.axis==="x"?s:d,_=l.axis==="x"?s:d,w=[];let M,A,P,L;for(M=i,A=i+r;M<A;++M)L=t[M],P={},P[o.axis]=o.parse(Ep(L,p),M),w.push(Y4(Ep(L,_),P,l,M));return w}updateRangeFromParsed(e,t,i,r){super.updateRangeFromParsed(e,t,i,r);const o=i._custom;o&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:i,vScale:r}=t,o=this.getParsed(e),l=o._custom,s=XE(l)?"["+l.start+", "+l.end+"]":""+r.getLabelForValue(o[r.axis]);return{label:""+i.getLabelForValue(o[i.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,i,r){const o=r==="reset",{index:l,_cachedMeta:{vScale:s}}=this,d=s.getBasePixel(),p=s.isHorizontal(),_=this._getRuler(),{sharedOptions:w,includeOptions:M}=this._getSharedOptions(t,r);for(let A=t;A<t+i;A++){const P=this.getParsed(A),L=o||xr(P[s.axis])?{base:d,head:d}:this._calculateBarValuePixels(A),D=this._calculateBarIndexPixels(A,_),z=(P._stacks||{})[s.axis],F={horizontal:p,base:L.base,enableBorderRadius:!z||XE(P._custom)||l===z._top||l===z._bottom,x:p?L.head:D.center,y:p?D.center:L.head,height:p?D.size:Math.abs(L.size),width:p?Math.abs(L.size):D.size};M&&(F.options=w||this.resolveDataElementOptions(A,e[A].active?"active":r));const N=F.options||e[A].options;Bq(F,N,z,l),Uq(F,N,_.ratio),this.updateElement(e[A],A,F,r)}}_getStacks(e,t){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),o=i.options.stacked,l=[],s=d=>{const p=d.controller.getParsed(t),_=p&&p[d.vScale.axis];if(xr(_)||isNaN(_))return!0};for(const d of r)if(!(t!==void 0&&s(d))&&((o===!1||l.indexOf(d.stack)===-1||o===void 0&&d.stack===void 0)&&l.push(d.stack),d.index===e))break;return l.length||l.push(void 0),l}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,i){const r=this._getStacks(e,i),o=t!==void 0?r.indexOf(t):-1;return o===-1?r.length-1:o}_getRuler(){const e=this.options,t=this._cachedMeta,i=t.iScale,r=[];let o,l;for(o=0,l=t.data.length;o<l;++o)r.push(i.getPixelForValue(this.getParsed(o)[i.axis],o));const s=e.barThickness;return{min:s||kq(t),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:i},options:{base:r,minBarLength:o}}=this,l=r||0,s=this.getParsed(e),d=s._custom,p=XE(d);let _=s[t.axis],w=0,M=i?this.applyStack(t,s,i):_,A,P;M!==_&&(w=M-_,M=_),p&&(_=d.barStart,M=d.barEnd-d.barStart,_!==0&&Th(_)!==Th(d.barEnd)&&(w=0),w+=_);const L=!xr(r)&&!p?r:w;let D=t.getPixelForValue(L);if(this.chart.getDataVisibility(e)?A=t.getPixelForValue(w+M):A=D,P=A-D,Math.abs(P)<o){P=Oq(P,t,l)*o,_===l&&(D-=P/2);const z=t.getPixelForDecimal(0),F=t.getPixelForDecimal(1),N=Math.min(z,F),V=Math.max(z,F);D=Math.max(Math.min(D,V),N),A=D+P}if(D===t.getPixelForValue(l)){const z=Th(P)*t.getLineWidthForValue(l)/2;D+=z,P-=z}return{size:P,base:D,head:A,center:A+P/2}}_calculateBarIndexPixels(e,t){const i=t.scale,r=this.options,o=r.skipNull,l=Mi(r.maxBarThickness,1/0);let s,d;if(t.grouped){const p=o?this._getStackCount(e):t.stackCount,_=r.barThickness==="flex"?Rq(e,t,r,p):Dq(e,t,r,p),w=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0);s=_.start+_.chunk*w+_.chunk/2,d=Math.min(l,_.chunk*_.ratio)}else s=i.getPixelForValue(this.getParsed(e)[i.axis],e),d=Math.min(l,t.min*t.ratio);return{base:s-d/2,head:s+d/2,center:s,size:d}}draw(){const e=this._cachedMeta,t=e.vScale,i=e.data,r=i.length;let o=0;for(;o<r;++o)this.getParsed(o)[t.axis]!==null&&i[o].draw(this._ctx)}}FP.id="bar";FP.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};FP.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class BP extends Dc{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,i,r){const o=super.parsePrimitiveData(e,t,i,r);for(let l=0;l<o.length;l++)o[l]._custom=this.resolveDataElementOptions(l+i).radius;return o}parseArrayData(e,t,i,r){const o=super.parseArrayData(e,t,i,r);for(let l=0;l<o.length;l++){const s=t[i+l];o[l]._custom=Mi(s[2],this.resolveDataElementOptions(l+i).radius)}return o}parseObjectData(e,t,i,r){const o=super.parseObjectData(e,t,i,r);for(let l=0;l<o.length;l++){const s=t[i+l];o[l]._custom=Mi(s&&s.r&&+s.r,this.resolveDataElementOptions(l+i).radius)}return o}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,{xScale:i,yScale:r}=t,o=this.getParsed(e),l=i.getLabelForValue(o.x),s=r.getLabelForValue(o.y),d=o._custom;return{label:t.label,value:"("+l+", "+s+(d?", "+d:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,i,r){const o=r==="reset",{iScale:l,vScale:s}=this._cachedMeta,{sharedOptions:d,includeOptions:p}=this._getSharedOptions(t,r),_=l.axis,w=s.axis;for(let M=t;M<t+i;M++){const A=e[M],P=!o&&this.getParsed(M),L={},D=L[_]=o?l.getPixelForDecimal(.5):l.getPixelForValue(P[_]),z=L[w]=o?s.getBasePixel():s.getPixelForValue(P[w]);L.skip=isNaN(D)||isNaN(z),p&&(L.options=d||this.resolveDataElementOptions(M,A.active?"active":r),o&&(L.options.radius=0)),this.updateElement(A,M,L,r)}}resolveDataElementOptions(e,t){const i=this.getParsed(e);let r=super.resolveDataElementOptions(e,t);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const o=r.radius;return t!=="active"&&(r.radius=0),r.radius+=Mi(i&&i._custom,o),r}}BP.id="bubble";BP.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};BP.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function Vq(n,e,t){let i=1,r=1,o=0,l=0;if(e<Or){const s=n,d=s+e,p=Math.cos(s),_=Math.sin(s),w=Math.cos(d),M=Math.sin(d),A=(N,V,j)=>Pv(N,s,d,!0)?1:Math.max(V,V*t,j,j*t),P=(N,V,j)=>Pv(N,s,d,!0)?-1:Math.min(V,V*t,j,j*t),L=A(0,p,w),D=A(Ms,_,M),z=P(Qr,p,w),F=P(Qr+Ms,_,M);i=(L-z)/2,r=(D-F)/2,o=-(L+z)/2,l=-(D+F)/2}return{ratioX:i,ratioY:r,offsetX:o,offsetY:l}}class c1 extends Dc{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let o=d=>+i[d];if(ur(i[e])){const{key:d="value"}=this._parsing;o=p=>+Ep(i[p],d)}let l,s;for(l=e,s=e+t;l<s;++l)r._parsed[l]=o(l)}}_getRotation(){return Tu(this.options.rotation-90)}_getCircumference(){return Tu(this.options.circumference)}_getRotationExtents(){let e=Or,t=-Or;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const r=this.chart.getDatasetMeta(i).controller,o=r._getRotation(),l=r._getCircumference();e=Math.min(e,o),t=Math.max(t,o+l)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:i}=t,r=this._cachedMeta,o=r.data,l=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,s=Math.max((Math.min(i.width,i.height)-l)/2,0),d=Math.min(R9(this.options.cutout,s),1),p=this._getRingWeight(this.index),{circumference:_,rotation:w}=this._getRotationExtents(),{ratioX:M,ratioY:A,offsetX:P,offsetY:L}=Vq(w,_,d),D=(i.width-l)/M,z=(i.height-l)/A,F=Math.max(Math.min(D,z)/2,0),N=b4(this.options.radius,F),V=Math.max(N*d,0),j=(N-V)/this._getVisibleDatasetWeightTotal();this.offsetX=P*N,this.offsetY=L*N,r.total=this.calculateTotal(),this.outerRadius=N-j*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-j*p,0),this.updateElements(o,0,o.length,e)}_circumference(e,t){const i=this.options,r=this._cachedMeta,o=this._getCircumference();return t&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*o/Or)}updateElements(e,t,i,r){const o=r==="reset",l=this.chart,s=l.chartArea,p=l.options.animation,_=(s.left+s.right)/2,w=(s.top+s.bottom)/2,M=o&&p.animateScale,A=M?0:this.innerRadius,P=M?0:this.outerRadius,{sharedOptions:L,includeOptions:D}=this._getSharedOptions(t,r);let z=this._getRotation(),F;for(F=0;F<t;++F)z+=this._circumference(F,o);for(F=t;F<t+i;++F){const N=this._circumference(F,o),V=e[F],j={x:_+this.offsetX,y:w+this.offsetY,startAngle:z,endAngle:z+N,circumference:N,outerRadius:P,innerRadius:A};D&&(j.options=L||this.resolveDataElementOptions(F,V.active?"active":r)),z+=N,this.updateElement(V,F,j,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let i=0,r;for(r=0;r<t.length;r++){const o=e._parsed[r];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(i+=Math.abs(o))}return i}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Or*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],o=l1(t._parsed[e],i.options.locale);return{label:r[e]||"",value:o}}getMaxBorderWidth(e){let t=0;const i=this.chart;let r,o,l,s,d;if(!e){for(r=0,o=i.data.datasets.length;r<o;++r)if(i.isDatasetVisible(r)){l=i.getDatasetMeta(r),e=l.data,s=l.controller;break}}if(!e)return 0;for(r=0,o=e.length;r<o;++r)d=s.resolveDataElementOptions(r),d.borderAlign!=="inner"&&(t=Math.max(t,d.borderWidth||0,d.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let i=0,r=e.length;i<r;++i){const o=this.resolveDataElementOptions(i);t=Math.max(t,o.offset||0,o.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(t+=this._getRingWeight(i));return t}_getRingWeight(e){return Math.max(Mi(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}c1.id="doughnut";c1.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};c1.descriptors={_scriptable:n=>n!=="spacing",_indexable:n=>n!=="spacing"};c1.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:t}}=n.legend.options;return e.labels.map((i,r)=>{const l=n.getDatasetMeta(0).controller.getStyle(r);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,lineWidth:l.borderWidth,pointStyle:t,hidden:!n.getDataVisibility(r),index:r}})}return[]}},onClick(n,e,t){t.chart.toggleDataVisibility(e.index),t.chart.update()}},tooltip:{callbacks:{title(){return""},label(n){let e=n.label;const t=": "+n.formattedValue;return zr(e)?(e=e.slice(),e[0]+=t):e+=t,e}}}}};class VM extends Dc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:i,data:r=[],_dataset:o}=t,l=this.chart._animationsDisabled;let{start:s,count:d}=I4(t,r,l);this._drawStart=s,this._drawCount=d,P4(t)&&(s=0,d=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!o._decimated,i.points=r;const p=this.resolveDatasetElementOptions(e);this.options.showLine||(p.borderWidth=0),p.segment=this.options.segment,this.updateElement(i,void 0,{animated:!l,options:p},e),this.updateElements(r,s,d,e)}updateElements(e,t,i,r){const o=r==="reset",{iScale:l,vScale:s,_stacked:d,_dataset:p}=this._cachedMeta,{sharedOptions:_,includeOptions:w}=this._getSharedOptions(t,r),M=l.axis,A=s.axis,{spanGaps:P,segment:L}=this.options,D=xg(P)?P:Number.POSITIVE_INFINITY,z=this.chart._animationsDisabled||o||r==="none";let F=t>0&&this.getParsed(t-1);for(let N=t;N<t+i;++N){const V=e[N],j=this.getParsed(N),Q=z?V:{},re=xr(j[A]),Z=Q[M]=l.getPixelForValue(j[M],N),ne=Q[A]=o||re?s.getBasePixel():s.getPixelForValue(d?this.applyStack(s,j,d):j[A],N);Q.skip=isNaN(Z)||isNaN(ne)||re,Q.stop=N>0&&Math.abs(j[M]-F[M])>D,L&&(Q.parsed=j,Q.raw=p.data[N]),w&&(Q.options=_||this.resolveDataElementOptions(N,V.active?"active":r)),z||this.updateElement(V,N,Q,r),F=j}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,i=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const o=r[0].size(this.resolveDataElementOptions(0)),l=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,o,l)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}VM.id="line";VM.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};VM.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class NP extends Dc{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,i=this.chart,r=i.data.labels||[],o=l1(t._parsed[e].r,i.options.locale);return{label:r[e]||"",value:o}}parseObjectData(e,t,i,r){return G4.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,r)=>{const o=this.getParsed(r).r;!isNaN(o)&&this.chart.getDataVisibility(r)&&(o<t.min&&(t.min=o),o>t.max&&(t.max=o))}),t}_updateRadius(){const e=this.chart,t=e.chartArea,i=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),o=Math.max(r/2,0),l=Math.max(i.cutoutPercentage?o/100*i.cutoutPercentage:1,0),s=(o-l)/e.getVisibleDatasetCount();this.outerRadius=o-s*this.index,this.innerRadius=this.outerRadius-s}updateElements(e,t,i,r){const o=r==="reset",l=this.chart,d=l.options.animation,p=this._cachedMeta.rScale,_=p.xCenter,w=p.yCenter,M=p.getIndexAngle(0)-.5*Qr;let A=M,P;const L=360/this.countVisibleElements();for(P=0;P<t;++P)A+=this._computeAngle(P,r,L);for(P=t;P<t+i;P++){const D=e[P];let z=A,F=A+this._computeAngle(P,r,L),N=l.getDataVisibility(P)?p.getDistanceFromCenterForValue(this.getParsed(P).r):0;A=F,o&&(d.animateScale&&(N=0),d.animateRotate&&(z=F=M));const V={x:_,y:w,innerRadius:0,outerRadius:N,startAngle:z,endAngle:F,options:this.resolveDataElementOptions(P,D.active?"active":r)};this.updateElement(D,P,V,r)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&t++}),t}_computeAngle(e,t,i){return this.chart.getDataVisibility(e)?Tu(this.resolveDataElementOptions(e,t).angle||i):0}}NP.id="polarArea";NP.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};NP.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(n){const e=n.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:t}}=n.legend.options;return e.labels.map((i,r)=>{const l=n.getDatasetMeta(0).controller.getStyle(r);return{text:i,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,lineWidth:l.borderWidth,pointStyle:t,hidden:!n.getDataVisibility(r),index:r}})}return[]}},onClick(n,e,t){t.chart.toggleDataVisibility(e.index),t.chart.update()}},tooltip:{callbacks:{title(){return""},label(n){return n.chart.data.labels[n.dataIndex]+": "+n.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class K4 extends c1{}K4.id="pie";K4.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class UP extends Dc{getLabelAndValue(e){const t=this._cachedMeta.vScale,i=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(i[t.axis])}}parseObjectData(e,t,i,r){return G4.bind(this)(e,t,i,r)}update(e){const t=this._cachedMeta,i=t.dataset,r=t.data||[],o=t.iScale.getLabels();if(i.points=r,e!=="resize"){const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0);const s={_loop:!0,_fullLoop:o.length===r.length,options:l};this.updateElement(i,void 0,s,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,i,r){const o=this._cachedMeta.rScale,l=r==="reset";for(let s=t;s<t+i;s++){const d=e[s],p=this.resolveDataElementOptions(s,d.active?"active":r),_=o.getPointPositionForValue(s,this.getParsed(s).r),w=l?o.xCenter:_.x,M=l?o.yCenter:_.y,A={x:w,y:M,angle:_.angle,skip:isNaN(w)||isNaN(M),options:p};this.updateElement(d,s,A,r)}}}UP.id="radar";UP.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};UP.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class zu{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}hasValue(){return xg(this.x)&&xg(this.y)}getProps(e,t){const i=this.$animations;if(!t||!i)return this;const r={};return e.forEach(o=>{r[o]=i[o]&&i[o].active()?i[o]._to:this[o]}),r}}zu.defaults={};zu.defaultRoutes=void 0;const J4={values(n){return zr(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const i=this.chart.options.locale;let r,o=n;if(t.length>1){const p=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(p<1e-4||p>1e15)&&(r="scientific"),o=Gq(n,t)}const l=vc(Math.abs(o)),s=Math.max(Math.min(-1*Math.floor(l),20),0),d={notation:r,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(d,this.options.ticks.format),l1(n,i,d)},logarithmic(n,e,t){if(n===0)return"0";const i=n/Math.pow(10,Math.floor(vc(n)));return i===1||i===2||i===5?J4.numeric.call(this,n,e,t):""}};function Gq(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var GM={formatters:J4};Fi.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(n,e)=>e.lineWidth,tickColor:(n,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:GM.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});Fi.route("scale.ticks","color","","color");Fi.route("scale.grid","color","","borderColor");Fi.route("scale.grid","borderColor","","borderColor");Fi.route("scale.title","color","","color");Fi.describe("scale",{_fallback:!1,_scriptable:n=>!n.startsWith("before")&&!n.startsWith("after")&&n!=="callback"&&n!=="parser",_indexable:n=>n!=="borderDash"&&n!=="tickBorderDash"});Fi.describe("scales",{_fallback:"scale"});Fi.describe("scale.ticks",{_scriptable:n=>n!=="backdropPadding"&&n!=="callback",_indexable:n=>n!=="backdropPadding"});function Wq(n,e){const t=n.options.ticks,i=t.maxTicksLimit||Hq(n),r=t.major.enabled?qq(e):[],o=r.length,l=r[0],s=r[o-1],d=[];if(o>i)return Zq(e,d,r,o/i),d;const p=jq(r,e,i);if(o>0){let _,w;const M=o>1?Math.round((s-l)/(o-1)):null;for(Kw(e,d,p,xr(M)?0:l-M,l),_=0,w=o-1;_<w;_++)Kw(e,d,p,r[_],r[_+1]);return Kw(e,d,p,s,xr(M)?e.length:s+M),d}return Kw(e,d,p),d}function Hq(n){const e=n.options.offset,t=n._tickSize(),i=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(i,r))}function jq(n,e,t){const i=Xq(n),r=e.length/t;if(!i)return Math.max(r,1);const o=G9(i);for(let l=0,s=o.length-1;l<s;l++){const d=o[l];if(d>r)return d}return Math.max(r,1)}function qq(n){const e=[];let t,i;for(t=0,i=n.length;t<i;t++)n[t].major&&e.push(t);return e}function Zq(n,e,t,i){let r=0,o=t[0],l;for(i=Math.ceil(i),l=0;l<n.length;l++)l===o&&(e.push(n[l]),r++,o=t[r*i])}function Kw(n,e,t,i,r){const o=Mi(i,0),l=Math.min(Mi(r,n.length),n.length);let s=0,d,p,_;for(t=Math.ceil(t),r&&(d=r-i,t=d/Math.floor(d/t)),_=o;_<0;)s++,_=Math.round(o+s*t);for(p=Math.max(o,0);p<l;p++)p===_&&(e.push(n[p]),s++,_=Math.round(o+s*t))}function Xq(n){const e=n.length;let t,i;if(e<2)return!1;for(i=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==i)return!1;return i}const $q=n=>n==="left"?"right":n==="right"?"left":n,tz=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t;function nz(n,e){const t=[],i=n.length/e,r=n.length;let o=0;for(;o<r;o+=i)t.push(n[Math.floor(o)]);return t}function Yq(n,e,t){const i=n.ticks.length,r=Math.min(e,i-1),o=n._startPixel,l=n._endPixel,s=1e-6;let d=n.getPixelForTick(r),p;if(!(t&&(i===1?p=Math.max(d-o,l-d):e===0?p=(n.getPixelForTick(1)-d)/2:p=(d-n.getPixelForTick(r-1))/2,d+=r<e?p:-p,d<o-s||d>l+s)))return d}function Kq(n,e){yi(n,t=>{const i=t.gc,r=i.length/2;let o;if(r>e){for(o=0;o<r;++o)delete t.data[i[o]];i.splice(0,r)}})}function ox(n){return n.drawTicks?n.tickLength:0}function iz(n,e){if(!n.display)return 0;const t=oo(n.font,e),i=ma(n.padding);return(zr(n.text)?n.text.length:1)*t.lineHeight+i.height}function Jq(n,e){return Bp(n,{scale:e,type:"scale"})}function Qq(n,e,t){return Bp(n,{tick:t,index:e,type:"tick"})}function eZ(n,e,t){let i=CP(n);return(t&&e!=="right"||!t&&e==="right")&&(i=$q(i)),i}function tZ(n,e,t,i){const{top:r,left:o,bottom:l,right:s,chart:d}=n,{chartArea:p,scales:_}=d;let w=0,M,A,P;const L=l-r,D=s-o;if(n.isHorizontal()){if(A=aa(i,o,s),ur(t)){const z=Object.keys(t)[0],F=t[z];P=_[z].getPixelForValue(F)+L-e}else t==="center"?P=(p.bottom+p.top)/2+L-e:P=tz(n,t,e);M=s-o}else{if(ur(t)){const z=Object.keys(t)[0],F=t[z];A=_[z].getPixelForValue(F)-D+e}else t==="center"?A=(p.left+p.right)/2-D+e:A=tz(n,t,e);P=aa(i,l,r),w=t==="left"?-Ms:Ms}return{titleX:A,titleY:P,maxWidth:M,rotation:w}}class Ig extends zu{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:i,_suggestedMax:r}=this;return e=dc(e,Number.POSITIVE_INFINITY),t=dc(t,Number.NEGATIVE_INFINITY),i=dc(i,Number.POSITIVE_INFINITY),r=dc(r,Number.NEGATIVE_INFINITY),{min:dc(e,i),max:dc(t,r),minDefined:ao(e),maxDefined:ao(t)}}getMinMax(e){let{min:t,max:i,minDefined:r,maxDefined:o}=this.getUserBounds(),l;if(r&&o)return{min:t,max:i};const s=this.getMatchingVisibleMetas();for(let d=0,p=s.length;d<p;++d)l=s[d].controller.getMinMax(this,e),r||(t=Math.min(t,l.min)),o||(i=Math.max(i,l.max));return t=o&&t>i?i:t,i=r&&t>i?t:i,{min:dc(t,dc(i,t)),max:dc(i,dc(t,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){_r(this.options.beforeUpdate,[this])}update(e,t,i){const{beginAtZero:r,grace:o,ticks:l}=this.options,s=l.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=L7(this,o,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=s<this.ticks.length;this._convertTicksToLabels(d?nz(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),l.display&&(l.autoSkip||l.source==="auto")&&(this.ticks=Wq(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,i;this.isHorizontal()?(t=this.left,i=this.right):(t=this.top,i=this.bottom,e=!e),this._startPixel=t,this._endPixel=i,this._reversePixels=e,this._length=i-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){_r(this.options.afterUpdate,[this])}beforeSetDimensions(){_r(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){_r(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),_r(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){_r(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let i,r,o;for(i=0,r=e.length;i<r;i++)o=e[i],o.label=_r(t.callback,[o.value,i,e],this)}afterTickToLabelConversion(){_r(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){_r(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,i=this.ticks.length,r=t.minRotation||0,o=t.maxRotation;let l=r,s,d,p;if(!this._isVisible()||!t.display||r>=o||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const _=this._getLabelSizes(),w=_.widest.width,M=_.highest.height,A=ha(this.chart.width-w,0,this.maxWidth);s=e.offset?this.maxWidth/i:A/(i-1),w+6>s&&(s=A/(i-(e.offset?.5:1)),d=this.maxHeight-ox(e.grid)-t.padding-iz(e.title,this.chart.options.font),p=Math.sqrt(w*w+M*M),l=AP(Math.min(Math.asin(ha((_.highest.height+6)/s,-1,1)),Math.asin(ha(d/p,-1,1))-Math.asin(ha(M/p,-1,1)))),l=Math.max(r,Math.min(o,l))),this.labelRotation=l}afterCalculateLabelRotation(){_r(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){_r(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:i,title:r,grid:o}}=this,l=this._isVisible(),s=this.isHorizontal();if(l){const d=iz(r,t.options.font);if(s?(e.width=this.maxWidth,e.height=ox(o)+d):(e.height=this.maxHeight,e.width=ox(o)+d),i.display&&this.ticks.length){const{first:p,last:_,widest:w,highest:M}=this._getLabelSizes(),A=i.padding*2,P=Tu(this.labelRotation),L=Math.cos(P),D=Math.sin(P);if(s){const z=i.mirror?0:D*w.width+L*M.height;e.height=Math.min(this.maxHeight,e.height+z+A)}else{const z=i.mirror?0:L*w.width+D*M.height;e.width=Math.min(this.maxWidth,e.width+z+A)}this._calculatePadding(p,_,D,L)}}this._handleMargins(),s?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,i,r){const{ticks:{align:o,padding:l},position:s}=this.options,d=this.labelRotation!==0,p=s!=="top"&&this.axis==="x";if(this.isHorizontal()){const _=this.getPixelForTick(0)-this.left,w=this.right-this.getPixelForTick(this.ticks.length-1);let M=0,A=0;d?p?(M=r*e.width,A=i*t.height):(M=i*e.height,A=r*t.width):o==="start"?A=t.width:o==="end"?M=e.width:o!=="inner"&&(M=e.width/2,A=t.width/2),this.paddingLeft=Math.max((M-_+l)*this.width/(this.width-_),0),this.paddingRight=Math.max((A-w+l)*this.width/(this.width-w),0)}else{let _=t.height/2,w=e.height/2;o==="start"?(_=0,w=e.height):o==="end"&&(_=t.height,w=0),this.paddingTop=_+l,this.paddingBottom=w+l}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){_r(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,i;for(t=0,i=e.length;t<i;t++)xr(e[t].label)&&(e.splice(t,1),i--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let i=this.ticks;t<i.length&&(i=nz(i,t)),this._labelSizes=e=this._computeLabelSizes(i,i.length)}return e}_computeLabelSizes(e,t){const{ctx:i,_longestTextCache:r}=this,o=[],l=[];let s=0,d=0,p,_,w,M,A,P,L,D,z,F,N;for(p=0;p<t;++p){if(M=e[p].label,A=this._resolveTickFontOptions(p),i.font=P=A.string,L=r[P]=r[P]||{data:{},gc:[]},D=A.lineHeight,z=F=0,!xr(M)&&!zr(M))z=JS(i,L.data,L.gc,z,M),F=D;else if(zr(M))for(_=0,w=M.length;_<w;++_)N=M[_],!xr(N)&&!zr(N)&&(z=JS(i,L.data,L.gc,z,N),F+=D);o.push(z),l.push(F),s=Math.max(z,s),d=Math.max(F,d)}Kq(r,t);const V=o.indexOf(s),j=l.indexOf(d),Q=re=>({width:o[re]||0,height:l[re]||0});return{first:Q(0),last:Q(t-1),widest:Q(V),highest:Q(j),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return j9(this._alignToPixels?bm(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const i=t[e];return i.$context||(i.$context=Qq(this.getContext(),e,i))}return this.$context||(this.$context=Jq(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Tu(this.labelRotation),i=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),o=this._getLabelSizes(),l=e.autoSkipPadding||0,s=o?o.widest.width+l:0,d=o?o.highest.height+l:0;return this.isHorizontal()?d*i>s*r?s/i:d/r:d*r<s*i?d/i:s/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,i=this.chart,r=this.options,{grid:o,position:l}=r,s=o.offset,d=this.isHorizontal(),_=this.ticks.length+(s?1:0),w=ox(o),M=[],A=o.setContext(this.getContext()),P=A.drawBorder?A.borderWidth:0,L=P/2,D=function(fe){return bm(i,fe,P)};let z,F,N,V,j,Q,re,Z,ne,he,De,He;if(l==="top")z=D(this.bottom),Q=this.bottom-w,Z=z-L,he=D(e.top)+L,He=e.bottom;else if(l==="bottom")z=D(this.top),he=e.top,He=D(e.bottom)-L,Q=z+L,Z=this.top+w;else if(l==="left")z=D(this.right),j=this.right-w,re=z-L,ne=D(e.left)+L,De=e.right;else if(l==="right")z=D(this.left),ne=e.left,De=D(e.right)-L,j=z+L,re=this.left+w;else if(t==="x"){if(l==="center")z=D((e.top+e.bottom)/2+.5);else if(ur(l)){const fe=Object.keys(l)[0],Oe=l[fe];z=D(this.chart.scales[fe].getPixelForValue(Oe))}he=e.top,He=e.bottom,Q=z+L,Z=Q+w}else if(t==="y"){if(l==="center")z=D((e.left+e.right)/2);else if(ur(l)){const fe=Object.keys(l)[0],Oe=l[fe];z=D(this.chart.scales[fe].getPixelForValue(Oe))}j=z-L,re=j-w,ne=e.left,De=e.right}const ae=Mi(r.ticks.maxTicksLimit,_),le=Math.max(1,Math.ceil(_/ae));for(F=0;F<_;F+=le){const fe=o.setContext(this.getContext(F)),Oe=fe.lineWidth,We=fe.color,ce=fe.borderDash||[],Te=fe.borderDashOffset,Pe=fe.tickWidth,Qe=fe.tickColor,Ne=fe.tickBorderDash||[],nt=fe.tickBorderDashOffset;N=Yq(this,F,s),N!==void 0&&(V=bm(i,N,Oe),d?j=re=ne=De=V:Q=Z=he=He=V,M.push({tx1:j,ty1:Q,tx2:re,ty2:Z,x1:ne,y1:he,x2:De,y2:He,width:Oe,color:We,borderDash:ce,borderDashOffset:Te,tickWidth:Pe,tickColor:Qe,tickBorderDash:Ne,tickBorderDashOffset:nt}))}return this._ticksLength=_,this._borderValue=z,M}_computeLabelItems(e){const t=this.axis,i=this.options,{position:r,ticks:o}=i,l=this.isHorizontal(),s=this.ticks,{align:d,crossAlign:p,padding:_,mirror:w}=o,M=ox(i.grid),A=M+_,P=w?-_:A,L=-Tu(this.labelRotation),D=[];let z,F,N,V,j,Q,re,Z,ne,he,De,He,ae="middle";if(r==="top")Q=this.bottom-P,re=this._getXAxisLabelAlignment();else if(r==="bottom")Q=this.top+P,re=this._getXAxisLabelAlignment();else if(r==="left"){const fe=this._getYAxisLabelAlignment(M);re=fe.textAlign,j=fe.x}else if(r==="right"){const fe=this._getYAxisLabelAlignment(M);re=fe.textAlign,j=fe.x}else if(t==="x"){if(r==="center")Q=(e.top+e.bottom)/2+A;else if(ur(r)){const fe=Object.keys(r)[0],Oe=r[fe];Q=this.chart.scales[fe].getPixelForValue(Oe)+A}re=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")j=(e.left+e.right)/2-A;else if(ur(r)){const fe=Object.keys(r)[0],Oe=r[fe];j=this.chart.scales[fe].getPixelForValue(Oe)}re=this._getYAxisLabelAlignment(M).textAlign}t==="y"&&(d==="start"?ae="top":d==="end"&&(ae="bottom"));const le=this._getLabelSizes();for(z=0,F=s.length;z<F;++z){N=s[z],V=N.label;const fe=o.setContext(this.getContext(z));Z=this.getPixelForTick(z)+o.labelOffset,ne=this._resolveTickFontOptions(z),he=ne.lineHeight,De=zr(V)?V.length:1;const Oe=De/2,We=fe.color,ce=fe.textStrokeColor,Te=fe.textStrokeWidth;let Pe=re;l?(j=Z,re==="inner"&&(z===F-1?Pe=this.options.reverse?"left":"right":z===0?Pe=this.options.reverse?"right":"left":Pe="center"),r==="top"?p==="near"||L!==0?He=-De*he+he/2:p==="center"?He=-le.highest.height/2-Oe*he+he:He=-le.highest.height+he/2:p==="near"||L!==0?He=he/2:p==="center"?He=le.highest.height/2-Oe*he:He=le.highest.height-De*he,w&&(He*=-1)):(Q=Z,He=(1-De)*he/2);let Qe;if(fe.showLabelBackdrop){const Ne=ma(fe.backdropPadding),nt=le.heights[z],ze=le.widths[z];let et=Q+He-Ne.top,Et=j-Ne.left;switch(ae){case"middle":et-=nt/2;break;case"bottom":et-=nt;break}switch(re){case"center":Et-=ze/2;break;case"right":Et-=ze;break}Qe={left:Et,top:et,width:ze+Ne.width,height:nt+Ne.height,color:fe.backdropColor}}D.push({rotation:L,label:V,font:ne,color:We,strokeColor:ce,strokeWidth:Te,textOffset:He,textAlign:Pe,textBaseline:ae,translation:[j,Q],backdrop:Qe})}return D}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Tu(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:i,mirror:r,padding:o}}=this.options,l=this._getLabelSizes(),s=e+o,d=l.widest.width;let p,_;return t==="left"?r?(_=this.right+o,i==="near"?p="left":i==="center"?(p="center",_+=d/2):(p="right",_+=d)):(_=this.right-s,i==="near"?p="right":i==="center"?(p="center",_-=d/2):(p="left",_=this.left)):t==="right"?r?(_=this.left+o,i==="near"?p="right":i==="center"?(p="center",_-=d/2):(p="left",_-=d)):(_=this.left+s,i==="near"?p="left":i==="center"?(p="center",_+=d/2):(p="right",_=this.right)):p="right",{textAlign:p,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:i,top:r,width:o,height:l}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(i,r,o,l),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(o=>o.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,l;const s=(d,p,_)=>{!_.width||!_.color||(i.save(),i.lineWidth=_.width,i.strokeStyle=_.color,i.setLineDash(_.borderDash||[]),i.lineDashOffset=_.borderDashOffset,i.beginPath(),i.moveTo(d.x,d.y),i.lineTo(p.x,p.y),i.stroke(),i.restore())};if(t.display)for(o=0,l=r.length;o<l;++o){const d=r[o];t.drawOnChartArea&&s({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&s({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{grid:i}}=this,r=i.setContext(this.getContext()),o=i.drawBorder?r.borderWidth:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,s=this._borderValue;let d,p,_,w;this.isHorizontal()?(d=bm(e,this.left,o)-o/2,p=bm(e,this.right,l)+l/2,_=w=s):(_=bm(e,this.top,o)-o/2,w=bm(e,this.bottom,l)+l/2,d=p=s),t.save(),t.lineWidth=r.borderWidth,t.strokeStyle=r.borderColor,t.beginPath(),t.moveTo(d,_),t.lineTo(p,w),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&o1(i,r);const o=this._labelItems||(this._labelItems=this._computeLabelItems(e));let l,s;for(l=0,s=o.length;l<s;++l){const d=o[l],p=d.font,_=d.label;d.backdrop&&(i.fillStyle=d.backdrop.color,i.fillRect(d.backdrop.left,d.backdrop.top,d.backdrop.width,d.backdrop.height));let w=d.textOffset;wg(i,_,0,w,p,d)}r&&a1(i)}drawTitle(){const{ctx:e,options:{position:t,title:i,reverse:r}}=this;if(!i.display)return;const o=oo(i.font),l=ma(i.padding),s=i.align;let d=o.lineHeight/2;t==="bottom"||t==="center"||ur(t)?(d+=l.bottom,zr(i.text)&&(d+=o.lineHeight*(i.text.length-1))):d+=l.top;const{titleX:p,titleY:_,maxWidth:w,rotation:M}=tZ(this,d,t,s);wg(e,i.text,0,0,o,{color:i.color,maxWidth:w,rotation:M,textAlign:eZ(s,t,r),textBaseline:"middle",translation:[p,_]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,i=Mi(e.grid&&e.grid.z,-1);return!this._isVisible()||this.draw!==Ig.prototype.draw?[{z:t,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:t,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let o,l;for(o=0,l=t.length;o<l;++o){const s=t[o];s[i]===this.id&&(!e||s.type===e)&&r.push(s)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return oo(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Jw{constructor(e,t,i){this.type=e,this.scope=t,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let i;rZ(t)&&(i=this.register(t));const r=this.items,o=e.id,l=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in r||(r[o]=e,nZ(e,l,i),this.override&&Fi.override(e.id,e.overrides)),l}get(e){return this.items[e]}unregister(e){const t=this.items,i=e.id,r=this.scope;i in t&&delete t[i],r&&i in Fi[r]&&(delete Fi[r][i],this.override&&delete vg[i])}}function nZ(n,e,t){const i=Iv(Object.create(null),[t?Fi.get(t):{},Fi.get(e),n.defaults]);Fi.set(e,i),n.defaultRoutes&&iZ(e,n.defaultRoutes),n.descriptors&&Fi.describe(e,n.descriptors)}function iZ(n,e){Object.keys(e).forEach(t=>{const i=t.split("."),r=i.pop(),o=[n].concat(i).join("."),l=e[t].split("."),s=l.pop(),d=l.join(".");Fi.route(o,r,d,s)})}function rZ(n){return"id"in n&&"defaults"in n}class sZ{constructor(){this.controllers=new Jw(Dc,"datasets",!0),this.elements=new Jw(zu,"elements"),this.plugins=new Jw(Object,"plugins"),this.scales=new Jw(Ig,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,i){[...t].forEach(r=>{const o=i||this._getRegistryForType(r);i||o.isForType(r)||o===this.plugins&&r.id?this._exec(e,o,r):yi(r,l=>{const s=i||this._getRegistryForType(l);this._exec(e,s,l)})})}_exec(e,t,i){const r=EP(e);_r(i["before"+r],[],i),t[e](i),_r(i["after"+r],[],i)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const i=this._typedRegistries[t];if(i.isForType(e))return i}return this.plugins}_get(e,t,i){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var Ca=new sZ;class VP extends Dc{update(e){const t=this._cachedMeta,{data:i=[]}=t,r=this.chart._animationsDisabled;let{start:o,count:l}=I4(t,i,r);if(this._drawStart=o,this._drawCount=l,P4(t)&&(o=0,l=i.length),this.options.showLine){const{dataset:s,_dataset:d}=t;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!d._decimated,s.points=i;const p=this.resolveDatasetElementOptions(e);p.segment=this.options.segment,this.updateElement(s,void 0,{animated:!r,options:p},e)}this.updateElements(i,o,l,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=Ca.getElement("line")),super.addElements()}updateElements(e,t,i,r){const o=r==="reset",{iScale:l,vScale:s,_stacked:d,_dataset:p}=this._cachedMeta,_=this.resolveDataElementOptions(t,r),w=this.getSharedOptions(_),M=this.includeOptions(r,w),A=l.axis,P=s.axis,{spanGaps:L,segment:D}=this.options,z=xg(L)?L:Number.POSITIVE_INFINITY,F=this.chart._animationsDisabled||o||r==="none";let N=t>0&&this.getParsed(t-1);for(let V=t;V<t+i;++V){const j=e[V],Q=this.getParsed(V),re=F?j:{},Z=xr(Q[P]),ne=re[A]=l.getPixelForValue(Q[A],V),he=re[P]=o||Z?s.getBasePixel():s.getPixelForValue(d?this.applyStack(s,Q,d):Q[P],V);re.skip=isNaN(ne)||isNaN(he)||Z,re.stop=V>0&&Math.abs(Q[A]-N[A])>z,D&&(re.parsed=Q,re.raw=p.data[V]),M&&(re.options=w||this.resolveDataElementOptions(V,j.active?"active":r)),F||this.updateElement(j,V,re,r),N=Q}this.updateSharedOptions(w,r,_)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let s=0;for(let d=t.length-1;d>=0;--d)s=Math.max(s,t[d].size(this.resolveDataElementOptions(d))/2);return s>0&&s}const i=e.dataset,r=i.options&&i.options.borderWidth||0;if(!t.length)return r;const o=t[0].size(this.resolveDataElementOptions(0)),l=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(r,o,l)/2}}VP.id="scatter";VP.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};VP.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(n){return"("+n.label+", "+n.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};function Sm(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class lC{constructor(e){this.options=e||{}}init(e){}formats(){return Sm()}parse(e,t){return Sm()}format(e,t){return Sm()}add(e,t,i){return Sm()}diff(e,t,i){return Sm()}startOf(e,t,i){return Sm()}endOf(e,t){return Sm()}}lC.override=function(n){Object.assign(lC.prototype,n)};var Q4={_date:lC};function oZ(n,e,t,i){const{controller:r,data:o,_sorted:l}=n,s=r._cachedMeta.iScale;if(s&&e===s.axis&&e!=="r"&&l&&o.length){const d=s._reversePixels?q9:Xm;if(i){if(r._sharedOptions){const p=o[0],_=typeof p.getRange=="function"&&p.getRange(e);if(_){const w=d(o,e,t-_),M=d(o,e,t+_);return{lo:w.lo,hi:M.hi}}}}else return d(o,e,t)}return{lo:0,hi:o.length-1}}function u1(n,e,t,i,r){const o=n.getSortedVisibleDatasetMetas(),l=t[e];for(let s=0,d=o.length;s<d;++s){const{index:p,data:_}=o[s],{lo:w,hi:M}=oZ(o[s],e,l,r);for(let A=w;A<=M;++A){const P=_[A];P.skip||i(P,p,A)}}}function aZ(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(i,r){const o=e?Math.abs(i.x-r.x):0,l=t?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))}}function $E(n,e,t,i,r){const o=[];return!r&&!n.isPointInArea(e)||u1(n,t,e,function(s,d,p){!r&&!Lv(s,n.chartArea,0)||s.inRange(e.x,e.y,i)&&o.push({element:s,datasetIndex:d,index:p})},!0),o}function lZ(n,e,t,i){let r=[];function o(l,s,d){const{startAngle:p,endAngle:_}=l.getProps(["startAngle","endAngle"],i),{angle:w}=T4(l,{x:e.x,y:e.y});Pv(w,p,_)&&r.push({element:l,datasetIndex:s,index:d})}return u1(n,t,e,o),r}function cZ(n,e,t,i,r,o){let l=[];const s=aZ(t);let d=Number.POSITIVE_INFINITY;function p(_,w,M){const A=_.inRange(e.x,e.y,r);if(i&&!A)return;const P=_.getCenterPoint(r);if(!(!!o||n.isPointInArea(P))&&!A)return;const D=s(e,P);D<d?(l=[{element:_,datasetIndex:w,index:M}],d=D):D===d&&l.push({element:_,datasetIndex:w,index:M})}return u1(n,t,e,p),l}function YE(n,e,t,i,r,o){return!o&&!n.isPointInArea(e)?[]:t==="r"&&!i?lZ(n,e,t,r):cZ(n,e,t,i,r,o)}function rz(n,e,t,i,r){const o=[],l=t==="x"?"inXRange":"inYRange";let s=!1;return u1(n,t,e,(d,p,_)=>{d[l](e[t],r)&&(o.push({element:d,datasetIndex:p,index:_}),s=s||d.inRange(e.x,e.y,r))}),i&&!s?[]:o}var uZ={evaluateInteractionItems:u1,modes:{index(n,e,t,i){const r=Xf(e,n),o=t.axis||"x",l=t.includeInvisible||!1,s=t.intersect?$E(n,r,o,i,l):YE(n,r,o,!1,i,l),d=[];return s.length?(n.getSortedVisibleDatasetMetas().forEach(p=>{const _=s[0].index,w=p.data[_];w&&!w.skip&&d.push({element:w,datasetIndex:p.index,index:_})}),d):[]},dataset(n,e,t,i){const r=Xf(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;let s=t.intersect?$E(n,r,o,i,l):YE(n,r,o,!1,i,l);if(s.length>0){const d=s[0].datasetIndex,p=n.getDatasetMeta(d).data;s=[];for(let _=0;_<p.length;++_)s.push({element:p[_],datasetIndex:d,index:_})}return s},point(n,e,t,i){const r=Xf(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return $E(n,r,o,i,l)},nearest(n,e,t,i){const r=Xf(e,n),o=t.axis||"xy",l=t.includeInvisible||!1;return YE(n,r,o,t.intersect,i,l)},x(n,e,t,i){const r=Xf(e,n);return rz(n,r,"x",t.intersect,i)},y(n,e,t,i){const r=Xf(e,n);return rz(n,r,"y",t.intersect,i)}}};const e5=["left","top","right","bottom"];function ax(n,e){return n.filter(t=>t.pos===e)}function sz(n,e){return n.filter(t=>e5.indexOf(t.pos)===-1&&t.box.axis===e)}function lx(n,e){return n.sort((t,i)=>{const r=e?i:t,o=e?t:i;return r.weight===o.weight?r.index-o.index:r.weight-o.weight})}function hZ(n){const e=[];let t,i,r,o,l,s;for(t=0,i=(n||[]).length;t<i;++t)r=n[t],{position:o,options:{stack:l,stackWeight:s=1}}=r,e.push({index:t,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:l&&o+l,stackWeight:s});return e}function dZ(n){const e={};for(const t of n){const{stack:i,pos:r,stackWeight:o}=t;if(!i||!e5.includes(r))continue;const l=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});l.count++,l.weight+=o}return e}function fZ(n,e){const t=dZ(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let o,l,s;for(o=0,l=n.length;o<l;++o){s=n[o];const{fullSize:d}=s.box,p=t[s.stack],_=p&&s.stackWeight/p.weight;s.horizontal?(s.width=_?_*i:d&&e.availableWidth,s.height=r):(s.width=i,s.height=_?_*r:d&&e.availableHeight)}return t}function pZ(n){const e=hZ(n),t=lx(e.filter(p=>p.box.fullSize),!0),i=lx(ax(e,"left"),!0),r=lx(ax(e,"right")),o=lx(ax(e,"top"),!0),l=lx(ax(e,"bottom")),s=sz(e,"x"),d=sz(e,"y");return{fullSize:t,leftAndTop:i.concat(o),rightAndBottom:r.concat(d).concat(l).concat(s),chartArea:ax(e,"chartArea"),vertical:i.concat(r).concat(d),horizontal:o.concat(l).concat(s)}}function oz(n,e,t,i){return Math.max(n[t],e[t])+Math.max(n[i],e[i])}function t5(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function mZ(n,e,t,i){const{pos:r,box:o}=t,l=n.maxPadding;if(!ur(r)){t.size&&(n[r]-=t.size);const w=i[t.stack]||{size:0,count:1};w.size=Math.max(w.size,t.horizontal?o.height:o.width),t.size=w.size/w.count,n[r]+=t.size}o.getPadding&&t5(l,o.getPadding());const s=Math.max(0,e.outerWidth-oz(l,n,"left","right")),d=Math.max(0,e.outerHeight-oz(l,n,"top","bottom")),p=s!==n.w,_=d!==n.h;return n.w=s,n.h=d,t.horizontal?{same:p,other:_}:{same:_,other:p}}function gZ(n){const e=n.maxPadding;function t(i){const r=Math.max(e[i]-n[i],0);return n[i]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function _Z(n,e){const t=e.maxPadding;function i(r){const o={left:0,top:0,right:0,bottom:0};return r.forEach(l=>{o[l]=Math.max(e[l],t[l])}),o}return i(n?["left","right"]:["top","bottom"])}function Ox(n,e,t,i){const r=[];let o,l,s,d,p,_;for(o=0,l=n.length,p=0;o<l;++o){s=n[o],d=s.box,d.update(s.width||e.w,s.height||e.h,_Z(s.horizontal,e));const{same:w,other:M}=mZ(e,t,s,i);p|=w&&r.length,_=_||M,d.fullSize||r.push(s)}return p&&Ox(r,e,t,i)||_}function Qw(n,e,t,i,r){n.top=t,n.left=e,n.right=e+i,n.bottom=t+r,n.width=i,n.height=r}function az(n,e,t,i){const r=t.padding;let{x:o,y:l}=e;for(const s of n){const d=s.box,p=i[s.stack]||{count:1,placed:0,weight:1},_=s.stackWeight/p.weight||1;if(s.horizontal){const w=e.w*_,M=p.size||d.height;Lc(p.start)&&(l=p.start),d.fullSize?Qw(d,r.left,l,t.outerWidth-r.right-r.left,M):Qw(d,e.left+p.placed,l,w,M),p.start=l,p.placed+=w,l=d.bottom}else{const w=e.h*_,M=p.size||d.width;Lc(p.start)&&(o=p.start),d.fullSize?Qw(d,o,r.top,M,t.outerHeight-r.bottom-r.top):Qw(d,o,e.top+p.placed,M,w),p.start=o,p.placed+=w,o=d.right}}e.x=o,e.y=l}Fi.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var Sc={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,i){if(!n)return;const r=ma(n.options.layout.padding),o=Math.max(e-r.width,0),l=Math.max(t-r.height,0),s=pZ(n.boxes),d=s.vertical,p=s.horizontal;yi(n.boxes,L=>{typeof L.beforeLayout=="function"&&L.beforeLayout()});const _=d.reduce((L,D)=>D.box.options&&D.box.options.display===!1?L:L+1,0)||1,w=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:o,availableHeight:l,vBoxMaxWidth:o/2/_,hBoxMaxHeight:l/2}),M=Object.assign({},r);t5(M,ma(i));const A=Object.assign({maxPadding:M,w:o,h:l,x:r.left,y:r.top},r),P=fZ(d.concat(p),w);Ox(s.fullSize,A,w,P),Ox(d,A,w,P),Ox(p,A,w,P)&&Ox(d,A,w,P),gZ(A),az(s.leftAndTop,A,w,P),A.x+=A.w,A.y+=A.h,az(s.rightAndBottom,A,w,P),n.chartArea={left:A.left,top:A.top,right:A.left+A.w,bottom:A.top+A.h,height:A.h,width:A.w},yi(s.chartArea,L=>{const D=L.box;Object.assign(D,n.chartArea),D.update(A.w,A.h,{left:0,top:0,right:0,bottom:0})})}};class n5{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,i){}removeEventListener(e,t,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,i,r){return t=Math.max(0,t||e.width),i=i||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):i)}}isAttached(e){return!0}updateConfig(e){}}class yZ extends n5{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const uS="$chartjs",xZ={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},lz=n=>n===null||n==="";function vZ(n,e){const t=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[uS]={initial:{height:i,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",lz(r)){const o=UR(n,"width");o!==void 0&&(n.width=o)}if(lz(i))if(n.style.height==="")n.height=n.width/(e||2);else{const o=UR(n,"height");o!==void 0&&(n.height=o)}return n}const i5=eq?{passive:!0}:!1;function wZ(n,e,t){n.addEventListener(e,t,i5)}function bZ(n,e,t){n.canvas.removeEventListener(e,t,i5)}function SZ(n,e){const t=xZ[n.type]||n.type,{x:i,y:r}=Xf(n,e);return{type:t,chart:e,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function eM(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function MZ(n,e,t){const i=n.canvas,r=new MutationObserver(o=>{let l=!1;for(const s of o)l=l||eM(s.addedNodes,i),l=l&&!eM(s.removedNodes,i);l&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function TZ(n,e,t){const i=n.canvas,r=new MutationObserver(o=>{let l=!1;for(const s of o)l=l||eM(s.removedNodes,i),l=l&&!eM(s.addedNodes,i);l&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const Dv=new Map;let cz=0;function r5(){const n=window.devicePixelRatio;n!==cz&&(cz=n,Dv.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function EZ(n,e){Dv.size||window.addEventListener("resize",r5),Dv.set(n,e)}function AZ(n){Dv.delete(n),Dv.size||window.removeEventListener("resize",r5)}function CZ(n,e,t){const i=n.canvas,r=i&&OP(i);if(!r)return;const o=C4((s,d)=>{const p=r.clientWidth;t(s,d),p<r.clientWidth&&t()},window),l=new ResizeObserver(s=>{const d=s[0],p=d.contentRect.width,_=d.contentRect.height;p===0&&_===0||o(p,_)});return l.observe(r),EZ(n,o),l}function KE(n,e,t){t&&t.disconnect(),e==="resize"&&AZ(n)}function IZ(n,e,t){const i=n.canvas,r=C4(o=>{n.ctx!==null&&t(SZ(o,n))},n,o=>{const l=o[0];return[l,l.offsetX,l.offsetY]});return wZ(i,e,r),r}class PZ extends n5{acquireContext(e,t){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(vZ(e,t),i):null}releaseContext(e){const t=e.canvas;if(!t[uS])return!1;const i=t[uS].initial;["height","width"].forEach(o=>{const l=i[o];xr(l)?t.removeAttribute(o):t.setAttribute(o,l)});const r=i.style||{};return Object.keys(r).forEach(o=>{t.style[o]=r[o]}),t.width=t.width,delete t[uS],!0}addEventListener(e,t,i){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),l={attach:MZ,detach:TZ,resize:CZ}[t]||IZ;r[t]=l(e,t,i)}removeEventListener(e,t){const i=e.$proxies||(e.$proxies={}),r=i[t];if(!r)return;({attach:KE,detach:KE,resize:KE}[t]||bZ)(e,t,r),i[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,i,r){return Q7(e,t,i,r)}isAttached(e){const t=OP(e);return!!(t&&t.isConnected)}}function LZ(n){return!H4()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?yZ:PZ}class kZ{constructor(){this._init=[]}notify(e,t,i,r){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=r?this._descriptors(e).filter(r):this._descriptors(e),l=this._notify(o,e,t,i);return t==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),l}_notify(e,t,i,r){r=r||{};for(const o of e){const l=o.plugin,s=l[i],d=[t,r,o.options];if(_r(s,d,l)===!1&&r.cancelable)return!1}return!0}invalidate(){xr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const i=e&&e.config,r=Mi(i.options&&i.options.plugins,{}),o=DZ(i);return r===!1&&!t?[]:zZ(e,o,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],i=this._cache,r=(o,l)=>o.filter(s=>!l.some(d=>s.plugin.id===d.plugin.id));this._notify(r(t,i),e,"stop"),this._notify(r(i,t),e,"start")}}function DZ(n){const e={},t=[],i=Object.keys(Ca.plugins.items);for(let o=0;o<i.length;o++)t.push(Ca.getPlugin(i[o]));const r=n.plugins||[];for(let o=0;o<r.length;o++){const l=r[o];t.indexOf(l)===-1&&(t.push(l),e[l.id]=!0)}return{plugins:t,localIds:e}}function RZ(n,e){return!e&&n===!1?null:n===!0?{}:n}function zZ(n,{plugins:e,localIds:t},i,r){const o=[],l=n.getContext();for(const s of e){const d=s.id,p=RZ(i[d],r);p!==null&&o.push({plugin:s,options:OZ(n.config,{plugin:s,local:t[d]},p,l)})}return o}function OZ(n,{plugin:e,local:t},i,r){const o=n.pluginScopeKeys(e),l=n.getOptionScopes(i,o);return t&&e.defaults&&l.push(e.defaults),n.createResolver(l,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cC(n,e){const t=Fi.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function FZ(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function BZ(n,e){return n===e?"_index_":"_value_"}function NZ(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function uC(n,e){return n==="x"||n==="y"?n:e.axis||NZ(e.position)||n.charAt(0).toLowerCase()}function UZ(n,e){const t=vg[n.type]||{scales:{}},i=e.scales||{},r=cC(n.type,e),o=Object.create(null),l=Object.create(null);return Object.keys(i).forEach(s=>{const d=i[s];if(!ur(d))return console.error(`Invalid scale configuration for scale: ${s}`);if(d._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${s}`);const p=uC(s,d),_=BZ(p,r),w=t.scales||{};o[p]=o[p]||s,l[s]=Kx(Object.create(null),[{axis:p},d,w[p],w[_]])}),n.data.datasets.forEach(s=>{const d=s.type||n.type,p=s.indexAxis||cC(d,e),w=(vg[d]||{}).scales||{};Object.keys(w).forEach(M=>{const A=FZ(M,p),P=s[A+"AxisID"]||o[A]||A;l[P]=l[P]||Object.create(null),Kx(l[P],[{axis:A},i[P],w[M]])})}),Object.keys(l).forEach(s=>{const d=l[s];Kx(d,[Fi.scales[d.type],Fi.scale])}),l}function s5(n){const e=n.options||(n.options={});e.plugins=Mi(e.plugins,{}),e.scales=UZ(n,e)}function o5(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function VZ(n){return n=n||{},n.data=o5(n.data),s5(n),n}const uz=new Map,a5=new Set;function eb(n,e){let t=uz.get(n);return t||(t=e(),uz.set(n,t),a5.add(t)),t}const cx=(n,e,t)=>{const i=Ep(e,t);i!==void 0&&n.add(i)};class GZ{constructor(e){this._config=VZ(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=o5(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),s5(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return eb(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return eb(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return eb(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,i=this.type;return eb(`${i}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const i=this._scopeCache;let r=i.get(e);return(!r||t)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,t,i){const{options:r,type:o}=this,l=this._cachedScopes(e,i),s=l.get(t);if(s)return s;const d=new Set;t.forEach(_=>{e&&(d.add(e),_.forEach(w=>cx(d,e,w))),_.forEach(w=>cx(d,r,w)),_.forEach(w=>cx(d,vg[o]||{},w)),_.forEach(w=>cx(d,Fi,w)),_.forEach(w=>cx(d,oC,w))});const p=Array.from(d);return p.length===0&&p.push(Object.create(null)),a5.has(t)&&l.set(t,p),p}chartOptionScopes(){const{options:e,type:t}=this;return[e,vg[t]||{},Fi.datasets[t]||{},{type:t},Fi,oC]}resolveNamedOptions(e,t,i,r=[""]){const o={$shared:!0},{resolver:l,subPrefixes:s}=hz(this._resolverCache,e,r);let d=l;if(HZ(l,t)){o.$shared=!1,i=Ap(i)?i():i;const p=this.createResolver(e,i,s);d=Ey(l,i,p)}for(const p of t)o[p]=d[p];return o}createResolver(e,t,i=[""],r){const{resolver:o}=hz(this._resolverCache,e,i);return ur(t)?Ey(o,t,void 0,r):o}}function hz(n,e,t){let i=n.get(e);i||(i=new Map,n.set(e,i));const r=t.join();let o=i.get(r);return o||(o={resolver:DP(e,t),subPrefixes:t.filter(s=>!s.toLowerCase().includes("hover"))},i.set(r,o)),o}const WZ=n=>ur(n)&&Object.getOwnPropertyNames(n).reduce((e,t)=>e||Ap(n[t]),!1);function HZ(n,e){const{isScriptable:t,isIndexable:i}=B4(n);for(const r of e){const o=t(r),l=i(r),s=(l||o)&&n[r];if(o&&(Ap(s)||WZ(s))||l&&zr(s))return!0}return!1}var jZ="3.9.1";const qZ=["top","bottom","left","right","chartArea"];function dz(n,e){return n==="top"||n==="bottom"||qZ.indexOf(n)===-1&&e==="x"}function fz(n,e){return function(t,i){return t[n]===i[n]?t[e]-i[e]:t[n]-i[n]}}function pz(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),_r(t&&t.onComplete,[n],e)}function ZZ(n){const e=n.chart,t=e.options.animation;_r(t&&t.onProgress,[n],e)}function l5(n){return H4()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const tM={},c5=n=>{const e=l5(n);return Object.values(tM).filter(t=>t.canvas===e).pop()};function XZ(n,e,t){const i=Object.keys(n);for(const r of i){const o=+r;if(o>=e){const l=n[r];delete n[r],(t>0||o>e)&&(n[o+t]=l)}}}function $Z(n,e,t,i){return!t||n.type==="mouseout"?null:i?e:n}let Yy=class{constructor(e,t){const i=this.config=new GZ(t),r=l5(e),o=c5(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const l=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||LZ(r)),this.platform.updateConfig(i);const s=this.platform.acquireContext(r,l.aspectRatio),d=s&&s.canvas,p=d&&d.height,_=d&&d.width;if(this.id=D9(),this.ctx=s,this.canvas=d,this.width=_,this.height=p,this._options=l,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new kZ,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=$9(w=>this.update(w),l.resizeDelay||0),this._dataChanges=[],tM[this.id]=this,!s||!d){console.error("Failed to create chart: can't acquire context from the given item");return}Md.listen(this,"complete",pz),Md.listen(this,"progress",ZZ),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:i,height:r,_aspectRatio:o}=this;return xr(e)?t&&o?o:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():NR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return OR(this.canvas,this.ctx),this}stop(){return Md.stop(this),this}resize(e,t){Md.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const i=this.options,r=this.canvas,o=i.maintainAspectRatio&&this.aspectRatio,l=this.platform.getMaximumSize(r,e,t,o),s=i.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=l.width,this.height=l.height,this._aspectRatio=this.aspectRatio,NR(this,s,!0)&&(this.notifyPlugins("resize",{size:l}),_r(i.onResize,[this,l],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};yi(t,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,i=this.scales,r=Object.keys(i).reduce((l,s)=>(l[s]=!1,l),{});let o=[];t&&(o=o.concat(Object.keys(t).map(l=>{const s=t[l],d=uC(l,s),p=d==="r",_=d==="x";return{options:s,dposition:p?"chartArea":_?"bottom":"left",dtype:p?"radialLinear":_?"category":"linear"}}))),yi(o,l=>{const s=l.options,d=s.id,p=uC(d,s),_=Mi(s.type,l.dtype);(s.position===void 0||dz(s.position,p)!==dz(l.dposition))&&(s.position=l.dposition),r[d]=!0;let w=null;if(d in i&&i[d].type===_)w=i[d];else{const M=Ca.getScale(_);w=new M({id:d,type:_,ctx:this.ctx,chart:this}),i[w.id]=w}w.init(s,e)}),yi(r,(l,s)=>{l||delete i[s]}),yi(i,l=>{Sc.configure(this,l,l.options),Sc.addBox(this,l)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,i=e.length;if(e.sort((r,o)=>r.index-o.index),i>t){for(let r=t;r<i;++r)this._destroyDatasetMeta(r);e.splice(t,i-t)}this._sortedMetasets=e.slice(0).sort(fz("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((i,r)=>{t.filter(o=>o===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=t.length;i<r;i++){const o=t[i];let l=this.getDatasetMeta(i);const s=o.type||this.config.type;if(l.type&&l.type!==s&&(this._destroyDatasetMeta(i),l=this.getDatasetMeta(i)),l.type=s,l.indexAxis=o.indexAxis||cC(s,this.options),l.order=o.order||0,l.index=i,l.label=""+o.label,l.visible=this.isDatasetVisible(i),l.controller)l.controller.updateIndex(i),l.controller.linkScales();else{const d=Ca.getController(s),{datasetElementType:p,dataElementType:_}=Fi.datasets[s];Object.assign(d.prototype,{dataElementType:Ca.getElement(_),datasetElementType:p&&Ca.getElement(p)}),l.controller=new d(this,i),e.push(l.controller)}}return this._updateMetasets(),e}_resetElements(){yi(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const i=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let l=0;for(let p=0,_=this.data.datasets.length;p<_;p++){const{controller:w}=this.getDatasetMeta(p),M=!r&&o.indexOf(w)===-1;w.buildOrUpdateElements(M),l=Math.max(+w.getMaxOverflow(),l)}l=this._minPadding=i.layout.autoPadding?l:0,this._updateLayout(l),r||yi(o,p=>{p.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(fz("z","_idx"));const{_active:s,_lastEvent:d}=this;d?this._eventHandler(d,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){yi(this.scales,e=>{Sc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!MR(t,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:o}of t){const l=i==="_removeElements"?-o:o;XZ(e,r,l)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,i=o=>new Set(e.filter(l=>l[0]===o).map((l,s)=>s+","+l.splice(1).join(","))),r=i(0);for(let o=1;o<t;o++)if(!MR(r,i(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Sc.update(this,this.width,this.height,e);const t=this.chartArea,i=t.width<=0||t.height<=0;this._layers=[],yi(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,i=this.data.datasets.length;t<i;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,i=this.data.datasets.length;t<i;++t)this._updateDataset(t,Ap(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Md.has(this)?this.attached&&!Md.running(this)&&Md.start(this):(this.draw(),pz({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resize(i,r),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,i=[];let r,o;for(r=0,o=t.length;r<o;++r){const l=t[r];(!e||l.visible)&&i.push(l)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,i=e._clip,r=!i.disabled,o=this.chartArea,l={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",l)!==!1&&(r&&o1(t,{left:i.left===!1?0:o.left-i.left,right:i.right===!1?this.width:o.right+i.right,top:i.top===!1?0:o.top-i.top,bottom:i.bottom===!1?this.height:o.bottom+i.bottom}),e.controller.draw(),r&&a1(t),l.cancelable=!1,this.notifyPlugins("afterDatasetDraw",l))}isPointInArea(e){return Lv(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,i,r){const o=uZ.modes[t];return typeof o=="function"?o(this,e,i,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],i=this._metasets;let r=i.filter(o=>o&&o._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Bp(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!t.hidden}setDatasetVisibility(e,t){const i=this.getDatasetMeta(e);i.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,i){const r=i?"show":"hide",o=this.getDatasetMeta(e),l=o.controller._resolveAnimations(void 0,r);Lc(t)?(o.data[t].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),l.update(o,{visible:i}),this.update(s=>s.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Md.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),OR(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete tM[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,i=(o,l)=>{t.addEventListener(this,o,l),e[o]=l},r=(o,l,s)=>{o.offsetX=l,o.offsetY=s,this._eventHandler(o)};yi(this.options.events,o=>i(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,i=(d,p)=>{t.addEventListener(this,d,p),e[d]=p},r=(d,p)=>{e[d]&&(t.removeEventListener(this,d,p),delete e[d])},o=(d,p)=>{this.canvas&&this.resize(d,p)};let l;const s=()=>{r("attach",s),this.attached=!0,this.resize(),i("resize",o),i("detach",l)};l=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),i("attach",s)},t.isAttached(this.canvas)?s():l()}unbindEvents(){yi(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},yi(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,i){const r=i?"set":"remove";let o,l,s,d;for(t==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),s=0,d=e.length;s<d;++s){l=e[s];const p=l&&this.getDatasetMeta(l.datasetIndex).controller;p&&p[r+"HoverStyle"](l.element,l.datasetIndex,l.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],i=e.map(({datasetIndex:o,index:l})=>{const s=this.getDatasetMeta(o);if(!s)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:s.data[l],index:l}});!XS(i,t)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,t))}notifyPlugins(e,t,i){return this._plugins.notify(this,e,t,i)}_updateHoverStyles(e,t,i){const r=this.options.hover,o=(d,p)=>d.filter(_=>!p.some(w=>_.datasetIndex===w.datasetIndex&&_.index===w.index)),l=o(t,e),s=i?e:o(e,t);l.length&&this.updateHoverStyle(l,r.mode,!1),s.length&&r.mode&&this.updateHoverStyle(s,r.mode,!0)}_eventHandler(e,t){const i={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=l=>(l.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const o=this._handleEvent(e,t,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(o||i.changed)&&this.render(),this}_handleEvent(e,t,i){const{_active:r=[],options:o}=this,l=t,s=this._getActiveElements(e,r,i,l),d=N9(e),p=$Z(e,this._lastEvent,i,d);i&&(this._lastEvent=null,_r(o.onHover,[e,s,this],this),d&&_r(o.onClick,[e,s,this],this));const _=!XS(s,r);return(_||t)&&(this._active=s,this._updateHoverStyles(s,r,t)),this._lastEvent=p,_}_getActiveElements(e,t,i,r){if(e.type==="mouseout")return[];if(!i)return t;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,r)}};const mz=()=>yi(Yy.instances,n=>n._plugins.invalidate()),Of=!0;Object.defineProperties(Yy,{defaults:{enumerable:Of,value:Fi},instances:{enumerable:Of,value:tM},overrides:{enumerable:Of,value:vg},registry:{enumerable:Of,value:Ca},version:{enumerable:Of,value:jZ},getChart:{enumerable:Of,value:c5},register:{enumerable:Of,value:(...n)=>{Ca.add(...n),mz()}},unregister:{enumerable:Of,value:(...n)=>{Ca.remove(...n),mz()}}});function u5(n,e,t){const{startAngle:i,pixelMargin:r,x:o,y:l,outerRadius:s,innerRadius:d}=e;let p=r/s;n.beginPath(),n.arc(o,l,s,i-p,t+p),d>r?(p=r/d,n.arc(o,l,d,t+p,i-p,!0)):n.arc(o,l,r,t+Ms,i-Ms),n.closePath(),n.clip()}function YZ(n){return kP(n,["outerStart","outerEnd","innerStart","innerEnd"])}function KZ(n,e,t,i){const r=YZ(n.options.borderRadius),o=(t-e)/2,l=Math.min(o,i*e/2),s=d=>{const p=(t-Math.min(o,d))*i/2;return ha(d,0,Math.min(o,p))};return{outerStart:s(r.outerStart),outerEnd:s(r.outerEnd),innerStart:ha(r.innerStart,0,l),innerEnd:ha(r.innerEnd,0,l)}}function g_(n,e,t,i){return{x:t+n*Math.cos(e),y:i+n*Math.sin(e)}}function hC(n,e,t,i,r,o){const{x:l,y:s,startAngle:d,pixelMargin:p,innerRadius:_}=e,w=Math.max(e.outerRadius+i+t-p,0),M=_>0?_+i+t+p:0;let A=0;const P=r-d;if(i){const fe=_>0?_-i:0,Oe=w>0?w-i:0,We=(fe+Oe)/2,ce=We!==0?P*We/(We+i):P;A=(P-ce)/2}const L=Math.max(.001,P*w-t/Qr)/w,D=(P-L)/2,z=d+D+A,F=r-D-A,{outerStart:N,outerEnd:V,innerStart:j,innerEnd:Q}=KZ(e,M,w,F-z),re=w-N,Z=w-V,ne=z+N/re,he=F-V/Z,De=M+j,He=M+Q,ae=z+j/De,le=F-Q/He;if(n.beginPath(),o){if(n.arc(l,s,w,ne,he),V>0){const We=g_(Z,he,l,s);n.arc(We.x,We.y,V,he,F+Ms)}const fe=g_(He,F,l,s);if(n.lineTo(fe.x,fe.y),Q>0){const We=g_(He,le,l,s);n.arc(We.x,We.y,Q,F+Ms,le+Math.PI)}if(n.arc(l,s,M,F-Q/M,z+j/M,!0),j>0){const We=g_(De,ae,l,s);n.arc(We.x,We.y,j,ae+Math.PI,z-Ms)}const Oe=g_(re,z,l,s);if(n.lineTo(Oe.x,Oe.y),N>0){const We=g_(re,ne,l,s);n.arc(We.x,We.y,N,z-Ms,ne)}}else{n.moveTo(l,s);const fe=Math.cos(ne)*w+l,Oe=Math.sin(ne)*w+s;n.lineTo(fe,Oe);const We=Math.cos(he)*w+l,ce=Math.sin(he)*w+s;n.lineTo(We,ce)}n.closePath()}function JZ(n,e,t,i,r){const{fullCircles:o,startAngle:l,circumference:s}=e;let d=e.endAngle;if(o){hC(n,e,t,i,l+Or,r);for(let p=0;p<o;++p)n.fill();isNaN(s)||(d=l+s%Or,s%Or===0&&(d+=Or))}return hC(n,e,t,i,d,r),n.fill(),d}function QZ(n,e,t){const{x:i,y:r,startAngle:o,pixelMargin:l,fullCircles:s}=e,d=Math.max(e.outerRadius-l,0),p=e.innerRadius+l;let _;for(t&&u5(n,e,o+Or),n.beginPath(),n.arc(i,r,p,o+Or,o,!0),_=0;_<s;++_)n.stroke();for(n.beginPath(),n.arc(i,r,d,o,o+Or),_=0;_<s;++_)n.stroke()}function eX(n,e,t,i,r,o){const{options:l}=e,{borderWidth:s,borderJoinStyle:d}=l,p=l.borderAlign==="inner";s&&(p?(n.lineWidth=s*2,n.lineJoin=d||"round"):(n.lineWidth=s,n.lineJoin=d||"bevel"),e.fullCircles&&QZ(n,e,p),p&&u5(n,e,r),hC(n,e,t,i,r,o),n.stroke())}class GP extends zu{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.getProps(["x","y"],i),{angle:o,distance:l}=T4(r,{x:e,y:t}),{startAngle:s,endAngle:d,innerRadius:p,outerRadius:_,circumference:w}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),M=this.options.spacing/2,P=Mi(w,d-s)>=Or||Pv(o,s,d),L=ip(l,p+M,_+M);return P&&L}getCenterPoint(e){const{x:t,y:i,startAngle:r,endAngle:o,innerRadius:l,outerRadius:s}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:d,spacing:p}=this.options,_=(r+o)/2,w=(l+s+p+d)/2;return{x:t+Math.cos(_)*w,y:i+Math.sin(_)*w}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:i}=this,r=(t.offset||0)/2,o=(t.spacing||0)/2,l=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=i>Or?Math.floor(i/Or):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();let s=0;if(r){s=r/2;const p=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(p)*s,Math.sin(p)*s),this.circumference>=Qr&&(s=r)}e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor;const d=JZ(e,this,s,o,l);eX(e,this,s,o,d,l),e.restore()}}GP.id="arc";GP.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};GP.defaultRoutes={backgroundColor:"backgroundColor"};function h5(n,e,t=e){n.lineCap=Mi(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Mi(t.borderDash,e.borderDash)),n.lineDashOffset=Mi(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Mi(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Mi(t.borderWidth,e.borderWidth),n.strokeStyle=Mi(t.borderColor,e.borderColor)}function tX(n,e,t){n.lineTo(t.x,t.y)}function nX(n){return n.stepped?S7:n.tension||n.cubicInterpolationMode==="monotone"?M7:tX}function d5(n,e,t={}){const i=n.length,{start:r=0,end:o=i-1}=t,{start:l,end:s}=e,d=Math.max(r,l),p=Math.min(o,s),_=r<l&&o<l||r>s&&o>s;return{count:i,start:d,loop:e.loop,ilen:p<d&&!_?i+p-d:p-d}}function iX(n,e,t,i){const{points:r,options:o}=e,{count:l,start:s,loop:d,ilen:p}=d5(r,t,i),_=nX(o);let{move:w=!0,reverse:M}=i||{},A,P,L;for(A=0;A<=p;++A)P=r[(s+(M?p-A:A))%l],!P.skip&&(w?(n.moveTo(P.x,P.y),w=!1):_(n,L,P,M,o.stepped),L=P);return d&&(P=r[(s+(M?p:0))%l],_(n,L,P,M,o.stepped)),!!d}function rX(n,e,t,i){const r=e.points,{count:o,start:l,ilen:s}=d5(r,t,i),{move:d=!0,reverse:p}=i||{};let _=0,w=0,M,A,P,L,D,z;const F=V=>(l+(p?s-V:V))%o,N=()=>{L!==D&&(n.lineTo(_,D),n.lineTo(_,L),n.lineTo(_,z))};for(d&&(A=r[F(0)],n.moveTo(A.x,A.y)),M=0;M<=s;++M){if(A=r[F(M)],A.skip)continue;const V=A.x,j=A.y,Q=V|0;Q===P?(j<L?L=j:j>D&&(D=j),_=(w*_+V)/++w):(N(),n.lineTo(V,j),P=Q,w=0,L=D=j),z=j}N()}function dC(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?rX:iX}function sX(n){return n.stepped?tq:n.tension||n.cubicInterpolationMode==="monotone"?nq:Fm}function oX(n,e,t,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,i)&&r.closePath()),h5(n,e.options),n.stroke(r)}function aX(n,e,t,i){const{segments:r,options:o}=e,l=dC(e);for(const s of r)h5(n,o,s.style),n.beginPath(),l(n,e,s,{start:t,end:t+i-1})&&n.closePath(),n.stroke()}const lX=typeof Path2D=="function";function cX(n,e,t,i){lX&&!e.options.segment?oX(n,e,t,i):aX(n,e,t,i)}class h1 extends zu{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;Z7(this._points,i,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=hq(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,i=e.length;return i&&t[e[i-1].end]}interpolate(e,t){const i=this.options,r=e[t],o=this.points,l=lq(this,{property:t,start:r,end:r});if(!l.length)return;const s=[],d=sX(i);let p,_;for(p=0,_=l.length;p<_;++p){const{start:w,end:M}=l[p],A=o[w],P=o[M];if(A===P){s.push(A);continue}const L=Math.abs((r-A[t])/(P[t]-A[t])),D=d(A,P,L,i.stepped);D[t]=e[t],s.push(D)}return s.length===1?s[0]:s}pathSegment(e,t,i){return dC(this)(e,this,t,i)}path(e,t,i){const r=this.segments,o=dC(this);let l=this._loop;t=t||0,i=i||this.points.length-t;for(const s of r)l&=o(e,this,s,{start:t,end:t+i-1});return!!l}draw(e,t,i,r){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),cX(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}h1.id="line";h1.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};h1.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};h1.descriptors={_scriptable:!0,_indexable:n=>n!=="borderDash"&&n!=="fill"};function gz(n,e,t,i){const r=n.options,{[t]:o}=n.getProps([t],i);return Math.abs(e-o)<r.radius+r.hitRadius}class WM extends zu{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,i){const r=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(e-o,2)+Math.pow(t-l,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return gz(this,e,"x",t)}inYRange(e,t){return gz(this,e,"y",t)}getCenterPoint(e){const{x:t,y:i}=this.getProps(["x","y"],e);return{x:t,y:i}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const i=t&&e.borderWidth||0;return(t+i)*2}draw(e,t){const i=this.options;this.skip||i.radius<.1||!Lv(this,t,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,aC(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}WM.id="point";WM.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};WM.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function f5(n,e){const{x:t,y:i,base:r,width:o,height:l}=n.getProps(["x","y","base","width","height"],e);let s,d,p,_,w;return n.horizontal?(w=l/2,s=Math.min(t,r),d=Math.max(t,r),p=i-w,_=i+w):(w=o/2,s=t-w,d=t+w,p=Math.min(i,r),_=Math.max(i,r)),{left:s,top:p,right:d,bottom:_}}function sp(n,e,t,i){return n?0:ha(e,t,i)}function uX(n,e,t){const i=n.options.borderWidth,r=n.borderSkipped,o=F4(i);return{t:sp(r.top,o.top,0,t),r:sp(r.right,o.right,0,e),b:sp(r.bottom,o.bottom,0,t),l:sp(r.left,o.left,0,e)}}function hX(n,e,t){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,o=ig(r),l=Math.min(e,t),s=n.borderSkipped,d=i||ur(r);return{topLeft:sp(!d||s.top||s.left,o.topLeft,0,l),topRight:sp(!d||s.top||s.right,o.topRight,0,l),bottomLeft:sp(!d||s.bottom||s.left,o.bottomLeft,0,l),bottomRight:sp(!d||s.bottom||s.right,o.bottomRight,0,l)}}function dX(n){const e=f5(n),t=e.right-e.left,i=e.bottom-e.top,r=uX(n,t/2,i/2),o=hX(n,t/2,i/2);return{outer:{x:e.left,y:e.top,w:t,h:i,radius:o},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,o.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,o.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,o.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,o.bottomRight-Math.max(r.b,r.r))}}}}function JE(n,e,t,i){const r=e===null,o=t===null,s=n&&!(r&&o)&&f5(n,i);return s&&(r||ip(e,s.left,s.right))&&(o||ip(t,s.top,s.bottom))}function fX(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function pX(n,e){n.rect(e.x,e.y,e.w,e.h)}function QE(n,e,t={}){const i=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,o=(n.x+n.w!==t.x+t.w?e:0)-i,l=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+o,h:n.h+l,radius:n.radius}}class WP extends zu{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:i,backgroundColor:r}}=this,{inner:o,outer:l}=dX(this),s=fX(l.radius)?kv:pX;e.save(),(l.w!==o.w||l.h!==o.h)&&(e.beginPath(),s(e,QE(l,t,o)),e.clip(),s(e,QE(o,-t,l)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),s(e,QE(o,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,i){return JE(this,e,t,i)}inXRange(e,t){return JE(this,e,null,t)}inYRange(e,t){return JE(this,null,e,t)}getCenterPoint(e){const{x:t,y:i,base:r,horizontal:o}=this.getProps(["x","y","base","horizontal"],e);return{x:o?(t+r)/2:t,y:o?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}WP.id="bar";WP.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};WP.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};const _z=(n,e)=>{let{boxHeight:t=e,boxWidth:i=e}=n;return n.usePointStyle&&(t=Math.min(t,e),i=n.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:t,itemHeight:Math.max(e,t)}},mX=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class yz extends zu{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,i){this.maxWidth=e,this.maxHeight=t,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=_r(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(i=>e.filter(i,this.chart.data))),e.sort&&(t=t.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=oo(i.font),o=r.size,l=this._computeTitleHeight(),{boxWidth:s,itemHeight:d}=_z(i,o);let p,_;t.font=r.string,this.isHorizontal()?(p=this.maxWidth,_=this._fitRows(l,o,s,d)+10):(_=this.maxHeight,p=this._fitCols(l,o,s,d)+10),this.width=Math.min(p,e.maxWidth||this.maxWidth),this.height=Math.min(_,e.maxHeight||this.maxHeight)}_fitRows(e,t,i,r){const{ctx:o,maxWidth:l,options:{labels:{padding:s}}}=this,d=this.legendHitBoxes=[],p=this.lineWidths=[0],_=r+s;let w=e;o.textAlign="left",o.textBaseline="middle";let M=-1,A=-_;return this.legendItems.forEach((P,L)=>{const D=i+t/2+o.measureText(P.text).width;(L===0||p[p.length-1]+D+2*s>l)&&(w+=_,p[p.length-(L>0?0:1)]=0,A+=_,M++),d[L]={left:0,top:A,row:M,width:D,height:r},p[p.length-1]+=D+s}),w}_fitCols(e,t,i,r){const{ctx:o,maxHeight:l,options:{labels:{padding:s}}}=this,d=this.legendHitBoxes=[],p=this.columnSizes=[],_=l-e;let w=s,M=0,A=0,P=0,L=0;return this.legendItems.forEach((D,z)=>{const F=i+t/2+o.measureText(D.text).width;z>0&&A+r+2*s>_&&(w+=M+s,p.push({width:M,height:A}),P+=M+s,L++,M=A=0),d[z]={left:P,top:A,col:L,width:F,height:r},M=Math.max(M,F),A+=r+s}),w+=M,p.push({width:M,height:A}),w}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:i,labels:{padding:r},rtl:o}}=this,l=cy(o,this.left,this.width);if(this.isHorizontal()){let s=0,d=aa(i,this.left+r,this.right-this.lineWidths[s]);for(const p of t)s!==p.row&&(s=p.row,d=aa(i,this.left+r,this.right-this.lineWidths[s])),p.top+=this.top+e+r,p.left=l.leftForLtr(l.x(d),p.width),d+=p.width+r}else{let s=0,d=aa(i,this.top+e+r,this.bottom-this.columnSizes[s].height);for(const p of t)p.col!==s&&(s=p.col,d=aa(i,this.top+e+r,this.bottom-this.columnSizes[s].height)),p.top=d,p.left+=this.left+r,p.left=l.leftForLtr(l.x(p.left),p.width),d+=p.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;o1(e,this),this._draw(),a1(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:i,ctx:r}=this,{align:o,labels:l}=e,s=Fi.color,d=cy(e.rtl,this.left,this.width),p=oo(l.font),{color:_,padding:w}=l,M=p.size,A=M/2;let P;this.drawTitle(),r.textAlign=d.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=p.string;const{boxWidth:L,boxHeight:D,itemHeight:z}=_z(l,M),F=function(re,Z,ne){if(isNaN(L)||L<=0||isNaN(D)||D<0)return;r.save();const he=Mi(ne.lineWidth,1);if(r.fillStyle=Mi(ne.fillStyle,s),r.lineCap=Mi(ne.lineCap,"butt"),r.lineDashOffset=Mi(ne.lineDashOffset,0),r.lineJoin=Mi(ne.lineJoin,"miter"),r.lineWidth=he,r.strokeStyle=Mi(ne.strokeStyle,s),r.setLineDash(Mi(ne.lineDash,[])),l.usePointStyle){const De={radius:D*Math.SQRT2/2,pointStyle:ne.pointStyle,rotation:ne.rotation,borderWidth:he},He=d.xPlus(re,L/2),ae=Z+A;O4(r,De,He,ae,l.pointStyleWidth&&L)}else{const De=Z+Math.max((M-D)/2,0),He=d.leftForLtr(re,L),ae=ig(ne.borderRadius);r.beginPath(),Object.values(ae).some(le=>le!==0)?kv(r,{x:He,y:De,w:L,h:D,radius:ae}):r.rect(He,De,L,D),r.fill(),he!==0&&r.stroke()}r.restore()},N=function(re,Z,ne){wg(r,ne.text,re,Z+z/2,p,{strikethrough:ne.hidden,textAlign:d.textAlign(ne.textAlign)})},V=this.isHorizontal(),j=this._computeTitleHeight();V?P={x:aa(o,this.left+w,this.right-i[0]),y:this.top+w+j,line:0}:P={x:this.left+w,y:aa(o,this.top+j+w,this.bottom-t[0].height),line:0},j4(this.ctx,e.textDirection);const Q=z+w;this.legendItems.forEach((re,Z)=>{r.strokeStyle=re.fontColor||_,r.fillStyle=re.fontColor||_;const ne=r.measureText(re.text).width,he=d.textAlign(re.textAlign||(re.textAlign=l.textAlign)),De=L+A+ne;let He=P.x,ae=P.y;d.setWidth(this.width),V?Z>0&&He+De+w>this.right&&(ae=P.y+=Q,P.line++,He=P.x=aa(o,this.left+w,this.right-i[P.line])):Z>0&&ae+Q>this.bottom&&(He=P.x=He+t[P.line].width+w,P.line++,ae=P.y=aa(o,this.top+j+w,this.bottom-t[P.line].height));const le=d.x(He);F(le,ae,re),He=Y9(he,He+L+A,V?He+De:this.right,e.rtl),N(d.x(He),ae,re),V?P.x+=De+w:P.y+=Q}),q4(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,i=oo(t.font),r=ma(t.padding);if(!t.display)return;const o=cy(e.rtl,this.left,this.width),l=this.ctx,s=t.position,d=i.size/2,p=r.top+d;let _,w=this.left,M=this.width;if(this.isHorizontal())M=Math.max(...this.lineWidths),_=this.top+p,w=aa(e.align,w,this.right-M);else{const P=this.columnSizes.reduce((L,D)=>Math.max(L,D.height),0);_=p+aa(e.align,this.top,this.bottom-P-e.labels.padding-this._computeTitleHeight())}const A=aa(s,w,w+M);l.textAlign=o.textAlign(CP(s)),l.textBaseline="middle",l.strokeStyle=t.color,l.fillStyle=t.color,l.font=i.string,wg(l,t.text,A,_,i)}_computeTitleHeight(){const e=this.options.title,t=oo(e.font),i=ma(e.padding);return e.display?t.lineHeight+i.height:0}_getLegendItemAt(e,t){let i,r,o;if(ip(e,this.left,this.right)&&ip(t,this.top,this.bottom)){for(o=this.legendHitBoxes,i=0;i<o.length;++i)if(r=o[i],ip(e,r.left,r.left+r.width)&&ip(t,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const t=this.options;if(!gX(e.type,t))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,o=mX(r,i);r&&!o&&_r(t.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!o&&_r(t.onHover,[e,i,this],this)}else i&&_r(t.onClick,[e,i,this],this)}}function gX(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var _X={id:"legend",_element:yz,start(n,e,t){const i=n.legend=new yz({ctx:n.ctx,options:t,chart:n});Sc.configure(n,i,t),Sc.addBox(n,i)},stop(n){Sc.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const i=n.legend;Sc.configure(n,i,t),i.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const i=e.datasetIndex,r=t.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:i,textAlign:r,color:o}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const s=l.controller.getStyle(t?0:void 0),d=ma(s.borderWidth);return{text:e[l.index].label,fillStyle:s.backgroundColor,fontColor:o,hidden:!l.visible,lineCap:s.borderCapStyle,lineDash:s.borderDash,lineDashOffset:s.borderDashOffset,lineJoin:s.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:s.borderColor,pointStyle:i||s.pointStyle,rotation:s.rotation,textAlign:r||s.textAlign,borderRadius:0,datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class p5 extends zu{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const r=zr(i.text)?i.text.length:1;this._padding=ma(i.padding);const o=r*oo(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:i,bottom:r,right:o,options:l}=this,s=l.align;let d=0,p,_,w;return this.isHorizontal()?(_=aa(s,i,o),w=t+e,p=o-i):(l.position==="left"?(_=i+e,w=aa(s,r,t),d=Qr*-.5):(_=o-e,w=aa(s,t,r),d=Qr*.5),p=r-t),{titleX:_,titleY:w,maxWidth:p,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const i=oo(t.font),o=i.lineHeight/2+this._padding.top,{titleX:l,titleY:s,maxWidth:d,rotation:p}=this._drawArgs(o);wg(e,t.text,0,0,i,{color:t.color,maxWidth:d,rotation:p,textAlign:CP(t.align),textBaseline:"middle",translation:[l,s]})}}function yX(n,e){const t=new p5({ctx:n.ctx,options:e,chart:n});Sc.configure(n,t,e),Sc.addBox(n,t),n.titleBlock=t}var xX={id:"title",_element:p5,start(n,e,t){yX(n,t)},stop(n){const e=n.titleBlock;Sc.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const i=n.titleBlock;Sc.configure(n,i,t),i.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const tv={average(n){if(!n.length)return!1;let e,t,i=0,r=0,o=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const s=l.tooltipPosition();i+=s.x,r+=s.y,++o}}return{x:i/o,y:r/o}},nearest(n,e){if(!n.length)return!1;let t=e.x,i=e.y,r=Number.POSITIVE_INFINITY,o,l,s;for(o=0,l=n.length;o<l;++o){const d=n[o].element;if(d&&d.hasValue()){const p=d.getCenterPoint(),_=iC(e,p);_<r&&(r=_,s=d)}}if(s){const d=s.tooltipPosition();t=d.x,i=d.y}return{x:t,y:i}}};function yh(n,e){return e&&(zr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Td(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function vX(n,e){const{element:t,datasetIndex:i,index:r}=e,o=n.getDatasetMeta(i).controller,{label:l,value:s}=o.getLabelAndValue(r);return{chart:n,label:l,parsed:o.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:s,dataset:o.getDataset(),dataIndex:r,datasetIndex:i,element:t}}function xz(n,e){const t=n.chart.ctx,{body:i,footer:r,title:o}=n,{boxWidth:l,boxHeight:s}=e,d=oo(e.bodyFont),p=oo(e.titleFont),_=oo(e.footerFont),w=o.length,M=r.length,A=i.length,P=ma(e.padding);let L=P.height,D=0,z=i.reduce((V,j)=>V+j.before.length+j.lines.length+j.after.length,0);if(z+=n.beforeBody.length+n.afterBody.length,w&&(L+=w*p.lineHeight+(w-1)*e.titleSpacing+e.titleMarginBottom),z){const V=e.displayColors?Math.max(s,d.lineHeight):d.lineHeight;L+=A*V+(z-A)*d.lineHeight+(z-1)*e.bodySpacing}M&&(L+=e.footerMarginTop+M*_.lineHeight+(M-1)*e.footerSpacing);let F=0;const N=function(V){D=Math.max(D,t.measureText(V).width+F)};return t.save(),t.font=p.string,yi(n.title,N),t.font=d.string,yi(n.beforeBody.concat(n.afterBody),N),F=e.displayColors?l+2+e.boxPadding:0,yi(i,V=>{yi(V.before,N),yi(V.lines,N),yi(V.after,N)}),F=0,t.font=_.string,yi(n.footer,N),t.restore(),D+=P.width,{width:D,height:L}}function wX(n,e){const{y:t,height:i}=e;return t<i/2?"top":t>n.height-i/2?"bottom":"center"}function bX(n,e,t,i){const{x:r,width:o}=i,l=t.caretSize+t.caretPadding;if(n==="left"&&r+o+l>e.width||n==="right"&&r-o-l<0)return!0}function SX(n,e,t,i){const{x:r,width:o}=t,{width:l,chartArea:{left:s,right:d}}=n;let p="center";return i==="center"?p=r<=(s+d)/2?"left":"right":r<=o/2?p="left":r>=l-o/2&&(p="right"),bX(p,n,e,t)&&(p="center"),p}function vz(n,e,t){const i=t.yAlign||e.yAlign||wX(n,t);return{xAlign:t.xAlign||e.xAlign||SX(n,e,t,i),yAlign:i}}function MX(n,e){let{x:t,width:i}=n;return e==="right"?t-=i:e==="center"&&(t-=i/2),t}function TX(n,e,t){let{y:i,height:r}=n;return e==="top"?i+=t:e==="bottom"?i-=r+t:i-=r/2,i}function wz(n,e,t,i){const{caretSize:r,caretPadding:o,cornerRadius:l}=n,{xAlign:s,yAlign:d}=t,p=r+o,{topLeft:_,topRight:w,bottomLeft:M,bottomRight:A}=ig(l);let P=MX(e,s);const L=TX(e,d,p);return d==="center"?s==="left"?P+=p:s==="right"&&(P-=p):s==="left"?P-=Math.max(_,M)+r:s==="right"&&(P+=Math.max(w,A)+r),{x:ha(P,0,i.width-e.width),y:ha(L,0,i.height-e.height)}}function tb(n,e,t){const i=ma(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-i.right:n.x+i.left}function bz(n){return yh([],Td(n))}function EX(n,e,t){return Bp(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function Sz(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}class fC extends zu{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart||e._chart,this._chart=this.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&t.options.animation&&i.animations,o=new X4(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=EX(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:i}=t,r=i.beforeTitle.apply(this,[e]),o=i.title.apply(this,[e]),l=i.afterTitle.apply(this,[e]);let s=[];return s=yh(s,Td(r)),s=yh(s,Td(o)),s=yh(s,Td(l)),s}getBeforeBody(e,t){return bz(t.callbacks.beforeBody.apply(this,[e]))}getBody(e,t){const{callbacks:i}=t,r=[];return yi(e,o=>{const l={before:[],lines:[],after:[]},s=Sz(i,o);yh(l.before,Td(s.beforeLabel.call(this,o))),yh(l.lines,s.label.call(this,o)),yh(l.after,Td(s.afterLabel.call(this,o))),r.push(l)}),r}getAfterBody(e,t){return bz(t.callbacks.afterBody.apply(this,[e]))}getFooter(e,t){const{callbacks:i}=t,r=i.beforeFooter.apply(this,[e]),o=i.footer.apply(this,[e]),l=i.afterFooter.apply(this,[e]);let s=[];return s=yh(s,Td(r)),s=yh(s,Td(o)),s=yh(s,Td(l)),s}_createItems(e){const t=this._active,i=this.chart.data,r=[],o=[],l=[];let s=[],d,p;for(d=0,p=t.length;d<p;++d)s.push(vX(this.chart,t[d]));return e.filter&&(s=s.filter((_,w,M)=>e.filter(_,w,M,i))),e.itemSort&&(s=s.sort((_,w)=>e.itemSort(_,w,i))),yi(s,_=>{const w=Sz(e.callbacks,_);r.push(w.labelColor.call(this,_)),o.push(w.labelPointStyle.call(this,_)),l.push(w.labelTextColor.call(this,_))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=l,this.dataPoints=s,s}update(e,t){const i=this.options.setContext(this.getContext()),r=this._active;let o,l=[];if(!r.length)this.opacity!==0&&(o={opacity:0});else{const s=tv[i.position].call(this,r,this._eventPosition);l=this._createItems(i),this.title=this.getTitle(l,i),this.beforeBody=this.getBeforeBody(l,i),this.body=this.getBody(l,i),this.afterBody=this.getAfterBody(l,i),this.footer=this.getFooter(l,i);const d=this._size=xz(this,i),p=Object.assign({},s,d),_=vz(this.chart,i,p),w=wz(i,p,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,o={opacity:1,x:w.x,y:w.y,width:d.width,height:d.height,caretX:s.x,caretY:s.y}}this._tooltipItems=l,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,i,r){const o=this.getCaretPosition(e,i,r);t.lineTo(o.x1,o.y1),t.lineTo(o.x2,o.y2),t.lineTo(o.x3,o.y3)}getCaretPosition(e,t,i){const{xAlign:r,yAlign:o}=this,{caretSize:l,cornerRadius:s}=i,{topLeft:d,topRight:p,bottomLeft:_,bottomRight:w}=ig(s),{x:M,y:A}=e,{width:P,height:L}=t;let D,z,F,N,V,j;return o==="center"?(V=A+L/2,r==="left"?(D=M,z=D-l,N=V+l,j=V-l):(D=M+P,z=D+l,N=V-l,j=V+l),F=D):(r==="left"?z=M+Math.max(d,_)+l:r==="right"?z=M+P-Math.max(p,w)-l:z=this.caretX,o==="top"?(N=A,V=N-l,D=z-l,F=z+l):(N=A+L,V=N+l,D=z+l,F=z-l),j=N),{x1:D,x2:z,x3:F,y1:N,y2:V,y3:j}}drawTitle(e,t,i){const r=this.title,o=r.length;let l,s,d;if(o){const p=cy(i.rtl,this.x,this.width);for(e.x=tb(this,i.titleAlign,i),t.textAlign=p.textAlign(i.titleAlign),t.textBaseline="middle",l=oo(i.titleFont),s=i.titleSpacing,t.fillStyle=i.titleColor,t.font=l.string,d=0;d<o;++d)t.fillText(r[d],p.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+s,d+1===o&&(e.y+=i.titleMarginBottom-s)}}_drawColorBox(e,t,i,r,o){const l=this.labelColors[i],s=this.labelPointStyles[i],{boxHeight:d,boxWidth:p,boxPadding:_}=o,w=oo(o.bodyFont),M=tb(this,"left",o),A=r.x(M),P=d<w.lineHeight?(w.lineHeight-d)/2:0,L=t.y+P;if(o.usePointStyle){const D={radius:Math.min(p,d)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},z=r.leftForLtr(A,p)+p/2,F=L+d/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,aC(e,D,z,F),e.strokeStyle=l.borderColor,e.fillStyle=l.backgroundColor,aC(e,D,z,F)}else{e.lineWidth=ur(l.borderWidth)?Math.max(...Object.values(l.borderWidth)):l.borderWidth||1,e.strokeStyle=l.borderColor,e.setLineDash(l.borderDash||[]),e.lineDashOffset=l.borderDashOffset||0;const D=r.leftForLtr(A,p-_),z=r.leftForLtr(r.xPlus(A,1),p-_-2),F=ig(l.borderRadius);Object.values(F).some(N=>N!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,kv(e,{x:D,y:L,w:p,h:d,radius:F}),e.fill(),e.stroke(),e.fillStyle=l.backgroundColor,e.beginPath(),kv(e,{x:z,y:L+1,w:p-2,h:d-2,radius:F}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(D,L,p,d),e.strokeRect(D,L,p,d),e.fillStyle=l.backgroundColor,e.fillRect(z,L+1,p-2,d-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,t,i){const{body:r}=this,{bodySpacing:o,bodyAlign:l,displayColors:s,boxHeight:d,boxWidth:p,boxPadding:_}=i,w=oo(i.bodyFont);let M=w.lineHeight,A=0;const P=cy(i.rtl,this.x,this.width),L=function(Z){t.fillText(Z,P.x(e.x+A),e.y+M/2),e.y+=M+o},D=P.textAlign(l);let z,F,N,V,j,Q,re;for(t.textAlign=l,t.textBaseline="middle",t.font=w.string,e.x=tb(this,D,i),t.fillStyle=i.bodyColor,yi(this.beforeBody,L),A=s&&D!=="right"?l==="center"?p/2+_:p+2+_:0,V=0,Q=r.length;V<Q;++V){for(z=r[V],F=this.labelTextColors[V],t.fillStyle=F,yi(z.before,L),N=z.lines,s&&N.length&&(this._drawColorBox(t,e,V,P,i),M=Math.max(w.lineHeight,d)),j=0,re=N.length;j<re;++j)L(N[j]),M=w.lineHeight;yi(z.after,L)}A=0,M=w.lineHeight,yi(this.afterBody,L),e.y-=o}drawFooter(e,t,i){const r=this.footer,o=r.length;let l,s;if(o){const d=cy(i.rtl,this.x,this.width);for(e.x=tb(this,i.footerAlign,i),e.y+=i.footerMarginTop,t.textAlign=d.textAlign(i.footerAlign),t.textBaseline="middle",l=oo(i.footerFont),t.fillStyle=i.footerColor,t.font=l.string,s=0;s<o;++s)t.fillText(r[s],d.x(e.x),e.y+l.lineHeight/2),e.y+=l.lineHeight+i.footerSpacing}}drawBackground(e,t,i,r){const{xAlign:o,yAlign:l}=this,{x:s,y:d}=e,{width:p,height:_}=i,{topLeft:w,topRight:M,bottomLeft:A,bottomRight:P}=ig(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(s+w,d),l==="top"&&this.drawCaret(e,t,i,r),t.lineTo(s+p-M,d),t.quadraticCurveTo(s+p,d,s+p,d+M),l==="center"&&o==="right"&&this.drawCaret(e,t,i,r),t.lineTo(s+p,d+_-P),t.quadraticCurveTo(s+p,d+_,s+p-P,d+_),l==="bottom"&&this.drawCaret(e,t,i,r),t.lineTo(s+A,d+_),t.quadraticCurveTo(s,d+_,s,d+_-A),l==="center"&&o==="left"&&this.drawCaret(e,t,i,r),t.lineTo(s,d+w),t.quadraticCurveTo(s,d,s+w,d),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,i=this.$animations,r=i&&i.x,o=i&&i.y;if(r||o){const l=tv[e.position].call(this,this._active,this._eventPosition);if(!l)return;const s=this._size=xz(this,e),d=Object.assign({},l,this._size),p=vz(t,e,d),_=wz(e,d,p,t);(r._to!==_.x||o._to!==_.y)&&(this.xAlign=p.xAlign,this.yAlign=p.yAlign,this.width=s.width,this.height=s.height,this.caretX=l.x,this.caretY=l.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const l=ma(t.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&s&&(e.save(),e.globalAlpha=i,this.drawBackground(o,e,r,t),j4(e,t.textDirection),o.y+=l.top,this.drawTitle(o,e,t),this.drawBody(o,e,t),this.drawFooter(o,e,t),q4(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const i=this._active,r=e.map(({datasetIndex:s,index:d})=>{const p=this.chart.getDatasetMeta(s);if(!p)throw new Error("Cannot find a dataset at index "+s);return{datasetIndex:s,element:p.data[d],index:d}}),o=!XS(i,r),l=this._positionChanged(r,t);(o||l)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,i=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],l=this._getActiveElements(e,o,t,i),s=this._positionChanged(l,e),d=t||!XS(l,o)||s;return d&&(this._active=l,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,i,r){const o=this.options;if(e.type==="mouseout")return[];if(!r)return t;const l=this.chart.getElementsAtEventForMode(e,o.mode,o,i);return o.reverse&&l.reverse(),l}_positionChanged(e,t){const{caretX:i,caretY:r,options:o}=this,l=tv[o.position].call(this,e,t);return l!==!1&&(i!==l.x||r!==l.y)}}fC.positioners=tv;var AX={id:"tooltip",_element:fC,positioners:tv,afterInit(n,e,t){t&&(n.tooltip=new fC({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",t)===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:ja,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,i=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return t[e.dataIndex]}return""},afterTitle:ja,beforeBody:ja,beforeLabel:ja,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return xr(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ja,afterBody:ja,beforeFooter:ja,footer:ja,afterFooter:ja}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const CX=(n,e,t,i)=>(typeof e=="string"?(t=n.push(e)-1,i.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function IX(n,e,t,i){const r=n.indexOf(e);if(r===-1)return CX(n,e,t,i);const o=n.lastIndexOf(e);return r!==o?t:r}const PX=(n,e)=>n===null?null:ha(Math.round(n),0,e);class nM extends Ig{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const i=this.getLabels();for(const{index:r,label:o}of t)i[r]===o&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(xr(e))return null;const i=this.getLabels();return t=isFinite(t)&&i[t]===e?t:IX(i,e,Mi(t,e),this._addedLabels),PX(t,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),t||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,t=this.max,i=this.options.offset,r=[];let o=this.getLabels();o=e===0&&t===o.length-1?o:o.slice(e,t+1),this._valueRange=Math.max(o.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let l=e;l<=t;l++)r.push({value:l});return r}getLabelForValue(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}nM.id="category";nM.defaults={ticks:{callback:nM.prototype.getLabelForValue}};function LX(n,e){const t=[],{bounds:r,step:o,min:l,max:s,precision:d,count:p,maxTicks:_,maxDigits:w,includeBounds:M}=n,A=o||1,P=_-1,{min:L,max:D}=e,z=!xr(l),F=!xr(s),N=!xr(p),V=(D-L)/(w+1);let j=ER((D-L)/P/A)*A,Q,re,Z,ne;if(j<1e-14&&!z&&!F)return[{value:L},{value:D}];ne=Math.ceil(D/j)-Math.floor(L/j),ne>P&&(j=ER(ne*j/P/A)*A),xr(d)||(Q=Math.pow(10,d),j=Math.ceil(j*Q)/Q),r==="ticks"?(re=Math.floor(L/j)*j,Z=Math.ceil(D/j)*j):(re=L,Z=D),z&&F&&o&&W9((s-l)/o,j/1e3)?(ne=Math.round(Math.min((s-l)/j,_)),j=(s-l)/ne,re=l,Z=s):N?(re=z?l:re,Z=F?s:Z,ne=p-1,j=(Z-re)/ne):(ne=(Z-re)/j,Jx(ne,Math.round(ne),j/1e3)?ne=Math.round(ne):ne=Math.ceil(ne));const he=Math.max(AR(j),AR(re));Q=Math.pow(10,xr(d)?he:d),re=Math.round(re*Q)/Q,Z=Math.round(Z*Q)/Q;let De=0;for(z&&(M&&re!==l?(t.push({value:l}),re<l&&De++,Jx(Math.round((re+De*j)*Q)/Q,l,Mz(l,V,n))&&De++):re<l&&De++);De<ne;++De)t.push({value:Math.round((re+De*j)*Q)/Q});return F&&M&&Z!==s?t.length&&Jx(t[t.length-1].value,s,Mz(s,V,n))?t[t.length-1].value=s:t.push({value:s}):(!F||Z===s)&&t.push({value:Z}),t}function Mz(n,e,{horizontal:t,minRotation:i}){const r=Tu(i),o=(t?Math.sin(r):Math.cos(r))||.001,l=.75*e*(""+n).length;return Math.min(e/o,l)}class iM extends Ig{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return xr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:r,max:o}=this;const l=d=>r=t?r:d,s=d=>o=i?o:d;if(e){const d=Th(r),p=Th(o);d<0&&p<0?s(0):d>0&&p>0&&l(0)}if(r===o){let d=1;(o>=Number.MAX_SAFE_INTEGER||r<=Number.MIN_SAFE_INTEGER)&&(d=Math.abs(o*.05)),s(o+d),e||l(r-d)}this.min=r,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},o=this._range||this,l=LX(r,o);return e.bounds==="ticks"&&M4(l,this,"value"),e.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}configure(){const e=this.ticks;let t=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-t)/Math.max(e.length-1,1)/2;t-=r,i+=r}this._startValue=t,this._endValue=i,this._valueRange=i-t}getLabelForValue(e){return l1(e,this.chart.options.locale,this.options.ticks.format)}}class HP extends iM{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=ao(e)?e:0,this.max=ao(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,i=Tu(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,o.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}HP.id="linear";HP.defaults={ticks:{callback:GM.formatters.numeric}};function Tz(n){return n/Math.pow(10,Math.floor(vc(n)))===1}function kX(n,e){const t=Math.floor(vc(e.max)),i=Math.ceil(e.max/Math.pow(10,t)),r=[];let o=dc(n.min,Math.pow(10,Math.floor(vc(e.min)))),l=Math.floor(vc(o)),s=Math.floor(o/Math.pow(10,l)),d=l<0?Math.pow(10,Math.abs(l)):1;do r.push({value:o,major:Tz(o)}),++s,s===10&&(s=1,++l,d=l>=0?1:d),o=Math.round(s*Math.pow(10,l)*d)/d;while(l<t||l===t&&s<i);const p=dc(n.max,o);return r.push({value:p,major:Tz(o)}),r}class m5 extends Ig{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const i=iM.prototype.parse.apply(this,[e,t]);if(i===0){this._zero=!0;return}return ao(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=ao(e)?Math.max(0,e):null,this.max=ao(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let i=this.min,r=this.max;const o=d=>i=e?i:d,l=d=>r=t?r:d,s=(d,p)=>Math.pow(10,Math.floor(vc(d))+p);i===r&&(i<=0?(o(1),l(10)):(o(s(i,-1)),l(s(r,1)))),i<=0&&o(s(r,-1)),r<=0&&l(s(i,1)),this._zero&&this.min!==this._suggestedMin&&i===s(this.min,0)&&o(s(i,-1)),this.min=i,this.max=r}buildTicks(){const e=this.options,t={min:this._userMin,max:this._userMax},i=kX(t,this);return e.bounds==="ticks"&&M4(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":l1(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=vc(e),this._valueRange=vc(this.max)-vc(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(vc(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}m5.id="logarithmic";m5.defaults={ticks:{callback:GM.formatters.logarithmic,major:{enabled:!0}}};function pC(n){const e=n.ticks;if(e.display&&n.display){const t=ma(e.backdropPadding);return Mi(e.font&&e.font.size,Fi.font.size)+t.height}return 0}function DX(n,e,t){return t=zr(t)?t:[t],{w:b7(n,e.string,t),h:t.length*e.lineHeight}}function Ez(n,e,t,i,r){return n===i||n===r?{start:e-t/2,end:e+t/2}:n<i||n>r?{start:e-t,end:e}:{start:e,end:e+t}}function RX(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},t=Object.assign({},e),i=[],r=[],o=n._pointLabels.length,l=n.options.pointLabels,s=l.centerPointLabels?Qr/o:0;for(let d=0;d<o;d++){const p=l.setContext(n.getPointLabelContext(d));r[d]=p.padding;const _=n.getPointPosition(d,n.drawingArea+r[d],s),w=oo(p.font),M=DX(n.ctx,w,n._pointLabels[d]);i[d]=M;const A=vu(n.getIndexAngle(d)+s),P=Math.round(AP(A)),L=Ez(P,_.x,M.w,0,180),D=Ez(P,_.y,M.h,90,270);zX(t,e,A,L,D)}n.setCenterPoint(e.l-t.l,t.r-e.r,e.t-t.t,t.b-e.b),n._pointLabelItems=OX(n,i,r)}function zX(n,e,t,i,r){const o=Math.abs(Math.sin(t)),l=Math.abs(Math.cos(t));let s=0,d=0;i.start<e.l?(s=(e.l-i.start)/o,n.l=Math.min(n.l,e.l-s)):i.end>e.r&&(s=(i.end-e.r)/o,n.r=Math.max(n.r,e.r+s)),r.start<e.t?(d=(e.t-r.start)/l,n.t=Math.min(n.t,e.t-d)):r.end>e.b&&(d=(r.end-e.b)/l,n.b=Math.max(n.b,e.b+d))}function OX(n,e,t){const i=[],r=n._pointLabels.length,o=n.options,l=pC(o)/2,s=n.drawingArea,d=o.pointLabels.centerPointLabels?Qr/r:0;for(let p=0;p<r;p++){const _=n.getPointPosition(p,s+l+t[p],d),w=Math.round(AP(vu(_.angle+Ms))),M=e[p],A=NX(_.y,M.h,w),P=FX(w),L=BX(_.x,M.w,P);i.push({x:_.x,y:A,textAlign:P,left:L,top:A,right:L+M.w,bottom:A+M.h})}return i}function FX(n){return n===0||n===180?"center":n<180?"left":"right"}function BX(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function NX(n,e,t){return t===90||t===270?n-=e/2:(t>270||t<90)&&(n-=e),n}function UX(n,e){const{ctx:t,options:{pointLabels:i}}=n;for(let r=e-1;r>=0;r--){const o=i.setContext(n.getPointLabelContext(r)),l=oo(o.font),{x:s,y:d,textAlign:p,left:_,top:w,right:M,bottom:A}=n._pointLabelItems[r],{backdropColor:P}=o;if(!xr(P)){const L=ig(o.borderRadius),D=ma(o.backdropPadding);t.fillStyle=P;const z=_-D.left,F=w-D.top,N=M-_+D.width,V=A-w+D.height;Object.values(L).some(j=>j!==0)?(t.beginPath(),kv(t,{x:z,y:F,w:N,h:V,radius:L}),t.fill()):t.fillRect(z,F,N,V)}wg(t,n._pointLabels[r],s,d+l.lineHeight/2,l,{color:o.color,textAlign:p,textBaseline:"middle"})}}function g5(n,e,t,i){const{ctx:r}=n;if(t)r.arc(n.xCenter,n.yCenter,e,0,Or);else{let o=n.getPointPosition(0,e);r.moveTo(o.x,o.y);for(let l=1;l<i;l++)o=n.getPointPosition(l,e),r.lineTo(o.x,o.y)}}function VX(n,e,t,i){const r=n.ctx,o=e.circular,{color:l,lineWidth:s}=e;!o&&!i||!l||!s||t<0||(r.save(),r.strokeStyle=l,r.lineWidth=s,r.setLineDash(e.borderDash),r.lineDashOffset=e.borderDashOffset,r.beginPath(),g5(n,t,o,i),r.closePath(),r.stroke(),r.restore())}function GX(n,e,t){return Bp(n,{label:t,index:e,type:"pointLabel"})}class HM extends iM{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=ma(pC(this.options)/2),t=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(t,i)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=ao(e)&&!isNaN(e)?e:0,this.max=ao(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/pC(this.options))}generateTickLabels(e){iM.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((t,i)=>{const r=_r(this.options.pointLabels.callback,[t,i],this);return r||r===0?r:""}).filter((t,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?RX(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,i,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,i,r))}getIndexAngle(e){const t=Or/(this._pointLabels.length||1),i=this.options.startAngle||0;return vu(e*t+Tu(i))}getDistanceFromCenterForValue(e){if(xr(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(xr(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const i=t[e];return GX(this.getContext(),e,i)}}getPointPosition(e,t,i=0){const r=this.getIndexAngle(e)-Ms+i;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:i,right:r,bottom:o}=this._pointLabelItems[e];return{left:t,top:i,right:r,bottom:o}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),g5(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:i,grid:r}=t,o=this._pointLabels.length;let l,s,d;if(t.pointLabels.display&&UX(this,o),r.display&&this.ticks.forEach((p,_)=>{if(_!==0){s=this.getDistanceFromCenterForValue(p.value);const w=r.setContext(this.getContext(_-1));VX(this,w,s,o)}}),i.display){for(e.save(),l=o-1;l>=0;l--){const p=i.setContext(this.getPointLabelContext(l)),{color:_,lineWidth:w}=p;!w||!_||(e.lineWidth=w,e.strokeStyle=_,e.setLineDash(p.borderDash),e.lineDashOffset=p.borderDashOffset,s=this.getDistanceFromCenterForValue(t.ticks.reverse?this.min:this.max),d=this.getPointPosition(l,s),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(d.x,d.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,i=t.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let o,l;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((s,d)=>{if(d===0&&!t.reverse)return;const p=i.setContext(this.getContext(d)),_=oo(p.font);if(o=this.getDistanceFromCenterForValue(this.ticks[d].value),p.showLabelBackdrop){e.font=_.string,l=e.measureText(s.label).width,e.fillStyle=p.backdropColor;const w=ma(p.backdropPadding);e.fillRect(-l/2-w.left,-o-_.size/2-w.top,l+w.width,_.size+w.height)}wg(e,s.label,0,-o,_,{color:p.color})}),e.restore()}drawTitle(){}}HM.id="radialLinear";HM.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:GM.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(n){return n},padding:5,centerPointLabels:!1}};HM.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};HM.descriptors={angleLines:{_fallback:"grid"}};const jM={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Za=Object.keys(jM);function WX(n,e){return n-e}function Az(n,e){if(xr(e))return null;const t=n._adapter,{parser:i,round:r,isoWeekday:o}=n._parseOpts;let l=e;return typeof i=="function"&&(l=i(l)),ao(l)||(l=typeof i=="string"?t.parse(l,i):t.parse(l)),l===null?null:(r&&(l=r==="week"&&(xg(o)||o===!0)?t.startOf(l,"isoWeek",o):t.startOf(l,r)),+l)}function Cz(n,e,t,i){const r=Za.length;for(let o=Za.indexOf(n);o<r-1;++o){const l=jM[Za[o]],s=l.steps?l.steps:Number.MAX_SAFE_INTEGER;if(l.common&&Math.ceil((t-e)/(s*l.size))<=i)return Za[o]}return Za[r-1]}function HX(n,e,t,i,r){for(let o=Za.length-1;o>=Za.indexOf(t);o--){const l=Za[o];if(jM[l].common&&n._adapter.diff(r,i,l)>=e-1)return l}return Za[t?Za.indexOf(t):0]}function jX(n){for(let e=Za.indexOf(n)+1,t=Za.length;e<t;++e)if(jM[Za[e]].common)return Za[e]}function Iz(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:r}=NM(t,e),o=t[i]>=e?t[i]:t[r];n[o]=!0}}function qX(n,e,t,i){const r=n._adapter,o=+r.startOf(e[0].value,i),l=e[e.length-1].value;let s,d;for(s=o;s<=l;s=+r.add(s,1,i))d=t[s],d>=0&&(e[d].major=!0);return e}function Pz(n,e,t){const i=[],r={},o=e.length;let l,s;for(l=0;l<o;++l)s=e[l],r[s]=l,i.push({value:s,major:!1});return o===0||!t?i:qX(n,i,r,t)}class d1 extends Ig{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t){const i=e.time||(e.time={}),r=this._adapter=new Q4._date(e.adapters.date);r.init(t),Kx(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:Az(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,i=e.time.unit||"day";let{min:r,max:o,minDefined:l,maxDefined:s}=this.getUserBounds();function d(p){!l&&!isNaN(p.min)&&(r=Math.min(r,p.min)),!s&&!isNaN(p.max)&&(o=Math.max(o,p.max))}(!l||!s)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),r=ao(r)&&!isNaN(r)?r:+t.startOf(Date.now(),i),o=ao(o)&&!isNaN(o)?o:+t.endOf(Date.now(),i)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],i=e[e.length-1]),{min:t,max:i}}buildTicks(){const e=this.options,t=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,l=this.max,s=Z9(r,o,l);return this._unit=t.unit||(i.autoSkip?Cz(t.minUnit,this.min,this.max,this._getLabelCapacity(o)):HX(this,s.length,t.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:jX(this._unit),this.initOffsets(r),e.reverse&&s.reverse(),Pz(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e){let t=0,i=0,r,o;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?i=o:i=(o-this.getDecimalForValue(e[e.length-2]))/2);const l=e.length<3?.5:.25;t=ha(t,0,l),i=ha(i,0,l),this._offsets={start:t,end:i,factor:1/(t+1+i)}}_generate(){const e=this._adapter,t=this.min,i=this.max,r=this.options,o=r.time,l=o.unit||Cz(o.minUnit,t,i,this._getLabelCapacity(t)),s=Mi(o.stepSize,1),d=l==="week"?o.isoWeekday:!1,p=xg(d)||d===!0,_={};let w=t,M,A;if(p&&(w=+e.startOf(w,"isoWeek",d)),w=+e.startOf(w,p?"day":l),e.diff(i,t,l)>1e5*s)throw new Error(t+" and "+i+" are too far apart with stepSize of "+s+" "+l);const P=r.ticks.source==="data"&&this.getDataTimestamps();for(M=w,A=0;M<i;M=+e.add(M,s,l),A++)Iz(_,M,P);return(M===i||r.bounds==="ticks"||A===1)&&Iz(_,M,P),Object.keys(_).sort((L,D)=>L-D).map(L=>+L)}getLabelForValue(e){const t=this._adapter,i=this.options.time;return i.tooltipFormat?t.format(e,i.tooltipFormat):t.format(e,i.displayFormats.datetime)}_tickFormatFunction(e,t,i,r){const o=this.options,l=o.time.displayFormats,s=this._unit,d=this._majorUnit,p=s&&l[s],_=d&&l[d],w=i[t],M=d&&_&&w&&w.major,A=this._adapter.format(e,r||(M?_:p)),P=o.ticks.callback;return P?_r(P,[A,t,i],this):A}generateTickLabels(e){let t,i,r;for(t=0,i=e.length;t<i;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+i)*t.factor)}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,i=this.ctx.measureText(e).width,r=Tu(this.isHorizontal()?t.maxRotation:t.minRotation),o=Math.cos(r),l=Math.sin(r),s=this._resolveTickFontOptions(0).size;return{w:i*o+s*l,h:i*l+s*o}}_getLabelCapacity(e){const t=this.options.time,i=t.displayFormats,r=i[t.unit]||i.millisecond,o=this._tickFormatFunction(e,0,Pz(this,[e],this._majorUnit),r),l=this._getLabelSize(o),s=Math.floor(this.isHorizontal()?this.width/l.w:this.height/l.h)-1;return s>0?s:1}getDataTimestamps(){let e=this._cache.data||[],t,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,i=r.length;t<i;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,i;if(e.length)return e;const r=this.getLabels();for(t=0,i=r.length;t<i;++t)e.push(Az(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return A4(e.sort(WX))}}d1.id="time";d1.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function nb(n,e,t){let i=0,r=n.length-1,o,l,s,d;t?(e>=n[i].pos&&e<=n[r].pos&&({lo:i,hi:r}=Xm(n,"pos",e)),{pos:o,time:s}=n[i],{pos:l,time:d}=n[r]):(e>=n[i].time&&e<=n[r].time&&({lo:i,hi:r}=Xm(n,"time",e)),{time:o,pos:s}=n[i],{time:l,pos:d}=n[r]);const p=l-o;return p?s+(d-s)*(e-o)/p:s}class _5 extends d1{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=nb(t,this.min),this._tableRange=nb(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:i}=this,r=[],o=[];let l,s,d,p,_;for(l=0,s=e.length;l<s;++l)p=e[l],p>=t&&p<=i&&r.push(p);if(r.length<2)return[{time:t,pos:0},{time:i,pos:1}];for(l=0,s=r.length;l<s;++l)_=r[l+1],d=r[l-1],p=r[l],Math.round((_+d)/2)!==p&&o.push({time:p,pos:l/(s-1)});return o}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),i=this.getLabelTimestamps();return t.length&&i.length?e=this.normalize(t.concat(i)):e=t.length?t:i,e=this._cache.all=e,e}getDecimalForValue(e){return(nb(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,i=this.getDecimalForPixel(e)/t.factor-t.end;return nb(this._table,i*this._tableRange+this._minPos,!0)}}_5.id="timeseries";_5.defaults=d1.defaults;const y5="label";function Lz(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function ZX(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function x5(n,e){n.labels=e}function v5(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:y5;const i=[];n.datasets=e.map(r=>{const o=n.datasets.find(l=>l[t]===r[t]);return!o||!r.data||i.includes(o)?{...r}:(i.push(o),Object.assign(o,r),o)})}function XX(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y5;const t={labels:[],datasets:[]};return x5(t,n.labels),v5(t,n.datasets,e),t}function $X(n,e){const{height:t=150,width:i=300,redraw:r=!1,datasetIdKey:o,type:l,data:s,options:d,plugins:p=[],fallbackContent:_,updateMode:w,...M}=n,A=$t.useRef(null),P=$t.useRef(),L=()=>{A.current&&(P.current=new Yy(A.current,{type:l,data:XX(s,o),options:d&&{...d},plugins:p}),Lz(e,P.current))},D=()=>{Lz(e,null),P.current&&(P.current.destroy(),P.current=null)};return $t.useEffect(()=>{!r&&P.current&&d&&ZX(P.current,d)},[r,d]),$t.useEffect(()=>{!r&&P.current&&x5(P.current.config.data,s.labels)},[r,s.labels]),$t.useEffect(()=>{!r&&P.current&&s.datasets&&v5(P.current.config.data,s.datasets,o)},[r,s.datasets]),$t.useEffect(()=>{P.current&&(r?(D(),setTimeout(L)):P.current.update(w))},[r,d,s.labels,s.datasets,w]),$t.useEffect(()=>{P.current&&(D(),setTimeout(L))},[l]),$t.useEffect(()=>(L(),()=>D()),[]),zI.createElement("canvas",Object.assign({ref:A,role:"img",height:t,width:i},M),_)}const YX=$t.forwardRef($X);function KX(n,e){return Yy.register(e),$t.forwardRef((t,i)=>zI.createElement(YX,Object.assign({},t,{ref:i,type:n})))}const JX=KX("line",VM);class Pg extends Error{}class QX extends Pg{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class e$ extends Pg{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class t$ extends Pg{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class Fx extends Pg{}class w5 extends Pg{constructor(e){super(`Invalid unit ${e}`)}}class xc extends Pg{}class Ff extends Pg{constructor(){super("Zone is an abstract class")}}const En="numeric",ku="short",zl="long",rM={year:En,month:En,day:En},b5={year:En,month:ku,day:En},n$={year:En,month:ku,day:En,weekday:ku},S5={year:En,month:zl,day:En},M5={year:En,month:zl,day:En,weekday:zl},T5={hour:En,minute:En},E5={hour:En,minute:En,second:En},A5={hour:En,minute:En,second:En,timeZoneName:ku},C5={hour:En,minute:En,second:En,timeZoneName:zl},I5={hour:En,minute:En,hourCycle:"h23"},P5={hour:En,minute:En,second:En,hourCycle:"h23"},L5={hour:En,minute:En,second:En,hourCycle:"h23",timeZoneName:ku},k5={hour:En,minute:En,second:En,hourCycle:"h23",timeZoneName:zl},D5={year:En,month:En,day:En,hour:En,minute:En},R5={year:En,month:En,day:En,hour:En,minute:En,second:En},z5={year:En,month:ku,day:En,hour:En,minute:En},O5={year:En,month:ku,day:En,hour:En,minute:En,second:En},i$={year:En,month:ku,day:En,weekday:ku,hour:En,minute:En},F5={year:En,month:zl,day:En,hour:En,minute:En,timeZoneName:ku},B5={year:En,month:zl,day:En,hour:En,minute:En,second:En,timeZoneName:ku},N5={year:En,month:zl,day:En,weekday:zl,hour:En,minute:En,timeZoneName:zl},U5={year:En,month:zl,day:En,weekday:zl,hour:En,minute:En,second:En,timeZoneName:zl};class f1{get type(){throw new Ff}get name(){throw new Ff}get ianaName(){return this.name}get isUniversal(){throw new Ff}offsetName(e,t){throw new Ff}formatOffset(e,t){throw new Ff}offset(e){throw new Ff}equals(e){throw new Ff}get isValid(){throw new Ff}}let e2=null;class qM extends f1{static get instance(){return e2===null&&(e2=new qM),e2}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return G5(e,t,i)}formatOffset(e,t){return iv(this.offset(e),t)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let hS={};function r$(n){return hS[n]||(hS[n]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:n,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),hS[n]}const s$={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function o$(n,e){const t=n.format(e).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(t),[,r,o,l,s,d,p,_]=i;return[l,r,o,s,d,p,_]}function a$(n,e){const t=n.formatToParts(e),i=[];for(let r=0;r<t.length;r++){const{type:o,value:l}=t[r],s=s$[o];o==="era"?i[s]=l:Ji(s)||(i[s]=parseInt(l,10))}return i}let ib={};class Xd extends f1{static create(e){return ib[e]||(ib[e]=new Xd(e)),ib[e]}static resetCache(){ib={},hS={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=Xd.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:t,locale:i}){return G5(e,t,i,this.name)}formatOffset(e,t){return iv(this.offset(e),t)}offset(e){const t=new Date(e);if(isNaN(t))return NaN;const i=r$(this.name);let[r,o,l,s,d,p,_]=i.formatToParts?a$(i,t):o$(i,t);s==="BC"&&(r=-Math.abs(r)+1);const M=ZP({year:r,month:o,day:l,hour:d===24?0:d,minute:p,second:_,millisecond:0});let A=+t;const P=A%1e3;return A-=P>=0?P:1e3+P,(M-A)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let kz={};function l$(n,e={}){const t=JSON.stringify([n,e]);let i=kz[t];return i||(i=new Intl.ListFormat(n,e),kz[t]=i),i}let mC={};function gC(n,e={}){const t=JSON.stringify([n,e]);let i=mC[t];return i||(i=new Intl.DateTimeFormat(n,e),mC[t]=i),i}let _C={};function c$(n,e={}){const t=JSON.stringify([n,e]);let i=_C[t];return i||(i=new Intl.NumberFormat(n,e),_C[t]=i),i}let yC={};function u$(n,e={}){const{base:t,...i}=e,r=JSON.stringify([n,i]);let o=yC[r];return o||(o=new Intl.RelativeTimeFormat(n,e),yC[r]=o),o}let Bx=null;function h$(){return Bx||(Bx=new Intl.DateTimeFormat().resolvedOptions().locale,Bx)}function d$(n){const e=n.indexOf("-x-");e!==-1&&(n=n.substring(0,e));const t=n.indexOf("-u-");if(t===-1)return[n];{let i,r;try{i=gC(n).resolvedOptions(),r=n}catch{const d=n.substring(0,t);i=gC(d).resolvedOptions(),r=d}const{numberingSystem:o,calendar:l}=i;return[r,o,l]}}function f$(n,e,t){return(t||e)&&(n.includes("-u-")||(n+="-u"),t&&(n+=`-ca-${t}`),e&&(n+=`-nu-${e}`)),n}function p$(n){const e=[];for(let t=1;t<=12;t++){const i=ti.utc(2016,t,1);e.push(n(i))}return e}function m$(n){const e=[];for(let t=1;t<=7;t++){const i=ti.utc(2016,11,13+t);e.push(n(i))}return e}function rb(n,e,t,i,r){const o=n.listingMode(t);return o==="error"?null:o==="en"?i(e):r(e)}function g$(n){return n.numberingSystem&&n.numberingSystem!=="latn"?!1:n.numberingSystem==="latn"||!n.locale||n.locale.startsWith("en")||new Intl.DateTimeFormat(n.intl).resolvedOptions().numberingSystem==="latn"}class _${constructor(e,t,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:r,floor:o,...l}=i;if(!t||Object.keys(l).length>0){const s={useGrouping:!1,...i};i.padTo>0&&(s.minimumIntegerDigits=i.padTo),this.inf=c$(e,s)}}format(e){if(this.inf){const t=this.floor?Math.floor(e):e;return this.inf.format(t)}else{const t=this.floor?Math.floor(e):qP(e,3);return Ws(t,this.padTo)}}}class y${constructor(e,t,i){this.opts=i;let r;if(e.zone.isUniversal){const l=-1*(e.offset/60),s=l>=0?`Etc/GMT+${l}`:`Etc/GMT${l}`;e.offset!==0&&Xd.create(s).valid?(r=s,this.dt=e):(r="UTC",i.timeZoneName?this.dt=e:this.dt=e.offset===0?e:ti.fromMillis(e.ts+e.offset*60*1e3))}else e.zone.type==="system"?this.dt=e:(this.dt=e,r=e.zone.name);const o={...this.opts};o.timeZone=o.timeZone||r,this.dtf=gC(t,o)}format(){return this.dtf.format(this.dt.toJSDate())}formatToParts(){return this.dtf.formatToParts(this.dt.toJSDate())}resolvedOptions(){return this.dtf.resolvedOptions()}}class x${constructor(e,t,i){this.opts={style:"long",...i},!t&&V5()&&(this.rtf=u$(e,i))}format(e,t){return this.rtf?this.rtf.format(e,t):O$(t,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,t){return this.rtf?this.rtf.formatToParts(e,t):[]}}class jr{static fromOpts(e){return jr.create(e.locale,e.numberingSystem,e.outputCalendar,e.defaultToEN)}static create(e,t,i,r=!1){const o=e||Gs.defaultLocale,l=o||(r?"en-US":h$()),s=t||Gs.defaultNumberingSystem,d=i||Gs.defaultOutputCalendar;return new jr(l,s,d,o)}static resetCache(){Bx=null,mC={},_C={},yC={}}static fromObject({locale:e,numberingSystem:t,outputCalendar:i}={}){return jr.create(e,t,i)}constructor(e,t,i,r){const[o,l,s]=d$(e);this.locale=o,this.numberingSystem=t||l||null,this.outputCalendar=i||s||null,this.intl=f$(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=g$(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),t=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&t?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:jr.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,t=!1,i=!0){return rb(this,e,i,j5,()=>{const r=t?{month:e,day:"numeric"}:{month:e},o=t?"format":"standalone";return this.monthsCache[o][e]||(this.monthsCache[o][e]=p$(l=>this.extract(l,r,"month"))),this.monthsCache[o][e]})}weekdays(e,t=!1,i=!0){return rb(this,e,i,X5,()=>{const r=t?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},o=t?"format":"standalone";return this.weekdaysCache[o][e]||(this.weekdaysCache[o][e]=m$(l=>this.extract(l,r,"weekday"))),this.weekdaysCache[o][e]})}meridiems(e=!0){return rb(this,void 0,e,()=>$5,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[ti.utc(2016,11,13,9),ti.utc(2016,11,13,19)].map(i=>this.extract(i,t,"dayperiod"))}return this.meridiemCache})}eras(e,t=!0){return rb(this,e,t,Y5,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[ti.utc(-40,1,1),ti.utc(2017,1,1)].map(r=>this.extract(r,i,"era"))),this.eraCache[e]})}extract(e,t,i){const r=this.dtFormatter(e,t),o=r.formatToParts(),l=o.find(s=>s.type.toLowerCase()===i);return l?l.value:null}numberFormatter(e={}){return new _$(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,t={}){return new y$(e,this.intl,t)}relFormatter(e={}){return new x$(this.intl,this.isEnglish(),e)}listFormatter(e={}){return l$(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}}let t2=null;class Ia extends f1{static get utcInstance(){return t2===null&&(t2=new Ia(0)),t2}static instance(e){return e===0?Ia.utcInstance:new Ia(e)}static parseSpecifier(e){if(e){const t=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(t)return new Ia(XM(t[1],t[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${iv(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${iv(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,t){return iv(this.fixed,t)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class v$ extends f1{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function ep(n,e){if(Ji(n)||n===null)return e;if(n instanceof f1)return n;if(w$(n)){const t=n.toLowerCase();return t==="default"?e:t==="local"||t==="system"?qM.instance:t==="utc"||t==="gmt"?Ia.utcInstance:Ia.parseSpecifier(t)||Xd.create(n)}else return sg(n)?Ia.instance(n):typeof n=="object"&&n.offset&&typeof n.offset=="number"?n:new v$(n)}let Dz=()=>Date.now(),Rz="system",zz=null,Oz=null,Fz=null,Bz=60,Nz;class Gs{static get now(){return Dz}static set now(e){Dz=e}static set defaultZone(e){Rz=e}static get defaultZone(){return ep(Rz,qM.instance)}static get defaultLocale(){return zz}static set defaultLocale(e){zz=e}static get defaultNumberingSystem(){return Oz}static set defaultNumberingSystem(e){Oz=e}static get defaultOutputCalendar(){return Fz}static set defaultOutputCalendar(e){Fz=e}static get twoDigitCutoffYear(){return Bz}static set twoDigitCutoffYear(e){Bz=e%100}static get throwOnInvalid(){return Nz}static set throwOnInvalid(e){Nz=e}static resetCaches(){jr.resetCache(),Xd.resetCache()}}function Ji(n){return typeof n>"u"}function sg(n){return typeof n=="number"}function ZM(n){return typeof n=="number"&&n%1===0}function w$(n){return typeof n=="string"}function b$(n){return Object.prototype.toString.call(n)==="[object Date]"}function V5(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function S$(n){return Array.isArray(n)?n:[n]}function Uz(n,e,t){if(n.length!==0)return n.reduce((i,r)=>{const o=[e(r),r];return i&&t(i[0],o[0])===i[0]?i:o},null)[1]}function M$(n,e){return e.reduce((t,i)=>(t[i]=n[i],t),{})}function Cy(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Od(n,e,t){return ZM(n)&&n>=e&&n<=t}function T$(n,e){return n-e*Math.floor(n/e)}function Ws(n,e=2){const t=n<0;let i;return t?i="-"+(""+-n).padStart(e,"0"):i=(""+n).padStart(e,"0"),i}function $f(n){if(!(Ji(n)||n===null||n===""))return parseInt(n,10)}function Mm(n){if(!(Ji(n)||n===null||n===""))return parseFloat(n)}function jP(n){if(!(Ji(n)||n===null||n==="")){const e=parseFloat("0."+n)*1e3;return Math.floor(e)}}function qP(n,e,t=!1){const i=10**e;return(t?Math.trunc:Math.round)(n*i)/i}function p1(n){return n%4===0&&(n%100!==0||n%400===0)}function nv(n){return p1(n)?366:365}function sM(n,e){const t=T$(e-1,12)+1,i=n+(e-t)/12;return t===2?p1(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][t-1]}function ZP(n){let e=Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,n.second,n.millisecond);return n.year<100&&n.year>=0&&(e=new Date(e),e.setUTCFullYear(e.getUTCFullYear()-1900)),+e}function oM(n){const e=(n+Math.floor(n/4)-Math.floor(n/100)+Math.floor(n/400))%7,t=n-1,i=(t+Math.floor(t/4)-Math.floor(t/100)+Math.floor(t/400))%7;return e===4||i===3?53:52}function xC(n){return n>99?n:n>Gs.twoDigitCutoffYear?1900+n:2e3+n}function G5(n,e,t,i=null){const r=new Date(n),o={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(o.timeZone=i);const l={timeZoneName:e,...o},s=new Intl.DateTimeFormat(t,l).formatToParts(r).find(d=>d.type.toLowerCase()==="timezonename");return s?s.value:null}function XM(n,e){let t=parseInt(n,10);Number.isNaN(t)&&(t=0);const i=parseInt(e,10)||0,r=t<0||Object.is(t,-0)?-i:i;return t*60+r}function W5(n){const e=Number(n);if(typeof n=="boolean"||n===""||Number.isNaN(e))throw new xc(`Invalid unit value ${n}`);return e}function aM(n,e){const t={};for(const i in n)if(Cy(n,i)){const r=n[i];if(r==null)continue;t[e(i)]=W5(r)}return t}function iv(n,e){const t=Math.trunc(Math.abs(n/60)),i=Math.trunc(Math.abs(n%60)),r=n>=0?"+":"-";switch(e){case"short":return`${r}${Ws(t,2)}:${Ws(i,2)}`;case"narrow":return`${r}${t}${i>0?`:${i}`:""}`;case"techie":return`${r}${Ws(t,2)}${Ws(i,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function $M(n){return M$(n,["hour","minute","second","millisecond"])}const E$=["January","February","March","April","May","June","July","August","September","October","November","December"],H5=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],A$=["J","F","M","A","M","J","J","A","S","O","N","D"];function j5(n){switch(n){case"narrow":return[...A$];case"short":return[...H5];case"long":return[...E$];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const q5=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Z5=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],C$=["M","T","W","T","F","S","S"];function X5(n){switch(n){case"narrow":return[...C$];case"short":return[...Z5];case"long":return[...q5];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const $5=["AM","PM"],I$=["Before Christ","Anno Domini"],P$=["BC","AD"],L$=["B","A"];function Y5(n){switch(n){case"narrow":return[...L$];case"short":return[...P$];case"long":return[...I$];default:return null}}function k$(n){return $5[n.hour<12?0:1]}function D$(n,e){return X5(e)[n.weekday-1]}function R$(n,e){return j5(e)[n.month-1]}function z$(n,e){return Y5(e)[n.year<0?0:1]}function O$(n,e,t="always",i=!1){const r={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=["hours","minutes","seconds"].indexOf(n)===-1;if(t==="auto"&&o){const w=n==="days";switch(e){case 1:return w?"tomorrow":`next ${r[n][0]}`;case-1:return w?"yesterday":`last ${r[n][0]}`;case 0:return w?"today":`this ${r[n][0]}`}}const l=Object.is(e,-0)||e<0,s=Math.abs(e),d=s===1,p=r[n],_=i?d?p[1]:p[2]||p[1]:d?r[n][0]:n;return l?`${s} ${_} ago`:`in ${s} ${_}`}function Vz(n,e){let t="";for(const i of n)i.literal?t+=i.val:t+=e(i.val);return t}const F$={D:rM,DD:b5,DDD:S5,DDDD:M5,t:T5,tt:E5,ttt:A5,tttt:C5,T:I5,TT:P5,TTT:L5,TTTT:k5,f:D5,ff:z5,fff:F5,ffff:N5,F:R5,FF:O5,FFF:B5,FFFF:U5};class ca{static create(e,t={}){return new ca(e,t)}static parseFormat(e){let t=null,i="",r=!1;const o=[];for(let l=0;l<e.length;l++){const s=e.charAt(l);s==="'"?(i.length>0&&o.push({literal:r,val:i}),t=null,i="",r=!r):r||s===t?i+=s:(i.length>0&&o.push({literal:!1,val:i}),i=s,t=s)}return i.length>0&&o.push({literal:r,val:i}),o}static macroTokenToFormatOpts(e){return F$[e]}constructor(e,t){this.opts=t,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,t){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTime(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).format()}formatDateTimeParts(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).formatToParts()}formatInterval(e,t={}){return this.loc.dtFormatter(e.start,{...this.opts,...t}).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,t={}){return this.loc.dtFormatter(e,{...this.opts,...t}).resolvedOptions()}num(e,t=0){if(this.opts.forceSimple)return Ws(e,t);const i={...this.opts};return t>0&&(i.padTo=t),this.loc.numberFormatter(i).format(e)}formatDateTimeFromString(e,t){const i=this.loc.listingMode()==="en",r=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",o=(A,P)=>this.loc.extract(e,A,P),l=A=>e.isOffsetFixed&&e.offset===0&&A.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,A.format):"",s=()=>i?k$(e):o({hour:"numeric",hourCycle:"h12"},"dayperiod"),d=(A,P)=>i?R$(e,A):o(P?{month:A}:{month:A,day:"numeric"},"month"),p=(A,P)=>i?D$(e,A):o(P?{weekday:A}:{weekday:A,month:"long",day:"numeric"},"weekday"),_=A=>{const P=ca.macroTokenToFormatOpts(A);return P?this.formatWithSystemDefault(e,P):A},w=A=>i?z$(e,A):o({era:A},"era"),M=A=>{switch(A){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return l({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return l({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return l({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return s();case"d":return r?o({day:"numeric"},"day"):this.num(e.day);case"dd":return r?o({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return p("short",!0);case"cccc":return p("long",!0);case"ccccc":return p("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return p("short",!1);case"EEEE":return p("long",!1);case"EEEEE":return p("narrow",!1);case"L":return r?o({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return r?o({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return d("short",!0);case"LLLL":return d("long",!0);case"LLLLL":return d("narrow",!0);case"M":return r?o({month:"numeric"},"month"):this.num(e.month);case"MM":return r?o({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return d("short",!1);case"MMMM":return d("long",!1);case"MMMMM":return d("narrow",!1);case"y":return r?o({year:"numeric"},"year"):this.num(e.year);case"yy":return r?o({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return r?o({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return r?o({year:"numeric"},"year"):this.num(e.year,6);case"G":return w("short");case"GG":return w("long");case"GGGGG":return w("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return _(A)}};return Vz(ca.parseFormat(t),M)}formatDurationFromString(e,t){const i=d=>{switch(d[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},r=d=>p=>{const _=i(p);return _?this.num(d.get(_),p.length):p},o=ca.parseFormat(t),l=o.reduce((d,{literal:p,val:_})=>p?d:d.concat(_),[]),s=e.shiftTo(...l.map(i).filter(d=>d));return Vz(o,r(s))}}class Eu{constructor(e,t){this.reason=e,this.explanation=t}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const K5=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Ky(...n){const e=n.reduce((t,i)=>t+i.source,"");return RegExp(`^${e}$`)}function Jy(...n){return e=>n.reduce(([t,i,r],o)=>{const[l,s,d]=o(e,r);return[{...t,...l},s||i,d]},[{},null,1]).slice(0,2)}function Qy(n,...e){if(n==null)return[null,null];for(const[t,i]of e){const r=t.exec(n);if(r)return i(r)}return[null,null]}function J5(...n){return(e,t)=>{const i={};let r;for(r=0;r<n.length;r++)i[n[r]]=$f(e[t+r]);return[i,null,t+r]}}const Q5=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,B$=`(?:${Q5.source}?(?:\\[(${K5.source})\\])?)?`,XP=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,eU=RegExp(`${XP.source}${B$}`),$P=RegExp(`(?:T${eU.source})?`),N$=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,U$=/(\d{4})-?W(\d\d)(?:-?(\d))?/,V$=/(\d{4})-?(\d{3})/,G$=J5("weekYear","weekNumber","weekDay"),W$=J5("year","ordinal"),H$=/(\d{4})-(\d\d)-(\d\d)/,tU=RegExp(`${XP.source} ?(?:${Q5.source}|(${K5.source}))?`),j$=RegExp(`(?: ${tU.source})?`);function uy(n,e,t){const i=n[e];return Ji(i)?t:$f(i)}function q$(n,e){return[{year:uy(n,e),month:uy(n,e+1,1),day:uy(n,e+2,1)},null,e+3]}function e0(n,e){return[{hours:uy(n,e,0),minutes:uy(n,e+1,0),seconds:uy(n,e+2,0),milliseconds:jP(n[e+3])},null,e+4]}function m1(n,e){const t=!n[e]&&!n[e+1],i=XM(n[e+1],n[e+2]),r=t?null:Ia.instance(i);return[{},r,e+3]}function g1(n,e){const t=n[e]?Xd.create(n[e]):null;return[{},t,e+1]}const Z$=RegExp(`^T?${XP.source}$`),X$=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function $$(n){const[e,t,i,r,o,l,s,d,p]=n,_=e[0]==="-",w=d&&d[0]==="-",M=(A,P=!1)=>A!==void 0&&(P||A&&_)?-A:A;return[{years:M(Mm(t)),months:M(Mm(i)),weeks:M(Mm(r)),days:M(Mm(o)),hours:M(Mm(l)),minutes:M(Mm(s)),seconds:M(Mm(d),d==="-0"),milliseconds:M(jP(p),w)}]}const Y$={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function YP(n,e,t,i,r,o,l){const s={year:e.length===2?xC($f(e)):$f(e),month:H5.indexOf(t)+1,day:$f(i),hour:$f(r),minute:$f(o)};return l&&(s.second=$f(l)),n&&(s.weekday=n.length>3?q5.indexOf(n)+1:Z5.indexOf(n)+1),s}const K$=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function J$(n){const[,e,t,i,r,o,l,s,d,p,_,w]=n,M=YP(e,r,i,t,o,l,s);let A;return d?A=Y$[d]:p?A=0:A=XM(_,w),[M,new Ia(A)]}function Q$(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const eY=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,tY=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,nY=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function Gz(n){const[,e,t,i,r,o,l,s]=n;return[YP(e,r,i,t,o,l,s),Ia.utcInstance]}function iY(n){const[,e,t,i,r,o,l,s]=n;return[YP(e,s,t,i,r,o,l),Ia.utcInstance]}const rY=Ky(N$,$P),sY=Ky(U$,$P),oY=Ky(V$,$P),aY=Ky(eU),nU=Jy(q$,e0,m1,g1),lY=Jy(G$,e0,m1,g1),cY=Jy(W$,e0,m1,g1),uY=Jy(e0,m1,g1);function hY(n){return Qy(n,[rY,nU],[sY,lY],[oY,cY],[aY,uY])}function dY(n){return Qy(Q$(n),[K$,J$])}function fY(n){return Qy(n,[eY,Gz],[tY,Gz],[nY,iY])}function pY(n){return Qy(n,[X$,$$])}const mY=Jy(e0);function gY(n){return Qy(n,[Z$,mY])}const _Y=Ky(H$,j$),yY=Ky(tU),xY=Jy(e0,m1,g1);function vY(n){return Qy(n,[_Y,nU],[yY,xY])}const wY="Invalid Duration",iU={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},bY={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...iU},uc=146097/400,__=146097/4800,SY={years:{quarters:4,months:12,weeks:uc/7,days:uc,hours:uc*24,minutes:uc*24*60,seconds:uc*24*60*60,milliseconds:uc*24*60*60*1e3},quarters:{months:3,weeks:uc/28,days:uc/4,hours:uc*24/4,minutes:uc*24*60/4,seconds:uc*24*60*60/4,milliseconds:uc*24*60*60*1e3/4},months:{weeks:__/7,days:__,hours:__*24,minutes:__*24*60,seconds:__*24*60*60,milliseconds:__*24*60*60*1e3},...iU},Bm=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],MY=Bm.slice(0).reverse();function Bf(n,e,t=!1){const i={values:t?e.values:{...n.values,...e.values||{}},loc:n.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||n.conversionAccuracy,matrix:e.matrix||n.matrix};return new lr(i)}function TY(n){return n<0?Math.floor(n):Math.ceil(n)}function rU(n,e,t,i,r){const o=n[r][t],l=e[t]/o,s=Math.sign(l)===Math.sign(i[r]),d=!s&&i[r]!==0&&Math.abs(l)<=1?TY(l):Math.trunc(l);i[r]+=d,e[t]-=d*o}function EY(n,e){MY.reduce((t,i)=>Ji(e[i])?t:(t&&rU(n,e,t,e,i),i),null)}function AY(n){const e={};for(const[t,i]of Object.entries(n))i!==0&&(e[t]=i);return e}class lr{constructor(e){const t=e.conversionAccuracy==="longterm"||!1;let i=t?SY:bY;e.matrix&&(i=e.matrix),this.values=e.values,this.loc=e.loc||jr.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(e,t){return lr.fromObject({milliseconds:e},t)}static fromObject(e,t={}){if(e==null||typeof e!="object")throw new xc(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new lr({values:aM(e,lr.normalizeUnit),loc:jr.fromObject(t),conversionAccuracy:t.conversionAccuracy,matrix:t.matrix})}static fromDurationLike(e){if(sg(e))return lr.fromMillis(e);if(lr.isDuration(e))return e;if(typeof e=="object")return lr.fromObject(e);throw new xc(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,t){const[i]=pY(e);return i?lr.fromObject(i,t):lr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,t){const[i]=gY(e);return i?lr.fromObject(i,t):lr.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,t=null){if(!e)throw new xc("need to specify a reason the Duration is invalid");const i=e instanceof Eu?e:new Eu(e,t);if(Gs.throwOnInvalid)throw new t$(i);return new lr({invalid:i})}static normalizeUnit(e){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!t)throw new w5(e);return t}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,t={}){const i={...t,floor:t.round!==!1&&t.floor!==!1};return this.isValid?ca.create(this.loc,i).formatDurationFromString(this,e):wY}toHuman(e={}){const t=Bm.map(i=>{const r=this.values[i];return Ji(r)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:i.slice(0,-1)}).format(r)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=qP(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e};const i=this.shiftTo("hours","minutes","seconds","milliseconds");let r=e.format==="basic"?"hhmm":"hh:mm";(!e.suppressSeconds||i.seconds!==0||i.milliseconds!==0)&&(r+=e.format==="basic"?"ss":":ss",(!e.suppressMilliseconds||i.milliseconds!==0)&&(r+=".SSS"));let o=i.toFormat(r);return e.includePrefix&&(o="T"+o),o}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const t=lr.fromDurationLike(e),i={};for(const r of Bm)(Cy(t.values,r)||Cy(this.values,r))&&(i[r]=t.get(r)+this.get(r));return Bf(this,{values:i},!0)}minus(e){if(!this.isValid)return this;const t=lr.fromDurationLike(e);return this.plus(t.negate())}mapUnits(e){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=W5(e(this.values[i],i));return Bf(this,{values:t},!0)}get(e){return this[lr.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const t={...this.values,...aM(e,lr.normalizeUnit)};return Bf(this,{values:t})}reconfigure({locale:e,numberingSystem:t,conversionAccuracy:i,matrix:r}={}){const l={loc:this.loc.clone({locale:e,numberingSystem:t}),matrix:r,conversionAccuracy:i};return Bf(this,l)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return EY(this.matrix,e),Bf(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=AY(this.normalize().shiftToAll().toObject());return Bf(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(l=>lr.normalizeUnit(l));const t={},i={},r=this.toObject();let o;for(const l of Bm)if(e.indexOf(l)>=0){o=l;let s=0;for(const p in i)s+=this.matrix[p][l]*i[p],i[p]=0;sg(r[l])&&(s+=r[l]);const d=Math.trunc(s);t[l]=d,i[l]=(s*1e3-d*1e3)/1e3;for(const p in r)Bm.indexOf(p)>Bm.indexOf(l)&&rU(this.matrix,r,p,t,l)}else sg(r[l])&&(i[l]=r[l]);for(const l in i)i[l]!==0&&(t[o]+=l===o?i[l]:i[l]/this.matrix[o][l]);return Bf(this,{values:t},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const t of Object.keys(this.values))e[t]=this.values[t]===0?0:-this.values[t];return Bf(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function t(i,r){return i===void 0||i===0?r===void 0||r===0:i===r}for(const i of Bm)if(!t(this.values[i],e.values[i]))return!1;return!0}}const y_="Invalid Interval";function CY(n,e){return!n||!n.isValid?ws.invalid("missing or invalid start"):!e||!e.isValid?ws.invalid("missing or invalid end"):e<n?ws.invalid("end before start",`The end of an interval must be after its start, but you had start=${n.toISO()} and end=${e.toISO()}`):null}class ws{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,t=null){if(!e)throw new xc("need to specify a reason the Interval is invalid");const i=e instanceof Eu?e:new Eu(e,t);if(Gs.throwOnInvalid)throw new e$(i);return new ws({invalid:i})}static fromDateTimes(e,t){const i=dx(e),r=dx(t),o=CY(i,r);return o??new ws({start:i,end:r})}static after(e,t){const i=lr.fromDurationLike(t),r=dx(e);return ws.fromDateTimes(r,r.plus(i))}static before(e,t){const i=lr.fromDurationLike(t),r=dx(e);return ws.fromDateTimes(r.minus(i),r)}static fromISO(e,t){const[i,r]=(e||"").split("/",2);if(i&&r){let o,l;try{o=ti.fromISO(i,t),l=o.isValid}catch{l=!1}let s,d;try{s=ti.fromISO(r,t),d=s.isValid}catch{d=!1}if(l&&d)return ws.fromDateTimes(o,s);if(l){const p=lr.fromISO(r,t);if(p.isValid)return ws.after(o,p)}else if(d){const p=lr.fromISO(i,t);if(p.isValid)return ws.before(s,p)}}return ws.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds"){if(!this.isValid)return NaN;const t=this.start.startOf(e),i=this.end.startOf(e);return Math.floor(i.diff(t,e).get(e))+1}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:t}={}){return this.isValid?ws.fromDateTimes(e||this.s,t||this.e):this}splitAt(...e){if(!this.isValid)return[];const t=e.map(dx).filter(l=>this.contains(l)).sort(),i=[];let{s:r}=this,o=0;for(;r<this.e;){const l=t[o]||this.e,s=+l>+this.e?this.e:l;i.push(ws.fromDateTimes(r,s)),r=s,o+=1}return i}splitBy(e){const t=lr.fromDurationLike(e);if(!this.isValid||!t.isValid||t.as("milliseconds")===0)return[];let{s:i}=this,r=1,o;const l=[];for(;i<this.e;){const s=this.start.plus(t.mapUnits(d=>d*r));o=+s>+this.e?this.e:s,l.push(ws.fromDateTimes(i,o)),i=o,r+=1}return l}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const t=this.s>e.s?this.s:e.s,i=this.e<e.e?this.e:e.e;return t>=i?null:ws.fromDateTimes(t,i)}union(e){if(!this.isValid)return this;const t=this.s<e.s?this.s:e.s,i=this.e>e.e?this.e:e.e;return ws.fromDateTimes(t,i)}static merge(e){const[t,i]=e.sort((r,o)=>r.s-o.s).reduce(([r,o],l)=>o?o.overlaps(l)||o.abutsStart(l)?[r,o.union(l)]:[r.concat([o]),l]:[r,l],[[],null]);return i&&t.push(i),t}static xor(e){let t=null,i=0;const r=[],o=e.map(d=>[{time:d.s,type:"s"},{time:d.e,type:"e"}]),l=Array.prototype.concat(...o),s=l.sort((d,p)=>d.time-p.time);for(const d of s)i+=d.type==="s"?1:-1,i===1?t=d.time:(t&&+t!=+d.time&&r.push(ws.fromDateTimes(t,d.time)),t=null);return ws.merge(r)}difference(...e){return ws.xor([this].concat(e)).map(t=>this.intersection(t)).filter(t=>t&&!t.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:y_}toLocaleString(e=rM,t={}){return this.isValid?ca.create(this.s.loc.clone(t),e).formatInterval(this):y_}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:y_}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:y_}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:y_}toFormat(e,{separator:t=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${t}${this.e.toFormat(e)}`:y_}toDuration(e,t){return this.isValid?this.e.diff(this.s,e,t):lr.invalid(this.invalidReason)}mapEndpoints(e){return ws.fromDateTimes(e(this.s),e(this.e))}}class sb{static hasDST(e=Gs.defaultZone){const t=ti.now().setZone(e).set({month:12});return!e.isUniversal&&t.offset!==t.set({month:6}).offset}static isValidIANAZone(e){return Xd.isValidZone(e)}static normalizeZone(e){return ep(e,Gs.defaultZone)}static months(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null,outputCalendar:o="gregory"}={}){return(r||jr.create(t,i,o)).months(e)}static monthsFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null,outputCalendar:o="gregory"}={}){return(r||jr.create(t,i,o)).months(e,!0)}static weekdays(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null}={}){return(r||jr.create(t,i,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:t=null,numberingSystem:i=null,locObj:r=null}={}){return(r||jr.create(t,i,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return jr.create(e).meridiems()}static eras(e="short",{locale:t=null}={}){return jr.create(t,null,"gregory").eras(e)}static features(){return{relative:V5()}}}function Wz(n,e){const t=r=>r.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=t(e)-t(n);return Math.floor(lr.fromMillis(i).as("days"))}function IY(n,e,t){const i=[["years",(d,p)=>p.year-d.year],["quarters",(d,p)=>p.quarter-d.quarter+(p.year-d.year)*4],["months",(d,p)=>p.month-d.month+(p.year-d.year)*12],["weeks",(d,p)=>{const _=Wz(d,p);return(_-_%7)/7}],["days",Wz]],r={},o=n;let l,s;for(const[d,p]of i)t.indexOf(d)>=0&&(l=d,r[d]=p(n,e),s=o.plus(r),s>e?(r[d]--,n=o.plus(r)):n=s);return[n,r,s,l]}function PY(n,e,t,i){let[r,o,l,s]=IY(n,e,t);const d=e-r,p=t.filter(w=>["hours","minutes","seconds","milliseconds"].indexOf(w)>=0);p.length===0&&(l<e&&(l=r.plus({[s]:1})),l!==r&&(o[s]=(o[s]||0)+d/(l-r)));const _=lr.fromObject(o,i);return p.length>0?lr.fromMillis(d,i).shiftTo(...p).plus(_):_}const KP={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},Hz={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},LY=KP.hanidec.replace(/[\[|\]]/g,"").split("");function kY(n){let e=parseInt(n,10);if(isNaN(e)){e="";for(let t=0;t<n.length;t++){const i=n.charCodeAt(t);if(n[t].search(KP.hanidec)!==-1)e+=LY.indexOf(n[t]);else for(const r in Hz){const[o,l]=Hz[r];i>=o&&i<=l&&(e+=i-o)}}return parseInt(e,10)}else return e}function fu({numberingSystem:n},e=""){return new RegExp(`${KP[n||"latn"]}${e}`)}const DY="missing Intl.DateTimeFormat.formatToParts support";function pr(n,e=t=>t){return{regex:n,deser:([t])=>e(kY(t))}}const RY=String.fromCharCode(160),sU=`[ ${RY}]`,oU=new RegExp(sU,"g");function zY(n){return n.replace(/\./g,"\\.?").replace(oU,sU)}function jz(n){return n.replace(/\./g,"").replace(oU," ").toLowerCase()}function pu(n,e){return n===null?null:{regex:RegExp(n.map(zY).join("|")),deser:([t])=>n.findIndex(i=>jz(t)===jz(i))+e}}function qz(n,e){return{regex:n,deser:([,t,i])=>XM(t,i),groups:e}}function n2(n){return{regex:n,deser:([e])=>e}}function OY(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function FY(n,e){const t=fu(e),i=fu(e,"{2}"),r=fu(e,"{3}"),o=fu(e,"{4}"),l=fu(e,"{6}"),s=fu(e,"{1,2}"),d=fu(e,"{1,3}"),p=fu(e,"{1,6}"),_=fu(e,"{1,9}"),w=fu(e,"{2,4}"),M=fu(e,"{4,6}"),A=D=>({regex:RegExp(OY(D.val)),deser:([z])=>z,literal:!0}),L=(D=>{if(n.literal)return A(D);switch(D.val){case"G":return pu(e.eras("short",!1),0);case"GG":return pu(e.eras("long",!1),0);case"y":return pr(p);case"yy":return pr(w,xC);case"yyyy":return pr(o);case"yyyyy":return pr(M);case"yyyyyy":return pr(l);case"M":return pr(s);case"MM":return pr(i);case"MMM":return pu(e.months("short",!0,!1),1);case"MMMM":return pu(e.months("long",!0,!1),1);case"L":return pr(s);case"LL":return pr(i);case"LLL":return pu(e.months("short",!1,!1),1);case"LLLL":return pu(e.months("long",!1,!1),1);case"d":return pr(s);case"dd":return pr(i);case"o":return pr(d);case"ooo":return pr(r);case"HH":return pr(i);case"H":return pr(s);case"hh":return pr(i);case"h":return pr(s);case"mm":return pr(i);case"m":return pr(s);case"q":return pr(s);case"qq":return pr(i);case"s":return pr(s);case"ss":return pr(i);case"S":return pr(d);case"SSS":return pr(r);case"u":return n2(_);case"uu":return n2(s);case"uuu":return pr(t);case"a":return pu(e.meridiems(),0);case"kkkk":return pr(o);case"kk":return pr(w,xC);case"W":return pr(s);case"WW":return pr(i);case"E":case"c":return pr(t);case"EEE":return pu(e.weekdays("short",!1,!1),1);case"EEEE":return pu(e.weekdays("long",!1,!1),1);case"ccc":return pu(e.weekdays("short",!0,!1),1);case"cccc":return pu(e.weekdays("long",!0,!1),1);case"Z":case"ZZ":return qz(new RegExp(`([+-]${s.source})(?::(${i.source}))?`),2);case"ZZZ":return qz(new RegExp(`([+-]${s.source})(${i.source})?`),2);case"z":return n2(/[a-z_+-/]{1,256}?/i);default:return A(D)}})(n)||{invalidReason:DY};return L.token=n,L}const BY={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour:{numeric:"h","2-digit":"hh"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function NY(n,e){const{type:t,value:i}=n;if(t==="literal")return{literal:!0,val:i};const r=e[t];let o=BY[t];if(typeof o=="object"&&(o=o[r]),o)return{literal:!1,val:o}}function UY(n){return[`^${n.map(t=>t.regex).reduce((t,i)=>`${t}(${i.source})`,"")}$`,n]}function VY(n,e,t){const i=n.match(e);if(i){const r={};let o=1;for(const l in t)if(Cy(t,l)){const s=t[l],d=s.groups?s.groups+1:1;!s.literal&&s.token&&(r[s.token.val[0]]=s.deser(i.slice(o,o+d))),o+=d}return[i,r]}else return[i,{}]}function GY(n){const e=o=>{switch(o){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let t=null,i;return Ji(n.z)||(t=Xd.create(n.z)),Ji(n.Z)||(t||(t=new Ia(n.Z)),i=n.Z),Ji(n.q)||(n.M=(n.q-1)*3+1),Ji(n.h)||(n.h<12&&n.a===1?n.h+=12:n.h===12&&n.a===0&&(n.h=0)),n.G===0&&n.y&&(n.y=-n.y),Ji(n.u)||(n.S=jP(n.u)),[Object.keys(n).reduce((o,l)=>{const s=e(l);return s&&(o[s]=n[l]),o},{}),t,i]}let i2=null;function WY(){return i2||(i2=ti.fromMillis(1555555555555)),i2}function HY(n,e){if(n.literal)return n;const t=ca.macroTokenToFormatOpts(n.val),i=cU(t,e);return i==null||i.includes(void 0)?n:i}function aU(n,e){return Array.prototype.concat(...n.map(t=>HY(t,e)))}function lU(n,e,t){const i=aU(ca.parseFormat(t),n),r=i.map(l=>FY(l,n)),o=r.find(l=>l.invalidReason);if(o)return{input:e,tokens:i,invalidReason:o.invalidReason};{const[l,s]=UY(r),d=RegExp(l,"i"),[p,_]=VY(e,d,s),[w,M,A]=_?GY(_):[null,null,void 0];if(Cy(_,"a")&&Cy(_,"H"))throw new Fx("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:i,regex:d,rawMatches:p,matches:_,result:w,zone:M,specificOffset:A}}}function jY(n,e,t){const{result:i,zone:r,specificOffset:o,invalidReason:l}=lU(n,e,t);return[i,r,o,l]}function cU(n,e){return n?ca.create(e,n).formatDateTimeParts(WY()).map(r=>NY(r,n)):null}const uU=[0,31,59,90,120,151,181,212,243,273,304,334],hU=[0,31,60,91,121,152,182,213,244,274,305,335];function Mc(n,e){return new Eu("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${n}, which is invalid`)}function dU(n,e,t){const i=new Date(Date.UTC(n,e-1,t));n<100&&n>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const r=i.getUTCDay();return r===0?7:r}function fU(n,e,t){return t+(p1(n)?hU:uU)[e-1]}function pU(n,e){const t=p1(n)?hU:uU,i=t.findIndex(o=>o<e),r=e-t[i];return{month:i+1,day:r}}function vC(n){const{year:e,month:t,day:i}=n,r=fU(e,t,i),o=dU(e,t,i);let l=Math.floor((r-o+10)/7),s;return l<1?(s=e-1,l=oM(s)):l>oM(e)?(s=e+1,l=1):s=e,{weekYear:s,weekNumber:l,weekday:o,...$M(n)}}function Zz(n){const{weekYear:e,weekNumber:t,weekday:i}=n,r=dU(e,1,4),o=nv(e);let l=t*7+i-r-3,s;l<1?(s=e-1,l+=nv(s)):l>o?(s=e+1,l-=nv(e)):s=e;const{month:d,day:p}=pU(s,l);return{year:s,month:d,day:p,...$M(n)}}function r2(n){const{year:e,month:t,day:i}=n,r=fU(e,t,i);return{year:e,ordinal:r,...$M(n)}}function Xz(n){const{year:e,ordinal:t}=n,{month:i,day:r}=pU(e,t);return{year:e,month:i,day:r,...$M(n)}}function qY(n){const e=ZM(n.weekYear),t=Od(n.weekNumber,1,oM(n.weekYear)),i=Od(n.weekday,1,7);return e?t?i?!1:Mc("weekday",n.weekday):Mc("week",n.week):Mc("weekYear",n.weekYear)}function ZY(n){const e=ZM(n.year),t=Od(n.ordinal,1,nv(n.year));return e?t?!1:Mc("ordinal",n.ordinal):Mc("year",n.year)}function mU(n){const e=ZM(n.year),t=Od(n.month,1,12),i=Od(n.day,1,sM(n.year,n.month));return e?t?i?!1:Mc("day",n.day):Mc("month",n.month):Mc("year",n.year)}function gU(n){const{hour:e,minute:t,second:i,millisecond:r}=n,o=Od(e,0,23)||e===24&&t===0&&i===0&&r===0,l=Od(t,0,59),s=Od(i,0,59),d=Od(r,0,999);return o?l?s?d?!1:Mc("millisecond",r):Mc("second",i):Mc("minute",t):Mc("hour",e)}const s2="Invalid DateTime",$z=864e13;function ob(n){return new Eu("unsupported zone",`the zone "${n.name}" is not supported`)}function o2(n){return n.weekData===null&&(n.weekData=vC(n.c)),n.weekData}function ux(n,e){const t={ts:n.ts,zone:n.zone,c:n.c,o:n.o,loc:n.loc,invalid:n.invalid};return new ti({...t,...e,old:t})}function _U(n,e,t){let i=n-e*60*1e3;const r=t.offset(i);if(e===r)return[i,e];i-=(r-e)*60*1e3;const o=t.offset(i);return r===o?[i,r]:[n-Math.min(r,o)*60*1e3,Math.max(r,o)]}function Yz(n,e){n+=e*60*1e3;const t=new Date(n);return{year:t.getUTCFullYear(),month:t.getUTCMonth()+1,day:t.getUTCDate(),hour:t.getUTCHours(),minute:t.getUTCMinutes(),second:t.getUTCSeconds(),millisecond:t.getUTCMilliseconds()}}function dS(n,e,t){return _U(ZP(n),e,t)}function Kz(n,e){const t=n.o,i=n.c.year+Math.trunc(e.years),r=n.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,o={...n.c,year:i,month:r,day:Math.min(n.c.day,sM(i,r))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},l=lr.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),s=ZP(o);let[d,p]=_U(s,t,n.zone);return l!==0&&(d+=l,p=n.zone.offset(d)),{ts:d,o:p}}function hx(n,e,t,i,r,o){const{setZone:l,zone:s}=t;if(n&&Object.keys(n).length!==0){const d=e||s,p=ti.fromObject(n,{...t,zone:d,specificOffset:o});return l?p:p.setZone(s)}else return ti.invalid(new Eu("unparsable",`the input "${r}" can't be parsed as ${i}`))}function ab(n,e,t=!0){return n.isValid?ca.create(jr.create("en-US"),{allowZ:t,forceSimple:!0}).formatDateTimeFromString(n,e):null}function a2(n,e){const t=n.c.year>9999||n.c.year<0;let i="";return t&&n.c.year>=0&&(i+="+"),i+=Ws(n.c.year,t?6:4),e?(i+="-",i+=Ws(n.c.month),i+="-",i+=Ws(n.c.day)):(i+=Ws(n.c.month),i+=Ws(n.c.day)),i}function Jz(n,e,t,i,r,o){let l=Ws(n.c.hour);return e?(l+=":",l+=Ws(n.c.minute),(n.c.second!==0||!t)&&(l+=":")):l+=Ws(n.c.minute),(n.c.second!==0||!t)&&(l+=Ws(n.c.second),(n.c.millisecond!==0||!i)&&(l+=".",l+=Ws(n.c.millisecond,3))),r&&(n.isOffsetFixed&&n.offset===0&&!o?l+="Z":n.o<0?(l+="-",l+=Ws(Math.trunc(-n.o/60)),l+=":",l+=Ws(Math.trunc(-n.o%60))):(l+="+",l+=Ws(Math.trunc(n.o/60)),l+=":",l+=Ws(Math.trunc(n.o%60)))),o&&(l+="["+n.zone.ianaName+"]"),l}const yU={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},XY={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},$Y={ordinal:1,hour:0,minute:0,second:0,millisecond:0},xU=["year","month","day","hour","minute","second","millisecond"],YY=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],KY=["year","ordinal","hour","minute","second","millisecond"];function Qz(n){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[n.toLowerCase()];if(!e)throw new w5(n);return e}function eO(n,e){const t=ep(e.zone,Gs.defaultZone),i=jr.fromObject(e),r=Gs.now();let o,l;if(Ji(n.year))o=r;else{for(const p of xU)Ji(n[p])&&(n[p]=yU[p]);const s=mU(n)||gU(n);if(s)return ti.invalid(s);const d=t.offset(r);[o,l]=dS(n,d,t)}return new ti({ts:o,zone:t,loc:i,o:l})}function tO(n,e,t){const i=Ji(t.round)?!0:t.round,r=(l,s)=>(l=qP(l,i||t.calendary?0:2,!0),e.loc.clone(t).relFormatter(t).format(l,s)),o=l=>t.calendary?e.hasSame(n,l)?0:e.startOf(l).diff(n.startOf(l),l).get(l):e.diff(n,l).get(l);if(t.unit)return r(o(t.unit),t.unit);for(const l of t.units){const s=o(l);if(Math.abs(s)>=1)return r(s,l)}return r(n>e?-0:0,t.units[t.units.length-1])}function nO(n){let e={},t;return n.length>0&&typeof n[n.length-1]=="object"?(e=n[n.length-1],t=Array.from(n).slice(0,n.length-1)):t=Array.from(n),[e,t]}class ti{constructor(e){const t=e.zone||Gs.defaultZone;let i=e.invalid||(Number.isNaN(e.ts)?new Eu("invalid input"):null)||(t.isValid?null:ob(t));this.ts=Ji(e.ts)?Gs.now():e.ts;let r=null,o=null;if(!i)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(t))[r,o]=[e.old.c,e.old.o];else{const s=t.offset(this.ts);r=Yz(this.ts,s),i=Number.isNaN(r.year)?new Eu("invalid input"):null,r=i?null:r,o=i?null:s}this._zone=t,this.loc=e.loc||jr.create(),this.invalid=i,this.weekData=null,this.c=r,this.o=o,this.isLuxonDateTime=!0}static now(){return new ti({})}static local(){const[e,t]=nO(arguments),[i,r,o,l,s,d,p]=t;return eO({year:i,month:r,day:o,hour:l,minute:s,second:d,millisecond:p},e)}static utc(){const[e,t]=nO(arguments),[i,r,o,l,s,d,p]=t;return e.zone=Ia.utcInstance,eO({year:i,month:r,day:o,hour:l,minute:s,second:d,millisecond:p},e)}static fromJSDate(e,t={}){const i=b$(e)?e.valueOf():NaN;if(Number.isNaN(i))return ti.invalid("invalid input");const r=ep(t.zone,Gs.defaultZone);return r.isValid?new ti({ts:i,zone:r,loc:jr.fromObject(t)}):ti.invalid(ob(r))}static fromMillis(e,t={}){if(sg(e))return e<-$z||e>$z?ti.invalid("Timestamp out of range"):new ti({ts:e,zone:ep(t.zone,Gs.defaultZone),loc:jr.fromObject(t)});throw new xc(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,t={}){if(sg(e))return new ti({ts:e*1e3,zone:ep(t.zone,Gs.defaultZone),loc:jr.fromObject(t)});throw new xc("fromSeconds requires a numerical input")}static fromObject(e,t={}){e=e||{};const i=ep(t.zone,Gs.defaultZone);if(!i.isValid)return ti.invalid(ob(i));const r=Gs.now(),o=Ji(t.specificOffset)?i.offset(r):t.specificOffset,l=aM(e,Qz),s=!Ji(l.ordinal),d=!Ji(l.year),p=!Ji(l.month)||!Ji(l.day),_=d||p,w=l.weekYear||l.weekNumber,M=jr.fromObject(t);if((_||s)&&w)throw new Fx("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(p&&s)throw new Fx("Can't mix ordinal dates with month/day");const A=w||l.weekday&&!_;let P,L,D=Yz(r,o);A?(P=YY,L=XY,D=vC(D)):s?(P=KY,L=$Y,D=r2(D)):(P=xU,L=yU);let z=!1;for(const Z of P){const ne=l[Z];Ji(ne)?z?l[Z]=L[Z]:l[Z]=D[Z]:z=!0}const F=A?qY(l):s?ZY(l):mU(l),N=F||gU(l);if(N)return ti.invalid(N);const V=A?Zz(l):s?Xz(l):l,[j,Q]=dS(V,o,i),re=new ti({ts:j,zone:i,o:Q,loc:M});return l.weekday&&_&&e.weekday!==re.weekday?ti.invalid("mismatched weekday",`you can't specify both a weekday of ${l.weekday} and a date of ${re.toISO()}`):re}static fromISO(e,t={}){const[i,r]=hY(e);return hx(i,r,t,"ISO 8601",e)}static fromRFC2822(e,t={}){const[i,r]=dY(e);return hx(i,r,t,"RFC 2822",e)}static fromHTTP(e,t={}){const[i,r]=fY(e);return hx(i,r,t,"HTTP",t)}static fromFormat(e,t,i={}){if(Ji(e)||Ji(t))throw new xc("fromFormat requires an input string and a format");const{locale:r=null,numberingSystem:o=null}=i,l=jr.fromOpts({locale:r,numberingSystem:o,defaultToEN:!0}),[s,d,p,_]=jY(l,e,t);return _?ti.invalid(_):hx(s,d,i,`format ${t}`,e,p)}static fromString(e,t,i={}){return ti.fromFormat(e,t,i)}static fromSQL(e,t={}){const[i,r]=vY(e);return hx(i,r,t,"SQL",e)}static invalid(e,t=null){if(!e)throw new xc("need to specify a reason the DateTime is invalid");const i=e instanceof Eu?e:new Eu(e,t);if(Gs.throwOnInvalid)throw new QX(i);return new ti({invalid:i})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,t={}){const i=cU(e,jr.fromObject(t));return i?i.map(r=>r?r.val:null).join(""):null}static expandFormat(e,t={}){return aU(ca.parseFormat(e),jr.fromObject(t)).map(r=>r.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?o2(this).weekYear:NaN}get weekNumber(){return this.isValid?o2(this).weekNumber:NaN}get weekday(){return this.isValid?o2(this).weekday:NaN}get ordinal(){return this.isValid?r2(this.c).ordinal:NaN}get monthShort(){return this.isValid?sb.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?sb.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?sb.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?sb.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}get isInLeapYear(){return p1(this.year)}get daysInMonth(){return sM(this.year,this.month)}get daysInYear(){return this.isValid?nv(this.year):NaN}get weeksInWeekYear(){return this.isValid?oM(this.weekYear):NaN}resolvedLocaleOptions(e={}){const{locale:t,numberingSystem:i,calendar:r}=ca.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:t,numberingSystem:i,outputCalendar:r}}toUTC(e=0,t={}){return this.setZone(Ia.instance(e),t)}toLocal(){return this.setZone(Gs.defaultZone)}setZone(e,{keepLocalTime:t=!1,keepCalendarTime:i=!1}={}){if(e=ep(e,Gs.defaultZone),e.equals(this.zone))return this;if(e.isValid){let r=this.ts;if(t||i){const o=e.offset(this.ts),l=this.toObject();[r]=dS(l,o,e)}return ux(this,{ts:r,zone:e})}else return ti.invalid(ob(e))}reconfigure({locale:e,numberingSystem:t,outputCalendar:i}={}){const r=this.loc.clone({locale:e,numberingSystem:t,outputCalendar:i});return ux(this,{loc:r})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const t=aM(e,Qz),i=!Ji(t.weekYear)||!Ji(t.weekNumber)||!Ji(t.weekday),r=!Ji(t.ordinal),o=!Ji(t.year),l=!Ji(t.month)||!Ji(t.day),s=o||l,d=t.weekYear||t.weekNumber;if((s||r)&&d)throw new Fx("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&r)throw new Fx("Can't mix ordinal dates with month/day");let p;i?p=Zz({...vC(this.c),...t}):Ji(t.ordinal)?(p={...this.toObject(),...t},Ji(t.day)&&(p.day=Math.min(sM(p.year,p.month),p.day))):p=Xz({...r2(this.c),...t});const[_,w]=dS(p,this.o,this.zone);return ux(this,{ts:_,o:w})}plus(e){if(!this.isValid)return this;const t=lr.fromDurationLike(e);return ux(this,Kz(this,t))}minus(e){if(!this.isValid)return this;const t=lr.fromDurationLike(e).negate();return ux(this,Kz(this,t))}startOf(e){if(!this.isValid)return this;const t={},i=lr.normalizeUnit(e);switch(i){case"years":t.month=1;case"quarters":case"months":t.day=1;case"weeks":case"days":t.hour=0;case"hours":t.minute=0;case"minutes":t.second=0;case"seconds":t.millisecond=0;break}if(i==="weeks"&&(t.weekday=1),i==="quarters"){const r=Math.ceil(this.month/3);t.month=(r-1)*3+1}return this.set(t)}endOf(e){return this.isValid?this.plus({[e]:1}).startOf(e).minus(1):this}toFormat(e,t={}){return this.isValid?ca.create(this.loc.redefaultToEN(t)).formatDateTimeFromString(this,e):s2}toLocaleString(e=rM,t={}){return this.isValid?ca.create(this.loc.clone(t),e).formatDateTime(this):s2}toLocaleParts(e={}){return this.isValid?ca.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:t=!1,suppressMilliseconds:i=!1,includeOffset:r=!0,extendedZone:o=!1}={}){if(!this.isValid)return null;const l=e==="extended";let s=a2(this,l);return s+="T",s+=Jz(this,l,t,i,r,o),s}toISODate({format:e="extended"}={}){return this.isValid?a2(this,e==="extended"):null}toISOWeekDate(){return ab(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:t=!1,includeOffset:i=!0,includePrefix:r=!1,extendedZone:o=!1,format:l="extended"}={}){return this.isValid?(r?"T":"")+Jz(this,l==="extended",t,e,i,o):null}toRFC2822(){return ab(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return ab(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?a2(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:t=!1,includeOffsetSpace:i=!0}={}){let r="HH:mm:ss.SSS";return(t||e)&&(i&&(r+=" "),t?r+="z":e&&(r+="ZZ")),ab(this,r,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():s2}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const t={...this.c};return e.includeConfig&&(t.outputCalendar=this.outputCalendar,t.numberingSystem=this.loc.numberingSystem,t.locale=this.loc.locale),t}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,t="milliseconds",i={}){if(!this.isValid||!e.isValid)return lr.invalid("created by diffing an invalid DateTime");const r={locale:this.locale,numberingSystem:this.numberingSystem,...i},o=S$(t).map(lr.normalizeUnit),l=e.valueOf()>this.valueOf(),s=l?this:e,d=l?e:this,p=PY(s,d,o,r);return l?p.negate():p}diffNow(e="milliseconds",t={}){return this.diff(ti.now(),e,t)}until(e){return this.isValid?ws.fromDateTimes(this,e):this}hasSame(e,t){if(!this.isValid)return!1;const i=e.valueOf(),r=this.setZone(e.zone,{keepLocalTime:!0});return r.startOf(t)<=i&&i<=r.endOf(t)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const t=e.base||ti.fromObject({},{zone:this.zone}),i=e.padding?this<t?-e.padding:e.padding:0;let r=["years","months","days","hours","minutes","seconds"],o=e.unit;return Array.isArray(e.unit)&&(r=e.unit,o=void 0),tO(t,this.plus(i),{...e,numeric:"always",units:r,unit:o})}toRelativeCalendar(e={}){return this.isValid?tO(e.base||ti.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(ti.isDateTime))throw new xc("min requires all arguments be DateTimes");return Uz(e,t=>t.valueOf(),Math.min)}static max(...e){if(!e.every(ti.isDateTime))throw new xc("max requires all arguments be DateTimes");return Uz(e,t=>t.valueOf(),Math.max)}static fromFormatExplain(e,t,i={}){const{locale:r=null,numberingSystem:o=null}=i,l=jr.fromOpts({locale:r,numberingSystem:o,defaultToEN:!0});return lU(l,e,t)}static fromStringExplain(e,t,i={}){return ti.fromFormatExplain(e,t,i)}static get DATE_SHORT(){return rM}static get DATE_MED(){return b5}static get DATE_MED_WITH_WEEKDAY(){return n$}static get DATE_FULL(){return S5}static get DATE_HUGE(){return M5}static get TIME_SIMPLE(){return T5}static get TIME_WITH_SECONDS(){return E5}static get TIME_WITH_SHORT_OFFSET(){return A5}static get TIME_WITH_LONG_OFFSET(){return C5}static get TIME_24_SIMPLE(){return I5}static get TIME_24_WITH_SECONDS(){return P5}static get TIME_24_WITH_SHORT_OFFSET(){return L5}static get TIME_24_WITH_LONG_OFFSET(){return k5}static get DATETIME_SHORT(){return D5}static get DATETIME_SHORT_WITH_SECONDS(){return R5}static get DATETIME_MED(){return z5}static get DATETIME_MED_WITH_SECONDS(){return O5}static get DATETIME_MED_WITH_WEEKDAY(){return i$}static get DATETIME_FULL(){return F5}static get DATETIME_FULL_WITH_SECONDS(){return B5}static get DATETIME_HUGE(){return N5}static get DATETIME_HUGE_WITH_SECONDS(){return U5}}function dx(n){if(ti.isDateTime(n))return n;if(n&&n.valueOf&&sg(n.valueOf()))return ti.fromJSDate(n);if(n&&typeof n=="object")return ti.fromObject(n);throw new xc(`Unknown datetime argument: ${n}, of type ${typeof n}`)}/*!
 * chartjs-adapter-luxon v1.3.1
 * https://www.chartjs.org
 * (c) 2023 chartjs-adapter-luxon Contributors
 * Released under the MIT license
 */const JY={datetime:ti.DATETIME_MED_WITH_SECONDS,millisecond:"h:mm:ss.SSS a",second:ti.TIME_WITH_SECONDS,minute:ti.TIME_SIMPLE,hour:{hour:"numeric"},day:{day:"numeric",month:"short"},week:"DD",month:{month:"short",year:"numeric"},quarter:"'Q'q - yyyy",year:{year:"numeric"}};Q4._date.override({_id:"luxon",_create:function(n){return ti.fromMillis(n,this.options)},init(n){this.options.locale||(this.options.locale=n.locale)},formats:function(){return JY},parse:function(n,e){const t=this.options,i=typeof n;return n===null||i==="undefined"?null:(i==="number"?n=this._create(n):i==="string"?typeof e=="string"?n=ti.fromFormat(n,e,t):n=ti.fromISO(n,t):n instanceof Date?n=ti.fromJSDate(n,t):i==="object"&&!(n instanceof ti)&&(n=ti.fromObject(n,t)),n.isValid?n.valueOf():null)},format:function(n,e){const t=this._create(n);return typeof e=="string"?t.toFormat(e):t.toLocaleString(e)},add:function(n,e,t){const i={};return i[t]=e,this._create(n).plus(i).valueOf()},diff:function(n,e,t){return this._create(n).diff(this._create(e)).as(t).valueOf()},startOf:function(n,e,t){if(e==="isoWeek"){t=Math.trunc(Math.min(Math.max(0,t),6));const i=this._create(n);return i.minus({days:(i.weekday-t+7)%7}).startOf("day").valueOf()}return e?this._create(n).startOf(e).valueOf():n},endOf:function(n,e){return this._create(n).endOf(e).valueOf()}});/*!
 * chartjs-plugin-streaming v2.0.0
 * https://nagix.github.io/chartjs-plugin-streaming
 * (c) 2017-2021 Akihiko Kusanagi
 * Released under the MIT license
 */function wC(n,e,t){return Math.min(Math.max(n,e),t)}function Hs(n,e){const t=n.options.realtime,i=n.chart.options.plugins.streaming;return Mi(t[e],i[e])}function bC(n,{x:e,y:t},{xAxisID:i,yAxisID:r}){const o={};return yi(e,l=>{o[l]={axisId:i}}),yi(t,l=>{o[l]={axisId:r}}),o}const QY=function(){return typeof window>"u"?ja:window.cancelAnimationFrame}();function eK(n,e){if(!n.frameRequestID){const t=()=>{const i=n.nextRefresh||0,r=Date.now();if(i<=r){const o=_r(e),l=1e3/(Math.max(o,0)||30),s=n.nextRefresh+l||0;n.nextRefresh=s>r?s:r+l}n.frameRequestID=KS.call(window,t)};n.frameRequestID=KS.call(window,t)}}function iO(n){const e=n.frameRequestID;e&&(QY.call(window,e),delete n.frameRequestID)}function vU(n){const e=n.refreshTimerID;e&&(clearInterval(e),delete n.refreshTimerID,delete n.refreshInterval)}function wU(n,e,t){n.refreshTimerID||(n.refreshTimerID=setInterval(()=>{const i=_r(e);n.refreshInterval!==i&&!isNaN(i)&&(vU(n),wU(n,e,i))},t||0),n.refreshInterval=t||0)}function Mu(n,e,t){return e=typeof e=="number"?e:n.parse(e),ao(e)?{value:n.getPixelForValue(e),transitionable:!0}:{value:t}}function tK(n,e,t){const{scales:i,chartArea:r}=e,{xScaleID:o,yScaleID:l,xMin:s,xMax:d,yMin:p,yMax:_}=t,w=i[o],M=i[l],{top:A,left:P,bottom:L,right:D}=r,z=n.$streaming={};if(w){const F=Mu(w,s,P),N=Mu(w,d,D),V=F.value>N.value;F.transitionable&&(z[V?"x2":"x"]={axisId:o}),N.transitionable&&(z[V?"x":"x2"]={axisId:o}),F.transitionable!==N.transitionable&&(z.width={axisId:o,reverse:F.transitionable})}if(M){const F=Mu(M,p,A),N=Mu(M,_,L),V=F.value>N.value;F.transitionable&&(z[V?"y2":"y"]={axisId:l}),N.transitionable&&(z[V?"y":"y2"]={axisId:l}),F.transitionable!==N.transitionable&&(z.height={axisId:l,reverse:F.transitionable})}}function nK(n,e,t){const{scales:i,chartArea:r}=e,{scaleID:o,value:l}=t,s=i[o],{top:d,left:p,bottom:_,right:w}=r,M=n.$streaming={};if(s){const Q=s.isHorizontal();return Mu(s,l).transitionable&&(M[Q?"x":"y"]={axisId:o},M[Q?"x2":"y2"]={axisId:o}),Q?{top:d,bottom:_}:{left:p,right:w}}const{xScaleID:A,yScaleID:P,xMin:L,xMax:D,yMin:z,yMax:F}=t,N=i[A],V=i[P],j={};if(N){const Q=Mu(N,L),re=Mu(N,D);Q.transitionable?M.x={axisId:A}:j.left=p,re.transitionable?M.x2={axisId:A}:j.right=w}if(V){const Q=Mu(V,z),re=Mu(V,F);Q.transitionable?M.y={axisId:P}:j.top=d,re.transitionable?M.y2={axisId:P}:j.bottom=_}return j}function iK(n,e,t){const i=e.scales,{xScaleID:r,yScaleID:o,xValue:l,yValue:s}=t,d=i[r],p=i[o],_=n.$streaming={};d&&Mu(d,l).transitionable&&(_.x={axisId:r}),p&&Mu(p,s).transitionable&&(_.y={axisId:o})}function rK(){const n=Ca.getElement("boxAnnotation"),e=Ca.getElement("lineAnnotation"),t=Ca.getElement("pointAnnotation"),i=n.prototype.resolveElementProperties,r=e.prototype.resolveElementProperties,o=t.prototype.resolveElementProperties;n.prototype.resolveElementProperties=function(l,s){return tK(this,l,s),i.call(this,l,s)},e.prototype.resolveElementProperties=function(l,s){const d=l.chartArea;l.chartArea=nK(this,l,s);const p=r.call(this,l,s);return l.chartArea=d,p},t.prototype.resolveElementProperties=function(l,s){return iK(this,l,s),o.call(this,l,s)}}function sK(n,e){const t=e.$streaming;if(t.annotationPlugin!==n){const i=n.afterUpdate;rK(),t.annotationPlugin=n,n.afterUpdate=(r,o,l)=>{const s=o.mode,d=l.animation;s==="quiet"&&(l.animation=!1),i.call(this,r,o,l),s==="quiet"&&(l.animation=d)}}}function oK(n){const e=n.$streaming.annotationPlugin;if(e){const t=e._getState(n);return t&&t.elements||[]}return[]}function aK(n){delete n.$streaming.annotationPlugin}const lK={x:["x","caretX"],y:["y","caretY"]};function cK(...n){const e=this,t=e.getActiveElements()[0];if(t){const i=e._chart.getDatasetMeta(t.datasetIndex);e.$streaming=bC(e,lK,i)}else e.$streaming={};e.constructor.prototype.update.call(e,...n)}const SC=new WeakMap;function uK(n){let e=SC.get(n);return e||(e={originalScaleOptions:{}},SC.set(n,e)),e}function hK(n){SC.delete(n)}function JP(n){const{originalScaleOptions:e}=uK(n),t=n.scales;return yi(t,i=>{const r=i.id;e[r]||(e[r]={duration:Hs(i,"duration"),delay:Hs(i,"delay")})}),yi(e,(i,r)=>{t[r]||delete e[r]}),e}function dK(n,e,t,i){const{chart:r,axis:o}=n,{minDuration:l=0,maxDuration:s=1/0,minDelay:d=-1/0,maxDelay:p=1/0}=i&&i[o]||{},_=n.options.realtime,w=Hs(n,"duration"),M=Hs(n,"delay"),A=wC(w*(2-e),l,s);let P,L;return JP(r),n.isHorizontal()?P=(n.right-t.x)/(n.right-n.left):P=(n.bottom-t.y)/(n.bottom-n.top),L=M+P*(w-A),_.duration=A,_.delay=wC(L,d,p),A!==n.max-n.min}function fK(n,e,t){const{chart:i,axis:r}=n,{minDelay:o=-1/0,maxDelay:l=1/0}=t&&t[r]||{},d=Hs(n,"delay")+(n.getValueForPixel(e)-n.getValueForPixel(0));return JP(i),n.options.realtime.delay=wC(d,o,l),!0}function pK(n){const e=JP(n);yi(n.scales,t=>{const i=t.options.realtime;if(i){const r=e[t.id];r?(i.duration=r.duration,i.delay=r.delay):(delete i.duration,delete i.delay)}})}function mK(n){n.zoomFunctions.realtime=dK,n.panFunctions.realtime=fK}function gK(n,e){const t=e.$streaming;if(t.zoomPlugin!==n){const i=t.resetZoom=e.resetZoom;mK(n),e.resetZoom=r=>{pK(e),i(r)},t.zoomPlugin=n}}function _K(n){const e=n.$streaming;e.zoomPlugin&&(n.resetZoom=e.resetZoom,hK(n),delete e.resetZoom,delete e.zoomPlugin)}const _1={millisecond:{common:!0,size:1,steps:[1,2,5,10,20,50,100,250,500]},second:{common:!0,size:1e3,steps:[1,2,5,10,15,30]},minute:{common:!0,size:6e4,steps:[1,2,5,10,15,30]},hour:{common:!0,size:36e5,steps:[1,2,3,6,12]},day:{common:!0,size:864e5,steps:[1,2,5]},week:{common:!1,size:6048e5,steps:[1,2,3,4]},month:{common:!0,size:2628e6,steps:[1,2,3]},quarter:{common:!1,size:7884e6,steps:[1,2,3,4]},year:{common:!0,size:3154e7}},Ld=Object.keys(_1);function yK(n,e,t,i){const r=e-n,{size:o,steps:l}=_1[t];let s;if(!l)return Math.ceil(r/(i*o));for(let d=0,p=l.length;d<p&&(s=l[d],!(Math.ceil(r/(o*s))<=i));++d);return s}function xK(n,e,t,i){const r=t-e,o=Ld.length;for(let l=Ld.indexOf(n);l<o-1;++l){const{common:s,size:d,steps:p}=_1[Ld[l]],_=p?p[p.length-1]:Number.MAX_SAFE_INTEGER;if(s&&Math.ceil(r/(_*d))<=i)return Ld[l]}return Ld[o-1]}function vK(n){for(let e=Ld.indexOf(n)+1,t=Ld.length;e<t;++e)if(_1[Ld[e]].common)return Ld[e]}function rO(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:i,hi:r}=NM(t,e),o=t[i]>=e?t[i]:t[r];n[o]=!0}}const wK=["pointBackgroundColor","pointBorderColor","pointBorderWidth","pointRadius","pointRotation","pointStyle","pointHitRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointHoverRadius","backgroundColor","borderColor","borderSkipped","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","radius","rotation"];function bK(n){const{chart:e,id:t,max:i}=n,r=Hs(n,"duration"),o=Hs(n,"delay"),l=Hs(n,"ttl"),s=Hs(n,"pause"),d=Date.now()-(isNaN(l)?r+o:l);let p,_,w,M;yi(e.data.datasets,(A,P)=>{const L=e.getDatasetMeta(P),D=t===L.xAxisID&&"x"||t===L.yAxisID&&"y";if(D){const z=L.controller,F=A.data,N=F.length;if(s){for(p=0;p<N;++p){const V=z.getParsed(p);if(V&&!(V[D]<i))break}_=p+2}else _=0;for(p=_;p<N;++p){const V=z.getParsed(p);if(!V||!(V[D]<=d))break}w=p-_,isNaN(l)&&(w=Math.max(w-2,0)),F.splice(_,w),yi(wK,V=>{zr(A[V])&&A[V].splice(_,w)}),yi(A.datalabels,V=>{zr(V)&&V.splice(_,w)}),typeof F[0]!="object"&&(M={start:_,count:w}),yi(e._active,(V,j)=>{V.datasetIndex===P&&V.index>=_&&(V.index>=_+w?V.index-=w:e._active.splice(j,1))},null,!0)}}),M&&e.data.labels.splice(M.start,M.count)}function lb(n,e,t){const i=n.$animations||{};yi(n.$streaming,(r,o)=>{if(r.axisId===e){const l=r.reverse?-t:t,s=i[o];ao(n[o])&&(n[o]-=l),s&&(s._from-=l,s._to-=l)}})}function SK(n){const{chart:e,id:t,$realtime:i}=n,r=Hs(n,"duration"),o=Hs(n,"delay"),l=n.isHorizontal(),s=l?n.width:n.height,d=Date.now(),p=e.tooltip,_=oK(e);let w=s*(d-i.head)/r;l===!!n.options.reverse&&(w=-w),yi(e.data.datasets,(M,A)=>{const P=e.getDatasetMeta(A),{data:L=[],dataset:D}=P;for(let z=0,F=L.length;z<F;++z)lb(L[z],t,w);D&&(lb(D,t,w),delete D._path)});for(let M=0,A=_.length;M<A;++M)lb(_[M],t,w);p&&lb(p,t,w),n.max=d-o,n.min=n.max-r,i.head=d}class hy extends d1{constructor(e){super(e),this.$realtime=this.$realtime||{}}init(e,t){const i=this;super.init(e,t),wU(i.$realtime,()=>{const r=i.chart,o=Hs(i,"onRefresh");return _r(o,[r],i),bK(i),r.update("quiet"),Hs(i,"refresh")})}update(e,t,i){const r=this,{$realtime:o,options:l}=r,{bounds:s,offset:d,ticks:p}=l,{autoSkip:_,source:w,major:M}=p,A=M.enabled;Hs(r,"pause")?iO(o):(o.frameRequestID||(o.head=Date.now()),eK(o,()=>{const P=r.chart,L=P.$streaming;return SK(r),L&&_r(L.render,[P]),Hs(r,"frameRate")})),l.bounds=void 0,l.offset=!1,p.autoSkip=!1,p.source=w==="auto"?"":w,M.enabled=!0,super.update(e,t,i),l.bounds=s,l.offset=d,p.autoSkip=_,p.source=w,M.enabled=A}buildTicks(){const e=this,t=Hs(e,"duration"),i=Hs(e,"delay"),r=e.$realtime.head-i,o=r-t,l=[1e15,r],s=[-1e15,o];Object.defineProperty(e,"min",{get:()=>s.shift(),set:ja}),Object.defineProperty(e,"max",{get:()=>l.shift(),set:ja});const d=super.buildTicks();return delete e.min,delete e.max,e.min=o,e.max=r,d}calculateLabelRotation(){const e=this.options.ticks,t=e.maxRotation;e.maxRotation=e.minRotation||0,super.calculateLabelRotation(),e.maxRotation=t}fit(){const e=this,t=e.options;super.fit(),t.ticks.display&&t.display&&e.isHorizontal()&&(e.paddingLeft=3,e.paddingRight=3,e._handleMargins())}draw(e){const t=this,{chart:i,ctx:r}=t,o=t.isHorizontal()?{left:e.left,top:0,right:e.right,bottom:i.height}:{left:0,top:e.top,right:i.width,bottom:e.bottom};t._gridLineItems=null,t._labelItems=null,o1(r,o),super.draw(e),a1(r)}destroy(){const e=this.$realtime;iO(e),vU(e)}_generate(){const e=this,t=e._adapter,i=Hs(e,"duration"),r=Hs(e,"delay"),o=Hs(e,"refresh"),l=e.$realtime.head-r,s=l-i,d=e._getLabelCapacity(s),{time:p,ticks:_}=e.options,w=p.unit||xK(p.minUnit,s,l,d),M=vK(w),A=p.stepSize||yK(s,l,w,d),P=w==="week"?p.isoWeekday:!1,L=_.major.enabled,D=xg(P)||P===!0,z=_1[w],F={};let N=s,V,j;if(D&&(N=+t.startOf(N,"isoWeek",P)),N=+t.startOf(N,D?"day":w),t.diff(l,s,w)>1e5*A)throw new Error(s+" and "+l+" are too far apart with stepSize of "+A+" "+w);V=N,L&&M&&!D&&!p.round&&(V=+t.startOf(V,M),V=+t.add(V,~~((N-V)/(z.size*A))*A,w));const Q=_.source==="data"&&e.getDataTimestamps();for(j=0;V<l+o;V=+t.add(V,A,w),j++)rO(F,V,Q);return(V===l+o||j===1)&&rO(F,V,Q),Object.keys(F).sort((re,Z)=>re-Z).map(re=>+re)}}hy.id="realtime";hy.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},realtime:{},ticks:{autoSkip:!1,source:"auto",major:{enabled:!0}}};Fi.describe("scale.realtime",{_scriptable:n=>n!=="onRefresh"});var MK="2.0.0";Fi.set("transitions",{quiet:{animation:{duration:0}}});const sO={x:["x","cp1x","cp2x"],y:["y","cp1y","cp2y"]};function TK(n){const e=this;n==="quiet"&&yi(e.data.datasets,(t,i)=>{const r=e.getDatasetMeta(i).controller;r._setStyle=function(o,l,s,d){Dc.prototype._setStyle.call(this,o,l,"quiet",d)}}),Yy.prototype.update.call(e,n),n==="quiet"&&yi(e.data.datasets,(t,i)=>{delete e.getDatasetMeta(i).controller._setStyle})}function EK(n){const e=n.$streaming;n.render(),e.lastMouseEvent&&setTimeout(()=>{const t=e.lastMouseEvent;t&&n._eventHandler(t)},0)}var AK={id:"streaming",version:MK,beforeInit(n){const e=n.$streaming=n.$streaming||{render:EK},t=e.canvas=n.canvas,i=e.mouseEventListener=r=>{const o=Xf(r,n);e.lastMouseEvent={type:"mousemove",chart:n,native:r,x:o.x,y:o.y}};t.addEventListener("mousedown",i),t.addEventListener("mouseup",i)},afterInit(n){n.update=TK},beforeUpdate(n){const{scales:e,elements:t}=n.options,i=n.tooltip;yi(e,({type:r})=>{r==="realtime"&&(t.line.capBezierPoints=!1)}),i&&(i.update=cK);try{const r=Ca.getPlugin("annotation");sK(r,n)}catch{aK(n)}try{const r=Ca.getPlugin("zoom");gK(r,n)}catch{_K(n)}},beforeDatasetUpdate(n,e){const{meta:t,mode:i}=e;if(i==="quiet"){const{controller:r,$animations:o}=t;o&&o.visible&&o.visible._active&&(r.updateElement=ja,r.updateSharedOptions=ja)}},afterDatasetUpdate(n,e){const{meta:t,mode:i}=e,{data:r=[],dataset:o,controller:l}=t;for(let s=0,d=r.length;s<d;++s)r[s].$streaming=bC(r[s],sO,t);o&&(o.$streaming=bC(o,sO,t)),i==="quiet"&&(delete l.updateElement,delete l.updateSharedOptions)},beforeDatasetDraw(n,e){const{ctx:t,chartArea:i,width:r,height:o}=n,{xAxisID:l,yAxisID:s,controller:d}=e.meta,p={left:0,top:0,right:r,bottom:o};l&&d.getScaleForId(l)instanceof hy&&(p.left=i.left,p.right=i.right),s&&d.getScaleForId(s)instanceof hy&&(p.top=i.top,p.bottom=i.bottom),o1(t,p)},afterDatasetDraw(n){a1(n.ctx)},beforeEvent(n,e){const t=n.$streaming,i=e.event;i.type==="mousemove"?t.lastMouseEvent=i:i.type==="mouseout"&&delete t.lastMouseEvent},destroy(n){const{scales:e,$streaming:t,tooltip:i}=n,{canvas:r,mouseEventListener:o}=t;delete n.update,i&&delete i.update,r.removeEventListener("mousedown",o),r.removeEventListener("mouseup",o),yi(e,l=>{l instanceof hy&&l.destroy()})},defaults:{duration:1e4,delay:0,frameRate:30,refresh:1e3,onRefresh:null,pause:!1,ttl:void 0},descriptors:{_scriptable:n=>n!=="onRefresh"}};const CK=[AK,hy];Yy.register(nM,HP,WM,h1,xX,AX,_X,CK);let IK=$t.forwardRef((n,e)=>{let t,i=[{}];switch(n.type){case"altitude":t="Altitude (m)",i=[{id:1,label:"filtered altitude",backgroundColor:"rgba(255, 99, 132, 0.5)",borderColor:"rgb(255, 99, 132)",data:[],borderWidth:2,pointRadius:2},{id:2,label:"raw altitude",backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgb(54, 162, 235)",data:[],pointRadius:2}];break;case"velocity":t="Velocity (m/s)",i=[{id:1,label:"filtered velocity",backgroundColor:"rgba(255, 99, 132, 0.5)",borderColor:"rgb(255, 99, 132)",data:[]}];break;case"acceleration":t="Acceleration (m/s^2)",i=[{id:1,label:"filtered acceleration",backgroundColor:"rgba(255, 99, 132, 0.5)",borderColor:"rgb(255, 99, 132)",data:[]},{id:2,label:"ax",backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgb(54, 162, 235)",data:[]},{id:3,label:"ay",borderColor:"rgb(255,165,0)",backgroundColor:"rgb(255,165,0,0.1)",data:[]},{id:4,label:"az",borderColor:"rgb(60,186,159)",backgroundColor:"rgb(60,186,159,0.1)",data:[]}];break;case"gyroscope":t="Gyroscope (rad/s)";break;default:t="Altitude (m)"}return yr(JX,{ref:e,data:{datasets:i},options:{datasets:{line:{borderWidth:1,pointRadius:1}},scales:{x:{type:"realtime",realtime:{},ticks:{font:{size:12,weight:"bolder"},color:"#000"},title:{display:!0,text:"Time",font:{size:18,weight:"bolder"},color:"#000"}},y:{ticks:{font:{size:15,weight:"bolder"},color:"#000"},title:{display:!0,text:t,font:{size:18,weight:"bolder"},color:"#000"}}},plugins:{legend:{position:"top",align:"end"},title:{display:!1,text:"Telemetry Graph"}}}})});const l2=$t.memo(IK);function Ad(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function bU(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ol={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Iy={duration:.5,overwrite:!1,delay:0},QP,da,js,Tc=1e8,Rr=1/Tc,MC=Math.PI*2,PK=MC/4,LK=0,SU=Math.sqrt,kK=Math.cos,DK=Math.sin,Co=function(e){return typeof e=="string"},Ts=function(e){return typeof e=="function"},$d=function(e){return typeof e=="number"},eL=function(e){return typeof e>"u"},Ch=function(e){return typeof e=="object"},el=function(e){return e!==!1},MU=function(){return typeof window<"u"},cb=function(e){return Ts(e)||Co(e)},TU=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},fa=Array.isArray,TC=/(?:-?\.?\d|\.)+/gi,EU=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,J_=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,c2=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,AU=/[+-]=-?[.\d]+/,CU=/[^,'"\[\]\s]+/gi,RK=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ls,pc,EC,tL,Nl={},lM={},IU,PU=function(e){return(lM=bg(e,Nl))&&Ul},nL=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},cM=function(e,t){return!t&&console.warn(e)},LU=function(e,t){return e&&(Nl[e]=t)&&lM&&(lM[e]=t)||Nl},Rv=function(){return 0},zK={suppressEvents:!0,isStart:!0,kill:!1},fS={suppressEvents:!0,kill:!1},OK={suppressEvents:!0},iL={},wp=[],AC={},kU,Pl={},u2={},oO=30,pS=[],rL="",sL=function(e){var t=e[0],i,r;if(Ch(t)||Ts(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=pS.length;r--&&!pS[r].targetTest(t););i=pS[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new e6(e[r],i)))||e.splice(r,1);return e},og=function(e){return e._gsap||sL(Ec(e))[0]._gsap},DU=function(e,t,i){return(i=e[t])&&Ts(i)?e[t]():eL(i)&&e.getAttribute&&e.getAttribute(t)||i},tl=function(e,t){return(e=e.split(",")).forEach(t)||e},zs=function(e){return Math.round(e*1e5)/1e5||0},Bo=function(e){return Math.round(e*1e7)/1e7||0},dy=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+r:i==="-"?e-r:i==="*"?e*r:e/r},FK=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},uM=function(){var e=wp.length,t=wp.slice(0),i,r;for(AC={},wp.length=0,i=0;i<e;i++)r=t[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},RU=function(e,t,i,r){wp.length&&!da&&uM(),e.render(t,i,r||da&&t<0&&(e._initted||e._startAt)),wp.length&&!da&&uM()},zU=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(CU).length<2?t:Co(e)?e.trim():e},OU=function(e){return e},kc=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},BK=function(e){return function(t,i){for(var r in i)r in t||r==="duration"&&e||r==="ease"||(t[r]=i[r])}},bg=function(e,t){for(var i in t)e[i]=t[i];return e},aO=function n(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Ch(t[i])?n(e[i]||(e[i]={}),t[i]):t[i]);return e},hM=function(e,t){var i={},r;for(r in e)r in t||(i[r]=e[r]);return i},rv=function(e){var t=e.parent||ls,i=e.keyframes?BK(fa(e.keyframes)):kc;if(el(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},NK=function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0},FU=function(e,t,i,r,o){i===void 0&&(i="_first"),r===void 0&&(r="_last");var l=e[r],s;if(o)for(s=t[o];l&&l[o]>s;)l=l._prev;return l?(t._next=l._next,l._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=l,t.parent=t._dp=e,t},YM=function(e,t,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var o=t._prev,l=t._next;o?o._next=l:e[i]===t&&(e[i]=l),l?l._prev=o:e[r]===t&&(e[r]=o),t._next=t._prev=t.parent=null},Cp=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove(e),e._act=0},ag=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},UK=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},CC=function(e,t,i,r){return e._startAt&&(da?e._startAt.revert(fS):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},VK=function n(e){return!e||e._ts&&n(e.parent)},lO=function(e){return e._repeat?Py(e._tTime,e=e.duration()+e._rDelay)*e:0},Py=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},dM=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},KM=function(e){return e._end=Bo(e._start+(e._tDur/Math.abs(e._ts||e._rts||Rr)||0))},JM=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=Bo(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),KM(e),i._dirty||ag(i,e)),e},BU=function(e,t){var i;if((t._time||t._initted&&!t._dur)&&(i=dM(e.rawTime(),t),(!t._dur||y1(0,t.totalDuration(),i)-t._tTime>Rr)&&t.render(i,!0)),ag(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-Rr}},wh=function(e,t,i,r){return t.parent&&Cp(t),t._start=Bo(($d(i)?i:i||e!==ls?fc(e,i,t):e._time)+t._delay),t._end=Bo(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),FU(e,t,"_first","_last",e._sort?"_start":0),IC(t)||(e._recent=t),r||BU(e,t),e._ts<0&&JM(e,e._tTime),e},NU=function(e,t){return(Nl.ScrollTrigger||nL("scrollTrigger",t))&&Nl.ScrollTrigger.create(t,e)},UU=function(e,t,i,r,o){if(aL(e,t,o),!e._initted)return 1;if(!i&&e._pt&&!da&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&kU!==Ll.frame)return wp.push(e),e._lazy=[o,r],1},GK=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},IC=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},WK=function(e,t,i,r){var o=e.ratio,l=t<0||!t&&(!e._start&&GK(e)&&!(!e._initted&&IC(e))||(e._ts<0||e._dp._ts<0)&&!IC(e))?0:1,s=e._rDelay,d=0,p,_,w;if(s&&e._repeat&&(d=y1(0,e._tDur,t),_=Py(d,s),e._yoyo&&_&1&&(l=1-l),_!==Py(e._tTime,s)&&(o=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==o||da||r||e._zTime===Rr||!t&&e._zTime){if(!e._initted&&UU(e,t,r,i,d))return;for(w=e._zTime,e._zTime=t||(i?Rr:0),i||(i=t&&!w),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=d,p=e._pt;p;)p.r(l,p.d),p=p._next;t<0&&CC(e,t,i,!0),e._onUpdate&&!i&&Ac(e,"onUpdate"),d&&e._repeat&&!i&&e.parent&&Ac(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===l&&(l&&Cp(e,1),!i&&!da&&(Ac(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},HK=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},Ly=function(e,t,i,r){var o=e._repeat,l=Bo(t)||0,s=e._tTime/e._tDur;return s&&!r&&(e._time*=l/e._dur),e._dur=l,e._tDur=o?o<0?1e10:Bo(l*(o+1)+e._rDelay*o):l,s>0&&!r&&JM(e,e._tTime=e._tDur*s),e.parent&&KM(e),i||ag(e.parent,e),e},cO=function(e){return e instanceof Xa?ag(e):Ly(e,e._dur)},jK={_start:0,endTime:Rv,totalDuration:Rv},fc=function n(e,t,i){var r=e.labels,o=e._recent||jK,l=e.duration()>=Tc?o.endTime(!1):e._dur,s,d,p;return Co(t)&&(isNaN(t)||t in r)?(d=t.charAt(0),p=t.substr(-1)==="%",s=t.indexOf("="),d==="<"||d===">"?(s>=0&&(t=t.replace(/=/,"")),(d==="<"?o._start:o.endTime(o._repeat>=0))+(parseFloat(t.substr(1))||0)*(p?(s<0?o:i).totalDuration()/100:1)):s<0?(t in r||(r[t]=l),r[t]):(d=parseFloat(t.charAt(s-1)+t.substr(s+1)),p&&i&&(d=d/100*(fa(i)?i[0]:i).totalDuration()),s>1?n(e,t.substr(0,s-1),i)+d:l+d)):t==null?l:+t},sv=function(e,t,i){var r=$d(t[1]),o=(r?2:1)+(e<2?0:1),l=t[o],s,d;if(r&&(l.duration=t[1]),l.parent=i,e){for(s=l,d=i;d&&!("immediateRender"in s);)s=d.vars.defaults||{},d=el(d.vars.inherit)&&d.parent;l.immediateRender=el(s.immediateRender),e<2?l.runBackwards=1:l.startAt=t[o-1]}return new ro(t[0],l,t[o+1])},Np=function(e,t){return e||e===0?t(e):t},y1=function(e,t,i){return i<e?e:i>t?t:i},ua=function(e,t){return!Co(e)||!(t=RK.exec(e))?"":t[1]},qK=function(e,t,i){return Np(i,function(r){return y1(e,t,r)})},PC=[].slice,VU=function(e,t){return e&&Ch(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Ch(e[0]))&&!e.nodeType&&e!==pc},ZK=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(r){var o;return Co(r)&&!t||VU(r,1)?(o=i).push.apply(o,Ec(r)):i.push(r)})||i},Ec=function(e,t,i){return js&&!t&&js.selector?js.selector(e):Co(e)&&!i&&(EC||!ky())?PC.call((t||tL).querySelectorAll(e),0):fa(e)?ZK(e,i):VU(e)?PC.call(e,0):e?[e]:[]},LC=function(e){return e=Ec(e)[0]||cM("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return Ec(t,i.querySelectorAll?i:i===e?cM("Invalid scope")||tL.createElement("div"):e)}},GU=function(e){return e.sort(function(){return .5-Math.random()})},WU=function(e){if(Ts(e))return e;var t=Ch(e)?e:{each:e},i=lg(t.ease),r=t.from||0,o=parseFloat(t.base)||0,l={},s=r>0&&r<1,d=isNaN(r)||s,p=t.axis,_=r,w=r;return Co(r)?_=w={center:.5,edges:.5,end:1}[r]||0:!s&&d&&(_=r[0],w=r[1]),function(M,A,P){var L=(P||t).length,D=l[L],z,F,N,V,j,Q,re,Z,ne;if(!D){if(ne=t.grid==="auto"?0:(t.grid||[1,Tc])[1],!ne){for(re=-Tc;re<(re=P[ne++].getBoundingClientRect().left)&&ne<L;);ne--}for(D=l[L]=[],z=d?Math.min(ne,L)*_-.5:r%ne,F=ne===Tc?0:d?L*w/ne-.5:r/ne|0,re=0,Z=Tc,Q=0;Q<L;Q++)N=Q%ne-z,V=F-(Q/ne|0),D[Q]=j=p?Math.abs(p==="y"?V:N):SU(N*N+V*V),j>re&&(re=j),j<Z&&(Z=j);r==="random"&&GU(D),D.max=re-Z,D.min=Z,D.v=L=(parseFloat(t.amount)||parseFloat(t.each)*(ne>L?L-1:p?p==="y"?L/ne:ne:Math.max(ne,L/ne))||0)*(r==="edges"?-1:1),D.b=L<0?o-L:o,D.u=ua(t.amount||t.each)||0,i=i&&L<0?KU(i):i}return L=(D[M]-D.min)/D.max||0,Bo(D.b+(i?i(L):L)*D.v)+D.u}},kC=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=Bo(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+($d(i)?0:ua(i))}},HU=function(e,t){var i=fa(e),r,o;return!i&&Ch(e)&&(r=i=e.radius||Tc,e.values?(e=Ec(e.values),(o=!$d(e[0]))&&(r*=r)):e=kC(e.increment)),Np(t,i?Ts(e)?function(l){return o=e(l),Math.abs(o-l)<=r?o:l}:function(l){for(var s=parseFloat(o?l.x:l),d=parseFloat(o?l.y:0),p=Tc,_=0,w=e.length,M,A;w--;)o?(M=e[w].x-s,A=e[w].y-d,M=M*M+A*A):M=Math.abs(e[w]-s),M<p&&(p=M,_=w);return _=!r||p<=r?e[_]:l,o||_===l||$d(l)?_:_+ua(l)}:kC(e))},jU=function(e,t,i,r){return Np(fa(e)?!t:i===!0?!!(i=0):!r,function(){return fa(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*r)/r})},XK=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(o,l){return l(o)},r)}},$K=function(e,t){return function(i){return e(parseFloat(i))+(t||ua(i))}},YK=function(e,t,i){return ZU(e,t,0,1,i)},qU=function(e,t,i){return Np(i,function(r){return e[~~t(r)]})},KK=function n(e,t,i){var r=t-e;return fa(e)?qU(e,n(0,e.length),t):Np(i,function(o){return(r+(o-e)%r)%r+e})},JK=function n(e,t,i){var r=t-e,o=r*2;return fa(e)?qU(e,n(0,e.length-1),t):Np(i,function(l){return l=(o+(l-e)%o)%o||0,e+(l>r?o-l:l)})},zv=function(e){for(var t=0,i="",r,o,l,s;~(r=e.indexOf("random(",t));)l=e.indexOf(")",r),s=e.charAt(r+7)==="[",o=e.substr(r+7,l-r-7).match(s?CU:TC),i+=e.substr(t,r-t)+jU(s?o:+o[0],s?0:+o[1],+o[2]||1e-5),t=l+1;return i+e.substr(t,e.length-t)},ZU=function(e,t,i,r,o){var l=t-e,s=r-i;return Np(o,function(d){return i+((d-e)/l*s||0)})},QK=function n(e,t,i,r){var o=isNaN(e+t)?0:function(A){return(1-A)*e+A*t};if(!o){var l=Co(e),s={},d,p,_,w,M;if(i===!0&&(r=1)&&(i=null),l)e={p:e},t={p:t};else if(fa(e)&&!fa(t)){for(_=[],w=e.length,M=w-2,p=1;p<w;p++)_.push(n(e[p-1],e[p]));w--,o=function(P){P*=w;var L=Math.min(M,~~P);return _[L](P-L)},i=t}else r||(e=bg(fa(e)?[]:{},e));if(!_){for(d in t)oL.call(s,e,d,"get",t[d]);o=function(P){return uL(P,s)||(l?e.p:e)}}}return Np(i,o)},uO=function(e,t,i){var r=e.labels,o=Tc,l,s,d;for(l in r)s=r[l]-t,s<0==!!i&&s&&o>(s=Math.abs(s))&&(d=l,o=s);return d},Ac=function(e,t,i){var r=e.vars,o=r[t],l=js,s=e._ctx,d,p,_;if(o)return d=r[t+"Params"],p=r.callbackScope||e,i&&wp.length&&uM(),s&&(js=s),_=d?o.apply(p,d):o.call(p),js=l,_},Nx=function(e){return Cp(e),e.scrollTrigger&&e.scrollTrigger.kill(!!da),e.progress()<1&&Ac(e,"onInterrupt"),e},Q_,eJ=function(e){e=!e.name&&e.default||e;var t=e.name,i=Ts(e),r=t&&!i&&e.init?function(){this._props=[]}:e,o={init:Rv,render:uL,add:oL,kill:gJ,modifier:mJ,rawVars:0},l={targetTest:0,get:0,getSetter:cL,aliases:{},register:0};if(ky(),e!==r){if(Pl[t])return;kc(r,kc(hM(e,o),l)),bg(r.prototype,bg(o,hM(e,l))),Pl[r.prop=t]=r,e.targetTest&&(pS.push(r),iL[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}LU(t,r),e.register&&e.register(Ul,r,nl)},kr=255,Ux={aqua:[0,kr,kr],lime:[0,kr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,kr],navy:[0,0,128],white:[kr,kr,kr],olive:[128,128,0],yellow:[kr,kr,0],orange:[kr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[kr,0,0],pink:[kr,192,203],cyan:[0,kr,kr],transparent:[kr,kr,kr,0]},h2=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*kr+.5|0},XU=function(e,t,i){var r=e?$d(e)?[e>>16,e>>8&kr,e&kr]:0:Ux.black,o,l,s,d,p,_,w,M,A,P;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Ux[e])r=Ux[e];else if(e.charAt(0)==="#"){if(e.length<6&&(o=e.charAt(1),l=e.charAt(2),s=e.charAt(3),e="#"+o+o+l+l+s+s+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&kr,r&kr,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&kr,e&kr]}else if(e.substr(0,3)==="hsl"){if(r=P=e.match(TC),!t)d=+r[0]%360/360,p=+r[1]/100,_=+r[2]/100,l=_<=.5?_*(p+1):_+p-_*p,o=_*2-l,r.length>3&&(r[3]*=1),r[0]=h2(d+1/3,o,l),r[1]=h2(d,o,l),r[2]=h2(d-1/3,o,l);else if(~e.indexOf("="))return r=e.match(EU),i&&r.length<4&&(r[3]=1),r}else r=e.match(TC)||Ux.transparent;r=r.map(Number)}return t&&!P&&(o=r[0]/kr,l=r[1]/kr,s=r[2]/kr,w=Math.max(o,l,s),M=Math.min(o,l,s),_=(w+M)/2,w===M?d=p=0:(A=w-M,p=_>.5?A/(2-w-M):A/(w+M),d=w===o?(l-s)/A+(l<s?6:0):w===l?(s-o)/A+2:(o-l)/A+4,d*=60),r[0]=~~(d+.5),r[1]=~~(p*100+.5),r[2]=~~(_*100+.5)),i&&r.length<4&&(r[3]=1),r},$U=function(e){var t=[],i=[],r=-1;return e.split(bp).forEach(function(o){var l=o.match(J_)||[];t.push.apply(t,l),i.push(r+=l.length+1)}),t.c=i,t},hO=function(e,t,i){var r="",o=(e+r).match(bp),l=t?"hsla(":"rgba(",s=0,d,p,_,w;if(!o)return e;if(o=o.map(function(M){return(M=XU(M,t,1))&&l+(t?M[0]+","+M[1]+"%,"+M[2]+"%,"+M[3]:M.join(","))+")"}),i&&(_=$U(e),d=i.c,d.join(r)!==_.c.join(r)))for(p=e.replace(bp,"1").split(J_),w=p.length-1;s<w;s++)r+=p[s]+(~d.indexOf(s)?o.shift()||l+"0,0,0,0)":(_.length?_:o.length?o:i).shift());if(!p)for(p=e.split(bp),w=p.length-1;s<w;s++)r+=p[s]+o[s];return r+p[w]},bp=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Ux)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),tJ=/hsl[a]?\(/,YU=function(e){var t=e.join(" "),i;if(bp.lastIndex=0,bp.test(t))return i=tJ.test(t),e[1]=hO(e[1],i),e[0]=hO(e[0],i,$U(e[1])),!0},Ov,Ll=function(){var n=Date.now,e=500,t=33,i=n(),r=i,o=1e3/240,l=o,s=[],d,p,_,w,M,A,P=function L(D){var z=n()-r,F=D===!0,N,V,j,Q;if(z>e&&(i+=z-t),r+=z,j=r-i,N=j-l,(N>0||F)&&(Q=++w.frame,M=j-w.time*1e3,w.time=j=j/1e3,l+=N+(N>=o?4:o-N),V=1),F||(d=p(L)),V)for(A=0;A<s.length;A++)s[A](j,M,Q,D)};return w={time:0,frame:0,tick:function(){P(!0)},deltaRatio:function(D){return M/(1e3/(D||60))},wake:function(){IU&&(!EC&&MU()&&(pc=EC=window,tL=pc.document||{},Nl.gsap=Ul,(pc.gsapVersions||(pc.gsapVersions=[])).push(Ul.version),PU(lM||pc.GreenSockGlobals||!pc.gsap&&pc||{}),_=pc.requestAnimationFrame),d&&w.sleep(),p=_||function(D){return setTimeout(D,l-w.time*1e3+1|0)},Ov=1,P(2))},sleep:function(){(_?pc.cancelAnimationFrame:clearTimeout)(d),Ov=0,p=Rv},lagSmoothing:function(D,z){e=D||1/0,t=Math.min(z||33,e)},fps:function(D){o=1e3/(D||240),l=w.time*1e3+o},add:function(D,z,F){var N=z?function(V,j,Q,re){D(V,j,Q,re),w.remove(N)}:D;return w.remove(D),s[F?"unshift":"push"](N),ky(),N},remove:function(D,z){~(z=s.indexOf(D))&&s.splice(z,1)&&A>=z&&A--},_listeners:s},w}(),ky=function(){return!Ov&&Ll.wake()},ji={},nJ=/^[\d.\-M][\d.\-,\s]/,iJ=/["']/g,rJ=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),r=i[0],o=1,l=i.length,s,d,p;o<l;o++)d=i[o],s=o!==l-1?d.lastIndexOf(","):d.length,p=d.substr(0,s),t[r]=isNaN(p)?p.replace(iJ,"").trim():+p,r=d.substr(s+1).trim();return t},sJ=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)},oJ=function(e){var t=(e+"").split("("),i=ji[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[rJ(t[1])]:sJ(e).split(",").map(zU)):ji._CE&&nJ.test(e)?ji._CE("",e):i},KU=function(e){return function(t){return 1-e(1-t)}},JU=function n(e,t){for(var i=e._first,r;i;)i instanceof Xa?n(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?n(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},lg=function(e,t){return e&&(Ts(e)?e:ji[e]||oJ(e))||t},Lg=function(e,t,i,r){i===void 0&&(i=function(d){return 1-t(1-d)}),r===void 0&&(r=function(d){return d<.5?t(d*2)/2:1-t((1-d)*2)/2});var o={easeIn:t,easeOut:i,easeInOut:r},l;return tl(e,function(s){ji[s]=Nl[s]=o,ji[l=s.toLowerCase()]=i;for(var d in o)ji[l+(d==="easeIn"?".in":d==="easeOut"?".out":".inOut")]=ji[s+"."+d]=o[d]}),o},QU=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},d2=function n(e,t,i){var r=t>=1?t:1,o=(i||(e?.3:.45))/(t<1?t:1),l=o/MC*(Math.asin(1/r)||0),s=function(_){return _===1?1:r*Math.pow(2,-10*_)*DK((_-l)*o)+1},d=e==="out"?s:e==="in"?function(p){return 1-s(1-p)}:QU(s);return o=MC/o,d.config=function(p,_){return n(e,p,_)},d},f2=function n(e,t){t===void 0&&(t=1.70158);var i=function(l){return l?--l*l*((t+1)*l+t)+1:0},r=e==="out"?i:e==="in"?function(o){return 1-i(1-o)}:QU(i);return r.config=function(o){return n(e,o)},r};tl("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;Lg(n+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});ji.Linear.easeNone=ji.none=ji.Linear.easeIn;Lg("Elastic",d2("in"),d2("out"),d2());(function(n,e){var t=1/e,i=2*t,r=2.5*t,o=function(s){return s<t?n*s*s:s<i?n*Math.pow(s-1.5/e,2)+.75:s<r?n*(s-=2.25/e)*s+.9375:n*Math.pow(s-2.625/e,2)+.984375};Lg("Bounce",function(l){return 1-o(1-l)},o)})(7.5625,2.75);Lg("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});Lg("Circ",function(n){return-(SU(1-n*n)-1)});Lg("Sine",function(n){return n===1?1:-kK(n*PK)+1});Lg("Back",f2("in"),f2("out"),f2());ji.SteppedEase=ji.steps=Nl.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,r=e+(t?0:1),o=t?1:0,l=1-Rr;return function(s){return((r*y1(0,l,s)|0)+o)*i}}};Iy.ease=ji["quad.out"];tl("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return rL+=n+","+n+"Params,"});var e6=function(e,t){this.id=LK++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:DU,this.set=t?t.getSetter:cL},Dy=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Ly(this,+t.duration,1,1),this.data=t.data,js&&(this._ctx=js,js.data.push(this)),Ov||Ll.wake()}var e=n.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,Ly(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(ky(),!arguments.length)return this._tTime;var o=this._dp;if(o&&o.smoothChildTiming&&this._ts){for(JM(this,i),!o._dp||o.parent||BU(o,this);o&&o.parent;)o.parent._time!==o._start+(o._ts>=0?o._tTime/o._ts:(o.totalDuration()-o._tTime)/-o._ts)&&o.totalTime(o._tTime,!0),o=o.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&wh(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===Rr||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),RU(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+lO(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+lO(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(i,r){var o=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*o,r):this._repeat?Py(this._tTime,o)+1:1},e.timeScale=function(i){if(!arguments.length)return this._rts===-Rr?0:this._rts;if(this._rts===i)return this;var r=this.parent&&this._ts?dM(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-Rr?0:this._rts,this.totalTime(y1(-this._delay,this._tDur,r),!0),KM(this),UK(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ky(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Rr&&(this._tTime-=Rr)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&wh(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(el(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?dM(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=OK);var r=da;return da=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),da=r,this},e.globalTime=function(i){for(var r=this,o=arguments.length?i:r.rawTime();r;)o=r._start+o/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(i):o},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,cO(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,cO(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime(fc(this,i),el(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,el(r))},e.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-Rr:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Rr,this},e.isActive=function(){var i=this.parent||this._dp,r=this._start,o;return!!(!i||this._ts&&this._initted&&i.isActive()&&(o=i.rawTime(!0))>=r&&o<this.endTime(!0)-Rr)},e.eventCallback=function(i,r,o){var l=this.vars;return arguments.length>1?(r?(l[i]=r,o&&(l[i+"Params"]=o),i==="onUpdate"&&(this._onUpdate=r)):delete l[i],this):l[i]},e.then=function(i){var r=this;return new Promise(function(o){var l=Ts(i)?i:OU,s=function(){var p=r.then;r.then=null,Ts(l)&&(l=l(r))&&(l.then||l===r)&&(r.then=p),o(l),r.then=p};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?s():r._prom=s})},e.kill=function(){Nx(this)},n}();kc(Dy.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Rr,_prom:0,_ps:!1,_rts:1});var Xa=function(n){bU(e,n);function e(i,r){var o;return i===void 0&&(i={}),o=n.call(this,i)||this,o.labels={},o.smoothChildTiming=!!i.smoothChildTiming,o.autoRemoveChildren=!!i.autoRemoveChildren,o._sort=el(i.sortChildren),ls&&wh(i.parent||ls,Ad(o),r),i.reversed&&o.reverse(),i.paused&&o.paused(!0),i.scrollTrigger&&NU(Ad(o),i.scrollTrigger),o}var t=e.prototype;return t.to=function(r,o,l){return sv(0,arguments,this),this},t.from=function(r,o,l){return sv(1,arguments,this),this},t.fromTo=function(r,o,l,s){return sv(2,arguments,this),this},t.set=function(r,o,l){return o.duration=0,o.parent=this,rv(o).repeatDelay||(o.repeat=0),o.immediateRender=!!o.immediateRender,new ro(r,o,fc(this,l),1),this},t.call=function(r,o,l){return wh(this,ro.delayedCall(0,r,o),l)},t.staggerTo=function(r,o,l,s,d,p,_){return l.duration=o,l.stagger=l.stagger||s,l.onComplete=p,l.onCompleteParams=_,l.parent=this,new ro(r,l,fc(this,d)),this},t.staggerFrom=function(r,o,l,s,d,p,_){return l.runBackwards=1,rv(l).immediateRender=el(l.immediateRender),this.staggerTo(r,o,l,s,d,p,_)},t.staggerFromTo=function(r,o,l,s,d,p,_,w){return s.startAt=l,rv(s).immediateRender=el(s.immediateRender),this.staggerTo(r,o,s,d,p,_,w)},t.render=function(r,o,l){var s=this._time,d=this._dirty?this.totalDuration():this._tDur,p=this._dur,_=r<=0?0:Bo(r),w=this._zTime<0!=r<0&&(this._initted||!p),M,A,P,L,D,z,F,N,V,j,Q,re;if(this!==ls&&_>d&&r>=0&&(_=d),_!==this._tTime||l||w){if(s!==this._time&&p&&(_+=this._time-s,r+=this._time-s),M=_,V=this._start,N=this._ts,z=!N,w&&(p||(s=this._zTime),(r||!o)&&(this._zTime=r)),this._repeat){if(Q=this._yoyo,D=p+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(D*100+r,o,l);if(M=Bo(_%D),_===d?(L=this._repeat,M=p):(L=~~(_/D),L&&L===_/D&&(M=p,L--),M>p&&(M=p)),j=Py(this._tTime,D),!s&&this._tTime&&j!==L&&(j=L),Q&&L&1&&(M=p-M,re=1),L!==j&&!this._lock){var Z=Q&&j&1,ne=Z===(Q&&L&1);if(L<j&&(Z=!Z),s=Z?0:p,this._lock=1,this.render(s||(re?0:Bo(L*D)),o,!p)._lock=0,this._tTime=_,!o&&this.parent&&Ac(this,"onRepeat"),this.vars.repeatRefresh&&!re&&(this.invalidate()._lock=1),s&&s!==this._time||z!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(p=this._dur,d=this._tDur,ne&&(this._lock=2,s=Z?p:-1e-4,this.render(s,!0),this.vars.repeatRefresh&&!re&&this.invalidate()),this._lock=0,!this._ts&&!z)return this;JU(this,re)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(F=HK(this,Bo(s),Bo(M)),F&&(_-=M-(M=F._start))),this._tTime=_,this._time=M,this._act=!N,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,s=0),!s&&M&&!o&&(Ac(this,"onStart"),this._tTime!==_))return this;if(M>=s&&r>=0)for(A=this._first;A;){if(P=A._next,(A._act||M>=A._start)&&A._ts&&F!==A){if(A.parent!==this)return this.render(r,o,l);if(A.render(A._ts>0?(M-A._start)*A._ts:(A._dirty?A.totalDuration():A._tDur)+(M-A._start)*A._ts,o,l),M!==this._time||!this._ts&&!z){F=0,P&&(_+=this._zTime=-Rr);break}}A=P}else{A=this._last;for(var he=r<0?r:M;A;){if(P=A._prev,(A._act||he<=A._end)&&A._ts&&F!==A){if(A.parent!==this)return this.render(r,o,l);if(A.render(A._ts>0?(he-A._start)*A._ts:(A._dirty?A.totalDuration():A._tDur)+(he-A._start)*A._ts,o,l||da&&(A._initted||A._startAt)),M!==this._time||!this._ts&&!z){F=0,P&&(_+=this._zTime=he?-Rr:Rr);break}}A=P}}if(F&&!o&&(this.pause(),F.render(M>=s?0:-Rr)._zTime=M>=s?1:-1,this._ts))return this._start=V,KM(this),this.render(r,o,l);this._onUpdate&&!o&&Ac(this,"onUpdate",!0),(_===d&&this._tTime>=this.totalDuration()||!_&&s)&&(V===this._start||Math.abs(N)!==Math.abs(this._ts))&&(this._lock||((r||!p)&&(_===d&&this._ts>0||!_&&this._ts<0)&&Cp(this,1),!o&&!(r<0&&!s)&&(_||s||!d)&&(Ac(this,_===d&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(_<d&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,o){var l=this;if($d(o)||(o=fc(this,o,r)),!(r instanceof Dy)){if(fa(r))return r.forEach(function(s){return l.add(s,o)}),this;if(Co(r))return this.addLabel(r,o);if(Ts(r))r=ro.delayedCall(0,r);else return this}return this!==r?wh(this,r,o):this},t.getChildren=function(r,o,l,s){r===void 0&&(r=!0),o===void 0&&(o=!0),l===void 0&&(l=!0),s===void 0&&(s=-Tc);for(var d=[],p=this._first;p;)p._start>=s&&(p instanceof ro?o&&d.push(p):(l&&d.push(p),r&&d.push.apply(d,p.getChildren(!0,o,l)))),p=p._next;return d},t.getById=function(r){for(var o=this.getChildren(1,1,1),l=o.length;l--;)if(o[l].vars.id===r)return o[l]},t.remove=function(r){return Co(r)?this.removeLabel(r):Ts(r)?this.killTweensOf(r):(YM(this,r),r===this._recent&&(this._recent=this._last),ag(this))},t.totalTime=function(r,o){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Bo(Ll.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),n.prototype.totalTime.call(this,r,o),this._forcing=0,this):this._tTime},t.addLabel=function(r,o){return this.labels[r]=fc(this,o),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,o,l){var s=ro.delayedCall(0,o||Rv,l);return s.data="isPause",this._hasPause=1,wh(this,s,fc(this,r))},t.removePause=function(r){var o=this._first;for(r=fc(this,r);o;)o._start===r&&o.data==="isPause"&&Cp(o),o=o._next},t.killTweensOf=function(r,o,l){for(var s=this.getTweensOf(r,l),d=s.length;d--;)op!==s[d]&&s[d].kill(r,o);return this},t.getTweensOf=function(r,o){for(var l=[],s=Ec(r),d=this._first,p=$d(o),_;d;)d instanceof ro?FK(d._targets,s)&&(p?(!op||d._initted&&d._ts)&&d.globalTime(0)<=o&&d.globalTime(d.totalDuration())>o:!o||d.isActive())&&l.push(d):(_=d.getTweensOf(s,o)).length&&l.push.apply(l,_),d=d._next;return l},t.tweenTo=function(r,o){o=o||{};var l=this,s=fc(l,r),d=o,p=d.startAt,_=d.onStart,w=d.onStartParams,M=d.immediateRender,A,P=ro.to(l,kc({ease:o.ease||"none",lazy:!1,immediateRender:!1,time:s,overwrite:"auto",duration:o.duration||Math.abs((s-(p&&"time"in p?p.time:l._time))/l.timeScale())||Rr,onStart:function(){if(l.pause(),!A){var D=o.duration||Math.abs((s-(p&&"time"in p?p.time:l._time))/l.timeScale());P._dur!==D&&Ly(P,D,0,1).render(P._time,!0,!0),A=1}_&&_.apply(P,w||[])}},o));return M?P.render(0):P},t.tweenFromTo=function(r,o,l){return this.tweenTo(o,kc({startAt:{time:fc(this,r)}},l))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),uO(this,fc(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),uO(this,fc(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+Rr)},t.shiftChildren=function(r,o,l){l===void 0&&(l=0);for(var s=this._first,d=this.labels,p;s;)s._start>=l&&(s._start+=r,s._end+=r),s=s._next;if(o)for(p in d)d[p]>=l&&(d[p]+=r);return ag(this)},t.invalidate=function(r){var o=this._first;for(this._lock=0;o;)o.invalidate(r),o=o._next;return n.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var o=this._first,l;o;)l=o._next,this.remove(o),o=l;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),ag(this)},t.totalDuration=function(r){var o=0,l=this,s=l._last,d=Tc,p,_,w;if(arguments.length)return l.timeScale((l._repeat<0?l.duration():l.totalDuration())/(l.reversed()?-r:r));if(l._dirty){for(w=l.parent;s;)p=s._prev,s._dirty&&s.totalDuration(),_=s._start,_>d&&l._sort&&s._ts&&!l._lock?(l._lock=1,wh(l,s,_-s._delay,1)._lock=0):d=_,_<0&&s._ts&&(o-=_,(!w&&!l._dp||w&&w.smoothChildTiming)&&(l._start+=_/l._ts,l._time-=_,l._tTime-=_),l.shiftChildren(-_,!1,-1/0),d=0),s._end>o&&s._ts&&(o=s._end),s=p;Ly(l,l===ls&&l._time>o?l._time:o,1,1),l._dirty=0}return l._tDur},e.updateRoot=function(r){if(ls._ts&&(RU(ls,dM(r,ls)),kU=Ll.frame),Ll.frame>=oO){oO+=Ol.autoSleep||120;var o=ls._first;if((!o||!o._ts)&&Ol.autoSleep&&Ll._listeners.length<2){for(;o&&!o._ts;)o=o._next;o||Ll.sleep()}}},e}(Dy);kc(Xa.prototype,{_lock:0,_hasPause:0,_forcing:0});var aJ=function(e,t,i,r,o,l,s){var d=new nl(this._pt,e,t,0,1,o6,null,o),p=0,_=0,w,M,A,P,L,D,z,F;for(d.b=i,d.e=r,i+="",r+="",(z=~r.indexOf("random("))&&(r=zv(r)),l&&(F=[i,r],l(F,e,t),i=F[0],r=F[1]),M=i.match(c2)||[];w=c2.exec(r);)P=w[0],L=r.substring(p,w.index),A?A=(A+1)%5:L.substr(-5)==="rgba("&&(A=1),P!==M[_++]&&(D=parseFloat(M[_-1])||0,d._pt={_next:d._pt,p:L||_===1?L:",",s:D,c:P.charAt(1)==="="?dy(D,P)-D:parseFloat(P)-D,m:A&&A<4?Math.round:0},p=c2.lastIndex);return d.c=p<r.length?r.substring(p,r.length):"",d.fp=s,(AU.test(r)||z)&&(d.e=0),this._pt=d,d},oL=function(e,t,i,r,o,l,s,d,p,_){Ts(r)&&(r=r(o||0,e,l));var w=e[t],M=i!=="get"?i:Ts(w)?p?e[t.indexOf("set")||!Ts(e["get"+t.substr(3)])?t:"get"+t.substr(3)](p):e[t]():w,A=Ts(w)?p?dJ:r6:lL,P;if(Co(r)&&(~r.indexOf("random(")&&(r=zv(r)),r.charAt(1)==="="&&(P=dy(M,r)+(ua(M)||0),(P||P===0)&&(r=P))),!_||M!==r||DC)return!isNaN(M*r)&&r!==""?(P=new nl(this._pt,e,t,+M||0,r-(M||0),typeof w=="boolean"?pJ:s6,0,A),p&&(P.fp=p),s&&P.modifier(s,this,e),this._pt=P):(!w&&!(t in e)&&nL(t,r),aJ.call(this,e,t,M,r,A,d||Ol.stringFilter,p))},lJ=function(e,t,i,r,o){if(Ts(e)&&(e=ov(e,o,t,i,r)),!Ch(e)||e.style&&e.nodeType||fa(e)||TU(e))return Co(e)?ov(e,o,t,i,r):e;var l={},s;for(s in e)l[s]=ov(e[s],o,t,i,r);return l},t6=function(e,t,i,r,o,l){var s,d,p,_;if(Pl[e]&&(s=new Pl[e]).init(o,s.rawVars?t[e]:lJ(t[e],r,o,l,i),i,r,l)!==!1&&(i._pt=d=new nl(i._pt,o,e,0,1,s.render,s,0,s.priority),i!==Q_))for(p=i._ptLookup[i._targets.indexOf(o)],_=s._props.length;_--;)p[s._props[_]]=d;return s},op,DC,aL=function n(e,t,i){var r=e.vars,o=r.ease,l=r.startAt,s=r.immediateRender,d=r.lazy,p=r.onUpdate,_=r.onUpdateParams,w=r.callbackScope,M=r.runBackwards,A=r.yoyoEase,P=r.keyframes,L=r.autoRevert,D=e._dur,z=e._startAt,F=e._targets,N=e.parent,V=N&&N.data==="nested"?N.vars.targets:F,j=e._overwrite==="auto"&&!QP,Q=e.timeline,re,Z,ne,he,De,He,ae,le,fe,Oe,We,ce,Te;if(Q&&(!P||!o)&&(o="none"),e._ease=lg(o,Iy.ease),e._yEase=A?KU(lg(A===!0?o:A,Iy.ease)):0,A&&e._yoyo&&!e._repeat&&(A=e._yEase,e._yEase=e._ease,e._ease=A),e._from=!Q&&!!r.runBackwards,!Q||P&&!r.stagger){if(le=F[0]?og(F[0]).harness:0,ce=le&&r[le.prop],re=hM(r,iL),z&&(z._zTime<0&&z.progress(1),t<0&&M&&s&&!L?z.render(-1,!0):z.revert(M&&D?fS:zK),z._lazy=0),l){if(Cp(e._startAt=ro.set(F,kc({data:"isStart",overwrite:!1,parent:N,immediateRender:!0,lazy:!z&&el(d),startAt:null,delay:0,onUpdate:p,onUpdateParams:_,callbackScope:w,stagger:0},l))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(da||!s&&!L)&&e._startAt.revert(fS),s&&D&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(M&&D&&!z){if(t&&(s=!1),ne=kc({overwrite:!1,data:"isFromStart",lazy:s&&!z&&el(d),immediateRender:s,stagger:0,parent:N},re),ce&&(ne[le.prop]=ce),Cp(e._startAt=ro.set(F,ne)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(da?e._startAt.revert(fS):e._startAt.render(-1,!0)),e._zTime=t,!s)n(e._startAt,Rr,Rr);else if(!t)return}for(e._pt=e._ptCache=0,d=D&&el(d)||d&&!D,Z=0;Z<F.length;Z++){if(De=F[Z],ae=De._gsap||sL(F)[Z]._gsap,e._ptLookup[Z]=Oe={},AC[ae.id]&&wp.length&&uM(),We=V===F?Z:V.indexOf(De),le&&(fe=new le).init(De,ce||re,e,We,V)!==!1&&(e._pt=he=new nl(e._pt,De,fe.name,0,1,fe.render,fe,0,fe.priority),fe._props.forEach(function(Pe){Oe[Pe]=he}),fe.priority&&(He=1)),!le||ce)for(ne in re)Pl[ne]&&(fe=t6(ne,re,e,We,De,V))?fe.priority&&(He=1):Oe[ne]=he=oL.call(e,De,ne,"get",re[ne],We,V,0,r.stringFilter);e._op&&e._op[Z]&&e.kill(De,e._op[Z]),j&&e._pt&&(op=e,ls.killTweensOf(De,Oe,e.globalTime(t)),Te=!e.parent,op=0),e._pt&&d&&(AC[ae.id]=1)}He&&a6(e),e._onInit&&e._onInit(e)}e._onUpdate=p,e._initted=(!e._op||e._pt)&&!Te,P&&t<=0&&Q.render(Tc,!0,!0)},cJ=function(e,t,i,r,o,l,s){var d=(e._pt&&e._ptCache||(e._ptCache={}))[t],p,_,w,M;if(!d)for(d=e._ptCache[t]=[],w=e._ptLookup,M=e._targets.length;M--;){if(p=w[M][t],p&&p.d&&p.d._pt)for(p=p.d._pt;p&&p.p!==t&&p.fp!==t;)p=p._next;if(!p)return DC=1,e.vars[t]="+=0",aL(e,s),DC=0,1;d.push(p)}for(M=d.length;M--;)_=d[M],p=_._pt||_,p.s=(r||r===0)&&!o?r:p.s+(r||0)+l*p.c,p.c=i-p.s,_.e&&(_.e=zs(i)+ua(_.e)),_.b&&(_.b=p.s+ua(_.b))},uJ=function(e,t){var i=e[0]?og(e[0]).harness:0,r=i&&i.aliases,o,l,s,d;if(!r)return t;o=bg({},t);for(l in r)if(l in o)for(d=r[l].split(","),s=d.length;s--;)o[d[s]]=o[l];return o},hJ=function(e,t,i,r){var o=t.ease||r||"power1.inOut",l,s;if(fa(t))s=i[e]||(i[e]=[]),t.forEach(function(d,p){return s.push({t:p/(t.length-1)*100,v:d,e:o})});else for(l in t)s=i[l]||(i[l]=[]),l==="ease"||s.push({t:parseFloat(e),v:t[l],e:o})},ov=function(e,t,i,r,o){return Ts(e)?e.call(t,i,r,o):Co(e)&&~e.indexOf("random(")?zv(e):e},n6=rL+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",i6={};tl(n6+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return i6[n]=1});var ro=function(n){bU(e,n);function e(i,r,o,l){var s;typeof r=="number"&&(o.duration=r,r=o,o=null),s=n.call(this,l?r:rv(r))||this;var d=s.vars,p=d.duration,_=d.delay,w=d.immediateRender,M=d.stagger,A=d.overwrite,P=d.keyframes,L=d.defaults,D=d.scrollTrigger,z=d.yoyoEase,F=r.parent||ls,N=(fa(i)||TU(i)?$d(i[0]):"length"in r)?[i]:Ec(i),V,j,Q,re,Z,ne,he,De;if(s._targets=N.length?sL(N):cM("GSAP target "+i+" not found. https://greensock.com",!Ol.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=A,P||M||cb(p)||cb(_)){if(r=s.vars,V=s.timeline=new Xa({data:"nested",defaults:L||{},targets:F&&F.data==="nested"?F.vars.targets:N}),V.kill(),V.parent=V._dp=Ad(s),V._start=0,M||cb(p)||cb(_)){if(re=N.length,he=M&&WU(M),Ch(M))for(Z in M)~n6.indexOf(Z)&&(De||(De={}),De[Z]=M[Z]);for(j=0;j<re;j++)Q=hM(r,i6),Q.stagger=0,z&&(Q.yoyoEase=z),De&&bg(Q,De),ne=N[j],Q.duration=+ov(p,Ad(s),j,ne,N),Q.delay=(+ov(_,Ad(s),j,ne,N)||0)-s._delay,!M&&re===1&&Q.delay&&(s._delay=_=Q.delay,s._start+=_,Q.delay=0),V.to(ne,Q,he?he(j,ne,N):0),V._ease=ji.none;V.duration()?p=_=0:s.timeline=0}else if(P){rv(kc(V.vars.defaults,{ease:"none"})),V._ease=lg(P.ease||r.ease||"none");var He=0,ae,le,fe;if(fa(P))P.forEach(function(Oe){return V.to(N,Oe,">")}),V.duration();else{Q={};for(Z in P)Z==="ease"||Z==="easeEach"||hJ(Z,P[Z],Q,P.easeEach);for(Z in Q)for(ae=Q[Z].sort(function(Oe,We){return Oe.t-We.t}),He=0,j=0;j<ae.length;j++)le=ae[j],fe={ease:le.e,duration:(le.t-(j?ae[j-1].t:0))/100*p},fe[Z]=le.v,V.to(N,fe,He),He+=fe.duration;V.duration()<p&&V.to({},{duration:p-V.duration()})}}p||s.duration(p=V.duration())}else s.timeline=0;return A===!0&&!QP&&(op=Ad(s),ls.killTweensOf(N),op=0),wh(F,Ad(s),o),r.reversed&&s.reverse(),r.paused&&s.paused(!0),(w||!p&&!P&&s._start===Bo(F._time)&&el(w)&&VK(Ad(s))&&F.data!=="nested")&&(s._tTime=-Rr,s.render(Math.max(0,-_)||0)),D&&NU(Ad(s),D),s}var t=e.prototype;return t.render=function(r,o,l){var s=this._time,d=this._tDur,p=this._dur,_=r<0,w=r>d-Rr&&!_?d:r<Rr?0:r,M,A,P,L,D,z,F,N,V;if(!p)WK(this,r,o,l);else if(w!==this._tTime||!r||l||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==_){if(M=w,N=this.timeline,this._repeat){if(L=p+this._rDelay,this._repeat<-1&&_)return this.totalTime(L*100+r,o,l);if(M=Bo(w%L),w===d?(P=this._repeat,M=p):(P=~~(w/L),P&&P===w/L&&(M=p,P--),M>p&&(M=p)),z=this._yoyo&&P&1,z&&(V=this._yEase,M=p-M),D=Py(this._tTime,L),M===s&&!l&&this._initted)return this._tTime=w,this;P!==D&&(N&&this._yEase&&JU(N,z),this.vars.repeatRefresh&&!z&&!this._lock&&(this._lock=l=1,this.render(Bo(L*P),!0).invalidate()._lock=0))}if(!this._initted){if(UU(this,_?r:M,l,o,w))return this._tTime=0,this;if(s!==this._time)return this;if(p!==this._dur)return this.render(r,o,l)}if(this._tTime=w,this._time=M,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=F=(V||this._ease)(M/p),this._from&&(this.ratio=F=1-F),M&&!s&&!o&&(Ac(this,"onStart"),this._tTime!==w))return this;for(A=this._pt;A;)A.r(F,A.d),A=A._next;N&&N.render(r<0?r:!M&&z?-Rr:N._dur*N._ease(M/this._dur),o,l)||this._startAt&&(this._zTime=r),this._onUpdate&&!o&&(_&&CC(this,r,o,l),Ac(this,"onUpdate")),this._repeat&&P!==D&&this.vars.onRepeat&&!o&&this.parent&&Ac(this,"onRepeat"),(w===this._tDur||!w)&&this._tTime===w&&(_&&!this._onUpdate&&CC(this,r,!0,!0),(r||!p)&&(w===this._tDur&&this._ts>0||!w&&this._ts<0)&&Cp(this,1),!o&&!(_&&!s)&&(w||s||z)&&(Ac(this,w===d?"onComplete":"onReverseComplete",!0),this._prom&&!(w<d&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),n.prototype.invalidate.call(this,r)},t.resetTo=function(r,o,l,s){Ov||Ll.wake(),this._ts||this.play();var d=Math.min(this._dur,(this._dp._time-this._start)*this._ts),p;return this._initted||aL(this,d),p=this._ease(d/this._dur),cJ(this,r,o,l,s,p,d)?this.resetTo(r,o,l,s):(JM(this,0),this.parent||FU(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,o){if(o===void 0&&(o="all"),!r&&(!o||o==="all"))return this._lazy=this._pt=0,this.parent?Nx(this):this;if(this.timeline){var l=this.timeline.totalDuration();return this.timeline.killTweensOf(r,o,op&&op.vars.overwrite!==!0)._first||Nx(this),this.parent&&l!==this.timeline.totalDuration()&&Ly(this,this._dur*this.timeline._tDur/l,0,1),this}var s=this._targets,d=r?Ec(r):s,p=this._ptLookup,_=this._pt,w,M,A,P,L,D,z;if((!o||o==="all")&&NK(s,d))return o==="all"&&(this._pt=0),Nx(this);for(w=this._op=this._op||[],o!=="all"&&(Co(o)&&(L={},tl(o,function(F){return L[F]=1}),o=L),o=uJ(s,o)),z=s.length;z--;)if(~d.indexOf(s[z])){M=p[z],o==="all"?(w[z]=o,P=M,A={}):(A=w[z]=w[z]||{},P=o);for(L in P)D=M&&M[L],D&&((!("kill"in D.d)||D.d.kill(L)===!0)&&YM(this,D,"_pt"),delete M[L]),A!=="all"&&(A[L]=1)}return this._initted&&!this._pt&&_&&Nx(this),this},e.to=function(r,o){return new e(r,o,arguments[2])},e.from=function(r,o){return sv(1,arguments)},e.delayedCall=function(r,o,l,s){return new e(o,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:o,onReverseComplete:o,onCompleteParams:l,onReverseCompleteParams:l,callbackScope:s})},e.fromTo=function(r,o,l){return sv(2,arguments)},e.set=function(r,o){return o.duration=0,o.repeatDelay||(o.repeat=0),new e(r,o)},e.killTweensOf=function(r,o,l){return ls.killTweensOf(r,o,l)},e}(Dy);kc(ro.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});tl("staggerTo,staggerFrom,staggerFromTo",function(n){ro[n]=function(){var e=new Xa,t=PC.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var lL=function(e,t,i){return e[t]=i},r6=function(e,t,i){return e[t](i)},dJ=function(e,t,i,r){return e[t](r.fp,i)},fJ=function(e,t,i){return e.setAttribute(t,i)},cL=function(e,t){return Ts(e[t])?r6:eL(e[t])&&e.setAttribute?fJ:lL},s6=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},pJ=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},o6=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},uL=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},mJ=function(e,t,i,r){for(var o=this._pt,l;o;)l=o._next,o.p===r&&o.modifier(e,t,i),o=l},gJ=function(e){for(var t=this._pt,i,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?YM(this,t,"_pt"):t.dep||(i=1),t=r;return!i},_J=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},a6=function(e){for(var t=e._pt,i,r,o,l;t;){for(i=t._next,r=o;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:l)?t._prev._next=t:o=t,(t._next=r)?r._prev=t:l=t,t=i}e._pt=o},nl=function(){function n(t,i,r,o,l,s,d,p,_){this.t=i,this.s=o,this.c=l,this.p=r,this.r=s||s6,this.d=d||this,this.set=p||lL,this.pr=_||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(i,r,o){this.mSet=this.mSet||this.set,this.set=_J,this.m=i,this.mt=o,this.tween=r},n}();tl(rL+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return iL[n]=1});Nl.TweenMax=Nl.TweenLite=ro;Nl.TimelineLite=Nl.TimelineMax=Xa;ls=new Xa({sortChildren:!1,defaults:Iy,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ol.stringFilter=YU;var Ry=[],mS={},yJ=[],dO=0,p2=function(e){return(mS[e]||yJ).map(function(t){return t()})},RC=function(){var e=Date.now(),t=[];e-dO>2&&(p2("matchMediaInit"),Ry.forEach(function(i){var r=i.queries,o=i.conditions,l,s,d,p;for(s in r)l=pc.matchMedia(r[s]).matches,l&&(d=1),l!==o[s]&&(o[s]=l,p=1);p&&(i.revert(),d&&t.push(i))}),p2("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i)}),dO=e,p2("matchMedia"))},l6=function(){function n(t,i){this.selector=i&&LC(i),this.data=[],this._r=[],this.isReverted=!1,t&&this.add(t)}var e=n.prototype;return e.add=function(i,r,o){Ts(i)&&(o=r,r=i,i=Ts);var l=this,s=function(){var p=js,_=l.selector,w;return p&&p!==l&&p.data.push(l),o&&(l.selector=LC(o)),js=l,w=r.apply(l,arguments),Ts(w)&&l._r.push(w),js=p,l.selector=_,l.isReverted=!1,w};return l.last=s,i===Ts?s(l):i?l[i]=s:s},e.ignore=function(i){var r=js;js=null,i(this),js=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof n?i.push.apply(i,r.getTweens()):r instanceof ro&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var o=this;if(i){var l=this.getTweens();this.data.forEach(function(d){d.data==="isFlip"&&(d.revert(),d.getChildren(!0,!0,!1).forEach(function(p){return l.splice(l.indexOf(p),1)}))}),l.map(function(d){return{g:d.globalTime(0),t:d}}).sort(function(d,p){return p.g-d.g||-1}).forEach(function(d){return d.t.revert(i)}),this.data.forEach(function(d){return!(d instanceof Dy)&&d.revert&&d.revert(i)}),this._r.forEach(function(d){return d(i,o)}),this.isReverted=!0}else this.data.forEach(function(d){return d.kill&&d.kill()});if(this.clear(),r){var s=Ry.indexOf(this);~s&&Ry.splice(s,1)}},e.revert=function(i){this.kill(i||{})},n}(),xJ=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(i,r,o){Ch(i)||(i={matches:i});var l=new l6(0,o||this.scope),s=l.conditions={},d,p,_;this.contexts.push(l),r=l.add("onMatch",r),l.queries=i;for(p in i)p==="all"?_=1:(d=pc.matchMedia(i[p]),d&&(Ry.indexOf(l)<0&&Ry.push(l),(s[p]=d.matches)&&(_=1),d.addListener?d.addListener(RC):d.addEventListener("change",RC)));return _&&r(l),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},n}(),fM={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return eJ(r)})},timeline:function(e){return new Xa(e)},getTweensOf:function(e,t){return ls.getTweensOf(e,t)},getProperty:function(e,t,i,r){Co(e)&&(e=Ec(e)[0]);var o=og(e||{}).get,l=i?OU:zU;return i==="native"&&(i=""),e&&(t?l((Pl[t]&&Pl[t].get||o)(e,t,i,r)):function(s,d,p){return l((Pl[s]&&Pl[s].get||o)(e,s,d,p))})},quickSetter:function(e,t,i){if(e=Ec(e),e.length>1){var r=e.map(function(_){return Ul.quickSetter(_,t,i)}),o=r.length;return function(_){for(var w=o;w--;)r[w](_)}}e=e[0]||{};var l=Pl[t],s=og(e),d=s.harness&&(s.harness.aliases||{})[t]||t,p=l?function(_){var w=new l;Q_._pt=0,w.init(e,i?_+i:_,Q_,0,[e]),w.render(1,w),Q_._pt&&uL(1,Q_)}:s.set(e,d);return l?p:function(_){return p(e,d,i?_+i:_,s,1)}},quickTo:function(e,t,i){var r,o=Ul.to(e,bg((r={},r[t]="+=0.1",r.paused=!0,r),i||{})),l=function(d,p,_){return o.resetTo(t,d,p,_)};return l.tween=o,l},isTweening:function(e){return ls.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=lg(e.ease,Iy.ease)),aO(Iy,e||{})},config:function(e){return aO(Ol,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,r=e.plugins,o=e.defaults,l=e.extendTimeline;(r||"").split(",").forEach(function(s){return s&&!Pl[s]&&!Nl[s]&&cM(t+" effect requires "+s+" plugin.")}),u2[t]=function(s,d,p){return i(Ec(s),kc(d||{},o),p)},l&&(Xa.prototype[t]=function(s,d,p){return this.add(u2[t](s,Ch(d)?d:(p=d)&&{},this),p)})},registerEase:function(e,t){ji[e]=lg(t)},parseEase:function(e,t){return arguments.length?lg(e,t):ji},getById:function(e){return ls.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new Xa(e),r,o;for(i.smoothChildTiming=el(e.smoothChildTiming),ls.remove(i),i._dp=0,i._time=i._tTime=ls._time,r=ls._first;r;)o=r._next,(t||!(!r._dur&&r instanceof ro&&r.vars.onComplete===r._targets[0]))&&wh(i,r,r._start-r._delay),r=o;return wh(ls,i,0),i},context:function(e,t){return e?new l6(e,t):js},matchMedia:function(e){return new xJ(e)},matchMediaRefresh:function(){return Ry.forEach(function(e){var t=e.conditions,i,r;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||RC()},addEventListener:function(e,t){var i=mS[e]||(mS[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=mS[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:KK,wrapYoyo:JK,distribute:WU,random:jU,snap:HU,normalize:YK,getUnit:ua,clamp:qK,splitColor:XU,toArray:Ec,selector:LC,mapRange:ZU,pipe:XK,unitize:$K,interpolate:QK,shuffle:GU},install:PU,effects:u2,ticker:Ll,updateRoot:Xa.updateRoot,plugins:Pl,globalTimeline:ls,core:{PropTween:nl,globals:LU,Tween:ro,Timeline:Xa,Animation:Dy,getCache:og,_removeLinkedListItem:YM,reverting:function(){return da},context:function(e){return e&&js&&(js.data.push(e),e._ctx=js),js},suppressOverwrites:function(e){return QP=e}}};tl("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return fM[n]=ro[n]});Ll.add(Xa.updateRoot);Q_=fM.to({},{duration:0});var vJ=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},wJ=function(e,t){var i=e._targets,r,o,l;for(r in t)for(o=i.length;o--;)l=e._ptLookup[o][r],l&&(l=l.d)&&(l._pt&&(l=vJ(l,r)),l&&l.modifier&&l.modifier(t[r],e,i[o],r))},m2=function(e,t){return{name:e,rawVars:1,init:function(r,o,l){l._onInit=function(s){var d,p;if(Co(o)&&(d={},tl(o,function(_){return d[_]=1}),o=d),t){d={};for(p in o)d[p]=t(o[p]);o=d}wJ(s,o)}}}},Ul=fM.registerPlugin({name:"attr",init:function(e,t,i,r,o){var l,s,d;this.tween=i;for(l in t)d=e.getAttribute(l)||"",s=this.add(e,"setAttribute",(d||0)+"",t[l],r,o,0,0,l),s.op=l,s.b=d,this._props.push(l)},render:function(e,t){for(var i=t._pt;i;)da?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},m2("roundProps",kC),m2("modifiers"),m2("snap",HU))||fM;ro.version=Xa.version=Ul.version="3.11.4";IU=1;MU()&&ky();ji.Power0;ji.Power1;ji.Power2;ji.Power3;ji.Power4;ji.Linear;ji.Quad;ji.Cubic;ji.Quart;ji.Quint;ji.Strong;ji.Elastic;ji.Back;ji.SteppedEase;ji.Bounce;ji.Sine;ji.Expo;ji.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var fO,ap,fy,hL,$m,pO,dL,bJ=function(){return typeof window<"u"},Yd={},Nm=180/Math.PI,py=Math.PI/180,x_=Math.atan2,mO=1e8,fL=/([A-Z])/g,SJ=/(left|right|width|margin|padding|x)/i,MJ=/[\s,\(]\S/,Fd={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},zC=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},TJ=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},EJ=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},AJ=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},c6=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},u6=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},CJ=function(e,t,i){return e.style[t]=i},IJ=function(e,t,i){return e.style.setProperty(t,i)},PJ=function(e,t,i){return e._gsap[t]=i},LJ=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},kJ=function(e,t,i,r,o){var l=e._gsap;l.scaleX=l.scaleY=i,l.renderTransform(o,l)},DJ=function(e,t,i,r,o){var l=e._gsap;l[t]=i,l.renderTransform(o,l)},us="transform",Iu=us+"Origin",RJ=function(e,t){var i=this,r=this.target,o=r.style;if(e in Yd){if(this.tfm=this.tfm||{},e!=="transform"&&(e=Fd[e]||e,~e.indexOf(",")?e.split(",").forEach(function(l){return i.tfm[l]=Pd(r,l)}):this.tfm[e]=r._gsap.x?r._gsap[e]:Pd(r,e)),this.props.indexOf(us)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Iu,t,"")),e=us}(o||t)&&this.props.push(e,t,o[e])},h6=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},zJ=function(){var e=this.props,t=this.target,i=t.style,r=t._gsap,o,l;for(o=0;o<e.length;o+=3)e[o+1]?t[e[o]]=e[o+2]:e[o+2]?i[e[o]]=e[o+2]:i.removeProperty(e[o].replace(fL,"-$1").toLowerCase());if(this.tfm){for(l in this.tfm)r[l]=this.tfm[l];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),o=dL(),o&&!o.isStart&&!i[us]&&(h6(i),r.uncache=1)}},d6=function(e,t){var i={target:e,props:[],revert:zJ,save:RJ};return t&&t.split(",").forEach(function(r){return i.save(r)}),i},f6,OC=function(e,t){var i=ap.createElementNS?ap.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):ap.createElement(e);return i.style?i:ap.createElement(e)},Eh=function n(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(fL,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&n(e,zy(t)||t,1)||""},gO="O,Moz,ms,Ms,Webkit".split(","),zy=function(e,t,i){var r=t||$m,o=r.style,l=5;if(e in o&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);l--&&!(gO[l]+e in o););return l<0?null:(l===3?"ms":l>=0?gO[l]:"")+e},FC=function(){bJ()&&window.document&&(fO=window,ap=fO.document,fy=ap.documentElement,$m=OC("div")||{style:{}},OC("div"),us=zy(us),Iu=us+"Origin",$m.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",f6=!!zy("perspective"),dL=Ul.core.reverting,hL=1)},g2=function n(e){var t=OC("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,o=this.style.cssText,l;if(fy.appendChild(t),t.appendChild(this),this.style.display="block",e)try{l=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(l=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),fy.removeChild(t),this.style.cssText=o,l},_O=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},p6=function(e){var t;try{t=e.getBBox()}catch{t=g2.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===g2||(t=g2.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+_O(e,["x","cx","x1"])||0,y:+_O(e,["y","cy","y1"])||0,width:0,height:0}:t},m6=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&p6(e))},Fv=function(e,t){if(t){var i=e.style;t in Yd&&t!==Iu&&(t=us),i.removeProperty?((t.substr(0,2)==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(t.replace(fL,"-$1").toLowerCase())):i.removeAttribute(t)}},lp=function(e,t,i,r,o,l){var s=new nl(e._pt,t,i,0,1,l?u6:c6);return e._pt=s,s.b=r,s.e=o,e._props.push(i),s},yO={deg:1,rad:1,turn:1},OJ={grid:1,flex:1},Ip=function n(e,t,i,r){var o=parseFloat(i)||0,l=(i+"").trim().substr((o+"").length)||"px",s=$m.style,d=SJ.test(t),p=e.tagName.toLowerCase()==="svg",_=(p?"client":"offset")+(d?"Width":"Height"),w=100,M=r==="px",A=r==="%",P,L,D,z;return r===l||!o||yO[r]||yO[l]?o:(l!=="px"&&!M&&(o=n(e,t,i,"px")),z=e.getCTM&&m6(e),(A||l==="%")&&(Yd[t]||~t.indexOf("adius"))?(P=z?e.getBBox()[d?"width":"height"]:e[_],zs(A?o/P*w:o/100*P)):(s[d?"width":"height"]=w+(M?l:r),L=~t.indexOf("adius")||r==="em"&&e.appendChild&&!p?e:e.parentNode,z&&(L=(e.ownerSVGElement||{}).parentNode),(!L||L===ap||!L.appendChild)&&(L=ap.body),D=L._gsap,D&&A&&D.width&&d&&D.time===Ll.time&&!D.uncache?zs(o/D.width*w):((A||l==="%")&&!OJ[Eh(L,"display")]&&(s.position=Eh(e,"position")),L===e&&(s.position="static"),L.appendChild($m),P=$m[_],L.removeChild($m),s.position="absolute",d&&A&&(D=og(L),D.time=Ll.time,D.width=L[_]),zs(M?P*o/w:P&&o?w/P*o:0))))},Pd=function(e,t,i,r){var o;return hL||FC(),t in Fd&&t!=="transform"&&(t=Fd[t],~t.indexOf(",")&&(t=t.split(",")[0])),Yd[t]&&t!=="transform"?(o=Nv(e,r),o=t!=="transformOrigin"?o[t]:o.svg?o.origin:mM(Eh(e,Iu))+" "+o.zOrigin+"px"):(o=e.style[t],(!o||o==="auto"||r||~(o+"").indexOf("calc("))&&(o=pM[t]&&pM[t](e,t,i)||Eh(e,t)||DU(e,t)||(t==="opacity"?1:0))),i&&!~(o+"").trim().indexOf(" ")?Ip(e,t,o,i)+i:o},FJ=function(e,t,i,r){if(!i||i==="none"){var o=zy(t,e,1),l=o&&Eh(e,o,1);l&&l!==i?(t=o,i=l):t==="borderColor"&&(i=Eh(e,"borderTopColor"))}var s=new nl(this._pt,e.style,t,0,1,o6),d=0,p=0,_,w,M,A,P,L,D,z,F,N,V,j;if(s.b=i,s.e=r,i+="",r+="",r==="auto"&&(e.style[t]=r,r=Eh(e,t)||r,e.style[t]=i),_=[i,r],YU(_),i=_[0],r=_[1],M=i.match(J_)||[],j=r.match(J_)||[],j.length){for(;w=J_.exec(r);)D=w[0],F=r.substring(d,w.index),P?P=(P+1)%5:(F.substr(-5)==="rgba("||F.substr(-5)==="hsla(")&&(P=1),D!==(L=M[p++]||"")&&(A=parseFloat(L)||0,V=L.substr((A+"").length),D.charAt(1)==="="&&(D=dy(A,D)+V),z=parseFloat(D),N=D.substr((z+"").length),d=J_.lastIndex-N.length,N||(N=N||Ol.units[t]||V,d===r.length&&(r+=N,s.e+=N)),V!==N&&(A=Ip(e,t,L,N)||0),s._pt={_next:s._pt,p:F||p===1?F:",",s:A,c:z-A,m:P&&P<4||t==="zIndex"?Math.round:0});s.c=d<r.length?r.substring(d,r.length):""}else s.r=t==="display"&&r==="none"?u6:c6;return AU.test(r)&&(s.e=0),this._pt=s,s},xO={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},BJ=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(e=i,i=r,r=e),t[0]=xO[i]||i,t[1]=xO[r]||r,t.join(" ")},NJ=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,r=i.style,o=t.u,l=i._gsap,s,d,p;if(o==="all"||o===!0)r.cssText="",d=1;else for(o=o.split(","),p=o.length;--p>-1;)s=o[p],Yd[s]&&(d=1,s=s==="transformOrigin"?Iu:us),Fv(i,s);d&&(Fv(i,us),l&&(l.svg&&i.removeAttribute("transform"),Nv(i,1),l.uncache=1,h6(r)))}},pM={clearProps:function(e,t,i,r,o){if(o.data!=="isFromStart"){var l=e._pt=new nl(e._pt,t,i,0,0,NJ);return l.u=r,l.pr=-10,l.tween=o,e._props.push(i),1}}},Bv=[1,0,0,1,0,0],g6={},_6=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},vO=function(e){var t=Eh(e,us);return _6(t)?Bv:t.substr(7).match(EU).map(zs)},pL=function(e,t){var i=e._gsap||og(e),r=e.style,o=vO(e),l,s,d,p;return i.svg&&e.getAttribute("transform")?(d=e.transform.baseVal.consolidate().matrix,o=[d.a,d.b,d.c,d.d,d.e,d.f],o.join(",")==="1,0,0,1,0,0"?Bv:o):(o===Bv&&!e.offsetParent&&e!==fy&&!i.svg&&(d=r.display,r.display="block",l=e.parentNode,(!l||!e.offsetParent)&&(p=1,s=e.nextElementSibling,fy.appendChild(e)),o=vO(e),d?r.display=d:Fv(e,"display"),p&&(s?l.insertBefore(e,s):l?l.appendChild(e):fy.removeChild(e))),t&&o.length>6?[o[0],o[1],o[4],o[5],o[12],o[13]]:o)},BC=function(e,t,i,r,o,l){var s=e._gsap,d=o||pL(e,!0),p=s.xOrigin||0,_=s.yOrigin||0,w=s.xOffset||0,M=s.yOffset||0,A=d[0],P=d[1],L=d[2],D=d[3],z=d[4],F=d[5],N=t.split(" "),V=parseFloat(N[0])||0,j=parseFloat(N[1])||0,Q,re,Z,ne;i?d!==Bv&&(re=A*D-P*L)&&(Z=V*(D/re)+j*(-L/re)+(L*F-D*z)/re,ne=V*(-P/re)+j*(A/re)-(A*F-P*z)/re,V=Z,j=ne):(Q=p6(e),V=Q.x+(~N[0].indexOf("%")?V/100*Q.width:V),j=Q.y+(~(N[1]||N[0]).indexOf("%")?j/100*Q.height:j)),r||r!==!1&&s.smooth?(z=V-p,F=j-_,s.xOffset=w+(z*A+F*L)-z,s.yOffset=M+(z*P+F*D)-F):s.xOffset=s.yOffset=0,s.xOrigin=V,s.yOrigin=j,s.smooth=!!r,s.origin=t,s.originIsAbsolute=!!i,e.style[Iu]="0px 0px",l&&(lp(l,s,"xOrigin",p,V),lp(l,s,"yOrigin",_,j),lp(l,s,"xOffset",w,s.xOffset),lp(l,s,"yOffset",M,s.yOffset)),e.setAttribute("data-svg-origin",V+" "+j)},Nv=function(e,t){var i=e._gsap||new e6(e);if("x"in i&&!t&&!i.uncache)return i;var r=e.style,o=i.scaleX<0,l="px",s="deg",d=getComputedStyle(e),p=Eh(e,Iu)||"0",_,w,M,A,P,L,D,z,F,N,V,j,Q,re,Z,ne,he,De,He,ae,le,fe,Oe,We,ce,Te,Pe,Qe,Ne,nt,ze,et;return _=w=M=L=D=z=F=N=V=0,A=P=1,i.svg=!!(e.getCTM&&m6(e)),d.translate&&((d.translate!=="none"||d.scale!=="none"||d.rotate!=="none")&&(r[us]=(d.translate!=="none"?"translate3d("+(d.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(d.rotate!=="none"?"rotate("+d.rotate+") ":"")+(d.scale!=="none"?"scale("+d.scale.split(" ").join(",")+") ":"")+(d[us]!=="none"?d[us]:"")),r.scale=r.rotate=r.translate="none"),re=pL(e,i.svg),i.svg&&(i.uncache?(ce=e.getBBox(),p=i.xOrigin-ce.x+"px "+(i.yOrigin-ce.y)+"px",We=""):We=!t&&e.getAttribute("data-svg-origin"),BC(e,We||p,!!We||i.originIsAbsolute,i.smooth!==!1,re)),j=i.xOrigin||0,Q=i.yOrigin||0,re!==Bv&&(De=re[0],He=re[1],ae=re[2],le=re[3],_=fe=re[4],w=Oe=re[5],re.length===6?(A=Math.sqrt(De*De+He*He),P=Math.sqrt(le*le+ae*ae),L=De||He?x_(He,De)*Nm:0,F=ae||le?x_(ae,le)*Nm+L:0,F&&(P*=Math.abs(Math.cos(F*py))),i.svg&&(_-=j-(j*De+Q*ae),w-=Q-(j*He+Q*le))):(et=re[6],nt=re[7],Pe=re[8],Qe=re[9],Ne=re[10],ze=re[11],_=re[12],w=re[13],M=re[14],Z=x_(et,Ne),D=Z*Nm,Z&&(ne=Math.cos(-Z),he=Math.sin(-Z),We=fe*ne+Pe*he,ce=Oe*ne+Qe*he,Te=et*ne+Ne*he,Pe=fe*-he+Pe*ne,Qe=Oe*-he+Qe*ne,Ne=et*-he+Ne*ne,ze=nt*-he+ze*ne,fe=We,Oe=ce,et=Te),Z=x_(-ae,Ne),z=Z*Nm,Z&&(ne=Math.cos(-Z),he=Math.sin(-Z),We=De*ne-Pe*he,ce=He*ne-Qe*he,Te=ae*ne-Ne*he,ze=le*he+ze*ne,De=We,He=ce,ae=Te),Z=x_(He,De),L=Z*Nm,Z&&(ne=Math.cos(Z),he=Math.sin(Z),We=De*ne+He*he,ce=fe*ne+Oe*he,He=He*ne-De*he,Oe=Oe*ne-fe*he,De=We,fe=ce),D&&Math.abs(D)+Math.abs(L)>359.9&&(D=L=0,z=180-z),A=zs(Math.sqrt(De*De+He*He+ae*ae)),P=zs(Math.sqrt(Oe*Oe+et*et)),Z=x_(fe,Oe),F=Math.abs(Z)>2e-4?Z*Nm:0,V=ze?1/(ze<0?-ze:ze):0),i.svg&&(We=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!_6(Eh(e,us)),We&&e.setAttribute("transform",We))),Math.abs(F)>90&&Math.abs(F)<270&&(o?(A*=-1,F+=L<=0?180:-180,L+=L<=0?180:-180):(P*=-1,F+=F<=0?180:-180)),t=t||i.uncache,i.x=_-((i.xPercent=_&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-_)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+l,i.y=w-((i.yPercent=w&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-w)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+l,i.z=M+l,i.scaleX=zs(A),i.scaleY=zs(P),i.rotation=zs(L)+s,i.rotationX=zs(D)+s,i.rotationY=zs(z)+s,i.skewX=F+s,i.skewY=N+s,i.transformPerspective=V+l,(i.zOrigin=parseFloat(p.split(" ")[2])||0)&&(r[Iu]=mM(p)),i.xOffset=i.yOffset=0,i.force3D=Ol.force3D,i.renderTransform=i.svg?VJ:f6?y6:UJ,i.uncache=0,i},mM=function(e){return(e=e.split(" "))[0]+" "+e[1]},_2=function(e,t,i){var r=ua(t);return zs(parseFloat(t)+parseFloat(Ip(e,"x",i+"px",r)))+r},UJ=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,y6(e,t)},Tm="0deg",fx="0px",Em=") ",y6=function(e,t){var i=t||this,r=i.xPercent,o=i.yPercent,l=i.x,s=i.y,d=i.z,p=i.rotation,_=i.rotationY,w=i.rotationX,M=i.skewX,A=i.skewY,P=i.scaleX,L=i.scaleY,D=i.transformPerspective,z=i.force3D,F=i.target,N=i.zOrigin,V="",j=z==="auto"&&e&&e!==1||z===!0;if(N&&(w!==Tm||_!==Tm)){var Q=parseFloat(_)*py,re=Math.sin(Q),Z=Math.cos(Q),ne;Q=parseFloat(w)*py,ne=Math.cos(Q),l=_2(F,l,re*ne*-N),s=_2(F,s,-Math.sin(Q)*-N),d=_2(F,d,Z*ne*-N+N)}D!==fx&&(V+="perspective("+D+Em),(r||o)&&(V+="translate("+r+"%, "+o+"%) "),(j||l!==fx||s!==fx||d!==fx)&&(V+=d!==fx||j?"translate3d("+l+", "+s+", "+d+") ":"translate("+l+", "+s+Em),p!==Tm&&(V+="rotate("+p+Em),_!==Tm&&(V+="rotateY("+_+Em),w!==Tm&&(V+="rotateX("+w+Em),(M!==Tm||A!==Tm)&&(V+="skew("+M+", "+A+Em),(P!==1||L!==1)&&(V+="scale("+P+", "+L+Em),F.style[us]=V||"translate(0, 0)"},VJ=function(e,t){var i=t||this,r=i.xPercent,o=i.yPercent,l=i.x,s=i.y,d=i.rotation,p=i.skewX,_=i.skewY,w=i.scaleX,M=i.scaleY,A=i.target,P=i.xOrigin,L=i.yOrigin,D=i.xOffset,z=i.yOffset,F=i.forceCSS,N=parseFloat(l),V=parseFloat(s),j,Q,re,Z,ne;d=parseFloat(d),p=parseFloat(p),_=parseFloat(_),_&&(_=parseFloat(_),p+=_,d+=_),d||p?(d*=py,p*=py,j=Math.cos(d)*w,Q=Math.sin(d)*w,re=Math.sin(d-p)*-M,Z=Math.cos(d-p)*M,p&&(_*=py,ne=Math.tan(p-_),ne=Math.sqrt(1+ne*ne),re*=ne,Z*=ne,_&&(ne=Math.tan(_),ne=Math.sqrt(1+ne*ne),j*=ne,Q*=ne)),j=zs(j),Q=zs(Q),re=zs(re),Z=zs(Z)):(j=w,Z=M,Q=re=0),(N&&!~(l+"").indexOf("px")||V&&!~(s+"").indexOf("px"))&&(N=Ip(A,"x",l,"px"),V=Ip(A,"y",s,"px")),(P||L||D||z)&&(N=zs(N+P-(P*j+L*re)+D),V=zs(V+L-(P*Q+L*Z)+z)),(r||o)&&(ne=A.getBBox(),N=zs(N+r/100*ne.width),V=zs(V+o/100*ne.height)),ne="matrix("+j+","+Q+","+re+","+Z+","+N+","+V+")",A.setAttribute("transform",ne),F&&(A.style[us]=ne)},GJ=function(e,t,i,r,o){var l=360,s=Co(o),d=parseFloat(o)*(s&&~o.indexOf("rad")?Nm:1),p=d-r,_=r+p+"deg",w,M;return s&&(w=o.split("_")[1],w==="short"&&(p%=l,p!==p%(l/2)&&(p+=p<0?l:-l)),w==="cw"&&p<0?p=(p+l*mO)%l-~~(p/l)*l:w==="ccw"&&p>0&&(p=(p-l*mO)%l-~~(p/l)*l)),e._pt=M=new nl(e._pt,t,i,r,p,TJ),M.e=_,M.u="deg",e._props.push(i),M},wO=function(e,t){for(var i in t)e[i]=t[i];return e},WJ=function(e,t,i){var r=wO({},i._gsap),o="perspective,force3D,transformOrigin,svgOrigin",l=i.style,s,d,p,_,w,M,A,P;r.svg?(p=i.getAttribute("transform"),i.setAttribute("transform",""),l[us]=t,s=Nv(i,1),Fv(i,us),i.setAttribute("transform",p)):(p=getComputedStyle(i)[us],l[us]=t,s=Nv(i,1),l[us]=p);for(d in Yd)p=r[d],_=s[d],p!==_&&o.indexOf(d)<0&&(A=ua(p),P=ua(_),w=A!==P?Ip(i,d,p,P):parseFloat(p),M=parseFloat(_),e._pt=new nl(e._pt,s,d,w,M-w,zC),e._pt.u=P||0,e._props.push(d));wO(s,r)};tl("padding,margin,Width,Radius",function(n,e){var t="Top",i="Right",r="Bottom",o="Left",l=(e<3?[t,i,r,o]:[t+o,t+i,r+i,r+o]).map(function(s){return e<2?n+s:"border"+s+n});pM[e>1?"border"+n:n]=function(s,d,p,_,w){var M,A;if(arguments.length<4)return M=l.map(function(P){return Pd(s,P,p)}),A=M.join(" "),A.split(M[0]).length===5?M[0]:A;M=(_+"").split(" "),A={},l.forEach(function(P,L){return A[P]=M[L]=M[L]||M[(L-1)/2|0]}),s.init(d,A,w)}});var x6={name:"css",register:FC,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,o){var l=this._props,s=e.style,d=i.vars.startAt,p,_,w,M,A,P,L,D,z,F,N,V,j,Q,re,Z;hL||FC(),this.styles=this.styles||d6(e),Z=this.styles.props,this.tween=i;for(L in t)if(L!=="autoRound"&&(_=t[L],!(Pl[L]&&t6(L,t,i,r,e,o)))){if(A=typeof _,P=pM[L],A==="function"&&(_=_.call(i,r,e,o),A=typeof _),A==="string"&&~_.indexOf("random(")&&(_=zv(_)),P)P(this,e,L,_,i)&&(re=1);else if(L.substr(0,2)==="--")p=(getComputedStyle(e).getPropertyValue(L)+"").trim(),_+="",bp.lastIndex=0,bp.test(p)||(D=ua(p),z=ua(_)),z?D!==z&&(p=Ip(e,L,p,z)+z):D&&(_+=D),this.add(s,"setProperty",p,_,r,o,0,0,L),l.push(L),Z.push(L,0,s[L]);else if(A!=="undefined"){if(d&&L in d?(p=typeof d[L]=="function"?d[L].call(i,r,e,o):d[L],Co(p)&&~p.indexOf("random(")&&(p=zv(p)),ua(p+"")||(p+=Ol.units[L]||ua(Pd(e,L))||""),(p+"").charAt(1)==="="&&(p=Pd(e,L))):p=Pd(e,L),M=parseFloat(p),F=A==="string"&&_.charAt(1)==="="&&_.substr(0,2),F&&(_=_.substr(2)),w=parseFloat(_),L in Fd&&(L==="autoAlpha"&&(M===1&&Pd(e,"visibility")==="hidden"&&w&&(M=0),Z.push("visibility",0,s.visibility),lp(this,s,"visibility",M?"inherit":"hidden",w?"inherit":"hidden",!w)),L!=="scale"&&L!=="transform"&&(L=Fd[L],~L.indexOf(",")&&(L=L.split(",")[0]))),N=L in Yd,N){if(this.styles.save(L),V||(j=e._gsap,j.renderTransform&&!t.parseTransform||Nv(e,t.parseTransform),Q=t.smoothOrigin!==!1&&j.smooth,V=this._pt=new nl(this._pt,s,us,0,1,j.renderTransform,j,0,-1),V.dep=1),L==="scale")this._pt=new nl(this._pt,j,"scaleY",j.scaleY,(F?dy(j.scaleY,F+w):w)-j.scaleY||0,zC),this._pt.u=0,l.push("scaleY",L),L+="X";else if(L==="transformOrigin"){Z.push(Iu,0,s[Iu]),_=BJ(_),j.svg?BC(e,_,0,Q,0,this):(z=parseFloat(_.split(" ")[2])||0,z!==j.zOrigin&&lp(this,j,"zOrigin",j.zOrigin,z),lp(this,s,L,mM(p),mM(_)));continue}else if(L==="svgOrigin"){BC(e,_,1,Q,0,this);continue}else if(L in g6){GJ(this,j,L,M,F?dy(M,F+_):_);continue}else if(L==="smoothOrigin"){lp(this,j,"smooth",j.smooth,_);continue}else if(L==="force3D"){j[L]=_;continue}else if(L==="transform"){WJ(this,_,e);continue}}else L in s||(L=zy(L)||L);if(N||(w||w===0)&&(M||M===0)&&!MJ.test(_)&&L in s)D=(p+"").substr((M+"").length),w||(w=0),z=ua(_)||(L in Ol.units?Ol.units[L]:D),D!==z&&(M=Ip(e,L,p,z)),this._pt=new nl(this._pt,N?j:s,L,M,(F?dy(M,F+w):w)-M,!N&&(z==="px"||L==="zIndex")&&t.autoRound!==!1?AJ:zC),this._pt.u=z||0,D!==z&&z!=="%"&&(this._pt.b=p,this._pt.r=EJ);else if(L in s)FJ.call(this,e,L,p,F?F+_:_);else if(L in e)this.add(e,L,p||e[L],F?F+_:_,r,o);else if(L!=="parseTransform"){nL(L,_);continue}N||(L in s?Z.push(L,0,s[L]):Z.push(L,1,p||e[L])),l.push(L)}}re&&a6(this)},render:function(e,t){if(t.tween._time||!dL())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:Pd,aliases:Fd,getSetter:function(e,t,i){var r=Fd[t];return r&&r.indexOf(",")<0&&(t=r),t in Yd&&t!==Iu&&(e._gsap.x||Pd(e,"x"))?i&&pO===i?t==="scale"?LJ:PJ:(pO=i||{})&&(t==="scale"?kJ:DJ):e.style&&!eL(e.style[t])?CJ:~t.indexOf("-")?IJ:cL(e,t)},core:{_removeProperty:Fv,_getMatrix:pL}};Ul.utils.checkPrefix=zy;Ul.core.getStyleSaver=d6;(function(n,e,t,i){var r=tl(n+","+e+","+t,function(o){Yd[o]=1});tl(e,function(o){Ol.units[o]="deg",g6[o]=1}),Fd[r[13]]=n+","+e,tl(i,function(o){var l=o.split(":");Fd[l[1]]=r[l[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");tl("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Ol.units[n]="px"});Ul.registerPlugin(x6);var v6=Ul.registerPlugin(x6)||Ul;v6.core.Tween;var NC={},HJ={get exports(){return NC},set exports(n){NC=n}};(function(n,e){(function(t,i){n.exports=i()})(Kb,function(){var t,i,r;function o(s,d){if(!t)t=d;else if(!i)i=d;else{var p="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+t+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",_={};t(_),r=d(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}o(["exports"],function(s){var d=typeof self<"u"?self:{},p="2.12.1";let _;const w={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):c}catch{_=c}}return _},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},M={supported:!1,testSupport:function(c){!L&&P&&(D?z(c):A=c)}};let A,P,L=!1,D=!1;function z(c){const a=c.createTexture();c.bindTexture(c.TEXTURE_2D,a);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,P),c.isContextLost())return;M.supported=!0}catch{}c.deleteTexture(a),L=!0}d.document&&(P=d.document.createElement("img"),P.onload=function(){A&&z(A),A=null,D=!0},P.onerror=function(){L=!0,A=null},P.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const F="01";var N=V;function V(c,a,u,f){this.cx=3*c,this.bx=3*(u-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(f-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=a,this.p2x=u,this.p2y=f}V.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,a){if(a===void 0&&(a=1e-6),c<0)return 0;if(c>1)return 1;for(var u=c,f=0;f<8;f++){var g=this.sampleCurveX(u)-c;if(Math.abs(g)<a)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=g/v}var T=0,C=1;for(u=c,f=0;f<20&&(g=this.sampleCurveX(u),!(Math.abs(g-c)<a));f++)c>g?T=u:C=u,u=.5*(C-T)+T;return u},solve:function(c,a){return this.sampleCurveY(this.solveCurveX(c,a))}};var j=Q;function Q(c,a){this.x=c,this.y=a}Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x,u=c.y-this.y;return a*a+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=a,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var a=Math.cos(c),u=Math.sin(c),f=u*this.x+a*this.y;return this.x=a*this.x-u*this.y,this.y=f,this},_rotateAround:function(c,a){var u=Math.cos(c),f=Math.sin(c),g=a.y+f*(this.x-a.x)+u*(this.y-a.y);return this.x=a.x+u*(this.x-a.x)-f*(this.y-a.y),this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Q.convert=function(c){return c instanceof Q?c:Array.isArray(c)?new Q(c[0],c[1]):c};const re=Math.PI/180,Z=180/Math.PI;function ne(c){return c*re}function he(c){return c*Z}const De=[[0,0],[1,0],[1,1],[0,1]];function He(c){if(c<=0)return 0;if(c>=1)return 1;const a=c*c,u=a*c;return 4*(c<.5?u:3*(c-a)+u-.75)}function ae(c,a,u,f){const g=new N(c,a,u,f);return function(v){return g.solve(v)}}const le=ae(.25,.1,.25,1);function fe(c,a,u){return Math.min(u,Math.max(a,c))}function Oe(c,a,u){return(u=fe((u-c)/(a-c),0,1))*u*(3-2*u)}function We(c,a,u){const f=u-a,g=((c-a)%f+f)%f+a;return g===a?u:g}function ce(c,a,u){if(!c.length)return u(null,[]);let f=c.length;const g=new Array(c.length);let v=null;c.forEach((T,C)=>{a(T,(k,O)=>{k&&(v=k),g[C]=O,--f==0&&u(v,g)})})}function Te(c){const a=[];for(const u in c)a.push(c[u]);return a}function Pe(c,...a){for(const u of a)for(const f in u)c[f]=u[f];return c}let Qe=1;function Ne(){return Qe++}function nt(){return function c(a){return a?(a^Math.random()*(16>>a/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function ze(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function et(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Et(c,a){c.forEach(u=>{a[u]&&(a[u]=a[u].bind(a))})}function Nt(c,a){return c.indexOf(a,c.length-a.length)!==-1}function qt(c,a,u){const f={};for(const g in c)f[g]=a.call(u||this,c[g],g,c);return f}function wn(c,a,u){const f={};for(const g in c)a.call(u||this,c[g],g,c)&&(f[g]=c[g]);return f}function _n(c){return Array.isArray(c)?c.map(_n):typeof c=="object"&&c?qt(c,_n):c}const Rn={};function At(c){Rn[c]||(typeof console<"u"&&console.warn(c),Rn[c]=!0)}function Ot(c,a,u){return(u.y-c.y)*(a.x-c.x)>(a.y-c.y)*(u.x-c.x)}function Ft(c){let a=0;for(let u,f,g=0,v=c.length,T=v-1;g<v;T=g++)u=c[g],f=c[T],a+=(f.x-u.x)*(u.y+f.y);return a}function Cn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function pn(c){const a={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,v)=>{const T=g||v;return a[f]=!T||T.toLowerCase(),""}),a["max-age"]){const u=parseInt(a["max-age"],10);isNaN(u)?delete a["max-age"]:a["max-age"]=u}return a}let Vn=null;function On(c){if(Vn==null){const a=c.navigator?c.navigator.userAgent:null;Vn=!!c.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Vn}function Zn(c){try{const a=d[c];return a.setItem("_mapbox_test_",1),a.removeItem("_mapbox_test_"),!0}catch{return!1}}function ai(c,a){return[c[4*a],c[4*a+1],c[4*a+2],c[4*a+3]]}const Ei="mapbox-tiles";let Be,Se,St=500,tn=50;function nn(){try{return d.caches}catch{}}function fn(){nn()&&!Be&&(Be=d.caches.open(Ei))}function Nn(c){const a=c.indexOf("?");if(a<0)return c;const u=function(g){const v=g.indexOf("?");return v>0?g.slice(v+1).split("&"):[]}(c),f=u.filter(g=>{const v=g.split("=");return v[0]==="language"||v[0]==="worldview"});return f.length?`${c.slice(0,a)}?${f.join("&")}`:c.slice(0,a)}let yn=1/0;const Dt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Dt);class Un extends Error{constructor(a,u,f){u===401&&bn(f)&&(a+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(a),this.status=u,this.url=f}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Je=Cn()?()=>self.worker&&self.worker.referrer:()=>(d.location.protocol==="blob:"?d.parent:d).location.href,It=function(c,a){if(!(/^file:/.test(u=c.url)||/^file:/.test(Je())&&!/^\w+:/.test(u))){if(d.fetch&&d.Request&&d.AbortController&&d.Request.prototype.hasOwnProperty("signal"))return function(f,g){const v=new d.AbortController,T=new d.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:Je(),signal:v.signal});let C=!1,k=!1;const O=(W=T.url).indexOf("sku=")>0&&bn(W);var W;f.type==="json"&&T.headers.set("Accept","application/json");const q=(J,ie,ue)=>{if(k)return;if(J&&J.message!=="SecurityError"&&At(J),ie&&ue)return $(ie);const ge=Date.now();d.fetch(T).then(Re=>{if(Re.ok){const je=O?Re.clone():null;return $(Re,je,ge)}return g(new Un(Re.statusText,Re.status,f.url))}).catch(Re=>{Re.code!==20&&g(new Error(Re.message))})},$=(J,ie,ue)=>{(f.type==="arrayBuffer"?J.arrayBuffer():f.type==="json"?J.json():J.text()).then(ge=>{k||(ie&&ue&&function(Re,je,ke){if(fn(),!Be)return;const Ge={status:je.status,statusText:je.statusText,headers:new d.Headers};je.headers.forEach((dt,ut)=>Ge.headers.set(ut,dt));const $e=pn(je.headers.get("Cache-Control")||"");if($e["no-store"])return;$e["max-age"]&&Ge.headers.set("Expires",new Date(ke+1e3*$e["max-age"]).toUTCString());const qe=Ge.headers.get("Expires");qe&&(new Date(qe).getTime()-ke<42e4||function(dt,ut){if(Se===void 0)try{new Response(new ReadableStream),Se=!0}catch{Se=!1}Se?ut(dt.body):dt.blob().then(ut)}(je,dt=>{const ut=new d.Response(dt,Ge);fn(),Be&&Be.then(Tt=>Tt.put(Nn(Re.url),ut)).catch(Tt=>At(Tt.message))}))}(T,ie,ue),C=!0,g(null,ge,J.headers.get("Cache-Control"),J.headers.get("Expires")))}).catch(ge=>{k||g(new Error(ge.message))})};return O?function(J,ie){if(fn(),!Be)return ie(null);const ue=Nn(J.url);Be.then(ge=>{ge.match(ue).then(Re=>{const je=function(ke){if(!ke)return!1;const Ge=new Date(ke.headers.get("Expires")||0),$e=pn(ke.headers.get("Cache-Control")||"");return Ge>Date.now()&&!$e["no-cache"]}(Re);ge.delete(ue),je&&ge.put(ue,Re.clone()),ie(null,Re,je)}).catch(ie)}).catch(ie)}(T,q):q(null,null),{cancel:()=>{k=!0,C||v.abort()}}}(c,a);if(Cn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,a,void 0,!0)}var u;return function(f,g){const v=new d.XMLHttpRequest;v.open(f.method||"GET",f.url,!0),f.type==="arrayBuffer"&&(v.responseType="arraybuffer");for(const T in f.headers)v.setRequestHeader(T,f.headers[T]);return f.type==="json"&&(v.responseType="text",v.setRequestHeader("Accept","application/json")),v.withCredentials=f.credentials==="include",v.onerror=()=>{g(new Error(v.statusText))},v.onload=()=>{if((v.status>=200&&v.status<300||v.status===0)&&v.response!==null){let T=v.response;if(f.type==="json")try{T=JSON.parse(v.response)}catch(C){return g(C)}g(null,T,v.getResponseHeader("Cache-Control"),v.getResponseHeader("Expires"))}else g(new Un(v.statusText,v.status,f.url))},v.send(f.body),{cancel:()=>v.abort()}}(c,a)},Zt=function(c,a){return It(Pe(c,{type:"arrayBuffer"}),a)};function sn(c){const a=d.document.createElement("a");return a.href=c,a.protocol===d.document.location.protocol&&a.host===d.document.location.host}const Yn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let li,Bi;li=[],Bi=0;const rt=function(c,a){if(M.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Bi>=w.MAX_PARALLEL_IMAGE_REQUESTS){const v={requestParameters:c,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return li.push(v),v}Bi++;let u=!1;const f=()=>{if(!u)for(u=!0,Bi--;li.length&&Bi<w.MAX_PARALLEL_IMAGE_REQUESTS;){const v=li.shift(),{requestParameters:T,callback:C,cancelled:k}=v;k||(v.cancel=rt(T,C).cancel)}},g=Zt(c,(v,T,C,k)=>{f(),v?a(v):T&&(d.createImageBitmap?function(O,W){const q=new d.Blob([new Uint8Array(O)],{type:"image/png"});d.createImageBitmap(q).then($=>{W(null,$)}).catch($=>{W(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(T,(O,W)=>a(O,W,C,k)):function(O,W){const q=new d.Image,$=d.URL;q.onload=()=>{W(null,q),$.revokeObjectURL(q.src),q.onload=null,d.requestAnimationFrame(()=>{q.src=Yn})},q.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const J=new d.Blob([new Uint8Array(O)],{type:"image/png"});q.src=O.byteLength?$.createObjectURL(J):Yn}(T,(O,W)=>a(O,W,C,k)))});return{cancel:()=>{g.cancel(),f()}}},Ct="NO_ACCESS_TOKEN";function Vt(c){return c.indexOf("mapbox:")===0}function bn(c){return w.API_URL_REGEX.test(c)}function Ln(c){return w.API_CDN_URL_REGEX.test(c)}function Ri(c){return w.API_STYLE_REGEX.test(c)&&!hr(c)}function hr(c){return w.API_SPRITE_REGEX.test(c)}const Fr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pr(c){const a=c.match(Fr);if(!a)throw new Error("Unable to parse URL object");return{protocol:a[1],authority:a[2],path:a[3]||"/",params:a[4]?a[4].split("&"):[]}}function Gi(c){const a=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${a}`}function es(c){if(!c)return null;const a=c.split(".");if(!a||a.length!==3)return null;try{return JSON.parse(decodeURIComponent(d.atob(a[1]).split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ee{constructor(a){this.type=a,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(a){const u=es(w.ACCESS_TOKEN);let f="";return f=u&&u.u?d.btoa(encodeURIComponent(u.u).replace(/%([0-9A-F]{2})/g,(g,v)=>String.fromCharCode(Number("0x"+v)))):w.ACCESS_TOKEN||"",a?`mapbox.eventData.${a}:${f}`:`mapbox.eventData:${f}`}fetchEventData(){const a=Zn("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{const g=d.localStorage.getItem(u);g&&(this.eventData=JSON.parse(g));const v=d.localStorage.getItem(f);v&&(this.anonId=v)}catch{At("Unable to read from LocalStorage")}}saveEventData(){const a=Zn("localStorage"),u=this.getStorageKey(),f=this.getStorageKey("uuid");if(a)try{d.localStorage.setItem(f,this.anonId),Object.keys(this.eventData).length>=1&&d.localStorage.setItem(u,JSON.stringify(this.eventData))}catch{At("Unable to write to LocalStorage")}}processRequests(a){}postEvent(a,u,f,g){if(!w.EVENTS_URL)return;const v=Pr(w.EVENTS_URL);v.params.push(`access_token=${g||w.ACCESS_TOKEN||""}`);const T={event:this.type,created:new Date(a).toISOString()},C=u?Pe(T,u):T,k={url:Gi(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([C])};this.pendingRequest=function(O,W){return It(Pe(O,{method:"POST"}),W)}(k,O=>{this.pendingRequest=null,f(O),this.saveEventData(),this.processRequests(g)})}queueRequest(a,u){this.queue.push(a),this.processRequests(u)}}const se=new class extends Ee{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,a){w.EVENTS_URL&&w.ACCESS_TOKEN&&Array.isArray(c)&&c.some(u=>Vt(u)||bn(u))&&this.queueRequest(Date.now(),a)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const a=es(w.ACCESS_TOKEN),u=a?a.u:w.ACCESS_TOKEN;let f=u!==this.eventData.tokenU;et(this.anonId)||(this.anonId=nt(),f=!0);const g=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),T=new Date(g),C=(g-this.eventData.lastSuccess)/864e5;f=f||C>=1||C<-1||v.getDate()!==T.getDate()}else f=!0;f?this.postEvent(g,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:F,"enabled.telemetry":!1,userId:this.anonId},v=>{v||(this.eventData.lastSuccess=g,this.eventData.tokenU=u)},c):this.processRequests()}},de=se.postTurnstileEvent.bind(se),Ie=new class extends Ee{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,a,u,f){this.skuToken=a,this.errorCb=f,w.EVENTS_URL&&(u||w.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Ct)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||(this.anonId||this.fetchEventData(),et(this.anonId)||(this.anonId=nt()),this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:p,skuId:F,skuToken:this.skuToken,userId:this.anonId},f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},c))}},ee=Ie.postMapLoadEvent.bind(Ie),pe=new class extends Ee{constructor(){super("gljs.performance")}postPerformanceEvent(c,a){w.EVENTS_URL&&(c||w.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:a},c)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:a,performanceData:u}=this.queue.shift(),f=function(g){const v=d.performance.getEntriesByType("resource"),T=d.performance.getEntriesByType("mark"),C=function($){const J={};if($){for(const ie in $)if(ie!=="other")for(const ue of $[ie]){const ge=`${ie}ResolveRangeMin`,Re=`${ie}ResolveRangeMax`,je=`${ie}RequestCount`,ke=`${ie}RequestCachedCount`;J[ge]=Math.min(J[ge]||1/0,ue.startTime),J[Re]=Math.max(J[Re]||-1/0,ue.responseEnd);const Ge=$e=>{J[$e]===void 0&&(J[$e]=0),++J[$e]};ue.transferSize!==void 0&&ue.transferSize===0&&Ge(ke),Ge(je)}}return J}(function($,J){const ie={};if($)for(const ue of $){const ge=J(ue);ie[ge]===void 0&&(ie[ge]=[]),ie[ge].push(ue)}return ie}(v,vt)),k=d.devicePixelRatio,O=d.navigator.connection||d.navigator.mozConnection||d.navigator.webkitConnection,W={counters:[],metadata:[],attributes:[]},q=($,J,ie)=>{ie!=null&&$.push({name:J,value:ie.toString()})};for(const $ in C)q(W.counters,$,C[$]);if(g.interactionRange[0]!==1/0&&g.interactionRange[1]!==-1/0&&(q(W.counters,"interactionRangeMin",g.interactionRange[0]),q(W.counters,"interactionRangeMax",g.interactionRange[1])),T)for(const $ of Object.keys(ht)){const J=ht[$],ie=T.find(ue=>ue.name===J);ie&&q(W.counters,J,ie.startTime)}return q(W.counters,"visibilityHidden",g.visibilityHidden),q(W.attributes,"style",function($){if($)for(const J of $){const ie=J.name.split("?")[0];if(Ri(ie)){const ue=ie.split("/").slice(-2);if(ue.length===2)return`mapbox://styles/${ue[0]}/${ue[1]}`}}}(v)),q(W.attributes,"terrainEnabled",g.terrainEnabled?"true":"false"),q(W.attributes,"fogEnabled",g.fogEnabled?"true":"false"),q(W.attributes,"projection",g.projection),q(W.attributes,"zoom",g.zoom),q(W.metadata,"devicePixelRatio",k),q(W.metadata,"connectionEffectiveType",O?O.effectiveType:void 0),q(W.metadata,"navigatorUserAgent",d.navigator.userAgent),q(W.metadata,"screenWidth",d.screen.width),q(W.metadata,"screenHeight",d.screen.height),q(W.metadata,"windowWidth",d.innerWidth),q(W.metadata,"windowHeight",d.innerHeight),q(W.metadata,"mapWidth",g.width/k),q(W.metadata,"mapHeight",g.height/k),q(W.metadata,"webglRenderer",g.renderer),q(W.metadata,"webglVendor",g.vendor),q(W.metadata,"sdkVersion",p),q(W.metadata,"sdkIdentifier","mapbox-gl-js"),W}(u);for(const g of f.metadata);for(const g of f.counters);for(const g of f.attributes);this.postEvent(a,f,()=>{},c)}},Ae=pe.postPerformanceEvent.bind(pe),ye=new class extends Ee{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,a,u,f){if(!w.API_URL||!w.SESSION_PATH)return;const g=Pr(w.API_URL+w.SESSION_PATH);g.params.push(`sku=${a||""}`),g.params.push(`access_token=${f||w.ACCESS_TOKEN||""}`);const v={url:Gi(g),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(T,C){return It(Pe(T,{method:"GET"}),C)}(v,T=>{this.pendingRequest=null,u(T),this.saveEventData(),this.processRequests(f)})}getSessionAPI(c,a,u,f){this.skuToken=a,this.errorCb=f,w.SESSION_PATH&&w.API_URL&&(u||w.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},u):this.errorCb(new Error(Ct)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:a,timestamp:u}=this.queue.shift();a&&this.success[a]||this.getSession(u,this.skuToken,f=>{f?this.errorCb(f):a&&(this.success[a]=!0)},c)}},ve=ye.getSessionAPI.bind(ye),Ke=new Set,ht={create:"create",load:"load",fullLoad:"fullLoad"},zt={mark(c){d.performance.mark(c)},measure(c,a,u){d.performance.measure(c,a,u)}};function vt(c){const a=c.name.split("?")[0];return Ln(a)&&a.includes("mapbox-gl.js")?"javascript":Ln(a)&&a.includes("mapbox-gl.css")?"css":function(u){return w.API_FONTS_REGEX.test(u)}(a)?"fontRange":hr(a)?"sprite":Ri(a)?"style":function(u){return w.API_TILEJSON_REGEX.test(u)}(a)?"tilejson":"other"}const Jt=d.performance;function Yt(c){const a=c?c.url.toString():void 0;return Jt.getEntriesByName(a)}let Xt,gn,Xn,ii;const Sn={now:()=>Xn!==void 0?Xn:d.performance.now(),setNow(c){Xn=c},restoreNow(){Xn=void 0},frame(c){const a=d.requestAnimationFrame(c);return{cancel:()=>d.cancelAnimationFrame(a)}},getImageData(c,a=0){const{width:u,height:f}=c;ii||(ii=d.document.createElement("canvas"));const g=ii.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(u>ii.width||f>ii.height)&&(ii.width=u,ii.height=f),g.clearRect(-a,-a,u+2*a,f+2*a),g.drawImage(c,0,0,u,f),g.getImageData(-a,-a,u+2*a,f+2*a)},resolveURL:c=>(Xt||(Xt=d.document.createElement("a")),Xt.href=c,Xt.href),get devicePixelRatio(){return d.devicePixelRatio},get prefersReducedMotion(){return!!d.matchMedia&&(gn==null&&(gn=d.matchMedia("(prefers-reduced-motion: reduce)")),gn.matches)}};function Jn(c,a,u){u[c]&&u[c].indexOf(a)!==-1||(u[c]=u[c]||[],u[c].push(a))}function kn(c,a,u){if(u&&u[c]){const f=u[c].indexOf(a);f!==-1&&u[c].splice(f,1)}}class ps{constructor(a,u={}){Pe(this,u),this.type=a}}class nr extends ps{constructor(a,u={}){super("error",Pe({error:a},u))}}class Br{on(a,u){return this._listeners=this._listeners||{},Jn(a,u,this._listeners),this}off(a,u){return kn(a,u,this._listeners),kn(a,u,this._oneTimeListeners),this}once(a,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},Jn(a,u,this._oneTimeListeners),this):new Promise(f=>this.once(a,f))}fire(a,u){typeof a=="string"&&(a=new ps(a,u||{}));const f=a.type;if(this.listens(f)){a.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const C of g)C.call(this,a);const v=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const C of v)kn(f,C,this._oneTimeListeners),C.call(this,a);const T=this._eventedParent;T&&(Pe(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(a))}else a instanceof nr&&console.error(a.error);return this}listens(a){return!!(this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a))}setEventedParent(a,u){return this._eventedParent=a,this._eventedParentData=u,this}}var wt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Es(c,...a){for(const u of a)for(const f in u)c[f]=u[f];return c}function ir(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function Ni(c){if(Array.isArray(c))return c.map(Ni);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const a={};for(const u in c)a[u]=Ni(c[u]);return a}return ir(c)}class zi extends Error{constructor(a,u){super(u),this.message=u,this.key=a}}var ci=zi;class wr{constructor(a,u=[]){this.parent=a,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(a){return new wr(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}var Ur=wr;const qi={kind:"null"},Kt={kind:"number"},ni={kind:"string"},Kn={kind:"boolean"},uo={kind:"color"},Wl={kind:"object"},ri={kind:"value"},Hl={kind:"collator"},Rc={kind:"formatted"},ms={kind:"resolvedImage"};function As(c,a){return{kind:"array",itemType:c,N:a}}function br(c){if(c.kind==="array"){const a=br(c.itemType);return typeof c.N=="number"?`array<${a}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${a}>`}return c.kind}const Da=[qi,Kt,ni,Kn,uo,Rc,Wl,As(ri),ms];function jl(c,a){if(a.kind==="error")return null;if(c.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!jl(c.itemType,a.itemType))&&(typeof c.N!="number"||c.N===a.N))return null}else{if(c.kind===a.kind)return null;if(c.kind==="value"){for(const u of Da)if(!jl(u,a))return null}}return`Expected ${br(c)} but found ${br(a)} instead.`}function ql(c,a){return a.some(u=>u.kind===c.kind)}function sl(c,a){return a.some(u=>u==="null"?c===null:u==="array"?Array.isArray(c):u==="object"?c&&!Array.isArray(c)&&typeof c=="object":u===typeof c)}var Zl,jp={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Xl(c){return(c=Math.round(c))<0?0:c>255?255:c}function zc(c){return Xl(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function Nu(c){return(a=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:a>1?1:a;var a}function Oc(c,a,u){return u<0?u+=1:u>1&&(u-=1),6*u<1?c+(a-c)*u*6:2*u<1?a:3*u<2?c+(a-c)*(2/3-u)*6:c}try{Zl={}.parseCSSColor=function(c){var a,u=c.replace(/ /g,"").toLowerCase();if(u in jp)return jp[u].slice();if(u[0]==="#")return u.length===4?(a=parseInt(u.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:u.length===7&&(a=parseInt(u.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var f=u.indexOf("("),g=u.indexOf(")");if(f!==-1&&g+1===u.length){var v=u.substr(0,f),T=u.substr(f+1,g-(f+1)).split(","),C=1;switch(v){case"rgba":if(T.length!==4)return null;C=Nu(T.pop());case"rgb":return T.length!==3?null:[zc(T[0]),zc(T[1]),zc(T[2]),C];case"hsla":if(T.length!==4)return null;C=Nu(T.pop());case"hsl":if(T.length!==3)return null;var k=(parseFloat(T[0])%360+360)%360/360,O=Nu(T[1]),W=Nu(T[2]),q=W<=.5?W*(O+1):W+O-W*O,$=2*W-q;return[Xl(255*Oc($,q,k+1/3)),Xl(255*Oc($,q,k)),Xl(255*Oc($,q,k-1/3)),C];default:return null}}return null}}catch{}class ho{constructor(a,u,f,g=1){this.r=a,this.g=u,this.b=f,this.a=g}static parse(a){if(!a)return;if(a instanceof ho)return a;if(typeof a!="string")return;const u=Zl(a);return u?new ho(u[0]/255*u[3],u[1]/255*u[3],u[2]/255*u[3],u[3]):void 0}toString(){const[a,u,f,g]=this.toArray();return`rgba(${Math.round(a)},${Math.round(u)},${Math.round(f)},${g})`}toArray(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[255*a/g,255*u/g,255*f/g,g]}toArray01(){const{r:a,g:u,b:f,a:g}=this;return g===0?[0,0,0,0]:[a/g,u/g,f/g,g]}toArray01PremultipliedAlpha(){const{r:a,g:u,b:f,a:g}=this;return[a,u,f,g]}}ho.black=new ho(0,0,0,1),ho.white=new ho(1,1,1,1),ho.transparent=new ho(0,0,0,0),ho.red=new ho(1,0,0,1),ho.blue=new ho(0,0,1,1);var Sr=ho;class Ai{constructor(a,u,f){this.sensitivity=a?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,u){return this.collator.compare(a,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class rf{constructor(a,u,f,g,v){this.text=a.normalize?a.normalize():a,this.image=u,this.scale=f,this.fontStack=g,this.textColor=v}}class ts{constructor(a){this.sections=a}static fromString(a){return new ts([new rf(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof ts?a:ts.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}serialize(){const a=["format"];for(const u of this.sections){if(u.image){a.push(["image",u.image.name]);continue}a.push(u.text);const f={};u.fontStack&&(f["text-font"]=["literal",u.fontStack.split(",")]),u.scale&&(f["font-scale"]=u.scale),u.textColor&&(f["text-color"]=["rgba"].concat(u.textColor.toArray())),a.push(f)}return a}}class Io{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Io({name:a,available:!1}):null}serialize(){return["image",this.name]}}function Og(c,a,u,f){return typeof c=="number"&&c>=0&&c<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[c,a,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[c,a,u,f]:[c,a,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function sf(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof Sr||c instanceof Ai||c instanceof ts||c instanceof Io)return!0;if(Array.isArray(c)){for(const a of c)if(!sf(a))return!1;return!0}if(typeof c=="object"){for(const a in c)if(!sf(c[a]))return!1;return!0}return!1}function wi(c){if(c===null)return qi;if(typeof c=="string")return ni;if(typeof c=="boolean")return Kn;if(typeof c=="number")return Kt;if(c instanceof Sr)return uo;if(c instanceof Ai)return Hl;if(c instanceof ts)return Rc;if(c instanceof Io)return ms;if(Array.isArray(c)){const a=c.length;let u;for(const f of c){const g=wi(f);if(u){if(u===g)continue;u=ri;break}u=g}return As(u||ri,a)}return Wl}function Fc(c){const a=typeof c;return c===null?"":a==="string"||a==="number"||a==="boolean"?String(c):c instanceof Sr||c instanceof ts||c instanceof Io?c.toString():JSON.stringify(c)}class qp{constructor(a,u){this.type=a,this.value=u}static parse(a,u){if(a.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!sf(a[1]))return u.error("invalid value");const f=a[1];let g=wi(f);const v=u.expectedType;return g.kind!=="array"||g.N!==0||!v||v.kind!=="array"||typeof v.N=="number"&&v.N!==0||(g=v),new qp(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Sr?["rgba"].concat(this.value.toArray()):this.value instanceof ts?this.value.serialize():this.value}}var Bc=qp,gs=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const ol={string:ni,number:Kt,boolean:Kn,object:Wl};class Wo{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");let f,g=1;const v=a[0];if(v==="array"){let C,k;if(a.length>2){const O=a[1];if(typeof O!="string"||!(O in ol)||O==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);C=ol[O],g++}else C=ri;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return u.error('The length argument to "array" must be a positive integer literal',2);k=a[2],g++}f=As(C,k)}else f=ol[v];const T=[];for(;g<a.length;g++){const C=u.parse(a[g],g,ri);if(!C)return null;T.push(C)}return new Wo(f,T)}evaluate(a){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(a);if(!jl(this.type,wi(f)))return f;if(u===this.args.length-1)throw new gs(`Expected value to be of type ${br(this.type)}, but found ${br(wi(f))} instead.`)}return null}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=this.type,u=[a.kind];if(a.kind==="array"){const f=a.itemType;if(f.kind==="string"||f.kind==="number"||f.kind==="boolean"){u.push(f.kind);const g=a.N;(typeof g=="number"||this.args.length>1)&&u.push(g)}}return u.concat(this.args.map(f=>f.serialize()))}}var al=Wo;class Dh{constructor(a){this.type=Rc,this.sections=a}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let v=!1;for(let T=1;T<=a.length-1;++T){const C=a[T];if(v&&typeof C=="object"&&!Array.isArray(C)){v=!1;let k=null;if(C["font-scale"]&&(k=u.parse(C["font-scale"],1,Kt),!k))return null;let O=null;if(C["text-font"]&&(O=u.parse(C["text-font"],1,As(ni)),!O))return null;let W=null;if(C["text-color"]&&(W=u.parse(C["text-color"],1,uo),!W))return null;const q=g[g.length-1];q.scale=k,q.font=O,q.textColor=W}else{const k=u.parse(a[T],1,ri);if(!k)return null;const O=k.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");v=!0,g.push({content:k,scale:null,font:null,textColor:null})}}return new Dh(g)}evaluate(a){return new ts(this.sections.map(u=>{const f=u.content.evaluate(a);return wi(f)===ms?new rf("",f,null,null,null):new rf(Fc(f),null,u.scale?u.scale.evaluate(a):null,u.font?u.font.evaluate(a).join(","):null,u.textColor?u.textColor.evaluate(a):null)}))}eachChild(a){for(const u of this.sections)a(u.content),u.scale&&a(u.scale),u.font&&a(u.font),u.textColor&&a(u.textColor)}outputDefined(){return!1}serialize(){const a=["format"];for(const u of this.sections){a.push(u.content.serialize());const f={};u.scale&&(f["font-scale"]=u.scale.serialize()),u.font&&(f["text-font"]=u.font.serialize()),u.textColor&&(f["text-color"]=u.textColor.serialize()),a.push(f)}return a}}class Po{constructor(a){this.type=ms,this.input=a}static parse(a,u){if(a.length!==2)return u.error("Expected two arguments.");const f=u.parse(a[1],1,ni);return f?new Po(f):u.error("No image name provided.")}evaluate(a){const u=this.input.evaluate(a),f=Io.fromString(u);return f&&a.availableImages&&(f.available=a.availableImages.indexOf(u)>-1),f}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ll={"to-boolean":Kn,"to-color":uo,"to-number":Kt,"to-string":ni};class Uu{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expected at least one argument.");const f=a[0];if((f==="to-boolean"||f==="to-string")&&a.length!==2)return u.error("Expected one argument.");const g=ll[f],v=[];for(let T=1;T<a.length;T++){const C=u.parse(a[T],T,ri);if(!C)return null;v.push(C)}return new Uu(g,v)}evaluate(a){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(a));if(this.type.kind==="color"){let u,f;for(const g of this.args){if(u=g.evaluate(a),f=null,u instanceof Sr)return u;if(typeof u=="string"){const v=a.parseColor(u);if(v)return v}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rbga value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Og(u[0],u[1],u[2],u[3]),!f))return new Sr(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new gs(f||`Could not parse color from value '${typeof u=="string"?u:String(JSON.stringify(u))}'`)}if(this.type.kind==="number"){let u=null;for(const f of this.args){if(u=f.evaluate(a),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new gs(`Could not convert ${JSON.stringify(u)} to number.`)}return this.type.kind==="formatted"?ts.fromString(Fc(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Io.fromString(Fc(this.args[0].evaluate(a))):Fc(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Dh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Po(this.args[0]).serialize();const a=[`to-${this.type.kind}`];return this.eachChild(u=>{a.push(u.serialize())}),a}}var cl=Uu;const Rh=["Unknown","Point","LineString","Polygon"];var Fg=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Rh[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,a=this.featureDistanceData.scale,{x:u,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*a-c[0])+this.featureDistanceData.bearing[1]*(f*a-c[1])}return 0}parseColor(c){let a=this._parseColorCache[c];return a||(a=this._parseColorCache[c]=Sr.parse(c)),a}};class Xs{constructor(a,u,f,g){this.name=a,this.type=u,this._evaluate=f,this.args=g}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(a=>a.serialize()))}static parse(a,u){const f=a[0],g=Xs.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const v=Array.isArray(g)?g[0]:g.type,T=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=T.filter(([O])=>!Array.isArray(O)||O.length===a.length-1);let k=null;for(const[O,W]of C){k=new za(u.registry,u.path,null,u.scope);const q=[];let $=!1;for(let J=1;J<a.length;J++){const ie=a[J],ue=Array.isArray(O)?O[J-1]:O.type,ge=k.parse(ie,1+q.length,ue);if(!ge){$=!0;break}q.push(ge)}if(!$)if(Array.isArray(O)&&O.length!==q.length)k.error(`Expected ${O.length} arguments, but found ${q.length} instead.`);else{for(let J=0;J<q.length;J++){const ie=Array.isArray(O)?O[J]:O.type,ue=q[J];k.concat(J+1).checkSubtype(ie,ue.type)}if(k.errors.length===0)return new Xs(f,v,W,q)}}if(C.length===1)u.errors.push(...k.errors);else{const O=(C.length?C:T).map(([q])=>{return $=q,Array.isArray($)?`(${$.map(br).join(", ")})`:`(${br($.type)}...)`;var $}).join(" | "),W=[];for(let q=1;q<a.length;q++){const $=u.parse(a[q],1+W.length);if(!$)return null;W.push(br($.type))}u.error(`Expected arguments of type ${O}, but found (${W.join(", ")}) instead.`)}return null}static register(a,u){Xs.definitions=u;for(const f in u)a[f]=Xs}}var $l=Xs;class Nc{constructor(a,u,f){this.type=Hl,this.locale=f,this.caseSensitive=a,this.diacriticSensitive=u}static parse(a,u){if(a.length!==2)return u.error("Expected one argument.");const f=a[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Kn);if(!g)return null;const v=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Kn);if(!v)return null;let T=null;return f.locale&&(T=u.parse(f.locale,1,ni),!T)?null:new Nc(g,v,T)}evaluate(a){return new Ai(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}serialize(){const a={};return a["case-sensitive"]=this.caseSensitive.serialize(),a["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(a.locale=this.locale.serialize()),["collator",a]}}const Cs=8192;function fo(c,a){c[0]=Math.min(c[0],a[0]),c[1]=Math.min(c[1],a[1]),c[2]=Math.max(c[2],a[0]),c[3]=Math.max(c[3],a[1])}function Yl(c,a){return!(c[0]<=a[0]||c[2]>=a[2]||c[1]<=a[1]||c[3]>=a[3])}function zh(c,a){const u=(180+c[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,g=Math.pow(2,a.z);return[Math.round(u*g*Cs),Math.round(f*g*Cs)]}function Uc(c,a,u){const f=c[0]-a[0],g=c[1]-a[1],v=c[0]-u[0],T=c[1]-u[1];return f*T-v*g==0&&f*v<=0&&g*T<=0}function Vu(c,a){let u=!1;for(let T=0,C=a.length;T<C;T++){const k=a[T];for(let O=0,W=k.length;O<W-1;O++){if(Uc(c,k[O],k[O+1]))return!1;(g=k[O])[1]>(f=c)[1]!=(v=k[O+1])[1]>f[1]&&f[0]<(v[0]-g[0])*(f[1]-g[1])/(v[1]-g[1])+g[0]&&(u=!u)}}var f,g,v;return u}function of(c,a){for(let u=0;u<a.length;u++)if(Vu(c,a[u]))return!0;return!1}function Oh(c,a,u,f){const g=f[0]-u[0],v=f[1]-u[1],T=(c[0]-u[0])*v-g*(c[1]-u[1]),C=(a[0]-u[0])*v-g*(a[1]-u[1]);return T>0&&C<0||T<0&&C>0}function Vc(c,a,u){for(const O of u)for(let W=0;W<O.length-1;++W)if((C=[(T=O[W+1])[0]-(v=O[W])[0],T[1]-v[1]])[0]*(k=[(g=a)[0]-(f=c)[0],g[1]-f[1]])[1]-C[1]*k[0]!=0&&Oh(f,g,v,T)&&Oh(v,T,f,g))return!0;var f,g,v,T,C,k;return!1}function Fh(c,a){for(let u=0;u<c.length;++u)if(!Vu(c[u],a))return!1;for(let u=0;u<c.length-1;++u)if(Vc(c[u],c[u+1],a))return!1;return!0}function Gc(c,a){for(let u=0;u<a.length;u++)if(Fh(c,a[u]))return!0;return!1}function Bs(c,a,u){const f=[];for(let g=0;g<c.length;g++){const v=[];for(let T=0;T<c[g].length;T++){const C=zh(c[g][T],u);fo(a,C),v.push(C)}f.push(v)}return f}function Ho(c,a,u){const f=[];for(let g=0;g<c.length;g++){const v=Bs(c[g],a,u);f.push(v)}return f}function po(c,a,u,f){if(c[0]<u[0]||c[0]>u[2]){const g=.5*f;let v=c[0]-u[0]>g?-f:u[0]-c[0]>g?f:0;v===0&&(v=c[0]-u[2]>g?-f:u[2]-c[0]>g?f:0),c[0]+=v}fo(a,c)}function Ci(c,a,u,f){const g=Math.pow(2,f.z)*Cs,v=[f.x*Cs,f.y*Cs],T=[];if(!c)return T;for(const C of c)for(const k of C){const O=[k.x+v[0],k.y+v[1]];po(O,a,u,g),T.push(O)}return T}function Zp(c,a,u,f){const g=Math.pow(2,f.z)*Cs,v=[f.x*Cs,f.y*Cs],T=[];if(!c)return T;for(const k of c){const O=[];for(const W of k){const q=[W.x+v[0],W.y+v[1]];fo(a,q),O.push(q)}T.push(O)}if(a[2]-a[0]<=g/2){(C=a)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const k of T)for(const O of k)po(O,a,u,g)}var C;return T}class Lo{constructor(a,u){this.type=Kn,this.geojson=a,this.geometries=u}static parse(a,u){if(a.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(sf(a[1])){const f=a[1];if(f.type==="FeatureCollection")for(let g=0;g<f.features.length;++g){const v=f.features[g].geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new Lo(f,f.features[g].geometry)}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Lo(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Lo(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],T=u.canonicalID();if(!T)return!1;if(f.type==="Polygon"){const C=Bs(f.coordinates,v,T),k=Ci(u.geometry(),g,v,T);if(!Yl(g,v))return!1;for(const O of k)if(!Vu(O,C))return!1}if(f.type==="MultiPolygon"){const C=Ho(f.coordinates,v,T),k=Ci(u.geometry(),g,v,T);if(!Yl(g,v))return!1;for(const O of k)if(!of(O,C))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],v=[1/0,1/0,-1/0,-1/0],T=u.canonicalID();if(!T)return!1;if(f.type==="Polygon"){const C=Bs(f.coordinates,v,T),k=Zp(u.geometry(),g,v,T);if(!Yl(g,v))return!1;for(const O of k)if(!Fh(O,C))return!1}if(f.type==="MultiPolygon"){const C=Ho(f.coordinates,v,T),k=Zp(u.geometry(),g,v,T);if(!Yl(g,v))return!1;for(const O of k)if(!Gc(O,C))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ra=Lo;function ul(c){if(c instanceof $l&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof Ra)return!1;let a=!0;return c.eachChild(u=>{a&&!ul(u)&&(a=!1)}),a}function Bh(c){if(c instanceof $l&&c.name==="feature-state")return!1;let a=!0;return c.eachChild(u=>{a&&!Bh(u)&&(a=!1)}),a}function Kl(c,a){if(c instanceof $l&&a.indexOf(c.name)>=0)return!1;let u=!0;return c.eachChild(f=>{u&&!Kl(f,a)&&(u=!1)}),u}class Nh{constructor(a,u){this.type=u.type,this.name=a,this.boundExpression=u}static parse(a,u){if(a.length!==2||typeof a[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=a[1];return u.scope.has(f)?new Nh(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var af=Nh;class Gu{constructor(a,u=[],f,g=new Ur,v=[]){this.registry=a,this.path=u,this.key=u.map(T=>`[${T}]`).join(""),this.scope=g,this.errors=v,this.expectedType=f}parse(a,u,f,g,v={}){return u?this.concat(u,f,g)._parse(a,v):this._parse(a,v)}_parse(a,u){function f(g,v,T){return T==="assert"?new al(v,[g]):T==="coerce"?new cl(v,[g]):g}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=a[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const v=this.registry[g];if(v){let T=v.parse(a,this);if(!T)return null;if(this.expectedType){const C=this.expectedType,k=T.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||k.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||k.kind!=="value"&&k.kind!=="string"){if(this.checkSubtype(C,k))return null}else T=f(T,C,u.typeAnnotation||"coerce");else T=f(T,C,u.typeAnnotation||"assert")}if(!(T instanceof Bc)&&T.type.kind!=="resolvedImage"&&Wc(T)){const C=new Fg;try{T=new Bc(T.type,T.evaluate(C))}catch(k){return this.error(k.message),null}}return T}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,u,f){const g=typeof a=="number"?this.path.concat(a):this.path,v=f?this.scope.concat(f):this.scope;return new Gu(this.registry,g,u||null,v,this.errors)}error(a,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new ci(f,a))}checkSubtype(a,u){const f=jl(a,u);return f&&this.error(f),f}}var za=Gu;function Wc(c){if(c instanceof af)return Wc(c.boundExpression);if(c instanceof $l&&c.name==="error"||c instanceof Nc||c instanceof Ra)return!1;const a=c instanceof cl||c instanceof al;let u=!0;return c.eachChild(f=>{u=a?u&&Wc(f):u&&f instanceof Bc}),!!u&&ul(c)&&Kl(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Uh(c,a){const u=c.length-1;let f,g,v=0,T=u,C=0;for(;v<=T;)if(C=Math.floor((v+T)/2),f=c[C],g=c[C+1],f<=a){if(C===u||a<g)return C;v=C+1}else{if(!(f>a))throw new gs("Input is not a number.");T=C-1}return 0}class Wu{constructor(a,u,f){this.type=a,this.input=u,this.labels=[],this.outputs=[];for(const[g,v]of f)this.labels.push(g),this.outputs.push(v)}static parse(a,u){if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(a[1],1,Kt);if(!f)return null;const g=[];let v=null;u.expectedType&&u.expectedType.kind!=="value"&&(v=u.expectedType);for(let T=1;T<a.length;T+=2){const C=T===1?-1/0:a[T],k=a[T+1],O=T,W=T+1;if(typeof C!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=C)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const q=u.parse(k,W,v);if(!q)return null;v=v||q.type,g.push([C,q])}return new Wu(v,f,g)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const v=u.length;return g>=u[v-1]?f[v-1].evaluate(a):f[Uh(u,g)].evaluate(a)}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){const a=["step",this.input.serialize()];for(let u=0;u<this.labels.length;u++)u>0&&a.push(this.labels[u]),a.push(this.outputs[u].serialize());return a}}var Hu=Wu;function di(c,a,u){return c*(1-u)+a*u}var hl=Object.freeze({__proto__:null,number:di,color:function(c,a,u){return new Sr(di(c.r,a.r,u),di(c.g,a.g,u),di(c.b,a.b,u),di(c.a,a.a,u))},array:function(c,a,u){return c.map((f,g)=>di(f,a[g],u))}});const ju=.95047,Vh=1.08883,mo=4/29,$s=6/29,Jl=3*$s*$s,Oa=Math.PI/180,dl=180/Math.PI;function Fa(c){return c>.008856451679035631?Math.pow(c,1/3):c/Jl+mo}function Gh(c){return c>$s?c*c*c:Jl*(c-mo)}function Wh(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function Hh(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function go(c){const a=Hh(c.r),u=Hh(c.g),f=Hh(c.b),g=Fa((.4124564*a+.3575761*u+.1804375*f)/ju),v=Fa((.2126729*a+.7151522*u+.072175*f)/1);return{l:116*v-16,a:500*(g-v),b:200*(v-Fa((.0193339*a+.119192*u+.9503041*f)/Vh)),alpha:c.a}}function _o(c){let a=(c.l+16)/116,u=isNaN(c.a)?a:a+c.a/500,f=isNaN(c.b)?a:a-c.b/200;return a=1*Gh(a),u=ju*Gh(u),f=Vh*Gh(f),new Sr(Wh(3.2404542*u-1.5371385*a-.4985314*f),Wh(-.969266*u+1.8760108*a+.041556*f),Wh(.0556434*u-.2040259*a+1.0572252*f),c.alpha)}function Ar(c,a,u){const f=a-c;return c+u*(f>180||f<-180?f-360*Math.round(f/360):f)}const fl={forward:go,reverse:_o,interpolate:function(c,a,u){return{l:di(c.l,a.l,u),a:di(c.a,a.a,u),b:di(c.b,a.b,u),alpha:di(c.alpha,a.alpha,u)}}},Ns={forward:function(c){const{l:a,a:u,b:f}=go(c),g=Math.atan2(f,u)*dl;return{h:g<0?g+360:g,c:Math.sqrt(u*u+f*f),l:a,alpha:c.a}},reverse:function(c){const a=c.h*Oa,u=c.c;return _o({l:c.l,a:Math.cos(a)*u,b:Math.sin(a)*u,alpha:c.alpha})},interpolate:function(c,a,u){return{h:Ar(c.h,a.h,u),c:di(c.c,a.c,u),l:di(c.l,a.l,u),alpha:di(c.alpha,a.alpha,u)}}};var Xp=Object.freeze({__proto__:null,lab:fl,hcl:Ns});class jh{constructor(a,u,f,g,v){this.type=a,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[T,C]of v)this.labels.push(T),this.outputs.push(C)}static interpolationFactor(a,u,f,g){let v=0;if(a.name==="exponential")v=qh(u,a.base,f,g);else if(a.name==="linear")v=qh(u,1,f,g);else if(a.name==="cubic-bezier"){const T=a.controlPoints;v=new N(T[0],T[1],T[2],T[3]).solve(qh(u,1,f,g))}return v}static parse(a,u){let[f,g,v,...T]=a;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(W=>typeof W!="number"||W<0||W>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(a.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(v=u.parse(v,2,Kt),!v)return null;const C=[];let k=null;f==="interpolate-hcl"||f==="interpolate-lab"?k=uo:u.expectedType&&u.expectedType.kind!=="value"&&(k=u.expectedType);for(let O=0;O<T.length;O+=2){const W=T[O],q=T[O+1],$=O+3,J=O+4;if(typeof W!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(C.length&&C[C.length-1][0]>=W)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const ie=u.parse(q,J,k);if(!ie)return null;k=k||ie.type,C.push([W,ie])}return k.kind==="number"||k.kind==="color"||k.kind==="array"&&k.itemType.kind==="number"&&typeof k.N=="number"?new jh(k,f,g,v,C):u.error(`Type ${br(k)} is not interpolatable.`)}evaluate(a){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(a);const g=this.input.evaluate(a);if(g<=u[0])return f[0].evaluate(a);const v=u.length;if(g>=u[v-1])return f[v-1].evaluate(a);const T=Uh(u,g),C=jh.interpolationFactor(this.interpolation,g,u[T],u[T+1]),k=f[T].evaluate(a),O=f[T+1].evaluate(a);return this.operator==="interpolate"?hl[this.type.kind.toLowerCase()](k,O,C):this.operator==="interpolate-hcl"?Ns.reverse(Ns.interpolate(Ns.forward(k),Ns.forward(O),C)):fl.reverse(fl.interpolate(fl.forward(k),fl.forward(O),C))}eachChild(a){a(this.input);for(const u of this.outputs)a(u)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}serialize(){let a;a=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const u=[this.operator,a,this.input.serialize()];for(let f=0;f<this.labels.length;f++)u.push(this.labels[f],this.outputs[f].serialize());return u}}function qh(c,a,u,f){const g=f-u,v=c-u;return g===0?0:a===1?v/g:(Math.pow(a,v)-1)/(Math.pow(a,g)-1)}var jo=jh;class Zh{constructor(a,u){this.type=a,this.args=u}static parse(a,u){if(a.length<2)return u.error("Expectected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const v=[];for(const C of a.slice(1)){const k=u.parse(C,1+v.length,f,void 0,{typeAnnotation:"omit"});if(!k)return null;f=f||k.type,v.push(k)}const T=g&&v.some(C=>jl(g,C.type));return new Zh(T?ri:f,v)}evaluate(a){let u,f=null,g=0;for(const v of this.args){if(g++,f=v.evaluate(a),f&&f instanceof Io&&!f.available&&(u||(u=f),f=null,g===this.args.length))return u;if(f!==null)break}return f}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}serialize(){const a=["coalesce"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var Hc=Zh;class pl{constructor(a,u){this.type=u.type,this.bindings=[].concat(a),this.result=u}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const u of this.bindings)a(u[1]);a(this.result)}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const f=[];for(let v=1;v<a.length-1;v+=2){const T=a[v];if(typeof T!="string")return u.error(`Expected string, but found ${typeof T} instead.`,v);if(/[^a-zA-Z0-9_]/.test(T))return u.error("Variable names must contain only alphanumeric characters or '_'.",v);const C=u.parse(a[v+1],v+1);if(!C)return null;f.push([T,C])}const g=u.parse(a[a.length-1],a.length-1,u.expectedType,f);return g?new pl(f,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const a=["let"];for(const[u,f]of this.bindings)a.push(u,f.serialize());return a.push(this.result.serialize()),a}}var lf=pl;class jc{constructor(a,u,f){this.type=a,this.index=u,this.input=f}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,Kt),g=u.parse(a[2],2,As(u.expectedType||ri));return f&&g?new jc(g.type.itemType,f,g):null}evaluate(a){const u=this.index.evaluate(a),f=this.input.evaluate(a);if(u<0)throw new gs(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new gs(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new gs(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Xh=jc;class $h{constructor(a,u){this.type=Kn,this.needle=a,this.haystack=u}static parse(a,u){if(a.length!==3)return u.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,ri),g=u.parse(a[2],2,ri);return f&&g?ql(f.type,[Kn,ni,Kt,qi,ri])?new $h(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${br(f.type)} instead`):null}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(f==null)return!1;if(!sl(u,["boolean","string","number","null"]))throw new gs(`Expected first argument to be of type boolean, string, number or null, but found ${br(wi(u))} instead.`);if(!sl(f,["string","array"]))throw new gs(`Expected second argument to be of type array or string, but found ${br(wi(f))} instead.`);return f.indexOf(u)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var $p=$h;class ml{constructor(a,u,f){this.type=Kt,this.needle=a,this.haystack=u,this.fromIndex=f}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,ri),g=u.parse(a[2],2,ri);if(!f||!g)return null;if(!ql(f.type,[Kn,ni,Kt,qi,ri]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${br(f.type)} instead`);if(a.length===4){const v=u.parse(a[3],3,Kt);return v?new ml(f,g,v):null}return new ml(f,g)}evaluate(a){const u=this.needle.evaluate(a),f=this.haystack.evaluate(a);if(!sl(u,["boolean","string","number","null"]))throw new gs(`Expected first argument to be of type boolean, string, number or null, but found ${br(wi(u))} instead.`);if(!sl(f,["string","array"]))throw new gs(`Expected second argument to be of type array or string, but found ${br(wi(f))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(a);return f.indexOf(u,g)}return f.indexOf(u)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const a=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),a]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Bg=ml;class qc{constructor(a,u,f,g,v,T){this.inputType=a,this.type=u,this.input=f,this.cases=g,this.outputs=v,this.otherwise=T}static parse(a,u){if(a.length<5)return u.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const v={},T=[];for(let O=2;O<a.length-1;O+=2){let W=a[O];const q=a[O+1];Array.isArray(W)||(W=[W]);const $=u.concat(O);if(W.length===0)return $.error("Expected at least one branch label.");for(const ie of W){if(typeof ie!="number"&&typeof ie!="string")return $.error("Branch labels must be numbers or strings.");if(typeof ie=="number"&&Math.abs(ie)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ie=="number"&&Math.floor(ie)!==ie)return $.error("Numeric branch labels must be integer values.");if(f){if($.checkSubtype(f,wi(ie)))return null}else f=wi(ie);if(v[String(ie)]!==void 0)return $.error("Branch labels must be unique.");v[String(ie)]=T.length}const J=u.parse(q,O,g);if(!J)return null;g=g||J.type,T.push(J)}const C=u.parse(a[1],1,ri);if(!C)return null;const k=u.parse(a[a.length-1],a.length-1,g);return k?C.type.kind!=="value"&&u.concat(1).checkSubtype(f,C.type)?null:new qc(f,g,C,v,T,k):null}evaluate(a){const u=this.input.evaluate(a);return(wi(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["match",this.input.serialize()],u=Object.keys(this.cases).sort(),f=[],g={};for(const T of u){const C=g[this.cases[T]];C===void 0?(g[this.cases[T]]=f.length,f.push([this.cases[T],[T]])):f[C][1].push(T)}const v=T=>this.inputType.kind==="number"?Number(T):T;for(const[T,C]of f)a.push(C.length===1?v(C[0]):C.map(v)),a.push(this.outputs[T].serialize());return a.push(this.otherwise.serialize()),a}}var qo=qc;class Ba{constructor(a,u,f){this.type=a,this.branches=u,this.otherwise=f}static parse(a,u){if(a.length<4)return u.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let T=1;T<a.length-1;T+=2){const C=u.parse(a[T],T,Kn);if(!C)return null;const k=u.parse(a[T+1],T+1,f);if(!k)return null;g.push([C,k]),f=f||k.type}const v=u.parse(a[a.length-1],a.length-1,f);return v?new Ba(f,g,v):null}evaluate(a){for(const[u,f]of this.branches)if(u.evaluate(a))return f.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[u,f]of this.branches)a(u),a(f);a(this.otherwise)}outputDefined(){return this.branches.every(([a,u])=>u.outputDefined())&&this.otherwise.outputDefined()}serialize(){const a=["case"];return this.eachChild(u=>{a.push(u.serialize())}),a}}var Zc=Ba;class yo{constructor(a,u,f,g){this.type=a,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(a,u){if(a.length<=2||a.length>=5)return u.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const f=u.parse(a[1],1,ri),g=u.parse(a[2],2,Kt);if(!f||!g)return null;if(!ql(f.type,[As(ri),ni,ri]))return u.error(`Expected first argument to be of type array or string, but found ${br(f.type)} instead`);if(a.length===4){const v=u.parse(a[3],3,Kt);return v?new yo(f.type,f,g,v):null}return new yo(f.type,f,g)}evaluate(a){const u=this.input.evaluate(a),f=this.beginIndex.evaluate(a);if(!sl(u,["string","array"]))throw new gs(`Expected first argument to be of type array or string, but found ${br(wi(u))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(a);return u.slice(f,g)}return u.slice(f)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const a=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),a]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Yp=yo;function Xc(c,a){return c==="=="||c==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function Kp(c,a,u,f){return f.compare(a,u)===0}function gl(c,a,u){const f=c!=="=="&&c!=="!=";return class w6{constructor(v,T,C){this.type=Kn,this.lhs=v,this.rhs=T,this.collator=C,this.hasUntypedArgument=v.type.kind==="value"||T.type.kind==="value"}static parse(v,T){if(v.length!==3&&v.length!==4)return T.error("Expected two or three arguments.");const C=v[0];let k=T.parse(v[1],1,ri);if(!k)return null;if(!Xc(C,k.type))return T.concat(1).error(`"${C}" comparisons are not supported for type '${br(k.type)}'.`);let O=T.parse(v[2],2,ri);if(!O)return null;if(!Xc(C,O.type))return T.concat(2).error(`"${C}" comparisons are not supported for type '${br(O.type)}'.`);if(k.type.kind!==O.type.kind&&k.type.kind!=="value"&&O.type.kind!=="value")return T.error(`Cannot compare types '${br(k.type)}' and '${br(O.type)}'.`);f&&(k.type.kind==="value"&&O.type.kind!=="value"?k=new al(O.type,[k]):k.type.kind!=="value"&&O.type.kind==="value"&&(O=new al(k.type,[O])));let W=null;if(v.length===4){if(k.type.kind!=="string"&&O.type.kind!=="string"&&k.type.kind!=="value"&&O.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(W=T.parse(v[3],3,Hl),!W)return null}return new w6(k,O,W)}evaluate(v){const T=this.lhs.evaluate(v),C=this.rhs.evaluate(v);if(f&&this.hasUntypedArgument){const k=wi(T),O=wi(C);if(k.kind!==O.kind||k.kind!=="string"&&k.kind!=="number")throw new gs(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${k.kind}, ${O.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const k=wi(T),O=wi(C);if(k.kind!=="string"||O.kind!=="string")return a(v,T,C)}return this.collator?u(v,T,C,this.collator.evaluate(v)):a(v,T,C)}eachChild(v){v(this.lhs),v(this.rhs),this.collator&&v(this.collator)}outputDefined(){return!0}serialize(){const v=[c];return this.eachChild(T=>{v.push(T.serialize())}),v}}}const Cr=gl("==",function(c,a,u){return a===u},Kp),Yh=gl("!=",function(c,a,u){return a!==u},function(c,a,u,f){return!Kp(0,a,u,f)}),Kh=gl("<",function(c,a,u){return a<u},function(c,a,u,f){return f.compare(a,u)<0}),Jp=gl(">",function(c,a,u){return a>u},function(c,a,u,f){return f.compare(a,u)>0}),cf=gl("<=",function(c,a,u){return a<=u},function(c,a,u,f){return f.compare(a,u)<=0}),Zo=gl(">=",function(c,a,u){return a>=u},function(c,a,u,f){return f.compare(a,u)>=0});class Ql{constructor(a,u,f,g,v,T){this.type=ni,this.number=a,this.locale=u,this.currency=f,this.unit=g,this.minFractionDigits=v,this.maxFractionDigits=T}static parse(a,u){if(a.length!==3)return u.error("Expected two arguments.");const f=u.parse(a[1],1,Kt);if(!f)return null;const g=a[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let v=null;if(g.locale&&(v=u.parse(g.locale,1,ni),!v))return null;let T=null;if(g.currency&&(T=u.parse(g.currency,1,ni),!T))return null;let C=null;if(g.unit&&(C=u.parse(g.unit,1,ni),!C))return null;let k=null;if(g["min-fraction-digits"]&&(k=u.parse(g["min-fraction-digits"],1,Kt),!k))return null;let O=null;return g["max-fraction-digits"]&&(O=u.parse(g["max-fraction-digits"],1,Kt),!O)?null:new Ql(f,v,T,C,k,O)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(a):void 0,unit:this.unit?this.unit.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.unit&&a(this.unit),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const a={};return this.locale&&(a.locale=this.locale.serialize()),this.currency&&(a.currency=this.currency.serialize()),this.unit&&(a.unit=this.unit.serialize()),this.minFractionDigits&&(a["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(a["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),a]}}class Ir{constructor(a){this.type=Kt,this.input=a}static parse(a,u){if(a.length!==2)return u.error(`Expected 1 argument, but found ${a.length-1} instead.`);const f=u.parse(a[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${br(f.type)} instead.`):new Ir(f):null}evaluate(a){const u=this.input.evaluate(a);if(typeof u=="string"||Array.isArray(u))return u.length;throw new gs(`Expected value to be of type string or array, but found ${br(wi(u))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}serialize(){const a=["length"];return this.eachChild(u=>{a.push(u.serialize())}),a}}const Is={"==":Cr,"!=":Yh,">":Jp,"<":Kh,">=":Zo,"<=":cf,array:al,at:Xh,boolean:al,case:Zc,coalesce:Hc,collator:Nc,format:Dh,image:Po,in:$p,"index-of":Bg,interpolate:jo,"interpolate-hcl":jo,"interpolate-lab":jo,length:Ir,let:lf,literal:Bc,match:qo,number:al,"number-format":Ql,object:al,slice:Yp,step:Hu,string:al,"to-boolean":cl,"to-color":cl,"to-number":cl,"to-string":cl,var:af,within:Ra};function ns(c,[a,u,f,g]){a=a.evaluate(c),u=u.evaluate(c),f=f.evaluate(c);const v=g?g.evaluate(c):1,T=Og(a,u,f,v);if(T)throw new gs(T);return new Sr(a/255*v,u/255*v,f/255*v,v)}function qu(c,a){return c in a}function ec(c,a){const u=a[c];return u===void 0?null:u}function xo(c){return{type:c}}$l.register(Is,{error:[{kind:"error"},[ni],(c,[a])=>{throw new gs(a.evaluate(c))}],typeof:[ni,[ri],(c,[a])=>br(wi(a.evaluate(c)))],"to-rgba":[As(Kt,4),[uo],(c,[a])=>a.evaluate(c).toArray()],rgb:[uo,[Kt,Kt,Kt],ns],rgba:[uo,[Kt,Kt,Kt,Kt],ns],has:{type:Kn,overloads:[[[ni],(c,[a])=>qu(a.evaluate(c),c.properties())],[[ni,Wl],(c,[a,u])=>qu(a.evaluate(c),u.evaluate(c))]]},get:{type:ri,overloads:[[[ni],(c,[a])=>ec(a.evaluate(c),c.properties())],[[ni,Wl],(c,[a,u])=>ec(a.evaluate(c),u.evaluate(c))]]},"feature-state":[ri,[ni],(c,[a])=>ec(a.evaluate(c),c.featureState||{})],properties:[Wl,[],c=>c.properties()],"geometry-type":[ni,[],c=>c.geometryType()],id:[ri,[],c=>c.id()],zoom:[Kt,[],c=>c.globals.zoom],pitch:[Kt,[],c=>c.globals.pitch||0],"distance-from-center":[Kt,[],c=>c.distanceFromCenter()],"heatmap-density":[Kt,[],c=>c.globals.heatmapDensity||0],"line-progress":[Kt,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[Kt,[],c=>c.globals.skyRadialProgress||0],accumulated:[ri,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[Kt,xo(Kt),(c,a)=>{let u=0;for(const f of a)u+=f.evaluate(c);return u}],"*":[Kt,xo(Kt),(c,a)=>{let u=1;for(const f of a)u*=f.evaluate(c);return u}],"-":{type:Kt,overloads:[[[Kt,Kt],(c,[a,u])=>a.evaluate(c)-u.evaluate(c)],[[Kt],(c,[a])=>-a.evaluate(c)]]},"/":[Kt,[Kt,Kt],(c,[a,u])=>a.evaluate(c)/u.evaluate(c)],"%":[Kt,[Kt,Kt],(c,[a,u])=>a.evaluate(c)%u.evaluate(c)],ln2:[Kt,[],()=>Math.LN2],pi:[Kt,[],()=>Math.PI],e:[Kt,[],()=>Math.E],"^":[Kt,[Kt,Kt],(c,[a,u])=>Math.pow(a.evaluate(c),u.evaluate(c))],sqrt:[Kt,[Kt],(c,[a])=>Math.sqrt(a.evaluate(c))],log10:[Kt,[Kt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN10],ln:[Kt,[Kt],(c,[a])=>Math.log(a.evaluate(c))],log2:[Kt,[Kt],(c,[a])=>Math.log(a.evaluate(c))/Math.LN2],sin:[Kt,[Kt],(c,[a])=>Math.sin(a.evaluate(c))],cos:[Kt,[Kt],(c,[a])=>Math.cos(a.evaluate(c))],tan:[Kt,[Kt],(c,[a])=>Math.tan(a.evaluate(c))],asin:[Kt,[Kt],(c,[a])=>Math.asin(a.evaluate(c))],acos:[Kt,[Kt],(c,[a])=>Math.acos(a.evaluate(c))],atan:[Kt,[Kt],(c,[a])=>Math.atan(a.evaluate(c))],min:[Kt,xo(Kt),(c,a)=>Math.min(...a.map(u=>u.evaluate(c)))],max:[Kt,xo(Kt),(c,a)=>Math.max(...a.map(u=>u.evaluate(c)))],abs:[Kt,[Kt],(c,[a])=>Math.abs(a.evaluate(c))],round:[Kt,[Kt],(c,[a])=>{const u=a.evaluate(c);return u<0?-Math.round(-u):Math.round(u)}],floor:[Kt,[Kt],(c,[a])=>Math.floor(a.evaluate(c))],ceil:[Kt,[Kt],(c,[a])=>Math.ceil(a.evaluate(c))],"filter-==":[Kn,[ni,ri],(c,[a,u])=>c.properties()[a.value]===u.value],"filter-id-==":[Kn,[ri],(c,[a])=>c.id()===a.value],"filter-type-==":[Kn,[ni],(c,[a])=>c.geometryType()===a.value],"filter-<":[Kn,[ni,ri],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[Kn,[ri],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u<f}],"filter->":[Kn,[ni,ri],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[Kn,[ri],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u>f}],"filter-<=":[Kn,[ni,ri],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[Kn,[ri],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u<=f}],"filter->=":[Kn,[ni,ri],(c,[a,u])=>{const f=c.properties()[a.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[Kn,[ri],(c,[a])=>{const u=c.id(),f=a.value;return typeof u==typeof f&&u>=f}],"filter-has":[Kn,[ri],(c,[a])=>a.value in c.properties()],"filter-has-id":[Kn,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Kn,[As(ni)],(c,[a])=>a.value.indexOf(c.geometryType())>=0],"filter-id-in":[Kn,[As(ri)],(c,[a])=>a.value.indexOf(c.id())>=0],"filter-in-small":[Kn,[ni,As(ri)],(c,[a,u])=>u.value.indexOf(c.properties()[a.value])>=0],"filter-in-large":[Kn,[ni,As(ri)],(c,[a,u])=>function(f,g,v,T){for(;v<=T;){const C=v+T>>1;if(g[C]===f)return!0;g[C]>f?T=C-1:v=C+1}return!1}(c.properties()[a.value],u.value,0,u.value.length-1)],all:{type:Kn,overloads:[[[Kn,Kn],(c,[a,u])=>a.evaluate(c)&&u.evaluate(c)],[xo(Kn),(c,a)=>{for(const u of a)if(!u.evaluate(c))return!1;return!0}]]},any:{type:Kn,overloads:[[[Kn,Kn],(c,[a,u])=>a.evaluate(c)||u.evaluate(c)],[xo(Kn),(c,a)=>{for(const u of a)if(u.evaluate(c))return!0;return!1}]]},"!":[Kn,[Kn],(c,[a])=>!a.evaluate(c)],"is-supported-script":[Kn,[ni],(c,[a])=>{const u=c.globals&&c.globals.isSupportedScript;return!u||u(a.evaluate(c))}],upcase:[ni,[ni],(c,[a])=>a.evaluate(c).toUpperCase()],downcase:[ni,[ni],(c,[a])=>a.evaluate(c).toLowerCase()],concat:[ni,xo(ri),(c,a)=>a.map(u=>Fc(u.evaluate(c))).join("")],"resolved-locale":[ni,[Hl],(c,[a])=>a.evaluate(c).resolvedLocale()]});var Jh=Is;function Ps(c){return{result:"success",value:c}}function Ys(c){return{result:"error",value:c}}function _l(c){return c["property-type"]==="data-driven"}function yl(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function _a(c){return!!c.expression&&c.expression.interpolated}function oi(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function ya(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function uf(c){return c}function $c(c,a){const u=a.type==="color",f=c.stops&&typeof c.stops[0][0]=="object",g=f||!(f||c.property!==void 0),v=c.type||(_a(a)?"exponential":"interval");if(u&&((c=Es({},c)).stops&&(c.stops=c.stops.map(O=>[O[0],Sr.parse(O[1])])),c.default=Sr.parse(c.default?c.default:a.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Xp[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let T,C,k;if(v==="exponential")T=df;else if(v==="interval")T=Qp;else if(v==="categorical"){T=hf,C=Object.create(null);for(const O of c.stops)C[O[0]]=O[1];k=typeof c.stops[0][0]}else{if(v!=="identity")throw new Error(`Unknown function type "${v}"`);T=ff}if(f){const O={},W=[];for(let J=0;J<c.stops.length;J++){const ie=c.stops[J],ue=ie[0].zoom;O[ue]===void 0&&(O[ue]={zoom:ue,type:c.type,property:c.property,default:c.default,stops:[]},W.push(ue)),O[ue].stops.push([ie[0].value,ie[1]])}const q=[];for(const J of W)q.push([O[J].zoom,$c(O[J],a)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:jo.interpolationFactor.bind(void 0,$),zoomStops:q.map(J=>J[0]),evaluate:({zoom:J},ie)=>df({stops:q,base:c.base},a,J).evaluate(J,ie)}}if(g){const O=v==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:jo.interpolationFactor.bind(void 0,O),zoomStops:c.stops.map(W=>W[0]),evaluate:({zoom:W})=>T(c,a,W,C,k)}}return{kind:"source",evaluate(O,W){const q=W&&W.properties?W.properties[c.property]:void 0;return q===void 0?Yc(c.default,a.default):T(c,a,q,C,k)}}}function Yc(c,a,u){return c!==void 0?c:a!==void 0?a:u!==void 0?u:void 0}function hf(c,a,u,f,g){return Yc(typeof u===g?f[u]:void 0,c.default,a.default)}function Qp(c,a,u){if(oi(u)!=="number")return Yc(c.default,a.default);const f=c.stops.length;if(f===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[f-1][0])return c.stops[f-1][1];const g=Uh(c.stops.map(v=>v[0]),u);return c.stops[g][1]}function df(c,a,u){const f=c.base!==void 0?c.base:1;if(oi(u)!=="number")return Yc(c.default,a.default);const g=c.stops.length;if(g===1||u<=c.stops[0][0])return c.stops[0][1];if(u>=c.stops[g-1][0])return c.stops[g-1][1];const v=Uh(c.stops.map(W=>W[0]),u),T=function(W,q,$,J){const ie=J-$,ue=W-$;return ie===0?0:q===1?ue/ie:(Math.pow(q,ue)-1)/(Math.pow(q,ie)-1)}(u,f,c.stops[v][0],c.stops[v+1][0]),C=c.stops[v][1],k=c.stops[v+1][1];let O=hl[a.type]||uf;if(c.colorSpace&&c.colorSpace!=="rgb"){const W=Xp[c.colorSpace];O=(q,$)=>W.reverse(W.interpolate(W.forward(q),W.forward($),T))}return typeof C.evaluate=="function"?{evaluate(...W){const q=C.evaluate.apply(void 0,W),$=k.evaluate.apply(void 0,W);if(q!==void 0&&$!==void 0)return O(q,$,T)}}:O(C,k,T)}function ff(c,a,u){return a.type==="color"?u=Sr.parse(u):a.type==="formatted"?u=ts.fromString(u.toString()):a.type==="resolvedImage"?u=Io.fromString(u.toString()):oi(u)===a.type||a.type==="enum"&&a.values[u]||(u=void 0),Yc(u,c.default,a.default)}class Qh{constructor(a,u){this.expression=a,this._warningHistory={},this._evaluator=new Fg,this._defaultValue=u?function(f){return f.type==="color"&&(ya(f.default)||Array.isArray(f.default))?new Sr(0,0,0,0):f.type==="color"?Sr.parse(f.default)||null:f.default===void 0?null:f.default}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null}evaluateWithoutErrorHandling(a,u,f,g,v,T,C,k){return this._evaluator.globals=a,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=T,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=k||null,this.expression.evaluate(this._evaluator)}evaluate(a,u,f,g,v,T,C,k){this._evaluator.globals=a,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=v||null,this._evaluator.formattedSection=T||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=k||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new gs(`Expected value to be one of ${Object.keys(this._enumValues).map(W=>JSON.stringify(W)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(O.message)),this._defaultValue}}}function Kc(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in Jh}function Xo(c,a){const u=new za(Jh,[],a?function(g){const v={color:uo,string:ni,number:Kt,enum:ni,boolean:Kn,formatted:Rc,resolvedImage:ms};return g.type==="array"?As(v[g.value]||ri,g.length):v[g.type]}(a):void 0),f=u.parse(c,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return f?Ps(new Qh(f,a)):Ys(u.errors)}class xl{constructor(a,u){this.kind=a,this._styleExpression=u,this.isStateDependent=a!=="constant"&&!Bh(u.expression)}evaluateWithoutErrorHandling(a,u,f,g,v,T){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,v,T)}evaluate(a,u,f,g,v,T){return this._styleExpression.evaluate(a,u,f,g,v,T)}}class Jc{constructor(a,u,f,g){this.kind=a,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=a!=="camera"&&!Bh(u.expression),this.interpolationType=g}evaluateWithoutErrorHandling(a,u,f,g,v,T){return this._styleExpression.evaluateWithoutErrorHandling(a,u,f,g,v,T)}evaluate(a,u,f,g,v,T){return this._styleExpression.evaluate(a,u,f,g,v,T)}interpolationFactor(a,u,f){return this.interpolationType?jo.interpolationFactor(this.interpolationType,a,u,f):0}}function Zu(c,a){if((c=Xo(c,a)).result==="error")return c;const u=c.value.expression,f=ul(u);if(!f&&!_l(a))return Ys([new ci("","data expressions not supported")]);const g=Kl(u,["zoom","pitch","distance-from-center"]);if(!g&&!yl(a))return Ys([new ci("","zoom expressions not supported")]);const v=vl(u);return v||g?v instanceof ci?Ys([v]):v instanceof jo&&!_a(a)?Ys([new ci("",'"interpolate" expressions cannot be used with this property')]):Ps(v?new Jc(f?"camera":"composite",c.value,v.labels,v instanceof jo?v.interpolation:void 0):new xl(f?"constant":"source",c.value)):Ys([new ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class tc{constructor(a,u){this._parameters=a,this._specification=u,Es(this,$c(this._parameters,this._specification))}static deserialize(a){return new tc(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function vl(c){let a=null;if(c instanceof lf)a=vl(c.result);else if(c instanceof Hc){for(const u of c.args)if(a=vl(u),a)break}else(c instanceof Hu||c instanceof jo)&&c.input instanceof $l&&c.input.name==="zoom"&&(a=c);return a instanceof ci||c.eachChild(u=>{const f=vl(u);f instanceof ci?a=f:!a&&f?a=new ci("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&f&&a!==f&&(a=new ci("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}class hn{constructor(a,u,f,g){this.message=(a?`${a}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function ko(c){const a=c.key,u=c.value,f=c.valueSpec||{},g=c.objectElementValidators||{},v=c.style,T=c.styleSpec;let C=[];const k=oi(u);if(k!=="object")return[new hn(a,u,`object expected, ${k} found`)];for(const O in u){const W=O.split(".")[0],q=f[W]||f["*"];let $;g[W]?$=g[W]:f[W]?$=Wi:g["*"]?$=g["*"]:f["*"]&&($=Wi),$?C=C.concat($({key:(a&&`${a}.`)+O,value:u[O],valueSpec:q,style:v,styleSpec:T,object:u,objectKey:O},u)):C.push(new hn(a,u[O],`unknown property "${O}"`))}for(const O in f)g[O]||f[O].required&&f[O].default===void 0&&u[O]===void 0&&C.push(new hn(a,u,`missing required property "${O}"`));return C}function Xu(c){const a=c.value,u=c.valueSpec,f=c.style,g=c.styleSpec,v=c.key,T=c.arrayElementValidator||Wi;if(oi(a)!=="array")return[new hn(v,a,`array expected, ${oi(a)} found`)];if(u.length&&a.length!==u.length)return[new hn(v,a,`array length ${u.length} expected, length ${a.length} found`)];if(u["min-length"]&&a.length<u["min-length"])return[new hn(v,a,`array length at least ${u["min-length"]} expected, length ${a.length} found`)];let C={type:u.value,values:u.values,minimum:u.minimum,maximum:u.maximum,function:void 0};g.$version<7&&(C.function=u.function),oi(u.value)==="object"&&(C=u.value);let k=[];for(let O=0;O<a.length;O++)k=k.concat(T({array:a,arrayIndex:O,value:a[O],valueSpec:C,style:f,styleSpec:g,key:`${v}[${O}]`}));return k}function em(c){const a=c.key,u=c.value,f=c.valueSpec;let g=oi(u);if(g==="number"&&u!=u&&(g="NaN"),g!=="number")return[new hn(a,u,`number expected, ${g} found`)];if("minimum"in f){let v=f.minimum;if(oi(f.minimum)==="array"&&(v=f.minimum[c.arrayIndex]),u<v)return[new hn(a,u,`${u} is less than the minimum value ${v}`)]}if("maximum"in f){let v=f.maximum;if(oi(f.maximum)==="array"&&(v=f.maximum[c.arrayIndex]),u>v)return[new hn(a,u,`${u} is greater than the maximum value ${v}`)]}return[]}function pf(c){const a=c.valueSpec,u=ir(c.value.type);let f,g,v,T={};const C=u!=="categorical"&&c.value.property===void 0,k=!C,O=oi(c.value.stops)==="array"&&oi(c.value.stops[0])==="array"&&oi(c.value.stops[0][0])==="object",W=ko({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(J){if(u==="identity")return[new hn(J.key,J.value,'identity function may not have a "stops" property')];let ie=[];const ue=J.value;return ie=ie.concat(Xu({key:J.key,value:ue,valueSpec:J.valueSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:q})),oi(ue)==="array"&&ue.length===0&&ie.push(new hn(J.key,ue,"array must have at least one stop")),ie},default:function(J){return Wi({key:J.key,value:J.value,valueSpec:a,style:J.style,styleSpec:J.styleSpec})}}});return u==="identity"&&C&&W.push(new hn(c.key,c.value,'missing required property "property"')),u==="identity"||c.value.stops||W.push(new hn(c.key,c.value,'missing required property "stops"')),u==="exponential"&&c.valueSpec.expression&&!_a(c.valueSpec)&&W.push(new hn(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(k&&!_l(c.valueSpec)?W.push(new hn(c.key,c.value,"property functions not supported")):C&&!yl(c.valueSpec)&&W.push(new hn(c.key,c.value,"zoom functions not supported"))),u!=="categorical"&&!O||c.value.property!==void 0||W.push(new hn(c.key,c.value,'"property" property is required')),W;function q(J){let ie=[];const ue=J.value,ge=J.key;if(oi(ue)!=="array")return[new hn(ge,ue,`array expected, ${oi(ue)} found`)];if(ue.length!==2)return[new hn(ge,ue,`array length 2 expected, length ${ue.length} found`)];if(O){if(oi(ue[0])!=="object")return[new hn(ge,ue,`object expected, ${oi(ue[0])} found`)];if(ue[0].zoom===void 0)return[new hn(ge,ue,"object stop key must have zoom")];if(ue[0].value===void 0)return[new hn(ge,ue,"object stop key must have value")];const Re=ir(ue[0].zoom);if(typeof Re!="number")return[new hn(ge,ue[0].zoom,"stop zoom values must be numbers")];if(v&&v>Re)return[new hn(ge,ue[0].zoom,"stop zoom values must appear in ascending order")];Re!==v&&(v=Re,g=void 0,T={}),ie=ie.concat(ko({key:`${ge}[0]`,value:ue[0],valueSpec:{zoom:{}},style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:em,value:$}}))}else ie=ie.concat($({key:`${ge}[0]`,value:ue[0],valueSpec:{},style:J.style,styleSpec:J.styleSpec},ue));return Kc(Ni(ue[1]))?ie.concat([new hn(`${ge}[1]`,ue[1],"expressions are not allowed in function stops.")]):ie.concat(Wi({key:`${ge}[1]`,value:ue[1],valueSpec:a,style:J.style,styleSpec:J.styleSpec}))}function $(J,ie){const ue=oi(J.value),ge=ir(J.value),Re=J.value!==null?J.value:ie;if(f){if(ue!==f)return[new hn(J.key,Re,`${ue} stop domain type must match previous stop domain type ${f}`)]}else f=ue;if(ue!=="number"&&ue!=="string"&&ue!=="boolean"&&typeof ge!="number"&&typeof ge!="string"&&typeof ge!="boolean")return[new hn(J.key,Re,"stop domain value must be a number, string, or boolean")];if(ue!=="number"&&u!=="categorical"){let je=`number expected, ${ue} found`;return _l(a)&&u===void 0&&(je+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hn(J.key,Re,je)]}return u!=="categorical"||ue!=="number"||typeof ge=="number"&&isFinite(ge)&&Math.floor(ge)===ge?u!=="categorical"&&ue==="number"&&typeof ge=="number"&&typeof g=="number"&&g!==void 0&&ge<g?[new hn(J.key,Re,"stop domain values must appear in ascending order")]:(g=ge,u==="categorical"&&ge in T?[new hn(J.key,Re,"stop domain values must be unique")]:(T[ge]=!0,[])):[new hn(J.key,Re,`integer expected, found ${String(ge)}`)]}}function Qc(c){const a=(c.expressionContext==="property"?Zu:Xo)(Ni(c.value),c.valueSpec);if(a.result==="error")return a.value.map(f=>new hn(`${c.key}${f.key}`,c.value,f.message));const u=a.value.expression||a.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!u.outputDefined())return[new hn(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!Bh(u))return[new hn(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return tm(u,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Kl(u,["zoom","feature-state"]))return[new hn(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!ul(u))return[new hn(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function tm(c,a){const u=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(a.valueSpec&&a.valueSpec.expression)for(const g of a.valueSpec.expression.parameters)u.delete(g);if(u.size===0)return[];const f=[];return c instanceof $l&&u.has(c.name)?[new hn(a.key,a.value,`["${c.name}"] expression is not supported in a filter for a ${a.object.type} layer with id: ${a.object.id}`)]:(c.eachChild(g=>{f.push(...tm(g,a))}),f)}function mf(c){const a=c.key,u=c.value,f=c.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(ir(u))===-1&&g.push(new hn(a,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(ir(u))===-1&&g.push(new hn(a,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function eu(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const a of c.slice(1))if(!eu(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}function tu(c,a="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};eu(c)||(c=Yu(c));const u=c;let f=!0;try{f=function(O){if(!nu(O))return O;let W=Ni(O);return $u(W),W=vo(W),W}(u)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(u,null,2)}
        `)}const g=wt[`filter_${a}`],v=Xo(f,g);let T=null;if(v.result==="error")throw new Error(v.value.map(O=>`${O.key}: ${O.message}`).join(", "));T=(O,W,q)=>v.value.evaluate(O,W,{},q);let C=null,k=null;if(f!==u){const O=Xo(u,g);if(O.result==="error")throw new Error(O.value.map(W=>`${W.key}: ${W.message}`).join(", "));C=(W,q,$,J,ie)=>O.value.evaluate(W,q,{},$,void 0,void 0,J,ie),k=!ul(O.value.expression)}return{filter:T,dynamicFilter:C||void 0,needGeometry:ed(f),needFeature:!!k}}function vo(c){if(!Array.isArray(c))return c;const a=function(u){if(Ng.has(u[0])){for(let f=1;f<u.length;f++)if(nu(u[f]))return!0}return u}(c);return a===!0?a:a.map(u=>vo(u))}function $u(c){let a=!1;const u=[];if(c[0]==="case"){for(let f=1;f<c.length-1;f+=2)a=a||nu(c[f]),u.push(c[f+1]);u.push(c[c.length-1])}else if(c[0]==="match"){a=a||nu(c[1]);for(let f=2;f<c.length-1;f+=2)u.push(c[f+1]);u.push(c[c.length-1])}else if(c[0]==="step"){a=a||nu(c[1]);for(let f=1;f<c.length-1;f+=2)u.push(c[f+1])}a&&(c.length=0,c.push("any",...u));for(let f=1;f<c.length;f++)$u(c[f])}function nu(c){if(!Array.isArray(c))return!1;if((a=c[0])==="pitch"||a==="distance-from-center")return!0;var a;for(let u=1;u<c.length;u++)if(nu(c[u]))return!0;return!1}const Ng=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ug(c,a){return c<a?-1:c>a?1:0}function ed(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let a=1;a<c.length;a++)if(ed(c[a]))return!0;return!1}function Yu(c){if(!c)return!0;const a=c[0];return c.length<=1?a!=="any":a==="=="?nm(c[1],c[2],"=="):a==="!="?Ku(nm(c[1],c[2],"==")):a==="<"||a===">"||a==="<="||a===">="?nm(c[1],c[2],a):a==="any"?(u=c.slice(1),["any"].concat(u.map(Yu))):a==="all"?["all"].concat(c.slice(1).map(Yu)):a==="none"?["all"].concat(c.slice(1).map(Yu).map(Ku)):a==="in"?gf(c[1],c.slice(2)):a==="!in"?Ku(gf(c[1],c.slice(2))):a==="has"?_f(c[1]):a==="!has"?Ku(_f(c[1])):a!=="within"||c;var u}function nm(c,a,u){switch(c){case"$type":return[`filter-type-${u}`,a];case"$id":return[`filter-id-${u}`,a];default:return[`filter-${u}`,c,a]}}function gf(c,a){if(a.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(u=>typeof u!=typeof a[0])?["filter-in-large",c,["literal",a.sort(Ug)]]:["filter-in-small",c,["literal",a]]}}function _f(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Ku(c){return["!",c]}function td(c){return eu(Ni(c.value))?Qc(Es({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):im(c)}function im(c){const a=c.value,u=c.key;if(oi(a)!=="array")return[new hn(u,a,`array expected, ${oi(a)} found`)];const f=c.styleSpec;let g,v=[];if(a.length<1)return[new hn(u,a,"filter array must have at least 1 element")];switch(v=v.concat(mf({key:`${u}[0]`,value:a[0],valueSpec:f.filter_operator,style:c.style,styleSpec:c.styleSpec})),ir(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&ir(a[1])==="$type"&&v.push(new hn(u,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&v.push(new hn(u,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(g=oi(a[1]),g!=="string"&&v.push(new hn(`${u}[1]`,a[1],`string expected, ${g} found`)));for(let T=2;T<a.length;T++)g=oi(a[T]),ir(a[1])==="$type"?v=v.concat(mf({key:`${u}[${T}]`,value:a[T],valueSpec:f.geometry_type,style:c.style,styleSpec:c.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&v.push(new hn(`${u}[${T}]`,a[T],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let T=1;T<a.length;T++)v=v.concat(im({key:`${u}[${T}]`,value:a[T],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":g=oi(a[1]),a.length!==2?v.push(new hn(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="string"&&v.push(new hn(`${u}[1]`,a[1],`string expected, ${g} found`));break;case"within":g=oi(a[1]),a.length!==2?v.push(new hn(u,a,`filter array for "${a[0]}" operator must have 2 elements`)):g!=="object"&&v.push(new hn(`${u}[1]`,a[1],`object expected, ${g} found`))}return v}function yf(c,a){const u=c.key,f=c.style,g=c.styleSpec,v=c.value,T=c.objectKey,C=g[`${a}_${c.layerType}`];if(!C)return[];const k=T.match(/^(.*)-transition$/);if(a==="paint"&&k&&C[k[1]]&&C[k[1]].transition)return Wi({key:u,value:v,valueSpec:g.transition,style:f,styleSpec:g});const O=c.valueSpec||C[T];if(!O)return[new hn(u,v,`unknown property "${T}"`)];let W;if(oi(v)==="string"&&_l(O)&&!O.tokens&&(W=/^{([^}]+)}$/.exec(v)))return[new hn(u,v,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(W[1])} }\`.`)];const q=[];return c.layerType==="symbol"&&(T==="text-field"&&f&&!f.glyphs&&q.push(new hn(u,v,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&ya(Ni(v))&&ir(v.type)==="identity"&&q.push(new hn(u,v,'"text-font" does not support identity functions'))),q.concat(Wi({key:c.key,value:v,valueSpec:O,style:f,styleSpec:g,expressionContext:"property",propertyType:a,propertyKey:T}))}function xf(c){return yf(c,"paint")}function rm(c){return yf(c,"layout")}function nd(c){let a=[];const u=c.value,f=c.key,g=c.style,v=c.styleSpec;u.type||u.ref||a.push(new hn(f,u,'either "type" or "ref" is required'));let T=ir(u.type);const C=ir(u.ref);if(u.id){const k=ir(u.id);for(let O=0;O<c.arrayIndex;O++){const W=g.layers[O];ir(W.id)===k&&a.push(new hn(f,u.id,`duplicate layer id "${u.id}", previously used at line ${W.id.__line__}`))}}if("ref"in u){let k;["type","source","source-layer","filter","layout"].forEach(O=>{O in u&&a.push(new hn(f,u[O],`"${O}" is prohibited for ref layers`))}),g.layers.forEach(O=>{ir(O.id)===C&&(k=O)}),k?k.ref?a.push(new hn(f,u.ref,"ref cannot reference another ref layer")):T=ir(k.type):typeof C=="string"&&a.push(new hn(f,u.ref,`ref layer "${C}" not found`))}else if(T!=="background"&&T!=="sky")if(u.source){const k=g.sources&&g.sources[u.source],O=k&&ir(k.type);k?O==="vector"&&T==="raster"?a.push(new hn(f,u.source,`layer "${u.id}" requires a raster source`)):O==="raster"&&T!=="raster"?a.push(new hn(f,u.source,`layer "${u.id}" requires a vector source`)):O!=="vector"||u["source-layer"]?O==="raster-dem"&&T!=="hillshade"?a.push(new hn(f,u.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!u.paint||!u.paint["line-gradient"]&&!u.paint["line-trim-offset"]||O==="geojson"&&k.lineMetrics||a.push(new hn(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new hn(f,u,`layer "${u.id}" must specify a "source-layer"`)):a.push(new hn(f,u.source,`source "${u.source}" not found`))}else a.push(new hn(f,u,'missing required property "source"'));return a=a.concat(ko({key:f,value:u,valueSpec:v.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Wi({key:`${f}.type`,value:u.type,valueSpec:v.layer.type,style:c.style,styleSpec:c.styleSpec,object:u,objectKey:"type"}),filter:k=>td(Es({layerType:T},k)),layout:k=>ko({layer:u,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":O=>rm(Es({layerType:T},O))}}),paint:k=>ko({layer:u,key:k.key,value:k.value,valueSpec:{},style:k.style,styleSpec:k.styleSpec,objectElementValidators:{"*":O=>xf(Es({layerType:T},O))}})}})),a}function _s(c){const a=c.value,u=c.key,f=oi(a);return f!=="string"?[new hn(u,a,`string expected, ${f} found`)]:[]}const vf={promoteId:function({key:c,value:a}){if(oi(a)==="string")return _s({key:c,value:a});{const u=[];for(const f in a)u.push(..._s({key:`${c}.${f}`,value:a[f]}));return u}}};function Ju(c){const a=c.value,u=c.key,f=c.styleSpec,g=c.style;if(!a.type)return[new hn(u,a,'"type" is required')];const v=ir(a.type);let T;switch(v){case"vector":case"raster":case"raster-dem":return T=ko({key:u,value:a,valueSpec:f[`source_${v.replace("-","_")}`],style:c.style,styleSpec:f,objectElementValidators:vf}),T;case"geojson":if(T=ko({key:u,value:a,valueSpec:f.source_geojson,style:g,styleSpec:f,objectElementValidators:vf}),a.cluster)for(const C in a.clusterProperties){const[k,O]=a.clusterProperties[C],W=typeof k=="string"?[k,["accumulated"],["get",C]]:k;T.push(...Qc({key:`${u}.${C}.map`,value:O,expressionContext:"cluster-map"})),T.push(...Qc({key:`${u}.${C}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return T;case"video":return ko({key:u,value:a,valueSpec:f.source_video,style:g,styleSpec:f});case"image":return ko({key:u,value:a,valueSpec:f.source_image,style:g,styleSpec:f});case"canvas":return[new hn(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return mf({key:`${u}.type`,value:a.type,valueSpec:{values:Qu(f)},style:g,styleSpec:f})}}function Qu(c){return c.source.reduce((a,u)=>{const f=c[u];return f.type.type==="enum"&&(a=a.concat(Object.keys(f.type.values))),a},[])}function id(c){const a=c.value,u=c.styleSpec,f=u.light,g=c.style;let v=[];const T=oi(a);if(a===void 0)return v;if(T!=="object")return v=v.concat([new hn("light",a,`object expected, ${T} found`)]),v;for(const C in a){const k=C.match(/^(.*)-transition$/);v=v.concat(k&&f[k[1]]&&f[k[1]].transition?Wi({key:C,value:a[C],valueSpec:u.transition,style:g,styleSpec:u}):f[C]?Wi({key:C,value:a[C],valueSpec:f[C],style:g,styleSpec:u}):[new hn(C,a[C],`unknown property "${C}"`)])}return v}function iu(c){const a=c.value,u=c.key,f=c.style,g=c.styleSpec,v=g.terrain;let T=[];const C=oi(a);if(a===void 0)return T;if(C!=="object")return T=T.concat([new hn("terrain",a,`object expected, ${C} found`)]),T;for(const k in a){const O=k.match(/^(.*)-transition$/);T=T.concat(O&&v[O[1]]&&v[O[1]].transition?Wi({key:k,value:a[k],valueSpec:g.transition,style:f,styleSpec:g}):v[k]?Wi({key:k,value:a[k],valueSpec:v[k],style:f,styleSpec:g}):[new hn(k,a[k],`unknown property "${k}"`)])}if(a.source){const k=f.sources&&f.sources[a.source],O=k&&ir(k.type);k?O!=="raster-dem"&&T.push(new hn(u,a.source,`terrain cannot be used with a source of type ${String(O)}, it only be used with a "raster-dem" source type`)):T.push(new hn(u,a.source,`source "${a.source}" not found`))}else T.push(new hn(u,a,'terrain is missing required property "source"'));return T}function sm(c){const a=c.value,u=c.style,f=c.styleSpec,g=f.fog;let v=[];const T=oi(a);if(a===void 0)return v;if(T!=="object")return v=v.concat([new hn("fog",a,`object expected, ${T} found`)]),v;for(const C in a){const k=C.match(/^(.*)-transition$/);v=v.concat(k&&g[k[1]]&&g[k[1]].transition?Wi({key:C,value:a[C],valueSpec:f.transition,style:u,styleSpec:f}):g[C]?Wi({key:C,value:a[C],valueSpec:g[C],style:u,styleSpec:f}):[new hn(C,a[C],`unknown property "${C}"`)])}return v}const eh={"*":()=>[],array:Xu,boolean:function(c){const a=c.value,u=c.key,f=oi(a);return f!=="boolean"?[new hn(u,a,`boolean expected, ${f} found`)]:[]},number:em,color:function(c){const a=c.key,u=c.value,f=oi(u);return f!=="string"?[new hn(a,u,`color expected, ${f} found`)]:Zl(u)===null?[new hn(a,u,`color expected, "${u}" found`)]:[]},enum:mf,filter:td,function:pf,layer:nd,object:ko,source:Ju,light:id,terrain:iu,fog:sm,string:_s,formatted:function(c){return _s(c).length===0?[]:Qc(c)},resolvedImage:function(c){return _s(c).length===0?[]:Qc(c)},projection:function(c){const a=c.value,u=c.styleSpec,f=u.projection,g=c.style;let v=[];const T=oi(a);if(T==="object")for(const C in a)v=v.concat(Wi({key:C,value:a[C],valueSpec:f[C],style:g,styleSpec:u}));else T!=="string"&&(v=v.concat([new hn("projection",a,`object or string expected, ${T} found`)]));return v}};function Wi(c){const a=c.value,u=c.valueSpec,f=c.styleSpec;return u.expression&&ya(ir(a))?pf(c):u.expression&&Kc(Ni(a))?Qc(c):u.type&&eh[u.type]?eh[u.type](c):ko(Es({},c,{valueSpec:u.type?f[u.type]:u}))}function l0(c){const a=c.value,u=c.key,f=_s(c);return f.length||(a.indexOf("{fontstack}")===-1&&f.push(new hn(u,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&f.push(new hn(u,a,'"glyphs" url must include a "{range}" token'))),f}function om(c,a=wt){return Na(Wi({key:"",value:c,valueSpec:a.$root,styleSpec:a,style:c,objectElementValidators:{glyphs:l0,"*":()=>[]}}))}const Do=c=>Na(xf(c)),Ks=c=>Na(rm(c));function Na(c){return c.slice().sort((a,u)=>a.line&&u.line?a.line-u.line:0)}function am(c,a){let u=!1;if(a&&a.length)for(const f of a)c.fire(new nr(new Error(f.message))),u=!0;return u}var ru=xa;function xa(c,a,u){var f=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var g=new Int32Array(this.arrayBuffer);c=g[0],this.d=(a=g[1])+2*(u=g[2]);for(var v=0;v<this.d*this.d;v++){var T=g[3+v],C=g[3+v+1];f.push(T===C?null:g.subarray(T,C))}var k=g[3+f.length+1];this.keys=g.subarray(g[3+f.length],k),this.bboxes=g.subarray(k),this.insert=this._insertReadonly}else{this.d=a+2*u;for(var O=0;O<this.d*this.d;O++)f.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=c,this.padding=u,this.scale=a/c,this.uid=0;var W=u/a*c;this.min=-W,this.max=c+W}xa.prototype.insert=function(c,a,u,f,g){this._forEachCell(a,u,f,g,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g)},xa.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},xa.prototype._insertCell=function(c,a,u,f,g,v){this.cells[g].push(v)},xa.prototype.query=function(c,a,u,f,g){var v=this.min,T=this.max;if(c<=v&&a<=v&&T<=u&&T<=f&&!g)return Array.prototype.slice.call(this.keys);var C=[];return this._forEachCell(c,a,u,f,this._queryCell,C,{},g),C},xa.prototype._queryCell=function(c,a,u,f,g,v,T,C){var k=this.cells[g];if(k!==null)for(var O=this.keys,W=this.bboxes,q=0;q<k.length;q++){var $=k[q];if(T[$]===void 0){var J=4*$;(C?C(W[J+0],W[J+1],W[J+2],W[J+3]):c<=W[J+2]&&a<=W[J+3]&&u>=W[J+0]&&f>=W[J+1])?(T[$]=!0,v.push(O[$])):T[$]=!1}}},xa.prototype._forEachCell=function(c,a,u,f,g,v,T,C){for(var k=this._convertToCellCoord(c),O=this._convertToCellCoord(a),W=this._convertToCellCoord(u),q=this._convertToCellCoord(f),$=k;$<=W;$++)for(var J=O;J<=q;J++){var ie=this.d*J+$;if((!C||C(this._convertFromCellCoord($),this._convertFromCellCoord(J),this._convertFromCellCoord($+1),this._convertFromCellCoord(J+1)))&&g.call(this,c,a,u,f,ie,v,T,C))return}},xa.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},xa.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},xa.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,a=3+this.cells.length+1+1,u=0,f=0;f<this.cells.length;f++)u+=this.cells[f].length;var g=new Int32Array(a+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var v=a,T=0;T<c.length;T++){var C=c[T];g[3+T]=v,g.set(C,v),v+=C.length}return g[3+c.length]=v,g.set(this.keys,v),g[3+c.length+1]=v+=this.keys.length,g.set(this.bboxes,v),v+=this.bboxes.length,g.buffer};const rd={};function dn(c,a,u={}){Object.defineProperty(c,"_classRegistryKey",{value:a,writeable:!1}),rd[a]={klass:c,omit:u.omit||[]}}dn(Object,"Object"),ru.serialize=function(c,a){const u=c.toArrayBuffer();return a&&a.push(u),{buffer:u}},ru.deserialize=function(c){return new ru(c.buffer)},Object.defineProperty(ru,"name",{value:"Grid"}),dn(ru,"Grid"),dn(Sr,"Color"),dn(Error,"Error"),dn(Un,"AJAXError"),dn(Io,"ResolvedImage"),dn(tc,"StylePropertyFunction"),dn(Qh,"StyleExpression",{omit:["_evaluator"]}),dn(Jc,"ZoomDependentExpression"),dn(xl,"ZoomConstantExpression"),dn($l,"CompoundExpression",{omit:["_evaluate"]});for(const c in Jh)rd[Jh[c]._classRegistryKey]||dn(Jh[c],`Expression${c}`);function lm(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function wf(c){return d.ImageBitmap&&c instanceof d.ImageBitmap}function wl(c,a){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(lm(c)||wf(c))return a&&a.push(c),c;if(ArrayBuffer.isView(c)){const u=c;return a&&a.push(u.buffer),u}if(c instanceof d.ImageData)return a&&a.push(c.data.buffer),c;if(Array.isArray(c)){const u=[];for(const f of c)u.push(wl(f,a));return u}if(typeof c=="object"){const u=c.constructor,f=u._classRegistryKey;if(!f)throw new Error(`can't serialize object of unregistered class ${f}`);const g=u.serialize?u.serialize(c,a):{};if(!u.serialize){for(const v in c)c.hasOwnProperty(v)&&(rd[f].omit.indexOf(v)>=0||(g[v]=wl(c[v],a)));c instanceof Error&&(g.message=c.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return f!=="Object"&&(g.$name=f),g}throw new Error("can't serialize object of type "+typeof c)}function th(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||lm(c)||wf(c)||ArrayBuffer.isView(c)||c instanceof d.ImageData)return c;if(Array.isArray(c))return c.map(th);if(typeof c=="object"){const a=c.$name||"Object",{klass:u}=rd[a];if(!u)throw new Error(`can't deserialize unregistered class ${a}`);if(u.deserialize)return u.deserialize(c);const f=Object.create(u.prototype);for(const g of Object.keys(c))g!=="$name"&&(f[g]=th(c[g]));return f}throw new Error("can't deserialize object of type "+typeof c)}const nh=c=>c>=1536&&c<=1791,sd=c=>c>=1872&&c<=1919,bf=c=>c>=2208&&c<=2303,od=c=>c>=11904&&c<=12031,Sf=c=>c>=12032&&c<=12255,Mf=c=>c>=12272&&c<=12287,bl=c=>c>=12288&&c<=12351,ih=c=>c>=12352&&c<=12447,rh=c=>c>=12448&&c<=12543,cm=c=>c>=12544&&c<=12591,va=c=>c>=12704&&c<=12735,Vg=c=>c>=12736&&c<=12783,Gg=c=>c>=12784&&c<=12799,ad=c=>c>=12800&&c<=13055,nc=c=>c>=13056&&c<=13311,Wg=c=>c>=13312&&c<=19903,xn=c=>c>=19968&&c<=40959,ld=c=>c>=40960&&c<=42127,Tf=c=>c>=42128&&c<=42191,Ef=c=>c>=44032&&c<=55215,cd=c=>c>=63744&&c<=64255,y=c=>c>=64336&&c<=65023,h=c=>c>=65040&&c<=65055,m=c=>c>=65072&&c<=65103,b=c=>c>=65104&&c<=65135,E=c=>c>=65136&&c<=65279,I=c=>c>=65280&&c<=65519;function B(c){for(const a of c)if(K(a.charCodeAt(0)))return!0;return!1}function U(c){for(const a of c)if(!H(a.charCodeAt(0)))return!1;return!0}function H(c){return!(nh(c)||sd(c)||bf(c)||y(c)||E(c))}function K(c){return!(c!==746&&c!==747&&(c<4352||!(va(c)||cm(c)||m(c)&&!(c>=65097&&c<=65103)||cd(c)||nc(c)||od(c)||Vg(c)||!(!bl(c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||Wg(c)||xn(c)||ad(c)||(a=>a>=12592&&a<=12687)(c)||(a=>a>=43360&&a<=43391)(c)||(a=>a>=55216&&a<=55295)(c)||(a=>a>=4352&&a<=4607)(c)||Ef(c)||ih(c)||Mf(c)||(a=>a>=12688&&a<=12703)(c)||Sf(c)||Gg(c)||rh(c)&&c!==12540||!(!I(c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!b(c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||(a=>a>=5120&&a<=5759)(c)||(a=>a>=6320&&a<=6399)(c)||h(c)||(a=>a>=19904&&a<=19967)(c)||ld(c)||Tf(c))))}function Y(c){return!(K(c)||function(a){return!!((u=>u>=128&&u<=255)(a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||(u=>u>=8192&&u<=8303)(a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||(u=>u>=8448&&u<=8527)(a)||(u=>u>=8528&&u<=8591)(a)||(u=>u>=8960&&u<=9215)(a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||(u=>u>=9216&&u<=9279)(a)&&a!==9251||(u=>u>=9280&&u<=9311)(a)||(u=>u>=9312&&u<=9471)(a)||(u=>u>=9632&&u<=9727)(a)||(u=>u>=9728&&u<=9983)(a)&&!(a>=9754&&a<=9759)||(u=>u>=11008&&u<=11263)(a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||bl(a)||rh(a)||(u=>u>=57344&&u<=63743)(a)||m(a)||b(a)||I(a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(c))}function oe(c){return c>=1424&&c<=2303||y(c)||E(c)}function me(c,a){return!(!a&&oe(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||(u=>u>=6016&&u<=6143)(c))}function be(c){for(const a of c)if(oe(a.charCodeAt(0)))return!0;return!1}const we="deferred",Me="loading",_e="loaded";let xe=null,Le="unavailable",Ce=null;const Ue=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(Le="error"),xe&&xe(c)};function Xe(){Ze.fire(new ps("pluginStateChange",{pluginStatus:Le,pluginURL:Ce}))}const Ze=new Br,tt=function(){return Le},ft=function(){if(Le!==we||!Ce)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Le=Me,Xe(),Ce&&Zt({url:Ce},c=>{c?Ue(c):(Le=_e,Xe())})},lt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Le===_e||lt.applyArabicShaping!=null,isLoading:()=>Le===Me,setState(c){Le=c.pluginStatus,Ce=c.pluginURL},isParsed:()=>lt.applyArabicShaping!=null&&lt.processBidirectionalText!=null&&lt.processStyledBidirectionalText!=null,getPluginURL:()=>Ce};class it{constructor(a,u){this.zoom=a,u?(this.now=u.now,this.fadeDuration=u.fadeDuration,this.transition=u.transition,this.pitch=u.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(a){return function(u,f){for(const g of u)if(!me(g.charCodeAt(0),f))return!1;return!0}(a,lt.isLoaded())}}class Wt{constructor(a,u){this.property=a,this.value=u,this.expression=function(f,g){if(ya(f))return new tc(f,g);if(Kc(f)){const v=Zu(f,g);if(v.result==="error")throw new Error(v.value.map(T=>`${T.key}: ${T.message}`).join(", "));return v.value}{let v=f;return typeof f=="string"&&g.type==="color"&&(v=Sr.parse(f)),{kind:"constant",evaluate:()=>v}}}(u===void 0?a.specification.default:u,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,u,f){return this.property.possiblyEvaluate(this,a,u,f)}}class ot{constructor(a){this.property=a,this.value=new Wt(a,void 0)}transitioned(a,u){return new mt(this.property,this.value,u,Pe({},a.transition,this.transition),a.now)}untransitioned(){return new mt(this.property,this.value,null,{},0)}}class bt{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return _n(this._values[a].value.value)}setValue(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new ot(this._values[a].property)),this._values[a].value=new Wt(this._values[a].property,u===null?void 0:_n(u))}getTransition(a){return _n(this._values[a].transition)}setTransition(a,u){this._values.hasOwnProperty(a)||(this._values[a]=new ot(this._values[a].property)),this._values[a].transition=_n(u)||void 0}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f);const g=this.getTransition(u);g!==void 0&&(a[`${u}-transition`]=g)}return a}transitioned(a,u){const f=new Ut(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(a,u._values[g]);return f}untransitioned(){const a=new Ut(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].untransitioned();return a}}class mt{constructor(a,u,f,g,v){const T=g.delay||0,C=g.duration||0;v=v||0,this.property=a,this.value=u,this.begin=v+T,this.end=this.begin+C,a.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(a,u,f){const g=a.now||0,v=this.value.possiblyEvaluate(a,u,f),T=this.prior;if(T){if(g>this.end)return this.prior=null,v;if(this.value.isDataDriven())return this.prior=null,v;if(g<this.begin)return T.possiblyEvaluate(a,u,f);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(a,u,f),v,He(C))}}return v}}class Ut{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,u,f){const g=new kt(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(a,u,f);return g}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class gt{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return _n(this._values[a].value)}setValue(a,u){this._values[a]=new Wt(this._values[a].property,u===null?void 0:_n(u))}serialize(){const a={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(a[u]=f)}return a}possiblyEvaluate(a,u,f){const g=new kt(this._properties);for(const v of Object.keys(this._values))g._values[v]=this._values[v].possiblyEvaluate(a,u,f);return g}}class Lt{constructor(a,u,f){this.property=a,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,u,f,g){return this.property.evaluate(this.value,this.parameters,a,u,f,g)}}class kt{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Ye{constructor(a){this.specification=a}possiblyEvaluate(a,u){return a.expression.evaluate(u)}interpolate(a,u,f){const g=hl[this.specification.type];return g?g(a,u,f):a}}class at{constructor(a,u){this.specification=a,this.overrides=u}possiblyEvaluate(a,u,f,g){return new Lt(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(u,null,{},f,g)}:a.expression,u)}interpolate(a,u,f){if(a.value.kind!=="constant"||u.value.kind!=="constant")return a;if(a.value.value===void 0||u.value.value===void 0)return new Lt(this,{kind:"constant",value:void 0},a.parameters);const g=hl[this.specification.type];return g?new Lt(this,{kind:"constant",value:g(a.value.value,u.value.value,f)},a.parameters):a}evaluate(a,u,f,g,v,T){return a.kind==="constant"?a.value:a.evaluate(u,f,g,v,T)}}class Qt{constructor(a){this.specification=a}possiblyEvaluate(a,u,f,g){return!!a.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class mn{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const u=new it(0,{});for(const f in a){const g=a[f];g.specification.overridable&&this.overridableProperties.push(f);const v=this.defaultPropertyValues[f]=new Wt(g,void 0),T=this.defaultTransitionablePropertyValues[f]=new ot(g);this.defaultTransitioningPropertyValues[f]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=v.possiblyEvaluate(u)}}}function cn(c,a){return 256*(c=fe(Math.floor(c),0,255))+fe(Math.floor(a),0,255)}dn(at,"DataDrivenProperty"),dn(Ye,"DataConstantProperty"),dn(Qt,"ColorRampProperty");const Fn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class zn{constructor(a,u){this._structArray=a,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class In{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,u){return a._trim(),u&&(a.isTransferred=!0,u.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const u=Object.create(this.prototype);return u.arrayBuffer=a.arrayBuffer,u.length=a.length,u.capacity=a.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function an(c,a=1){let u=0,f=0;return{members:c.map(g=>{const v=Fn[g.type].BYTES_PER_ELEMENT,T=u=Li(u,Math.max(a,v)),C=g.components||1;return f=Math.max(f,v),u+=v*C,{name:g.name,type:g.type,components:C,offset:T}}),size:Li(u,Math.max(f,a)),alignment:a}}function Li(c,a){return Math.ceil(c/a)*a}class bi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.int16[g+0]=u,this.int16[g+1]=f,a}}bi.prototype.bytesPerElement=4,dn(bi,"StructArrayLayout2i4");class ki extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const v=3*a;return this.int16[v+0]=u,this.int16[v+1]=f,this.int16[v+2]=g,a}}ki.prototype.bytesPerElement=6,dn(ki,"StructArrayLayout3i6");class si extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,f,g)}emplace(a,u,f,g,v){const T=4*a;return this.int16[T+0]=u,this.int16[T+1]=f,this.int16[T+2]=g,this.int16[T+3]=v,a}}si.prototype.bytesPerElement=8,dn(si,"StructArrayLayout4i8");class Us extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T,C){const k=this.length;return this.resize(k+1),this.emplace(k,a,u,f,g,v,T,C)}emplace(a,u,f,g,v,T,C,k){const O=6*a,W=12*a,q=3*a;return this.int16[O+0]=u,this.int16[O+1]=f,this.uint8[W+4]=g,this.uint8[W+5]=v,this.uint8[W+6]=T,this.uint8[W+7]=C,this.float32[q+2]=k,a}}Us.prototype.bytesPerElement=12,dn(Us,"StructArrayLayout2i4ub1f12");class Js extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,f,g)}emplace(a,u,f,g,v){const T=4*a;return this.float32[T+0]=u,this.float32[T+1]=f,this.float32[T+2]=g,this.float32[T+3]=v,a}}Js.prototype.bytesPerElement=16,dn(Js,"StructArrayLayout4f16");class Xr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v){const T=this.length;return this.resize(T+1),this.emplace(T,a,u,f,g,v)}emplace(a,u,f,g,v,T){const C=6*a,k=3*a;return this.uint16[C+0]=u,this.uint16[C+1]=f,this.uint16[C+2]=g,this.uint16[C+3]=v,this.float32[k+2]=T,a}}Xr.prototype.bytesPerElement=12,dn(Xr,"StructArrayLayout4ui1f12");class Ro extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,f,g)}emplace(a,u,f,g,v){const T=4*a;return this.uint16[T+0]=u,this.uint16[T+1]=f,this.uint16[T+2]=g,this.uint16[T+3]=v,a}}Ro.prototype.bytesPerElement=8,dn(Ro,"StructArrayLayout4ui8");class Zi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T){const C=this.length;return this.resize(C+1),this.emplace(C,a,u,f,g,v,T)}emplace(a,u,f,g,v,T,C){const k=6*a;return this.int16[k+0]=u,this.int16[k+1]=f,this.int16[k+2]=g,this.int16[k+3]=v,this.int16[k+4]=T,this.int16[k+5]=C,a}}Zi.prototype.bytesPerElement=12,dn(Zi,"StructArrayLayout6i12");class Si extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T,C,k,O,W,q,$){const J=this.length;return this.resize(J+1),this.emplace(J,a,u,f,g,v,T,C,k,O,W,q,$)}emplace(a,u,f,g,v,T,C,k,O,W,q,$,J){const ie=12*a;return this.int16[ie+0]=u,this.int16[ie+1]=f,this.int16[ie+2]=g,this.int16[ie+3]=v,this.uint16[ie+4]=T,this.uint16[ie+5]=C,this.uint16[ie+6]=k,this.uint16[ie+7]=O,this.int16[ie+8]=W,this.int16[ie+9]=q,this.int16[ie+10]=$,this.int16[ie+11]=J,a}}Si.prototype.bytesPerElement=24,dn(Si,"StructArrayLayout4i4ui4i24");class xi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T){const C=this.length;return this.resize(C+1),this.emplace(C,a,u,f,g,v,T)}emplace(a,u,f,g,v,T,C){const k=10*a,O=5*a;return this.int16[k+0]=u,this.int16[k+1]=f,this.int16[k+2]=g,this.float32[O+2]=v,this.float32[O+3]=T,this.float32[O+4]=C,a}}xi.prototype.bytesPerElement=20,dn(xi,"StructArrayLayout3i3f20");class rr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint32[1*a+0]=u,a}}rr.prototype.bytesPerElement=4,dn(rr,"StructArrayLayout1ul4");class is extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T,C,k,O,W,q,$,J){const ie=this.length;return this.resize(ie+1),this.emplace(ie,a,u,f,g,v,T,C,k,O,W,q,$,J)}emplace(a,u,f,g,v,T,C,k,O,W,q,$,J,ie){const ue=20*a,ge=10*a;return this.int16[ue+0]=u,this.int16[ue+1]=f,this.int16[ue+2]=g,this.int16[ue+3]=v,this.int16[ue+4]=T,this.float32[ge+3]=C,this.float32[ge+4]=k,this.float32[ge+5]=O,this.float32[ge+6]=W,this.int16[ue+14]=q,this.uint32[ge+8]=$,this.uint16[ue+18]=J,this.uint16[ue+19]=ie,a}}is.prototype.bytesPerElement=40,dn(is,"StructArrayLayout5i4f1i1ul2ui40");class Oi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T,C){const k=this.length;return this.resize(k+1),this.emplace(k,a,u,f,g,v,T,C)}emplace(a,u,f,g,v,T,C,k){const O=8*a;return this.int16[O+0]=u,this.int16[O+1]=f,this.int16[O+2]=g,this.int16[O+4]=v,this.int16[O+5]=T,this.int16[O+6]=C,this.int16[O+7]=k,a}}Oi.prototype.bytesPerElement=16,dn(Oi,"StructArrayLayout3i2i2i16");class Ls extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v){const T=this.length;return this.resize(T+1),this.emplace(T,a,u,f,g,v)}emplace(a,u,f,g,v,T){const C=4*a,k=8*a;return this.float32[C+0]=u,this.float32[C+1]=f,this.float32[C+2]=g,this.int16[k+6]=v,this.int16[k+7]=T,a}}Ls.prototype.bytesPerElement=16,dn(Ls,"StructArrayLayout2f1f2i16");class ic extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,f,g)}emplace(a,u,f,g,v){const T=12*a,C=3*a;return this.uint8[T+0]=u,this.uint8[T+1]=f,this.float32[C+1]=g,this.float32[C+2]=v,a}}ic.prototype.bytesPerElement=12,dn(ic,"StructArrayLayout2ub2f12");class $o extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const v=3*a;return this.float32[v+0]=u,this.float32[v+1]=f,this.float32[v+2]=g,a}}$o.prototype.bytesPerElement=12,dn($o,"StructArrayLayout3f12");class Xi extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,a,u,f)}emplace(a,u,f,g){const v=3*a;return this.uint16[v+0]=u,this.uint16[v+1]=f,this.uint16[v+2]=g,a}}Xi.prototype.bytesPerElement=6,dn(Xi,"StructArrayLayout3ui6");class rs extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge,Re,je,ke,Ge,$e){const qe=this.length;return this.resize(qe+1),this.emplace(qe,a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge,Re,je,ke,Ge,$e)}emplace(a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge,Re,je,ke,Ge,$e,qe){const dt=30*a,ut=15*a,Tt=60*a;return this.int16[dt+0]=u,this.int16[dt+1]=f,this.int16[dt+2]=g,this.float32[ut+2]=v,this.float32[ut+3]=T,this.uint16[dt+8]=C,this.uint16[dt+9]=k,this.uint32[ut+5]=O,this.uint32[ut+6]=W,this.uint32[ut+7]=q,this.uint16[dt+16]=$,this.uint16[dt+17]=J,this.uint16[dt+18]=ie,this.float32[ut+10]=ue,this.float32[ut+11]=ge,this.uint8[Tt+48]=Re,this.uint8[Tt+49]=je,this.uint8[Tt+50]=ke,this.uint32[ut+13]=Ge,this.int16[dt+28]=$e,this.uint8[Tt+58]=qe,a}}rs.prototype.bytesPerElement=60,dn(rs,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Vr extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge,Re,je,ke,Ge,$e,qe,dt,ut,Tt,Ht,yt,Pt,Rt,Bt){const jt=this.length;return this.resize(jt+1),this.emplace(jt,a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge,Re,je,ke,Ge,$e,qe,dt,ut,Tt,Ht,yt,Pt,Rt,Bt)}emplace(a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge,Re,je,ke,Ge,$e,qe,dt,ut,Tt,Ht,yt,Pt,Rt,Bt,jt){const xt=38*a,en=19*a;return this.int16[xt+0]=u,this.int16[xt+1]=f,this.int16[xt+2]=g,this.float32[en+2]=v,this.float32[en+3]=T,this.int16[xt+8]=C,this.int16[xt+9]=k,this.int16[xt+10]=O,this.int16[xt+11]=W,this.int16[xt+12]=q,this.int16[xt+13]=$,this.uint16[xt+14]=J,this.uint16[xt+15]=ie,this.uint16[xt+16]=ue,this.uint16[xt+17]=ge,this.uint16[xt+18]=Re,this.uint16[xt+19]=je,this.uint16[xt+20]=ke,this.uint16[xt+21]=Ge,this.uint16[xt+22]=$e,this.uint16[xt+23]=qe,this.uint16[xt+24]=dt,this.uint16[xt+25]=ut,this.uint16[xt+26]=Tt,this.uint16[xt+27]=Ht,this.uint16[xt+28]=yt,this.uint32[en+15]=Pt,this.float32[en+16]=Rt,this.float32[en+17]=Bt,this.float32[en+18]=jt,a}}Vr.prototype.bytesPerElement=76,dn(Vr,"StructArrayLayout3i2f6i15ui1ul3f76");class zo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.float32[1*a+0]=u,a}}zo.prototype.bytesPerElement=4,dn(zo,"StructArrayLayout1f4");class ys extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u,f,g,v){const T=this.length;return this.resize(T+1),this.emplace(T,a,u,f,g,v)}emplace(a,u,f,g,v,T){const C=5*a;return this.float32[C+0]=u,this.float32[C+1]=f,this.float32[C+2]=g,this.float32[C+3]=v,this.float32[C+4]=T,a}}ys.prototype.bytesPerElement=20,dn(ys,"StructArrayLayout5f20");class su extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u,f,g){const v=this.length;return this.resize(v+1),this.emplace(v,a,u,f,g)}emplace(a,u,f,g,v){const T=6*a;return this.uint32[3*a+0]=u,this.uint16[T+2]=f,this.uint16[T+3]=g,this.uint16[T+4]=v,a}}su.prototype.bytesPerElement=12,dn(su,"StructArrayLayout1ul3ui12");class Yo extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.uint16[g+0]=u,this.uint16[g+1]=f,a}}Yo.prototype.bytesPerElement=4,dn(Yo,"StructArrayLayout2ui4");class ud extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const u=this.length;return this.resize(u+1),this.emplace(u,a)}emplace(a,u){return this.uint16[1*a+0]=u,a}}ud.prototype.bytesPerElement=2,dn(ud,"StructArrayLayout1ui2");class Hg extends In{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,u){const f=this.length;return this.resize(f+1),this.emplace(f,a,u)}emplace(a,u,f){const g=2*a;return this.float32[g+0]=u,this.float32[g+1]=f,a}}Hg.prototype.bytesPerElement=8,dn(Hg,"StructArrayLayout2f8");class ou extends zn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ou.prototype.size=40;class jg extends is{get(a){return new ou(this,a)}}dn(jg,"CollisionBoxArray");class c0 extends zn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(a){this._structArray.uint8[this._pos1+49]=a}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(a){this._structArray.uint8[this._pos1+50]=a}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(a){this._structArray.uint32[this._pos4+13]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(a){this._structArray.uint8[this._pos1+58]=a}}c0.prototype.size=60;class qg extends rs{get(a){return new c0(this,a)}}dn(qg,"PlacedSymbolArray");class sh extends zn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(a){this._structArray.uint32[this._pos4+15]=a}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}sh.prototype.size=76;class u0 extends Vr{get(a){return new sh(this,a)}}dn(u0,"SymbolInstanceArray");class h0 extends zo{getoffsetX(a){return this.float32[1*a+0]}}dn(h0,"GlyphOffsetArray");class Zg extends bi{getx(a){return this.int16[2*a+0]}gety(a){return this.int16[2*a+1]}}dn(Zg,"SymbolLineVertexArray");class um extends zn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}um.prototype.size=12;class U1 extends su{get(a){return new um(this,a)}}dn(U1,"FeatureIndexArray");class V1 extends Yo{geta_centroid_pos0(a){return this.uint16[2*a+0]}geta_centroid_pos1(a){return this.uint16[2*a+1]}}dn(V1,"FillExtrusionCentroidArray");const G1=an([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),W1=an([{name:"a_dash",components:4,type:"Uint16"}]);var Ua={exports:{}},H1={exports:{}};H1.exports=function(c,a){var u,f,g,v,T,C,k,O;for(f=c.length-(u=3&c.length),g=a,T=3432918353,C=461845907,O=0;O<f;)k=255&c.charCodeAt(O)|(255&c.charCodeAt(++O))<<8|(255&c.charCodeAt(++O))<<16|(255&c.charCodeAt(++O))<<24,++O,g=27492+(65535&(v=5*(65535&(g=(g^=k=(65535&(k=(k=(65535&k)*T+(((k>>>16)*T&65535)<<16)&4294967295)<<15|k>>>17))*C+(((k>>>16)*C&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(k=0,u){case 3:k^=(255&c.charCodeAt(O+2))<<16;case 2:k^=(255&c.charCodeAt(O+1))<<8;case 1:g^=k=(65535&(k=(k=(65535&(k^=255&c.charCodeAt(O)))*T+(((k>>>16)*T&65535)<<16)&4294967295)<<15|k>>>17))*C+(((k>>>16)*C&65535)<<16)&4294967295}return g^=c.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0};var oh={exports:{}};oh.exports=function(c,a){for(var u,f=c.length,g=a^f,v=0;f>=4;)u=1540483477*(65535&(u=255&c.charCodeAt(v)|(255&c.charCodeAt(++v))<<8|(255&c.charCodeAt(++v))<<16|(255&c.charCodeAt(++v))<<24))+((1540483477*(u>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(u=1540483477*(65535&(u^=u>>>24))+((1540483477*(u>>>16)&65535)<<16)),f-=4,++v;switch(f){case 3:g^=(255&c.charCodeAt(v+2))<<16;case 2:g^=(255&c.charCodeAt(v+1))<<8;case 1:g=1540483477*(65535&(g^=255&c.charCodeAt(v)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0};var d0=H1.exports,Ko=oh.exports;Ua.exports=d0,Ua.exports.murmur3=d0,Ua.exports.murmur2=Ko;class Xg{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,u,f,g){this.ids.push(f0(a)),this.positions.push(u,f,g)}getPositions(a){const u=f0(a);let f=0,g=this.ids.length-1;for(;f<g;){const T=f+g>>1;this.ids[T]>=u?g=T:f=T+1}const v=[];for(;this.ids[f]===u;)v.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return v}static serialize(a,u){const f=new Float64Array(a.ids),g=new Uint32Array(a.positions);return p0(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(a){const u=new Xg;return u.ids=a.ids,u.positions=a.positions,u.indexed=!0,u}}function f0(c){const a=+c;return!isNaN(a)&&Number.MIN_SAFE_INTEGER<=a&&a<=Number.MAX_SAFE_INTEGER?a:Ua.exports(String(c))}function p0(c,a,u,f){for(;u<f;){const g=c[u+f>>1];let v=u-1,T=f+1;for(;;){do v++;while(c[v]<g);do T--;while(c[T]>g);if(v>=T)break;$g(c,v,T),$g(a,3*v,3*T),$g(a,3*v+1,3*T+1),$g(a,3*v+2,3*T+2)}T-u<f-T?(p0(c,a,u,T),u=T+1):(p0(c,a,T+1,f),f=T)}}function $g(c,a,u){const f=c[a];c[a]=c[u],c[u]=f}dn(Xg,"FeaturePositionMap");class rc{constructor(a){this.gl=a.gl,this.initialized=!1}fetchUniformLocation(a,u){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(a,u),this.initialized=!0),!!this.location}}class hm extends rc{constructor(a){super(a),this.current=0}set(a,u,f){this.fetchUniformLocation(a,u)&&this.current!==f&&(this.current=f,this.gl.uniform1f(this.location,f))}}class j1 extends rc{constructor(a){super(a),this.current=[0,0,0,0]}set(a,u,f){this.fetchUniformLocation(a,u)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]&&f[3]===this.current[3]||(this.current=f,this.gl.uniform4f(this.location,f[0],f[1],f[2],f[3])))}}class wa extends rc{constructor(a){super(a),this.current=Sr.transparent}set(a,u,f){this.fetchUniformLocation(a,u)&&(f.r===this.current.r&&f.g===this.current.g&&f.b===this.current.b&&f.a===this.current.a||(this.current=f,this.gl.uniform4f(this.location,f.r,f.g,f.b,f.a)))}}const m0=new Float32Array(16),_T=new Float32Array(9),ah=new Float32Array(4);function Af(c){return[cn(255*c.r,255*c.g),cn(255*c.b,255*c.a)]}class Sl{constructor(a,u,f){this.value=a,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(a,u,f,g,v){u.set(a,v,g.constantOr(this.value))}getBinding(a,u){return this.type==="color"?new wa(a):new hm(a)}}class au{constructor(a,u){this.uniformNames=u.map(f=>`u_${f}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(a){this.pixelRatio=a.pixelRatio||1,this.pattern=a.tl.concat(a.br)}setUniform(a,u,f,g,v){const T=v==="u_pattern"||v==="u_dash"?this.pattern:v==="u_pixel_ratio"?this.pixelRatio:null;T&&u.set(a,v,T)}getBinding(a,u){return u==="u_pattern"||u==="u_dash"?new j1(a):new hm(a)}}class Ml{constructor(a,u,f,g){this.expression=a,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(v=>({name:`a_${v}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(a,u,f,g,v,T){const C=this.paintVertexArray.length,k=this.expression.evaluate(new it(0),u,{},v,g,T);this.paintVertexArray.resize(a),this._setPaintValue(C,a,k)}updatePaintArray(a,u,f,g,v){const T=this.expression.evaluate({zoom:0},f,g,void 0,v);this._setPaintValue(a,u,T)}_setPaintValue(a,u,f){if(this.type==="color"){const g=Af(f);for(let v=a;v<u;v++)this.paintVertexArray.emplace(v,g[0],g[1])}else{for(let g=a;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ba{constructor(a,u,f,g,v,T){this.expression=a,this.uniformNames=u.map(C=>`u_${C}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=v,this.maxValue=0,this.paintVertexAttributes=u.map(C=>({name:`a_${C}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(a,u,f,g,v,T){const C=this.expression.evaluate(new it(this.zoom),u,{},v,g,T),k=this.expression.evaluate(new it(this.zoom+1),u,{},v,g,T),O=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(O,a,C,k)}updatePaintArray(a,u,f,g,v){const T=this.expression.evaluate({zoom:this.zoom},f,g,void 0,v),C=this.expression.evaluate({zoom:this.zoom+1},f,g,void 0,v);this._setPaintValue(a,u,T,C)}_setPaintValue(a,u,f,g){if(this.type==="color"){const v=Af(f),T=Af(g);for(let C=a;C<u;C++)this.paintVertexArray.emplace(C,v[0],v[1],T[0],T[1])}else{for(let v=a;v<u;v++)this.paintVertexArray.emplace(v,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,u,f,g,v){const T=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,C=fe(this.expression.interpolationFactor(T,this.zoom,this.zoom+1),0,1);u.set(a,v,C)}getBinding(a,u){return new hm(a)}}class lh{constructor(a,u,f,g,v){this.expression=a,this.layerId=v,this.paintVertexAttributes=(f==="array"?W1:G1).members;for(let T=0;T<u.length;++T);this.paintVertexArray=new g}populatePaintArray(a,u,f){const g=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValues(g,a,u.patterns&&u.patterns[this.layerId],f)}updatePaintArray(a,u,f,g,v,T){this._setPaintValues(a,u,f.patterns&&f.patterns[this.layerId],T)}_setPaintValues(a,u,f,g){if(!g||!f)return;const v=g[f];if(!v)return;const{tl:T,br:C,pixelRatio:k}=v;for(let O=a;O<u;O++)this.paintVertexArray.emplace(O,T[0],T[1],C[0],C[1],k)}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class lu{constructor(a,u,f=()=>!0){this.binders={},this._buffers=[];const g=[];for(const v in a.paint._values){if(!f(v))continue;const T=a.paint.get(v);if(!(T instanceof Lt&&_l(T.property.specification)))continue;const C=Z1(v,a.type),k=T.value,O=T.property.specification.type,W=T.property.useIntegerZoom,q=v==="line-dasharray"||v.endsWith("pattern"),$=v==="line-dasharray"&&a.layout.get("line-cap").value.kind!=="constant";if(k.kind!=="constant"||$)if(k.kind==="source"||$||q){const J=X1(v,O,"source");this.binders[v]=q?new lh(k,C,O,J,a.id):new Ml(k,C,O,J),g.push(`/a_${v}`)}else{const J=X1(v,O,"composite");this.binders[v]=new ba(k,C,O,W,u,J),g.push(`/z_${v}`)}else this.binders[v]=q?new au(k.value,C):new Sl(k.value,C,O),g.push(`/u_${v}`)}this.cacheKey=g.sort().join("")}getMaxValue(a){const u=this.binders[a];return u instanceof Ml||u instanceof ba?u.maxValue:0}populatePaintArrays(a,u,f,g,v,T){for(const C in this.binders){const k=this.binders[C];(k instanceof Ml||k instanceof ba||k instanceof lh)&&k.populatePaintArray(a,u,f,g,v,T)}}setConstantPatternPositions(a){for(const u in this.binders){const f=this.binders[u];f instanceof au&&f.setConstantPatternPositions(a)}}updatePaintArrays(a,u,f,g,v,T){let C=!1;for(const k in a){const O=u.getPositions(k);for(const W of O){const q=f.feature(W.index);for(const $ in this.binders){const J=this.binders[$];if((J instanceof Ml||J instanceof ba||J instanceof lh)&&J.expression.isStateDependent===!0){const ie=g.paint.get($);J.expression=ie.value,J.updatePaintArray(W.start,W.end,q,a[k],v,T),C=!0}}}}return C}defines(){const a=[];for(const u in this.binders){const f=this.binders[u];(f instanceof Sl||f instanceof au)&&a.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return a}getBinderAttributes(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Ml||f instanceof ba||f instanceof lh)for(let g=0;g<f.paintVertexAttributes.length;g++)a.push(f.paintVertexAttributes[g].name)}return a}getBinderUniforms(){const a=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Sl||f instanceof au||f instanceof ba)for(const g of f.uniformNames)a.push(g)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a){const u=[];for(const f in this.binders){const g=this.binders[f];if(g instanceof Sl||g instanceof au||g instanceof ba)for(const v of g.uniformNames)u.push({name:v,property:f,binding:g.getBinding(a,v)})}return u}setUniforms(a,u,f,g,v){for(const{name:T,property:C,binding:k}of f)this.binders[C].setUniform(a,k,v,g.get(C),T)}updatePaintBuffers(){this._buffers=[];for(const a in this.binders){const u=this.binders[a];(u instanceof Ml||u instanceof ba||u instanceof lh)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(a){for(const u in this.binders){const f=this.binders[u];(f instanceof Ml||f instanceof ba||f instanceof lh)&&f.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const u=this.binders[a];(u instanceof Ml||u instanceof ba||u instanceof lh)&&u.destroy()}}}class ch{constructor(a,u,f=()=>!0){this.programConfigurations={};for(const g of a)this.programConfigurations[g.id]=new lu(g,u,f);this.needsUpload=!1,this._featureMap=new Xg,this._bufferOffset=0}populatePaintArrays(a,u,f,g,v,T,C){for(const k in this.programConfigurations)this.programConfigurations[k].populatePaintArrays(a,u,g,v,T,C);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,u,f,g,v){for(const T of f)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(a,this._featureMap,u,T,g,v)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}const q1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Z1(c,a){return q1[c]||[c.replace(`${a}-`,"").replace(/-/g,"_")]}const g0={"line-pattern":{source:Xr,composite:Xr},"fill-pattern":{source:Xr,composite:Xr},"fill-extrusion-pattern":{source:Xr,composite:Xr},"line-dasharray":{source:Ro,composite:Ro}},yT={color:{source:Hg,composite:Js},number:{source:zo,composite:Hg}};function X1(c,a,u){const f=g0[c];return f&&f[u]||yT[a][u]}dn(Sl,"ConstantBinder"),dn(au,"PatternConstantBinder"),dn(Ml,"SourceExpressionBinder"),dn(lh,"PatternCompositeBinder"),dn(ba,"CompositeExpressionBinder"),dn(lu,"ProgramConfiguration",{omit:["_buffers"]}),dn(ch,"ProgramConfigurationSet");const x="-transition";class S extends Br{constructor(a,u){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&a.type!=="sky"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),u.layout&&(this._unevaluatedLayout=new gt(u.layout)),u.paint)){this._transitionablePaint=new bt(u.paint);for(const f in a.paint)this.setPaintProperty(f,a.paint[f],{validate:!1});for(const f in a.layout)this.setLayoutProperty(f,a.layout[f],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new kt(u.paint)}}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,u,f={}){u!=null&&this._validate(Ks,`layers.${this.id}.layout.${a}`,a,u,f)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,u):this.visibility=u)}getPaintProperty(a){return Nt(a,x)?this._transitionablePaint.getTransition(a.slice(0,-x.length)):this._transitionablePaint.getValue(a)}setPaintProperty(a,u,f={}){if(u!=null&&this._validate(Do,`layers.${this.id}.paint.${a}`,a,u,f))return!1;if(Nt(a,x))return this._transitionablePaint.setTransition(a.slice(0,-x.length),u||void 0),!1;{const g=this._transitionablePaint._values[a],v=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(a,u),this._handleSpecialPaintPropertyUpdate(a);const C=this._transitionablePaint._values[a].value,k=C.isDataDriven(),O=Nt(a,"pattern")||a==="line-dasharray";return k||v||O||this._handleOverridablePaintPropertyUpdate(a,T,C)}}_handleSpecialPaintPropertyUpdate(a){}getProgramIds(){return null}getProgramConfiguration(a){return null}_handleOverridablePaintPropertyUpdate(a,u,f){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,u){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,u)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),wn(a,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(a,u,f,g,v={}){return(!v||v.validate!==!1)&&am(this,a.call(om,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:wt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const u=this.paint.get(a);if(u instanceof Lt&&_l(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=tu(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const R=an([{name:"a_pos",components:2,type:"Int16"}],4),G=an([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class X{constructor(a=[]){this.segments=a}prepareSegment(a,u,f,g){let v=this.segments[this.segments.length-1];return a>X.MAX_VERTEX_ARRAY_LENGTH&&At(`Max vertices per segment is ${X.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!v||v.vertexLength+a>X.MAX_VERTEX_ARRAY_LENGTH||v.sortKey!==g)&&(v={vertexOffset:u.length,primitiveOffset:f.length,vertexLength:0,primitiveLength:0},g!==void 0&&(v.sortKey=g),this.segments.push(v)),v}get(){return this.segments}destroy(){for(const a of this.segments)for(const u in a.vaos)a.vaos[u].destroy()}static simpleSegment(a,u,f,g){return new X([{vertexOffset:a,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}X.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(X,"SegmentVector");var te=8192;class Ve{constructor(a,u){a&&(u?this.setSouthWest(a).setNorthEast(u):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof pt?new pt(a.lng,a.lat):pt.convert(a),this}setSouthWest(a){return this._sw=a instanceof pt?new pt(a.lng,a.lat):pt.convert(a),this}extend(a){const u=this._sw,f=this._ne;let g,v;if(a instanceof pt)g=a,v=a;else{if(!(a instanceof Ve))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Ve.convert(a)):this.extend(pt.convert(a)):typeof a=="object"&&a!==null&&a.hasOwnProperty("lat")&&a.hasOwnProperty("lon")?this.extend(pt.convert(a)):this;if(g=a._sw,v=a._ne,!g||!v)return this}return u||f?(u.lng=Math.min(g.lng,u.lng),u.lat=Math.min(g.lat,u.lat),f.lng=Math.max(v.lng,f.lng),f.lat=Math.max(v.lat,f.lat)):(this._sw=new pt(g.lng,g.lat),this._ne=new pt(v.lng,v.lat)),this}getCenter(){return new pt((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new pt(this.getWest(),this.getNorth())}getSouthEast(){return new pt(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:u,lat:f}=pt.convert(a);let g=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&g}static convert(a){return!a||a instanceof Ve?a:new Ve(a)}}const st=63710088e-1;class pt{constructor(a,u){if(isNaN(a)||isNaN(u))throw new Error(`Invalid LngLat object: (${a}, ${u})`);if(this.lng=+a,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new pt(We(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const u=Math.PI/180,f=this.lat*u,g=a.lat*u,v=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((a.lng-this.lng)*u);return st*Math.acos(Math.min(v,1))}toBounds(a=0){const u=360*a/40075017,f=u/Math.cos(Math.PI/180*this.lat);return new Ve(new pt(this.lng-f,this.lat-u),new pt(this.lng+f,this.lat+u))}static convert(a){if(a instanceof pt)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new pt(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new pt(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const ln=2*Math.PI*st;function Dn(c){return ln*Math.cos(c*Math.PI/180)}function Qn(c){return(180+c)/360}function Gn(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Ii(c,a){return c/Dn(a)}function Pn(c){return 360*c-180}function Hi(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function Sa(c,a){return c*Dn(Hi(a))}const _t=85.051129;function ct(c){return 1/Math.cos(c*Math.PI/180)}class Mt{constructor(a,u,f=0){this.x=+a,this.y=+u,this.z=+f}static fromLngLat(a,u=0){const f=pt.convert(a);return new Mt(Qn(f.lng),Gn(f.lat),Ii(u,f.lat))}toLngLat(){return new pt(Pn(this.x),Hi(this.y))}toAltitude(){return Sa(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/ln*ct(Hi(this.y))}}function Mn(c,a,u,f,g,v,T,C,k){const O=(a+f)/2,W=(u+g)/2,q=new j(O,W);C(q),function($,J,ie,ue,ge,Re){const je=ie-ge,ke=ue-Re;return Math.abs((ue-J)*je-(ie-$)*ke)/Math.hypot(je,ke)}(q.x,q.y,v.x,v.y,T.x,T.y)>=k?(Mn(c,a,u,O,W,v,q,C,k),Mn(c,O,W,f,g,q,T,C,k)):c.push(T)}function Hn(c,a,u){let f=c[0],g=f.x,v=f.y;a(f);const T=[f];for(let C=1;C<c.length;C++){const k=c[C],{x:O,y:W}=k;a(k),Mn(T,g,v,O,W,f,k,a,u),g=O,v=W,f=k}return T}function mi(c,a,u,f){if(f(a,u)){const g=a.add(u)._mult(.5);mi(c,a,g,f),mi(c,g,u,f)}else c.push(u)}function fi(c,a){let u=c[0];const f=[u];for(let g=1;g<c.length;g++){const v=c[g];mi(f,u,v,a),u=v}return f}const Ui=Math.pow(2,14)-1,ks=-Ui-1;function $i(c,a){const u=Math.round(c.x*a),f=Math.round(c.y*a);return c.x=fe(u,ks,Ui),c.y=fe(f,ks,Ui),(u<c.x||u>c.x+1||f<c.y||f>c.y+1)&&At("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function wo(c,a,u){const f=c.loadGeometry(),g=c.extent,v=te/g;if(a&&u&&u.projection.isReprojectedInTileSpace){const T=1<<a.z,{scale:C,x:k,y:O,projection:W}=u,q=$=>{const J=Pn((a.x+$.x/g)/T),ie=Hi((a.y+$.y/g)/T),ue=W.project(J,ie);$.x=(ue.x*C-k)*g,$.y=(ue.y*C-O)*g};for(let $=0;$<f.length;$++)if(c.type!==1)f[$]=Hn(f[$],q,1);else{const J=[];for(const ie of f[$])ie.x<0||ie.x>=g||ie.y<0||ie.y>=g||(q(ie),J.push(ie));f[$]=J}}for(const T of f)for(const C of T)$i(C,v);return f}function hd(c,a){return{type:c.type,id:c.id,properties:c.properties,geometry:a?wo(c):[]}}function $1(c,a,u,f,g){c.emplaceBack(2*a+(f+1)/2,2*u+(g+1)/2)}function Y1(c,a,u){c.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class xT{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.projection=a.projection,this.layoutVertexArray=new bi,this.indexArray=new Xi,this.segments=new X,this.programConfigurations=new ch(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){const v=this.layers[0],T=[];let C=null;v.type==="circle"&&(C=v.layout.get("circle-sort-key"));for(const{feature:O,id:W,index:q,sourceLayerIndex:$}of a){const J=this.layers[0]._featureFilter.needGeometry,ie=hd(O,J);if(!this.layers[0]._featureFilter.filter(new it(this.zoom),ie,f))continue;const ue=C?C.evaluate(ie,{},f):void 0,ge={id:W,properties:O.properties,type:O.type,sourceLayerIndex:$,index:q,geometry:J?ie.geometry:wo(O,f,g),patterns:{},sortKey:ue};T.push(ge)}C&&T.sort((O,W)=>O.sortKey-W.sortKey);let k=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Zi,k=g.projection);for(const O of T){const{geometry:W,index:q,sourceLayerIndex:$}=O,J=a[q].feature;this.addFeature(O,W,q,u.availableImages,f,k),u.featureIndex.insert(J,W,q,$,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,R.members),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,G.members))),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(a,u,f,g,v,T){for(const C of u)for(const k of C){const O=k.x,W=k.y;if(O<0||O>=te||W<0||W>=te)continue;if(T){const J=T.projectTilePoint(O,W,v),ie=T.upVector(v,O,W),ue=this.globeExtVertexArray;Y1(ue,J,ie),Y1(ue,J,ie),Y1(ue,J,ie),Y1(ue,J,ie)}const q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),$=q.vertexLength;$1(this.layoutVertexArray,O,W,-1,-1),$1(this.layoutVertexArray,O,W,1,-1),$1(this.layoutVertexArray,O,W,1,1),$1(this.layoutVertexArray,O,W,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,{},g,v)}}function sk(c,a){for(let u=0;u<c.length;u++)if(dm(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(dm(c,a[u]))return!0;return!!vT(c,a)}function HG(c,a,u){return!!dm(c,a)||!!wT(a,c,u)}function ok(c,a){if(c.length===1)return lk(a,c[0]);for(let u=0;u<a.length;u++){const f=a[u];for(let g=0;g<f.length;g++)if(dm(c,f[g]))return!0}for(let u=0;u<c.length;u++)if(lk(a,c[u]))return!0;for(let u=0;u<a.length;u++)if(vT(c,a[u]))return!0;return!1}function jG(c,a,u){if(c.length>1){if(vT(c,a))return!0;for(let f=0;f<a.length;f++)if(wT(a[f],c,u))return!0}for(let f=0;f<c.length;f++)if(wT(c[f],a,u))return!0;return!1}function vT(c,a){if(c.length===0||a.length===0)return!1;for(let u=0;u<c.length-1;u++){const f=c[u],g=c[u+1];for(let v=0;v<a.length-1;v++)if(qG(f,g,a[v],a[v+1]))return!0}return!1}function qG(c,a,u,f){return Ot(c,u,f)!==Ot(a,u,f)&&Ot(c,a,u)!==Ot(c,a,f)}function wT(c,a,u){const f=u*u;if(a.length===1)return c.distSqr(a[0])<f;for(let g=1;g<a.length;g++)if(ak(c,a[g-1],a[g])<f)return!0;return!1}function ak(c,a,u){const f=a.distSqr(u);if(f===0)return c.distSqr(a);const g=((c.x-a.x)*(u.x-a.x)+(c.y-a.y)*(u.y-a.y))/f;return c.distSqr(g<0?a:g>1?u:u.sub(a)._mult(g)._add(a))}function lk(c,a){let u,f,g,v=!1;for(let T=0;T<c.length;T++){u=c[T];for(let C=0,k=u.length-1;C<u.length;k=C++)f=u[C],g=u[k],f.y>a.y!=g.y>a.y&&a.x<(g.x-f.x)*(a.y-f.y)/(g.y-f.y)+f.x&&(v=!v)}return v}function dm(c,a){let u=!1;for(let f=0,g=c.length-1;f<c.length;g=f++){const v=c[f],T=c[g];v.y>a.y!=T.y>a.y&&a.x<(T.x-v.x)*(a.y-v.y)/(T.y-v.y)+v.x&&(u=!u)}return u}function ck(c,a,u,f,g){for(const T of c)if(a<=T.x&&u<=T.y&&f>=T.x&&g>=T.y)return!0;const v=[new j(a,u),new j(a,g),new j(f,g),new j(f,u)];if(c.length>2){for(const T of v)if(dm(c,T))return!0}for(let T=0;T<c.length-1;T++)if(ZG(c[T],c[T+1],v))return!0;return!1}function ZG(c,a,u){const f=u[0],g=u[2];if(c.x<f.x&&a.x<f.x||c.x>g.x&&a.x>g.x||c.y<f.y&&a.y<f.y||c.y>g.y&&a.y>g.y)return!1;const v=Ot(c,a,u[0]);return v!==Ot(c,a,u[1])||v!==Ot(c,a,u[2])||v!==Ot(c,a,u[3])}function Yg(c,a,u){const f=a.paint.get(c).value;return f.kind==="constant"?f.value:u.programConfigurations.get(a.id).getMaxValue(c)}function K1(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function uk(c,a,u,f,g){if(!a[0]&&!a[1])return c;const v=j.convert(a)._mult(g);u==="viewport"&&v._rotate(-f);const T=[];for(let C=0;C<c.length;C++)T.push(c[C].sub(v));return T}function hk(c,a,u,f){const g=j.convert(c)._mult(f);return a==="viewport"&&g._rotate(-u),g}dn(xT,"CircleBucket",{omit:["layers"]});const XG=new mn({"circle-sort-key":new at(wt.layout_circle["circle-sort-key"])});var $G={paint:new mn({"circle-radius":new at(wt.paint_circle["circle-radius"]),"circle-color":new at(wt.paint_circle["circle-color"]),"circle-blur":new at(wt.paint_circle["circle-blur"]),"circle-opacity":new at(wt.paint_circle["circle-opacity"]),"circle-translate":new Ye(wt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ye(wt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ye(wt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ye(wt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new at(wt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new at(wt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new at(wt.paint_circle["circle-stroke-opacity"])}),layout:XG},J1=1e-6,Va=typeof Float32Array<"u"?Float32Array:Array;function dk(){var c=new Va(9);return Va!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function fk(c,a,u){var f=a[0],g=a[1],v=a[2],T=a[3],C=a[4],k=a[5],O=a[6],W=a[7],q=a[8],$=u[0],J=u[1],ie=u[2],ue=u[3],ge=u[4],Re=u[5],je=u[6],ke=u[7],Ge=u[8];return c[0]=$*f+J*T+ie*O,c[1]=$*g+J*C+ie*W,c[2]=$*v+J*k+ie*q,c[3]=ue*f+ge*T+Re*O,c[4]=ue*g+ge*C+Re*W,c[5]=ue*v+ge*k+Re*q,c[6]=je*f+ke*T+Ge*O,c[7]=je*g+ke*C+Ge*W,c[8]=je*v+ke*k+Ge*q,c}function cu(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function bT(c,a){var u=a[0],f=a[1],g=a[2],v=a[3],T=a[4],C=a[5],k=a[6],O=a[7],W=a[8],q=a[9],$=a[10],J=a[11],ie=a[12],ue=a[13],ge=a[14],Re=a[15],je=u*C-f*T,ke=u*k-g*T,Ge=u*O-v*T,$e=f*k-g*C,qe=f*O-v*C,dt=g*O-v*k,ut=W*ue-q*ie,Tt=W*ge-$*ie,Ht=W*Re-J*ie,yt=q*ge-$*ue,Pt=q*Re-J*ue,Rt=$*Re-J*ge,Bt=je*Rt-ke*Pt+Ge*yt+$e*Ht-qe*Tt+dt*ut;return Bt?(c[0]=(C*Rt-k*Pt+O*yt)*(Bt=1/Bt),c[1]=(g*Pt-f*Rt-v*yt)*Bt,c[2]=(ue*dt-ge*qe+Re*$e)*Bt,c[3]=($*qe-q*dt-J*$e)*Bt,c[4]=(k*Ht-T*Rt-O*Tt)*Bt,c[5]=(u*Rt-g*Ht+v*Tt)*Bt,c[6]=(ge*Ge-ie*dt-Re*ke)*Bt,c[7]=(W*dt-$*Ge+J*ke)*Bt,c[8]=(T*Pt-C*Ht+O*ut)*Bt,c[9]=(f*Ht-u*Pt-v*ut)*Bt,c[10]=(ie*qe-ue*Ge+Re*je)*Bt,c[11]=(q*Ge-W*qe-J*je)*Bt,c[12]=(C*Tt-T*yt-k*ut)*Bt,c[13]=(u*yt-f*Tt+g*ut)*Bt,c[14]=(ue*ke-ie*$e-ge*je)*Bt,c[15]=(W*$e-q*ke+$*je)*Bt,c):null}function fm(c,a,u){var f=a[0],g=a[1],v=a[2],T=a[3],C=a[4],k=a[5],O=a[6],W=a[7],q=a[8],$=a[9],J=a[10],ie=a[11],ue=a[12],ge=a[13],Re=a[14],je=a[15],ke=u[0],Ge=u[1],$e=u[2],qe=u[3];return c[0]=ke*f+Ge*C+$e*q+qe*ue,c[1]=ke*g+Ge*k+$e*$+qe*ge,c[2]=ke*v+Ge*O+$e*J+qe*Re,c[3]=ke*T+Ge*W+$e*ie+qe*je,c[4]=(ke=u[4])*f+(Ge=u[5])*C+($e=u[6])*q+(qe=u[7])*ue,c[5]=ke*g+Ge*k+$e*$+qe*ge,c[6]=ke*v+Ge*O+$e*J+qe*Re,c[7]=ke*T+Ge*W+$e*ie+qe*je,c[8]=(ke=u[8])*f+(Ge=u[9])*C+($e=u[10])*q+(qe=u[11])*ue,c[9]=ke*g+Ge*k+$e*$+qe*ge,c[10]=ke*v+Ge*O+$e*J+qe*Re,c[11]=ke*T+Ge*W+$e*ie+qe*je,c[12]=(ke=u[12])*f+(Ge=u[13])*C+($e=u[14])*q+(qe=u[15])*ue,c[13]=ke*g+Ge*k+$e*$+qe*ge,c[14]=ke*v+Ge*O+$e*J+qe*Re,c[15]=ke*T+Ge*W+$e*ie+qe*je,c}function _0(c,a,u){var f,g,v,T,C,k,O,W,q,$,J,ie,ue=u[0],ge=u[1],Re=u[2];return a===c?(c[12]=a[0]*ue+a[4]*ge+a[8]*Re+a[12],c[13]=a[1]*ue+a[5]*ge+a[9]*Re+a[13],c[14]=a[2]*ue+a[6]*ge+a[10]*Re+a[14],c[15]=a[3]*ue+a[7]*ge+a[11]*Re+a[15]):(g=a[1],v=a[2],T=a[3],C=a[4],k=a[5],O=a[6],W=a[7],q=a[8],$=a[9],J=a[10],ie=a[11],c[0]=f=a[0],c[1]=g,c[2]=v,c[3]=T,c[4]=C,c[5]=k,c[6]=O,c[7]=W,c[8]=q,c[9]=$,c[10]=J,c[11]=ie,c[12]=f*ue+C*ge+q*Re+a[12],c[13]=g*ue+k*ge+$*Re+a[13],c[14]=v*ue+O*ge+J*Re+a[14],c[15]=T*ue+W*ge+ie*Re+a[15]),c}function pm(c,a,u){var f=u[0],g=u[1],v=u[2];return c[0]=a[0]*f,c[1]=a[1]*f,c[2]=a[2]*f,c[3]=a[3]*f,c[4]=a[4]*g,c[5]=a[5]*g,c[6]=a[6]*g,c[7]=a[7]*g,c[8]=a[8]*v,c[9]=a[9]*v,c[10]=a[10]*v,c[11]=a[11]*v,c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15],c}function ST(c,a,u){var f=Math.sin(u),g=Math.cos(u),v=a[4],T=a[5],C=a[6],k=a[7],O=a[8],W=a[9],q=a[10],$=a[11];return a!==c&&(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[4]=v*g+O*f,c[5]=T*g+W*f,c[6]=C*g+q*f,c[7]=k*g+$*f,c[8]=O*g-v*f,c[9]=W*g-T*f,c[10]=q*g-C*f,c[11]=$*g-k*f,c}function Q1(c,a,u){var f=Math.sin(u),g=Math.cos(u),v=a[0],T=a[1],C=a[2],k=a[3],O=a[8],W=a[9],q=a[10],$=a[11];return a!==c&&(c[4]=a[4],c[5]=a[5],c[6]=a[6],c[7]=a[7],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=v*g-O*f,c[1]=T*g-W*f,c[2]=C*g-q*f,c[3]=k*g-$*f,c[8]=v*f+O*g,c[9]=T*f+W*g,c[10]=C*f+q*g,c[11]=k*f+$*g,c}function pk(c,a){return c[0]=a[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=a[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=a[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function mk(c,a,u){var f,g,v,T=u[0],C=u[1],k=u[2],O=Math.hypot(T,C,k);return O<J1?null:(T*=O=1/O,C*=O,k*=O,f=Math.sin(a),g=Math.cos(a),c[0]=T*T*(v=1-g)+g,c[1]=C*T*v+k*f,c[2]=k*T*v-C*f,c[3]=0,c[4]=T*C*v-k*f,c[5]=C*C*v+g,c[6]=k*C*v+T*f,c[7]=0,c[8]=T*k*v+C*f,c[9]=C*k*v-T*f,c[10]=k*k*v+g,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,a=arguments.length;a--;)c+=arguments[a]*arguments[a];return Math.sqrt(c)});var YG=fm;function MT(){var c=new Va(3);return Va!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function gk(c){var a=new Va(3);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a}function y0(c){return Math.hypot(c[0],c[1],c[2])}function Kg(c,a,u){var f=new Va(3);return f[0]=c,f[1]=a,f[2]=u,f}function dd(c,a,u){return c[0]=a[0]+u[0],c[1]=a[1]+u[1],c[2]=a[2]+u[2],c}function TT(c,a,u){return c[0]=a[0]-u[0],c[1]=a[1]-u[1],c[2]=a[2]-u[2],c}function _k(c,a,u){return c[0]=a[0]*u[0],c[1]=a[1]*u[1],c[2]=a[2]*u[2],c}function x0(c,a,u){return c[0]=Math.min(a[0],u[0]),c[1]=Math.min(a[1],u[1]),c[2]=Math.min(a[2],u[2]),c}function v0(c,a,u){return c[0]=Math.max(a[0],u[0]),c[1]=Math.max(a[1],u[1]),c[2]=Math.max(a[2],u[2]),c}function Tl(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c}function w0(c,a,u,f){return c[0]=a[0]+u[0]*f,c[1]=a[1]+u[1]*f,c[2]=a[2]+u[2]*f,c}function Jo(c,a){var u=a[0],f=a[1],g=a[2],v=u*u+f*f+g*g;return v>0&&(v=1/Math.sqrt(v)),c[0]=a[0]*v,c[1]=a[1]*v,c[2]=a[2]*v,c}function sc(c,a){return c[0]*a[0]+c[1]*a[1]+c[2]*a[2]}function ET(c,a,u){var f=a[0],g=a[1],v=a[2],T=u[0],C=u[1],k=u[2];return c[0]=g*k-v*C,c[1]=v*T-f*k,c[2]=f*C-g*T,c}function $r(c,a,u){var f=a[0],g=a[1],v=a[2],T=u[3]*f+u[7]*g+u[11]*v+u[15];return c[0]=(u[0]*f+u[4]*g+u[8]*v+u[12])/(T=T||1),c[1]=(u[1]*f+u[5]*g+u[9]*v+u[13])/T,c[2]=(u[2]*f+u[6]*g+u[10]*v+u[14])/T,c}function yk(c,a,u){var f=u[0],g=u[1],v=u[2],T=a[0],C=a[1],k=a[2],O=g*k-v*C,W=v*T-f*k,q=f*C-g*T,$=g*q-v*W,J=v*O-f*q,ie=f*W-g*O,ue=2*u[3];return W*=ue,q*=ue,J*=2,ie*=2,c[0]=T+(O*=ue)+($*=2),c[1]=C+W+J,c[2]=k+q+ie,c}var b0,uu=TT,KG=_k,JG=y0;function xk(c,a,u){return c[0]=a[0]*u,c[1]=a[1]*u,c[2]=a[2]*u,c[3]=a[3]*u,c}function vk(c,a){var u=a[0],f=a[1],g=a[2],v=a[3],T=u*u+f*f+g*g+v*v;return T>0&&(T=1/Math.sqrt(T)),c[0]=u*T,c[1]=f*T,c[2]=g*T,c[3]=v*T,c}function mm(c,a,u){var f=a[0],g=a[1],v=a[2],T=a[3];return c[0]=u[0]*f+u[4]*g+u[8]*v+u[12]*T,c[1]=u[1]*f+u[5]*g+u[9]*v+u[13]*T,c[2]=u[2]*f+u[6]*g+u[10]*v+u[14]*T,c[3]=u[3]*f+u[7]*g+u[11]*v+u[15]*T,c}function wk(){var c=new Va(4);return Va!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function bk(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function Sk(c,a,u){u*=.5;var f=a[0],g=a[1],v=a[2],T=a[3],C=Math.sin(u),k=Math.cos(u);return c[0]=f*k+T*C,c[1]=g*k+v*C,c[2]=v*k-g*C,c[3]=T*k-f*C,c}function Mk(c,a,u){u*=.5;var f=a[0],g=a[1],v=a[2],T=a[3],C=Math.sin(u),k=Math.cos(u);return c[0]=f*k-v*C,c[1]=g*k+T*C,c[2]=v*k+f*C,c[3]=T*k-g*C,c}MT(),b0=new Va(4),Va!=Float32Array&&(b0[0]=0,b0[1]=0,b0[2]=0,b0[3]=0);var QG=vk;MT(),Kg(1,0,0),Kg(0,1,0),wk(),wk(),dk();class AT{constructor(a,u){this.pos=a,this.dir=u}intersectsPlane(a,u,f){const g=sc(u,this.dir);if(Math.abs(g)<1e-6)return!1;const v=((a[0]-this.pos[0])*u[0]+(a[1]-this.pos[1])*u[1]+(a[2]-this.pos[2])*u[2])/g;return f[0]=this.pos[0]+this.dir[0]*v,f[1]=this.pos[1]+this.dir[1]*v,f[2]=this.pos[2]+this.dir[2]*v,!0}closestPointOnSphere(a,u,f){if(function(J,ie){var ue=J[0],ge=J[1],Re=J[2],je=ie[0],ke=ie[1],Ge=ie[2];return Math.abs(ue-je)<=J1*Math.max(1,Math.abs(ue),Math.abs(je))&&Math.abs(ge-ke)<=J1*Math.max(1,Math.abs(ge),Math.abs(ke))&&Math.abs(Re-Ge)<=J1*Math.max(1,Math.abs(Re),Math.abs(Ge))}(this.pos,a)||u===0)return f[0]=f[1]=f[2]=0,!1;const[g,v,T]=this.dir,C=this.pos[0]-a[0],k=this.pos[1]-a[1],O=this.pos[2]-a[2],W=g*g+v*v+T*T,q=2*(C*g+k*v+O*T),$=q*q-4*W*(C*C+k*k+O*O-u*u);if($<0){const J=Math.max(-q/2,0),ie=C+g*J,ue=k+v*J,ge=O+T*J,Re=Math.hypot(ie,ue,ge);return f[0]=ie*u/Re,f[1]=ue*u/Re,f[2]=ge*u/Re,!1}{const J=(-q-Math.sqrt($))/(2*W);if(J<0){const ie=Math.hypot(C,k,O);return f[0]=C*u/ie,f[1]=k*u/ie,f[2]=O*u/ie,!1}return f[0]=C+g*J,f[1]=k+v*J,f[2]=O+T*J,!0}}}class CT{constructor(a,u,f,g,v){this.TL=a,this.TR=u,this.BR=f,this.BL=g,this.horizon=v}static fromInvProjectionMatrix(a,u,f){const g=[-1,1,1],v=[1,1,1],T=[1,-1,1],C=[-1,-1,1],k=$r(g,g,a),O=$r(v,v,a),W=$r(T,T,a),q=$r(C,C,a);return new CT(k,O,W,q,u/f)}}class IT{constructor(a,u){this.points=a,this.planes=u}static fromInvProjectionMatrix(a,u,f,g){const v=Math.pow(2,f),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(k=>{const O=mm([],k,a),W=1/O[3]/u*v;return function(q,$,J){return q[0]=$[0]*J[0],q[1]=$[1]*J[1],q[2]=$[2]*J[2],q[3]=$[3]*J[3],q}(O,O,[W,W,g?1/O[3]:W,W])}),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(k=>{const O=Jo([],ET([],uu([],T[k[0]],T[k[1]]),uu([],T[k[2]],T[k[1]]))),W=-sc(O,T[k[1]]);return O.concat(W)});return new IT(T,C)}}class Qo{static fromPoints(a){const u=[1/0,1/0,1/0],f=[-1/0,-1/0,-1/0];for(const g of a)x0(u,u,g),v0(f,f,g);return new Qo(u,f)}static applyTransform(a,u){const f=a.getCorners();for(let g=0;g<f.length;++g)$r(f[g],f[g],u);return Qo.fromPoints(f)}constructor(a,u){this.min=a,this.max=u,this.center=Tl([],dd([],this.min,this.max),.5)}quadrant(a){const u=[a%2==0,a<2],f=gk(this.min),g=gk(this.max);for(let v=0;v<u.length;v++)f[v]=u[v]?this.min[v]:this.center[v],g[v]=u[v]?this.center[v]:this.max[v];return g[2]=this.max[2],new Qo(f,g)}distanceX(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]}distanceY(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]}distanceZ(a){return Math.max(Math.min(this.max[2],a[2]),this.min[2])-a[2]}getCorners(){const a=this.min,u=this.max;return[[a[0],a[1],a[2]],[u[0],a[1],a[2]],[u[0],u[1],a[2]],[a[0],u[1],a[2]],[a[0],a[1],u[2]],[u[0],a[1],u[2]],[u[0],u[1],u[2]],[a[0],u[1],u[2]]]}intersects(a){const u=this.getCorners();let f=!0;for(let g=0;g<a.planes.length;g++){const v=a.planes[g];let T=0;for(let C=0;C<u.length;C++)T+=sc(v,u[C])+v[3]>=0;if(T===0)return 0;T!==u.length&&(f=!1)}if(f)return 2;for(let g=0;g<3;g++){let v=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let C=0;C<a.points.length;C++){const k=a.points[C][g]-this.min[g];v=Math.min(v,k),T=Math.max(T,k)}if(T<0||v>this.max[g]-this.min[g])return 0}return 1}}function Tk(c,a,u,f,g,v,T,C,k){if(v&&c.queryGeometry.isAboveHorizon)return!1;v&&(k*=c.pixelToTileUnitsFactor);const O=c.tileID.canonical,W=u.projection.upVectorScale(O,u.center.lat,u.worldSize).metersToTile;for(const q of a)for(const $ of q){const J=$.add(C),ie=g&&u.elevation?u.elevation.exaggeration()*g.getElevationAt(J.x,J.y,!0):0,ue=u.projection.projectTilePoint(J.x,J.y,O);if(ie>0){const ke=u.projection.upVector(O,J.x,J.y);ue.x+=ke[0]*W*ie,ue.y+=ke[1]*W*ie,ue.z+=ke[2]*W*ie}const ge=v?J:e8(ue.x,ue.y,ue.z,f),Re=v?c.tilespaceRays.map(ke=>n8(ke,ie)):c.queryGeometry.screenGeometry,je=mm([],[ue.x,ue.y,ue.z,1],f);if(!T&&v?k*=je[3]/u.cameraToCenterDistance:T&&!v&&(k*=u.cameraToCenterDistance/je[3]),v){const ke=Hi(($.y/te+O.y)/(1<<O.z));k/=u.projection.pixelsPerMeter(ke,1)/Ii(1,ke)}if(HG(Re,ge,k))return!0}return!1}function e8(c,a,u,f){const g=mm([],[c,a,u,1],f);return new j(g[0]/g[3],g[1]/g[3])}const Ek=Kg(0,0,0),t8=Kg(0,0,1);function n8(c,a){const u=MT();return Ek[2]=a,c.intersectsPlane(Ek,t8,u),new j(u[0],u[1])}class Ak extends xT{}function Ck(c,{width:a,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==a*u*f)throw new RangeError("mismatched image size")}else g=new Uint8Array(a*u*f);return c.width=a,c.height=u,c.data=g,c}function Ik(c,a,u){const{width:f,height:g}=a;f===c.width&&g===c.height||(PT(c,a,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,f),height:Math.min(c.height,g)},u),c.width=f,c.height=g,c.data=a.data)}function PT(c,a,u,f,g,v){if(g.width===0||g.height===0)return a;if(g.width>c.width||g.height>c.height||u.x>c.width-g.width||u.y>c.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>a.width||g.height>a.height||f.x>a.width-g.width||f.y>a.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const T=c.data,C=a.data;for(let k=0;k<g.height;k++){const O=((u.y+k)*c.width+u.x)*v,W=((f.y+k)*a.width+f.x)*v;for(let q=0;q<g.width*v;q++)C[W+q]=T[O+q]}return a}dn(Ak,"HeatmapBucket",{omit:["layers"]});class fd{constructor(a,u){Ck(this,a,1,u)}resize(a){Ik(this,new fd(a),1)}clone(){return new fd({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,v){PT(a,u,f,g,v,1)}}class Ga{constructor(a,u){Ck(this,a,4,u)}resize(a){Ik(this,new Ga(a),4)}replace(a,u){u?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new Ga({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,u,f,g,v){PT(a,u,f,g,v,4)}}dn(fd,"AlphaImage"),dn(Ga,"RGBAImage");var i8={paint:new mn({"heatmap-radius":new at(wt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new at(wt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ye(wt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Qt(wt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ye(wt.paint_heatmap["heatmap-opacity"])})};function LT(c){const a={},u=c.resolution||256,f=c.clips?c.clips.length:1,g=c.image||new Ga({width:u,height:f}),v=(T,C,k)=>{a[c.evaluationKey]=k;const O=c.expression.evaluate(a);g.data[T+C+0]=Math.floor(255*O.r/O.a),g.data[T+C+1]=Math.floor(255*O.g/O.a),g.data[T+C+2]=Math.floor(255*O.b/O.a),g.data[T+C+3]=Math.floor(255*O.a)};if(c.clips)for(let T=0,C=0;T<f;++T,C+=4*u)for(let k=0,O=0;k<u;k++,O+=4){const W=k/(u-1),{start:q,end:$}=c.clips[T];v(C,O,q*(1-W)+$*W)}else for(let T=0,C=0;T<u;T++,C+=4)v(0,C,T/(u-1));return g}var r8={paint:new mn({"hillshade-illumination-direction":new Ye(wt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ye(wt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ye(wt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ye(wt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ye(wt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ye(wt.paint_hillshade["hillshade-accent-color"])})};const s8=an([{name:"a_pos",components:2,type:"Int16"}],4),{members:o8}=s8;var S0={exports:{}};function ew(c,a,u){u=u||2;var f,g,v,T,C,k,O,W=a&&a.length,q=W?a[0]*u:c.length,$=Pk(c,0,q,u,!0),J=[];if(!$||$.next===$.prev)return J;if(W&&($=function(ue,ge,Re,je){var ke,Ge,$e,qe=[];for(ke=0,Ge=ge.length;ke<Ge;ke++)($e=Pk(ue,ge[ke]*je,ke<Ge-1?ge[ke+1]*je:ue.length,je,!1))===$e.next&&($e.steiner=!0),qe.push(p8($e));for(qe.sort(h8),ke=0;ke<qe.length;ke++)Re=d8(qe[ke],Re);return Re}(c,a,$,u)),c.length>80*u){f=v=c[0],g=T=c[1];for(var ie=u;ie<q;ie+=u)(C=c[ie])<f&&(f=C),(k=c[ie+1])<g&&(g=k),C>v&&(v=C),k>T&&(T=k);O=(O=Math.max(v-f,T-g))!==0?32767/O:0}return M0($,J,u,f,g,O,0),J}function Pk(c,a,u,f,g){var v,T;if(g===RT(c,a,u,f)>0)for(v=a;v<u;v+=f)T=Dk(v,c[v],c[v+1],T);else for(v=u-f;v>=a;v-=f)T=Dk(v,c[v],c[v+1],T);return T&&tw(T,T.next)&&(E0(T),T=T.next),T}function gm(c,a){if(!c)return c;a||(a=c);var u,f=c;do if(u=!1,f.steiner||!tw(f,f.next)&&ss(f.prev,f,f.next)!==0)f=f.next;else{if(E0(f),(f=a=f.prev)===f.next)break;u=!0}while(u||f!==a);return a}function M0(c,a,u,f,g,v,T){if(c){!T&&v&&function(W,q,$,J){var ie=W;do ie.z===0&&(ie.z=kT(ie.x,ie.y,q,$,J)),ie.prevZ=ie.prev,ie.nextZ=ie.next,ie=ie.next;while(ie!==W);ie.prevZ.nextZ=null,ie.prevZ=null,function(ue){var ge,Re,je,ke,Ge,$e,qe,dt,ut=1;do{for(Re=ue,ue=null,Ge=null,$e=0;Re;){for($e++,je=Re,qe=0,ge=0;ge<ut&&(qe++,je=je.nextZ);ge++);for(dt=ut;qe>0||dt>0&&je;)qe!==0&&(dt===0||!je||Re.z<=je.z)?(ke=Re,Re=Re.nextZ,qe--):(ke=je,je=je.nextZ,dt--),Ge?Ge.nextZ=ke:ue=ke,ke.prevZ=Ge,Ge=ke;Re=je}Ge.nextZ=null,ut*=2}while($e>1)}(ie)}(c,f,g,v);for(var C,k,O=c;c.prev!==c.next;)if(C=c.prev,k=c.next,v?l8(c,f,g,v):a8(c))a.push(C.i/u|0),a.push(c.i/u|0),a.push(k.i/u|0),E0(c),c=k.next,O=k.next;else if((c=k)===O){T?T===1?M0(c=c8(gm(c),a,u),a,u,f,g,v,2):T===2&&u8(c,a,u,f,g,v):M0(gm(c),a,u,f,g,v,1);break}}}function a8(c){var a=c.prev,u=c,f=c.next;if(ss(a,u,f)>=0)return!1;for(var g=a.x,v=u.x,T=f.x,C=a.y,k=u.y,O=f.y,W=g<v?g<T?g:T:v<T?v:T,q=C<k?C<O?C:O:k<O?k:O,$=g>v?g>T?g:T:v>T?v:T,J=C>k?C>O?C:O:k>O?k:O,ie=f.next;ie!==a;){if(ie.x>=W&&ie.x<=$&&ie.y>=q&&ie.y<=J&&Jg(g,C,v,k,T,O,ie.x,ie.y)&&ss(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function l8(c,a,u,f){var g=c.prev,v=c,T=c.next;if(ss(g,v,T)>=0)return!1;for(var C=g.x,k=v.x,O=T.x,W=g.y,q=v.y,$=T.y,J=C<k?C<O?C:O:k<O?k:O,ie=W<q?W<$?W:$:q<$?q:$,ue=C>k?C>O?C:O:k>O?k:O,ge=W>q?W>$?W:$:q>$?q:$,Re=kT(J,ie,a,u,f),je=kT(ue,ge,a,u,f),ke=c.prevZ,Ge=c.nextZ;ke&&ke.z>=Re&&Ge&&Ge.z<=je;){if(ke.x>=J&&ke.x<=ue&&ke.y>=ie&&ke.y<=ge&&ke!==g&&ke!==T&&Jg(C,W,k,q,O,$,ke.x,ke.y)&&ss(ke.prev,ke,ke.next)>=0||(ke=ke.prevZ,Ge.x>=J&&Ge.x<=ue&&Ge.y>=ie&&Ge.y<=ge&&Ge!==g&&Ge!==T&&Jg(C,W,k,q,O,$,Ge.x,Ge.y)&&ss(Ge.prev,Ge,Ge.next)>=0))return!1;Ge=Ge.nextZ}for(;ke&&ke.z>=Re;){if(ke.x>=J&&ke.x<=ue&&ke.y>=ie&&ke.y<=ge&&ke!==g&&ke!==T&&Jg(C,W,k,q,O,$,ke.x,ke.y)&&ss(ke.prev,ke,ke.next)>=0)return!1;ke=ke.prevZ}for(;Ge&&Ge.z<=je;){if(Ge.x>=J&&Ge.x<=ue&&Ge.y>=ie&&Ge.y<=ge&&Ge!==g&&Ge!==T&&Jg(C,W,k,q,O,$,Ge.x,Ge.y)&&ss(Ge.prev,Ge,Ge.next)>=0)return!1;Ge=Ge.nextZ}return!0}function c8(c,a,u){var f=c;do{var g=f.prev,v=f.next.next;!tw(g,v)&&Lk(g,f,f.next,v)&&T0(g,v)&&T0(v,g)&&(a.push(g.i/u|0),a.push(f.i/u|0),a.push(v.i/u|0),E0(f),E0(f.next),f=c=v),f=f.next}while(f!==c);return gm(f)}function u8(c,a,u,f,g,v){var T=c;do{for(var C=T.next.next;C!==T.prev;){if(T.i!==C.i&&m8(T,C)){var k=kk(T,C);return T=gm(T,T.next),k=gm(k,k.next),M0(T,a,u,f,g,v,0),void M0(k,a,u,f,g,v,0)}C=C.next}T=T.next}while(T!==c)}function h8(c,a){return c.x-a.x}function d8(c,a){var u=function(g,v){var T,C=v,k=g.x,O=g.y,W=-1/0;do{if(O<=C.y&&O>=C.next.y&&C.next.y!==C.y){var q=C.x+(O-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(q<=k&&q>W&&(W=q,T=C.x<C.next.x?C:C.next,q===k))return T}C=C.next}while(C!==v);if(!T)return null;var $,J=T,ie=T.x,ue=T.y,ge=1/0;C=T;do k>=C.x&&C.x>=ie&&k!==C.x&&Jg(O<ue?k:W,O,ie,ue,O<ue?W:k,O,C.x,C.y)&&($=Math.abs(O-C.y)/(k-C.x),T0(C,g)&&($<ge||$===ge&&(C.x>T.x||C.x===T.x&&f8(T,C)))&&(T=C,ge=$)),C=C.next;while(C!==J);return T}(c,a);if(!u)return a;var f=kk(u,c);return gm(f,f.next),gm(u,u.next)}function f8(c,a){return ss(c.prev,c,a.prev)<0&&ss(a.next,c,c.next)<0}function kT(c,a,u,f,g){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-u)*g|0)|c<<8))|c<<4))|c<<2))|c<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-f)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function p8(c){var a=c,u=c;do(a.x<u.x||a.x===u.x&&a.y<u.y)&&(u=a),a=a.next;while(a!==c);return u}function Jg(c,a,u,f,g,v,T,C){return(g-T)*(a-C)>=(c-T)*(v-C)&&(c-T)*(f-C)>=(u-T)*(a-C)&&(u-T)*(v-C)>=(g-T)*(f-C)}function m8(c,a){return c.next.i!==a.i&&c.prev.i!==a.i&&!function(u,f){var g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&Lk(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(c,a)&&(T0(c,a)&&T0(a,c)&&function(u,f){var g=u,v=!1,T=(u.x+f.x)/2,C=(u.y+f.y)/2;do g.y>C!=g.next.y>C&&g.next.y!==g.y&&T<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(v=!v),g=g.next;while(g!==u);return v}(c,a)&&(ss(c.prev,c,a.prev)||ss(c,a.prev,a))||tw(c,a)&&ss(c.prev,c,c.next)>0&&ss(a.prev,a,a.next)>0)}function ss(c,a,u){return(a.y-c.y)*(u.x-a.x)-(a.x-c.x)*(u.y-a.y)}function tw(c,a){return c.x===a.x&&c.y===a.y}function Lk(c,a,u,f){var g=iw(ss(c,a,u)),v=iw(ss(c,a,f)),T=iw(ss(u,f,c)),C=iw(ss(u,f,a));return g!==v&&T!==C||!(g!==0||!nw(c,u,a))||!(v!==0||!nw(c,f,a))||!(T!==0||!nw(u,c,f))||!(C!==0||!nw(u,a,f))}function nw(c,a,u){return a.x<=Math.max(c.x,u.x)&&a.x>=Math.min(c.x,u.x)&&a.y<=Math.max(c.y,u.y)&&a.y>=Math.min(c.y,u.y)}function iw(c){return c>0?1:c<0?-1:0}function T0(c,a){return ss(c.prev,c,c.next)<0?ss(c,a,c.next)>=0&&ss(c,c.prev,a)>=0:ss(c,a,c.prev)<0||ss(c,c.next,a)<0}function kk(c,a){var u=new DT(c.i,c.x,c.y),f=new DT(a.i,a.x,a.y),g=c.next,v=a.prev;return c.next=a,a.prev=c,u.next=g,g.prev=u,f.next=u,u.prev=f,v.next=f,f.prev=v,f}function Dk(c,a,u,f){var g=new DT(c,a,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function E0(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function DT(c,a,u){this.i=c,this.x=a,this.y=u,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function RT(c,a,u,f){for(var g=0,v=a,T=u-f;v<u;v+=f)g+=(c[T]-c[v])*(c[v+1]+c[T+1]),T=v;return g}function g8(c,a,u,f,g){Rk(c,a,u||0,f||c.length-1,g||_8)}function Rk(c,a,u,f,g){for(;f>u;){if(f-u>600){var v=f-u+1,T=a-u+1,C=Math.log(v),k=.5*Math.exp(2*C/3),O=.5*Math.sqrt(C*k*(v-k)/v)*(T-v/2<0?-1:1);Rk(c,a,Math.max(u,Math.floor(a-T*k/v+O)),Math.min(f,Math.floor(a+(v-T)*k/v+O)),g)}var W=c[a],q=u,$=f;for(A0(c,u,a),g(c[f],W)>0&&A0(c,u,f);q<$;){for(A0(c,q,$),q++,$--;g(c[q],W)<0;)q++;for(;g(c[$],W)>0;)$--}g(c[u],W)===0?A0(c,u,$):A0(c,++$,f),$<=a&&(u=$+1),a<=$&&(f=$-1)}}function A0(c,a,u){var f=c[a];c[a]=c[u],c[u]=f}function _8(c,a){return c<a?-1:c>a?1:0}function zT(c,a){const u=c.length;if(u<=1)return[c];const f=[];let g,v;for(let T=0;T<u;T++){const C=Ft(c[T]);C!==0&&(c[T].area=Math.abs(C),v===void 0&&(v=C<0),v===C<0?(g&&f.push(g),g=[c[T]]):g.push(c[T]))}if(g&&f.push(g),a>1)for(let T=0;T<f.length;T++)f[T].length<=a||(g8(f[T],a,1,f[T].length-1,y8),f[T]=f[T].slice(0,a));return f}function y8(c,a){return a.area-c.area}function OT(c,a,u){const f=u.patternDependencies;let g=!1;for(const v of a){const T=v.paint.get(`${c}-pattern`);T.isConstant()||(g=!0);const C=T.constantOr(null);C&&(g=!0,f[C]=!0)}return g}function FT(c,a,u,f,g){const v=g.patternDependencies;for(const T of a){const C=T.paint.get(`${c}-pattern`).value;if(C.kind!=="constant"){let k=C.evaluate({zoom:f},u,{},g.availableImages);k=k&&k.name?k.name:k,v[k]=!0,u.patterns[T.id]=k}}return u}S0.exports=ew,S0.exports.default=ew,ew.deviation=function(c,a,u,f){var g=a&&a.length,v=Math.abs(RT(c,0,g?a[0]*u:c.length,u));if(g)for(var T=0,C=a.length;T<C;T++)v-=Math.abs(RT(c,a[T]*u,T<C-1?a[T+1]*u:c.length,u));var k=0;for(T=0;T<f.length;T+=3){var O=f[T]*u,W=f[T+1]*u,q=f[T+2]*u;k+=Math.abs((c[O]-c[q])*(c[W+1]-c[O+1])-(c[O]-c[W])*(c[q+1]-c[O+1]))}return v===0&&k===0?0:Math.abs((k-v)/v)},ew.flatten=function(c){for(var a=c[0][0].length,u={vertices:[],holes:[],dimensions:a},f=0,g=0;g<c.length;g++){for(var v=0;v<c[g].length;v++)for(var T=0;T<a;T++)u.vertices.push(c[g][v][T]);g>0&&u.holes.push(f+=c[g-1].length)}return u};class rw{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new bi,this.indexArray=new Xi,this.indexArray2=new Yo,this.programConfigurations=new ch(a.layers,a.zoom),this.segments=new X,this.segments2=new X,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.projection=a.projection}populate(a,u,f,g){this.hasPattern=OT("fill",this.layers,u);const v=this.layers[0].layout.get("fill-sort-key"),T=[];for(const{feature:C,id:k,index:O,sourceLayerIndex:W}of a){const q=this.layers[0]._featureFilter.needGeometry,$=hd(C,q);if(!this.layers[0]._featureFilter.filter(new it(this.zoom),$,f))continue;const J=v?v.evaluate($,{},f,u.availableImages):void 0,ie={id:k,properties:C.properties,type:C.type,sourceLayerIndex:W,index:O,geometry:q?$.geometry:wo(C,f,g),patterns:{},sortKey:J};T.push(ie)}v&&T.sort((C,k)=>C.sortKey-k.sortKey);for(const C of T){const{geometry:k,index:O,sourceLayerIndex:W}=C;if(this.hasPattern){const q=FT("fill",this.layers,C,this.zoom,u);this.patternFeatures.push(q)}else this.addFeature(C,k,O,f,{},u.availableImages);u.featureIndex.insert(a[O].feature,k,O,W,this.index)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,o8),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,u,f,g,v,T=[]){for(const C of zT(u,500)){let k=0;for(const ie of C)k+=ie.length;const O=this.segments.prepareSegment(k,this.layoutVertexArray,this.indexArray),W=O.vertexLength,q=[],$=[];for(const ie of C){if(ie.length===0)continue;ie!==C[0]&&$.push(q.length/2);const ue=this.segments2.prepareSegment(ie.length,this.layoutVertexArray,this.indexArray2),ge=ue.vertexLength;this.layoutVertexArray.emplaceBack(ie[0].x,ie[0].y),this.indexArray2.emplaceBack(ge+ie.length-1,ge),q.push(ie[0].x),q.push(ie[0].y);for(let Re=1;Re<ie.length;Re++)this.layoutVertexArray.emplaceBack(ie[Re].x,ie[Re].y),this.indexArray2.emplaceBack(ge+Re-1,ge+Re),q.push(ie[Re].x),q.push(ie[Re].y);ue.vertexLength+=ie.length,ue.primitiveLength+=ie.length}const J=S0.exports(q,$);for(let ie=0;ie<J.length;ie+=3)this.indexArray.emplaceBack(W+J[ie],W+J[ie+1],W+J[ie+2]);O.vertexLength+=k,O.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,v,T,g)}}dn(rw,"FillBucket",{omit:["layers","patternFeatures"]});const x8=new mn({"fill-sort-key":new at(wt.layout_fill["fill-sort-key"])});var v8={paint:new mn({"fill-antialias":new Ye(wt.paint_fill["fill-antialias"]),"fill-opacity":new at(wt.paint_fill["fill-opacity"]),"fill-color":new at(wt.paint_fill["fill-color"]),"fill-outline-color":new at(wt.paint_fill["fill-outline-color"]),"fill-translate":new Ye(wt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ye(wt.paint_fill["fill-translate-anchor"]),"fill-pattern":new at(wt.paint_fill["fill-pattern"])}),layout:x8};const w8=an([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),b8=an([{name:"a_centroid_pos",components:2,type:"Uint16"}]),S8=an([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:M8}=w8;var sw={},T8=j,zk=Qg;function Qg(c,a,u,f,g){this.properties={},this.extent=u,this.type=0,this._pbf=c,this._geometry=-1,this._keys=f,this._values=g,c.readFields(E8,this,a)}function E8(c,a,u){c==1?a.id=u.readVarint():c==2?function(f,g){for(var v=f.readVarint()+f.pos;f.pos<v;){var T=g._keys[f.readVarint()],C=g._values[f.readVarint()];g.properties[T]=C}}(u,a):c==3?a.type=u.readVarint():c==4&&(a._geometry=u.pos)}function A8(c){for(var a,u,f=0,g=0,v=c.length,T=v-1;g<v;T=g++)f+=((u=c[T]).x-(a=c[g]).x)*(a.y+u.y);return f}Qg.types=["Unknown","Point","LineString","Polygon"],Qg.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var a,u=c.readVarint()+c.pos,f=1,g=0,v=0,T=0,C=[];c.pos<u;){if(g<=0){var k=c.readVarint();f=7&k,g=k>>3}if(g--,f===1||f===2)v+=c.readSVarint(),T+=c.readSVarint(),f===1&&(a&&C.push(a),a=[]),a.push(new T8(v,T));else{if(f!==7)throw new Error("unknown command "+f);a&&a.push(a[0].clone())}}return a&&C.push(a),C},Qg.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var a=c.readVarint()+c.pos,u=1,f=0,g=0,v=0,T=1/0,C=-1/0,k=1/0,O=-1/0;c.pos<a;){if(f<=0){var W=c.readVarint();u=7&W,f=W>>3}if(f--,u===1||u===2)(g+=c.readSVarint())<T&&(T=g),g>C&&(C=g),(v+=c.readSVarint())<k&&(k=v),v>O&&(O=v);else if(u!==7)throw new Error("unknown command "+u)}return[T,k,C,O]},Qg.prototype.toGeoJSON=function(c,a,u){var f,g,v=this.extent*Math.pow(2,u),T=this.extent*c,C=this.extent*a,k=this.loadGeometry(),O=Qg.types[this.type];function W(J){for(var ie=0;ie<J.length;ie++){var ue=J[ie];J[ie]=[360*(ue.x+T)/v-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+C)/v)*Math.PI/180))-90]}}switch(this.type){case 1:var q=[];for(f=0;f<k.length;f++)q[f]=k[f][0];W(k=q);break;case 2:for(f=0;f<k.length;f++)W(k[f]);break;case 3:for(k=function(J){var ie=J.length;if(ie<=1)return[J];for(var ue,ge,Re=[],je=0;je<ie;je++){var ke=A8(J[je]);ke!==0&&(ge===void 0&&(ge=ke<0),ge===ke<0?(ue&&Re.push(ue),ue=[J[je]]):ue.push(J[je]))}return ue&&Re.push(ue),Re}(k),f=0;f<k.length;f++)for(g=0;g<k[f].length;g++)W(k[f][g])}k.length===1?k=k[0]:O="Multi"+O;var $={type:"Feature",geometry:{type:O,coordinates:k},properties:this.properties};return"id"in this&&($.id=this.id),$};var C8=zk,Ok=Fk;function Fk(c,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(I8,this,a),this.length=this._features.length}function I8(c,a,u){c===15?a.version=u.readVarint():c===1?a.name=u.readString():c===5?a.extent=u.readVarint():c===2?a._features.push(u.pos):c===3?a._keys.push(u.readString()):c===4&&a._values.push(function(f){for(var g=null,v=f.readVarint()+f.pos;f.pos<v;){var T=f.readVarint()>>3;g=T===1?f.readString():T===2?f.readFloat():T===3?f.readDouble():T===4?f.readVarint64():T===5?f.readVarint():T===6?f.readSVarint():T===7?f.readBoolean():null}return g}(u))}Fk.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var a=this._pbf.readVarint()+this._pbf.pos;return new C8(this._pbf,a,this.extent,this._keys,this._values)};var P8=Ok;function L8(c,a,u){if(c===3){var f=new P8(u,u.readVarint()+u.pos);f.length&&(a[f.name]=f)}}var BT=sw.VectorTile=function(c,a){this.layers=c.readFields(L8,{},a)},ow=sw.VectorTileFeature=zk;function aw(c,a,u,f){const g=[],v=f===0?(T,C,k,O,W,q)=>{T.push(new j(q,k+(q-C)/(O-C)*(W-k)))}:(T,C,k,O,W,q)=>{T.push(new j(C+(q-k)/(W-k)*(O-C),q))};for(const T of c){const C=[];for(const k of T){if(k.length<=2)continue;const O=[];for(let $=0;$<k.length-1;$++){const J=k[$].x,ie=k[$].y,ue=k[$+1].x,ge=k[$+1].y,Re=f===0?J:ie,je=f===0?ue:ge;Re<a?je>a&&v(O,J,ie,ue,ge,a):Re>u?je<u&&v(O,J,ie,ue,ge,u):O.push(k[$]),je<a&&Re>=a&&v(O,J,ie,ue,ge,a),je>u&&Re<=u&&v(O,J,ie,ue,ge,u)}let W=k[k.length-1];const q=f===0?W.x:W.y;q>=a&&q<=u&&O.push(W),O.length&&(W=O[O.length-1],O[0].x===W.x&&O[0].y===W.y||O.push(O[0]),C.push(O))}C.length&&g.push(C)}return g}sw.VectorTileLayer=Ok;const k8=ow.types,D8=Math.pow(2,13);function C0(c,a,u,f,g,v,T,C){c.emplaceBack((a<<1)+T,(u<<1)+v,(Math.floor(f*D8)<<1)+g,Math.round(C))}function I0(c,a,u){c.emplaceBack(a.x,a.y,a.z,u[0]*16384,u[1]*16384,u[2]*16384)}class Bk{constructor(){this.acc=new j(0,0),this.polyCount=[]}startRing(a){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new j(a.x,a.y),this.max=new j(a.x,a.y))}append(a,u){this.currentPolyCount.edges++,this.acc._add(a);const f=this.min,g=this.max;a.x<f.x?f.x=a.x:a.x>g.x&&(g.x=a.x),a.y<f.y?f.y=a.y:a.y>g.y&&(g.y=a.y),((a.x===0||a.x===te)&&a.x===u.x)!=((a.y===0||a.y===te)&&a.y===u.y)&&this.processBorderOverlap(a,u),u.x<0!=a.x<0&&this.addBorderIntersection(0,di(u.y,a.y,(0-u.x)/(a.x-u.x))),u.x>te!=a.x>te&&this.addBorderIntersection(1,di(u.y,a.y,(te-u.x)/(a.x-u.x))),u.y<0!=a.y<0&&this.addBorderIntersection(2,di(u.x,a.x,(0-u.y)/(a.y-u.y))),u.y>te!=a.y>te&&this.addBorderIntersection(3,di(u.x,a.x,(te-u.y)/(a.y-u.y)))}addBorderIntersection(a,u){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const f=this.borders[a];u<f[0]&&(f[0]=u),u>f[1]&&(f[1]=u)}processBorderOverlap(a,u){if(a.x===u.x){if(a.y===u.y)return;const f=a.x===0?0:1;this.addBorderIntersection(f,u.y),this.addBorderIntersection(f,a.y)}else{const f=a.y===0?2:3;this.addBorderIntersection(f,u.x),this.addBorderIntersection(f,a.x)}}centroid(){const a=this.polyCount.reduce((u,f)=>u+f.edges,0);return a!==0?this.acc.div(a)._round():new j(0,0)}span(){return new j(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((a,u)=>a+ +(u[0]!==Number.MAX_VALUE),0)}}class P0{constructor(a){this.zoom=a.zoom,this.canonical=a.canonical,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=a.projection,this.layoutVertexArray=new si,this.centroidVertexArray=new V1,this.indexArray=new Xi,this.programConfigurations=new ch(a.layers,a.zoom),this.segments=new X,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id),this.enableTerrain=a.enableTerrain}populate(a,u,f,g){this.features=[],this.hasPattern=OT("fill-extrusion",this.layers,u),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(v){const T=Math.exp(Math.PI*(1-v.y/(1<<v.z)*2));return 80150034*T/(T*T+1)/te/(1<<v.z)}(f),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:v,id:T,index:C,sourceLayerIndex:k}of a){const O=this.layers[0]._featureFilter.needGeometry,W=hd(v,O);if(!this.layers[0]._featureFilter.filter(new it(this.zoom),W,f))continue;const q={id:T,sourceLayerIndex:k,index:C,geometry:O?W.geometry:wo(v,f,g),properties:v.properties,type:v.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(FT("fill-extrusion",this.layers,q,this.zoom,u)):this.addFeature(q,q.geometry,C,f,{},u.availableImages,g),u.featureIndex.insert(v,q.geometry,C,k,this.index,$)}this.sortBorders()}addFeatures(a,u,f,g,v){for(const T of this.features){const{geometry:C}=T;this.addFeature(T,C,T.index,u,f,g,v)}this.sortBorders()}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,M8),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=a.createVertexBuffer(this.layoutVertexExtArray,S8.members,!0))),this.programConfigurations.upload(a),this.uploaded=!0}uploadCentroid(a){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,b8.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,u,f,g,v,T,C){const k=[new j(0,0),new j(te,te)],O=C.projection,W=O.name==="globe",q=this.enableTerrain&&!W?new Bk:null,$=k8[a.type]==="Polygon";W&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Zi);const J=zT(u,500);for(let Re=J.length-1;Re>=0;Re--){const je=J[Re];(je.length===0||(ie=je[0]).every(ke=>ke.x<=0)||ie.every(ke=>ke.x>=te)||ie.every(ke=>ke.y<=0)||ie.every(ke=>ke.y>=te))&&J.splice(Re,1)}var ie;let ue;if(W)ue=jk(J,k,g);else{ue=[];for(const Re of J)ue.push({polygon:Re,bounds:k})}const ge=$?this.edgeRadius:0;for(const{polygon:Re,bounds:je}of ue){let ke=0,Ge=0;for(const qe of Re)$&&!qe[0].equals(qe[qe.length-1])&&qe.push(qe[0]),Ge+=$?qe.length-1:qe.length;const $e=this.segments.prepareSegment(($?5:4)*Ge,this.layoutVertexArray,this.indexArray);if($){const qe=[],dt=[];ke=$e.vertexLength;for(const Tt of Re){let Ht,yt;Tt.length&&Tt!==Re[0]&&dt.push(qe.length/2),Ht=Tt[1].sub(Tt[0])._perp()._unit();for(let Pt=1;Pt<Tt.length;Pt++){const Rt=Tt[Pt],Bt=Tt[Pt===Tt.length-1?1:Pt+1];let{x:jt,y:xt}=Rt;if(ge){yt=Bt.sub(Rt)._perp()._unit();const en=Ht.add(yt)._unit(),Wn=ge*Math.min(4,1/(Ht.x*en.x+Ht.y*en.y));jt+=Wn*en.x,xt+=Wn*en.y,Ht=yt}C0(this.layoutVertexArray,jt,xt,0,0,1,1,0),$e.vertexLength++,qe.push(Rt.x,Rt.y),W&&I0(this.layoutVertexExtArray,O.projectTilePoint(jt,xt,g),O.upVector(g,jt,xt))}}const ut=S0.exports(qe,dt);for(let Tt=0;Tt<ut.length;Tt+=3)this.indexArray.emplaceBack(ke+ut[Tt],ke+ut[Tt+2],ke+ut[Tt+1]),$e.primitiveLength++}for(const qe of Re){q&&qe.length&&q.startRing(qe[0]);let dt,ut,Tt,Ht=qe.length>4&&Gk(qe[qe.length-2],qe[0],qe[1]),yt=ge?R8(qe[qe.length-2],qe[0],qe[1],ge):0;ut=qe[1].sub(qe[0])._perp()._unit();let Pt=!0;for(let Rt=1,Bt=0;Rt<qe.length;Rt++){let jt=qe[Rt-1],xt=qe[Rt];const en=qe[Rt===qe.length-1?1:Rt+1];if(q&&$&&q.currentPolyCount.top++,Vk(xt,jt,je)){ge&&(ut=en.sub(xt)._perp()._unit(),Pt=!Pt);continue}q&&q.append(xt,jt);const Wn=xt.sub(jt)._perp(),un=Wn.x/(Math.abs(Wn.x)+Math.abs(Wn.y)),Tn=Wn.y>0?1:0,rn=jt.dist(xt);if(Bt+rn>32768&&(Bt=0),ge){Tt=en.sub(xt)._perp()._unit();let ui=Uk(jt,xt,en,Nk(ut,Tt),ge);isNaN(ui)&&(ui=0);const $n=xt.sub(jt)._unit();jt=jt.add($n.mult(yt))._round(),xt=xt.add($n.mult(-ui))._round(),yt=ui,ut=Tt}const jn=$e.vertexLength,gi=qe.length>4&&Gk(jt,xt,en);let pi=Wk(Bt,Ht,Pt);if(C0(this.layoutVertexArray,jt.x,jt.y,un,Tn,0,0,pi),C0(this.layoutVertexArray,jt.x,jt.y,un,Tn,0,1,pi),Bt+=rn,pi=Wk(Bt,gi,!Pt),Ht=gi,C0(this.layoutVertexArray,xt.x,xt.y,un,Tn,0,0,pi),C0(this.layoutVertexArray,xt.x,xt.y,un,Tn,0,1,pi),$e.vertexLength+=4,this.indexArray.emplaceBack(jn+0,jn+1,jn+2),this.indexArray.emplaceBack(jn+1,jn+3,jn+2),$e.primitiveLength+=2,ge){const ui=ke+(Rt===1?qe.length-2:Rt-2),$n=Rt===1?ke:ui+1;if(this.indexArray.emplaceBack(jn+1,ui,jn+3),this.indexArray.emplaceBack(ui,$n,jn+3),$e.primitiveLength+=2,dt===void 0&&(dt=jn),!Vk(en,qe[Rt],je)){const Yi=Rt===qe.length-1?dt:$e.vertexLength;this.indexArray.emplaceBack(jn+2,jn+3,Yi),this.indexArray.emplaceBack(jn+3,Yi+1,Yi),this.indexArray.emplaceBack(jn+3,$n,Yi+1),$e.primitiveLength+=3}Pt=!Pt}if(W){const ui=this.layoutVertexExtArray,$n=O.projectTilePoint(jt.x,jt.y,g),Yi=O.projectTilePoint(xt.x,xt.y,g),ei=O.upVector(g,jt.x,jt.y),_i=O.upVector(g,xt.x,xt.y);I0(ui,$n,ei),I0(ui,$n,ei),I0(ui,Yi,_i),I0(ui,Yi,_i)}}$&&(ke+=qe.length-1)}}if(q&&q.polyCount.length>0){if(q.borders){q.vertexArrayOffset=this.centroidVertexArray.length;const Re=q.borders,je=this.featuresOnBorder.push(q)-1;for(let ke=0;ke<4;ke++)Re[ke][0]!==Number.MAX_VALUE&&this.borders[ke].push(je)}this.encodeCentroid(q.borders?void 0:q.centroid(),q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,v,T,g)}sortBorders(){for(let a=0;a<4;a++)this.borders[a].sort((u,f)=>this.featuresOnBorder[u].borders[a][0]-this.featuresOnBorder[f].borders[a][0])}encodeCentroid(a,u,f=!0){let g,v;if(a)if(a.y!==0){const C=u.span()._mult(this.tileToMeter);g=(Math.max(a.x,1)<<3)+Math.min(7,Math.round(C.x/10)),v=(Math.max(a.y,1)<<3)+Math.min(7,Math.round(C.y/10))}else g=Math.ceil(7*(a.x+450)),v=0;else g=0,v=+f;let T=f?this.centroidVertexArray.length:u.vertexArrayOffset;for(const C of u.polyCount){f&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*C.edges+C.top);for(let k=0;k<C.top;k++)this.centroidVertexArray.emplace(T++,g,v);for(let k=0;k<2*C.edges;k++)this.centroidVertexArray.emplace(T++,0,v),this.centroidVertexArray.emplace(T++,g,v)}}}function Nk(c,a){const u=c.add(a)._unit();return c.x*u.x+c.y*u.y}function R8(c,a,u,f){const g=a.sub(c)._perp()._unit(),v=u.sub(a)._perp()._unit();return Uk(c,a,u,Nk(g,v),f)}function Uk(c,a,u,f,g){const v=Math.sqrt(1-f*f);return Math.min(c.dist(a)/3,a.dist(u)/3,g*v/f)}function Vk(c,a,u){return c.x<u[0].x&&a.x<u[0].x||c.x>u[1].x&&a.x>u[1].x||c.y<u[0].y&&a.y<u[0].y||c.y>u[1].y&&a.y>u[1].y}function Gk(c,a,u){if(c.x<0||c.x>=te||a.x<0||a.x>=te||u.x<0||u.x>=te)return!1;const f=u.sub(a),g=f.perp(),v=c.sub(a);return(f.x*v.x+f.y*v.y)/Math.sqrt((f.x*f.x+f.y*f.y)*(v.x*v.x+v.y*v.y))>-.866&&g.x*v.x+g.y*v.y<0}function Wk(c,a,u){const f=a?2|c:-3&c;return u?1|f:-2&f}function Hk(){const c=Math.PI/32,a=Math.tan(c),u=st;return u*Math.sqrt(1+2*a*a)-u}function jk(c,a,u){const f=1<<u.z,g=Pn(u.x/f),v=Pn((u.x+1)/f),T=Hi(u.y/f),C=Hi((u.y+1)/f);return function(k,O,W,q,$=0,J){const ie=[];if(!k.length||!W||!q)return ie;const ue=(qe,dt)=>{for(const ut of qe)ie.push({polygon:ut,bounds:dt})},ge=Math.ceil(Math.log2(W)),Re=Math.ceil(Math.log2(q)),je=ge-Re,ke=[];for(let qe=0;qe<Math.abs(je);qe++)ke.push(je>0?0:1);for(let qe=0;qe<Math.min(ge,Re);qe++)ke.push(0),ke.push(1);let Ge=k;if(Ge=aw(Ge,O[0].y-$,O[1].y+$,1),Ge=aw(Ge,O[0].x-$,O[1].x+$,0),!Ge.length)return ie;const $e=[];for(ke.length?$e.push({polygons:Ge,bounds:O,depth:0}):ue(Ge,O);$e.length;){const qe=$e.pop(),dt=qe.depth,ut=ke[dt],Tt=qe.bounds[0],Ht=qe.bounds[1],yt=ut===0?Tt.x:Tt.y,Pt=ut===0?Ht.x:Ht.y,Rt=J?J(ut,yt,Pt):.5*(yt+Pt),Bt=aw(qe.polygons,yt-$,Rt+$,ut),jt=aw(qe.polygons,Rt-$,Pt+$,ut);if(Bt.length){const xt=[Tt,new j(ut===0?Rt:Ht.x,ut===1?Rt:Ht.y)];ke.length>dt+1?$e.push({polygons:Bt,bounds:xt,depth:dt+1}):ue(Bt,xt)}if(jt.length){const xt=[new j(ut===0?Rt:Tt.x,ut===1?Rt:Tt.y),Ht];ke.length>dt+1?$e.push({polygons:jt,bounds:xt,depth:dt+1}):ue(jt,xt)}}return ie}(c,a,Math.ceil((v-g)/11.25),Math.ceil((T-C)/11.25),1,(k,O,W)=>{if(k===0)return .5*(O+W);{const q=Hi((u.y+O/te)/f);return(Gn(.5*(Hi((u.y+W/te)/f)+q))*f-u.y)*te}})}dn(P0,"FillExtrusionBucket",{omit:["layers","features"]}),dn(Bk,"PartMetadata");const z8=new mn({"fill-extrusion-edge-radius":new Ye(wt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var O8={paint:new mn({"fill-extrusion-opacity":new Ye(wt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new at(wt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ye(wt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ye(wt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new at(wt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new at(wt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new at(wt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ye(wt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ye(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ye(wt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:z8};function qk(c,a,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[c*f-2*Math.PI*6378137/2,a*f-2*Math.PI*6378137/2]}class lw{constructor(a,u,f){this.z=a,this.x=u,this.y=f,this.key=L0(0,a,a,u,f)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,u){const f=function(v,T,C){var k=qk(256*v,256*(T=Math.pow(2,C)-T-1),C),O=qk(256*(v+1),256*(T+1),C);return k[0]+","+k[1]+","+O[0]+","+O[1]}(this.x,this.y,this.z),g=function(v,T,C){let k,O="";for(let W=v;W>0;W--)k=1<<W-1,O+=(T&k?1:0)+(C&k?2:0);return O}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",f)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Zk{constructor(a,u){this.wrap=a,this.canonical=u,this.key=L0(a,u.z,u.z,u.x,u.y)}}class ea{constructor(a,u,f,g,v){this.overscaledZ=a,this.wrap=u,this.canonical=new lw(f,+g,+v),this.key=u===0&&a===f?this.canonical.key:L0(u,a,f,g,v)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){const u=this.canonical.z-a;return a>this.canonical.z?new ea(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ea(a,this.wrap,a,this.canonical.x>>u,this.canonical.y>>u)}calculateScaledKey(a,u=!0){if(this.overscaledZ===a&&u)return this.key;if(a>this.canonical.z)return L0(this.wrap*+u,a,this.canonical.z,this.canonical.x,this.canonical.y);{const f=this.canonical.z-a;return L0(this.wrap*+u,a,a,this.canonical.x>>f,this.canonical.y>>f)}}isChildOf(a){if(a.wrap!==this.wrap)return!1;const u=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>u&&a.canonical.y===this.canonical.y>>u}children(a){if(this.overscaledZ>=a)return[new ea(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new ea(u,this.wrap,u,f,g),new ea(u,this.wrap,u,f+1,g),new ea(u,this.wrap,u,f,g+1),new ea(u,this.wrap,u,f+1,g+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new ea(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new ea(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Zk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function L0(c,a,u,f,g){const v=1<<Math.min(u,22);let T=v*(g%v)+f%v;return c&&u<22&&(T+=v*v*((c<0?-2*c-1:2*c)%(1<<2*(22-u)))),16*(32*T+u)+(a-u)}dn(lw,"CanonicalTileID"),dn(ea,"OverscaledTileID",{omit:["projMatrix"]});class e_ extends j{constructor(a,u,f){super(a,u),this.z=f}}function k0(c,a){return c.x*a.x+c.y*a.y}function Xk(c,a){if(c.length===1){let u=0;const f=a[u++];let g;for(;!g||f.equals(g);)if(g=a[u++],!g)return 1/0;for(;u<a.length;u++){const v=a[u],T=c[0],C=g.sub(f),k=v.sub(f),O=T.sub(f),W=k0(C,C),q=k0(C,k),$=k0(k,k),J=k0(O,C),ie=k0(O,k),ue=W*$-q*q,ge=($*J-q*ie)/ue,Re=(W*ie-q*J)/ue,je=f.z*(1-ge-Re)+g.z*ge+v.z*Re;if(isFinite(je))return je}return 1/0}{let u=1/0;for(const f of a)u=Math.min(u,f.z);return u}}function $k(c,a,u,f,g,v,T,C){const k=T*g.getElevationAt(c,a,!0,!0),O=v[0]!==0,W=O?v[1]===0?T*(v[0]/7-450):T*function(q,$,J){const ie=Math.floor($[0]/8),ue=Math.floor($[1]/8),ge=10*($[0]-8*ie),Re=10*($[1]-8*ue),je=q.getElevationAt(ie,ue,!0,!0),ke=q.getMeterToDEM(J),Ge=Math.floor(.5*(ge*ke-1)),$e=Math.floor(.5*(Re*ke-1)),qe=q.tileCoordToPixel(ie,ue),dt=2*Ge+1,ut=2*$e+1,Tt=function(jt,xt,en,Wn,un){return[jt.getElevationAtPixel(xt,en,!0),jt.getElevationAtPixel(xt+un,en,!0),jt.getElevationAtPixel(xt,en+un,!0),jt.getElevationAtPixel(xt+Wn,en+un,!0)]}(q,qe.x-Ge,qe.y-$e,dt,ut),Ht=Math.abs(Tt[0]-Tt[1]),yt=Math.abs(Tt[2]-Tt[3]),Pt=Math.abs(Tt[0]-Tt[2])+Math.abs(Tt[1]-Tt[3]),Rt=Math.min(.25,.5*ke*(Ht+yt)/dt),Bt=Math.min(.25,.5*ke*Pt/ut);return je+Math.max(Rt*ge,Bt*Re)}(g,v,C):k;return{base:k+(u===0)?-1:u,top:O?Math.max(W+f,k+u+2):k+f}}const F8=an([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:B8}=F8,N8=an([{name:"a_packed",components:4,type:"Float32"}]),{members:U8}=N8,V8=ow.types,G8=Math.cos(Math.PI/180*37.5);class cw{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(u=>u.id),this.index=a.index,this.projection=a.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new Us,this.layoutVertexArray2=new Js,this.indexArray=new Xi,this.programConfigurations=new ch(a.layers,a.zoom),this.segments=new X,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(a,u,f,g){this.hasPattern=OT("line",this.layers,u);const v=this.layers[0].layout.get("line-sort-key"),T=[];for(const{feature:W,id:q,index:$,sourceLayerIndex:J}of a){const ie=this.layers[0]._featureFilter.needGeometry,ue=hd(W,ie);if(!this.layers[0]._featureFilter.filter(new it(this.zoom),ue,f))continue;const ge=v?v.evaluate(ue,{},f):void 0,Re={id:q,properties:W.properties,type:W.type,sourceLayerIndex:J,index:$,geometry:ie?ue.geometry:wo(W,f,g),patterns:{},sortKey:ge};T.push(Re)}v&&T.sort((W,q)=>W.sortKey-q.sortKey);const{lineAtlas:C,featureIndex:k}=u,O=this.addConstantDashes(C);for(const W of T){const{geometry:q,index:$,sourceLayerIndex:J}=W;if(O&&this.addFeatureDashes(W,C),this.hasPattern){const ie=FT("line",this.layers,W,this.zoom,u);this.patternFeatures.push(ie)}else this.addFeature(W,q,$,f,C.positions,u.availableImages);k.insert(a[$].feature,q,$,J,this.index)}}addConstantDashes(a){let u=!1;for(const f of this.layers){const g=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(g.kind!=="constant"||v.kind!=="constant")u=!0;else{const T=v.value,C=g.value;if(!C)continue;a.addDash(C,T)}}return u}addFeatureDashes(a,u){const f=this.zoom;for(const g of this.layers){const v=g.paint.get("line-dasharray").value,T=g.layout.get("line-cap").value;if(v.kind==="constant"&&T.kind==="constant")continue;let C,k;if(v.kind==="constant"){if(C=v.value,!C)continue}else C=v.evaluate({zoom:f},a);k=T.kind==="constant"?T.value:T.evaluate({zoom:f},a),u.addDash(C,k),a.patterns[g.id]=u.getKey(C,k)}}update(a,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,u,this.stateDependentLayers,f,g)}addFeatures(a,u,f,g,v){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,u,f,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,U8)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,B8),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&a.properties.hasOwnProperty("mapbox_clip_start")&&a.properties.hasOwnProperty("mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,u,f,g,v,T){const C=this.layers[0].layout,k=C.get("line-join").evaluate(a,{}),O=C.get("line-cap").evaluate(a,{}),W=C.get("line-miter-limit"),q=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const $ of u)this.addLine($,a,k,O,W,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,f,v,T,g)}addLine(a,u,f,g,v,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Re=0;Re<a.length-1;Re++)this.totalDistance+=a[Re].dist(a[Re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=V8[u.type]==="Polygon";let k=a.length;for(;k>=2&&a[k-1].equals(a[k-2]);)k--;let O=0;for(;O<k-1&&a[O].equals(a[O+1]);)O++;if(k<(C?3:2))return;f==="bevel"&&(v=1.05);const W=this.overscaling<=16?122880/(512*this.overscaling):0,q=this.segments.prepareSegment(10*k,this.layoutVertexArray,this.indexArray);let $,J,ie,ue,ge;this.e1=this.e2=-1,C&&($=a[k-2],ge=a[O].sub($)._unit()._perp());for(let Re=O;Re<k;Re++){if(ie=Re===k-1?C?a[O+1]:void 0:a[Re+1],ie&&a[Re].equals(ie))continue;ge&&(ue=ge),$&&(J=$),$=a[Re],ge=ie?ie.sub($)._unit()._perp():ue,ue=ue||ge;let je=ue.add(ge);je.x===0&&je.y===0||je._unit();const ke=ue.x*ge.x+ue.y*ge.y,Ge=je.x*ge.x+je.y*ge.y,$e=Ge!==0?1/Ge:1/0,qe=2*Math.sqrt(2-2*Ge),dt=Ge<G8&&J&&ie,ut=ue.x*ge.y-ue.y*ge.x>0;if(dt&&Re>O){const yt=$.dist(J);if(yt>2*W){const Pt=$.sub($.sub(J)._mult(W/yt)._round());this.updateDistance(J,Pt),this.addCurrentVertex(Pt,ue,0,0,q),J=Pt}}const Tt=J&&ie;let Ht=Tt?f:C?"butt":g;if(Tt&&Ht==="round"&&($e<T?Ht="miter":$e<=2&&(Ht="fakeround")),Ht==="miter"&&$e>v&&(Ht="bevel"),Ht==="bevel"&&($e>2&&(Ht="flipbevel"),$e<v&&(Ht="miter")),J&&this.updateDistance(J,$),Ht==="miter")je._mult($e),this.addCurrentVertex($,je,0,0,q);else if(Ht==="flipbevel"){if($e>100)je=ge.mult(-1);else{const yt=$e*ue.add(ge).mag()/ue.sub(ge).mag();je._perp()._mult(yt*(ut?-1:1))}this.addCurrentVertex($,je,0,0,q),this.addCurrentVertex($,je.mult(-1),0,0,q)}else if(Ht==="bevel"||Ht==="fakeround"){const yt=-Math.sqrt($e*$e-1),Pt=ut?yt:0,Rt=ut?0:yt;if(J&&this.addCurrentVertex($,ue,Pt,Rt,q),Ht==="fakeround"){const Bt=Math.round(180*qe/Math.PI/20);for(let jt=1;jt<Bt;jt++){let xt=jt/Bt;if(xt!==.5){const Wn=xt-.5;xt+=xt*Wn*(xt-1)*((1.0904+ke*(ke*(3.55645-1.43519*ke)-3.2452))*Wn*Wn+(.848013+ke*(.215638*ke-1.06021)))}const en=ge.sub(ue)._mult(xt)._add(ue)._unit()._mult(ut?-1:1);this.addHalfVertex($,en.x,en.y,!1,ut,0,q)}}ie&&this.addCurrentVertex($,ge,-Pt,-Rt,q)}else if(Ht==="butt")this.addCurrentVertex($,je,0,0,q);else if(Ht==="square"){const yt=J?1:-1;J||this.addCurrentVertex($,je,yt,yt,q),this.addCurrentVertex($,je,0,0,q),J&&this.addCurrentVertex($,je,yt,yt,q)}else Ht==="round"&&(J&&(this.addCurrentVertex($,ue,0,0,q),this.addCurrentVertex($,ue,1,1,q,!0)),ie&&(this.addCurrentVertex($,ge,-1,-1,q,!0),this.addCurrentVertex($,ge,0,0,q)));if(dt&&Re<k-1){const yt=$.dist(ie);if(yt>2*W){const Pt=$.add(ie.sub($)._mult(W/yt)._round());this.updateDistance($,Pt),this.addCurrentVertex(Pt,ge,0,0,q),$=Pt}}}}addCurrentVertex(a,u,f,g,v,T=!1){const C=u.y*g-u.x,k=-u.y-u.x*g;this.addHalfVertex(a,u.x+u.y*f,u.y-u.x*f,T,!1,f,v),this.addHalfVertex(a,C,k,T,!0,-g,v)}addHalfVertex({x:a,y:u},f,g,v,T,C,k){this.layoutVertexArray.emplaceBack((a<<1)+(v?1:0),(u<<1)+(T?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const O=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,O),k.primitiveLength++),T?this.e2=O:this.e1=O}updateScaledDistance(){if(this.lineClips){const a=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=a*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(a,u){this.distance+=a.dist(u),this.updateScaledDistance()}}dn(cw,"LineBucket",{omit:["layers","patternFeatures"]});const W8=new mn({"line-cap":new at(wt.layout_line["line-cap"]),"line-join":new at(wt.layout_line["line-join"]),"line-miter-limit":new Ye(wt.layout_line["line-miter-limit"]),"line-round-limit":new Ye(wt.layout_line["line-round-limit"]),"line-sort-key":new at(wt.layout_line["line-sort-key"])});var Yk={paint:new mn({"line-opacity":new at(wt.paint_line["line-opacity"]),"line-color":new at(wt.paint_line["line-color"]),"line-translate":new Ye(wt.paint_line["line-translate"]),"line-translate-anchor":new Ye(wt.paint_line["line-translate-anchor"]),"line-width":new at(wt.paint_line["line-width"]),"line-gap-width":new at(wt.paint_line["line-gap-width"]),"line-offset":new at(wt.paint_line["line-offset"]),"line-blur":new at(wt.paint_line["line-blur"]),"line-dasharray":new at(wt.paint_line["line-dasharray"]),"line-pattern":new at(wt.paint_line["line-pattern"]),"line-gradient":new Qt(wt.paint_line["line-gradient"]),"line-trim-offset":new Ye(wt.paint_line["line-trim-offset"])}),layout:W8};const Kk=new class extends at{possiblyEvaluate(c,a){return a=new it(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,transition:a.transition}),super.possiblyEvaluate(c,a)}evaluate(c,a,u,f){return a=Pe({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(c,a,u,f)}}(Yk.paint.properties["line-width"].specification);function Jk(c,a){return a>0?a+2*c:c}Kk.useIntegerZoom=!0;const H8=an([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),j8=an([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),q8=an([{name:"a_projected_pos",components:4,type:"Float32"}],4);an([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Z8=an([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),X8=an([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);an([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Qk=an([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$8=an([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);an([{name:"triangle",components:3,type:"Uint16"}]),an([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),an([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),an([{type:"Float32",name:"offsetX"}]),an([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var bo=24;const uh=128;function NT(c,a){const{expression:u}=a;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new it(c+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let v=0;for(;v<f.length&&f[v]<=c;)v++;v=Math.max(0,v-1);let T=v;for(;T<f.length&&f[T]<c+1;)T++;T=Math.min(f.length-1,T);const C=f[v],k=f[T];return u.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:k,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:k,minSize:u.evaluate(new it(C)),maxSize:u.evaluate(new it(k)),interpolationType:g}}}function uw(c,{uSize:a,uSizeT:u},{lowerSize:f,upperSize:g}){return c.kind==="source"?f/uh:c.kind==="composite"?di(f/uh,g/uh,u):a}function t_(c,a){let u=0,f=0;if(c.kind==="constant")f=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:g,minZoom:v,maxZoom:T}=c,C=g?fe(jo.interpolationFactor(g,a,v,T),0,1):0;c.kind==="camera"?f=di(c.minSize,c.maxSize,C):u=C}return{uSizeT:u,uSize:f}}var Y8=Object.freeze({__proto__:null,getSizeData:NT,evaluateSizeForFeature:uw,evaluateSizeForZoom:t_,SIZE_PACK_FACTOR:uh});function K8(c,a,u){return c.sections.forEach(f=>{f.text=function(g,v,T){const C=v.layout.get("text-transform").evaluate(T,{});return C==="uppercase"?g=g.toLocaleUpperCase():C==="lowercase"&&(g=g.toLocaleLowerCase()),lt.applyArabicShaping&&(g=lt.applyArabicShaping(g)),g}(f.text,a,u)}),c}const D0={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};function J8(c){return c==="︶"||c==="﹈"||c==="︸"||c==="﹄"||c==="﹂"||c==="︾"||c==="︼"||c==="︺"||c==="︘"||c==="﹀"||c==="︐"||c==="︓"||c==="︔"||c==="｀"||c==="￣"||c==="︑"||c==="︒"}function Q8(c){return c==="︵"||c==="﹇"||c==="︷"||c==="﹃"||c==="﹁"||c==="︽"||c==="︻"||c==="︹"||c==="︗"||c==="︿"}var R0=dr,eD=function(c,a,u,f,g){var v,T,C=8*g-f-1,k=(1<<C)-1,O=k>>1,W=-7,q=u?g-1:0,$=u?-1:1,J=c[a+q];for(q+=$,v=J&(1<<-W)-1,J>>=-W,W+=C;W>0;v=256*v+c[a+q],q+=$,W-=8);for(T=v&(1<<-W)-1,v>>=-W,W+=f;W>0;T=256*T+c[a+q],q+=$,W-=8);if(v===0)v=1-O;else{if(v===k)return T?NaN:1/0*(J?-1:1);T+=Math.pow(2,f),v-=O}return(J?-1:1)*T*Math.pow(2,v-f)},tD=function(c,a,u,f,g,v){var T,C,k,O=8*v-g-1,W=(1<<O)-1,q=W>>1,$=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,J=f?0:v-1,ie=f?1:-1,ue=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(C=isNaN(a)?1:0,T=W):(T=Math.floor(Math.log(a)/Math.LN2),a*(k=Math.pow(2,-T))<1&&(T--,k*=2),(a+=T+q>=1?$/k:$*Math.pow(2,1-q))*k>=2&&(T++,k/=2),T+q>=W?(C=0,T=W):T+q>=1?(C=(a*k-1)*Math.pow(2,g),T+=q):(C=a*Math.pow(2,q-1)*Math.pow(2,g),T=0));g>=8;c[u+J]=255&C,J+=ie,C/=256,g-=8);for(T=T<<g|C,O+=g;O>0;c[u+J]=255&T,J+=ie,T/=256,O-=8);c[u+J-ie]|=128*ue};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function dr(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}dr.Varint=0,dr.Fixed64=1,dr.Bytes=2,dr.Fixed32=5;var UT=4294967296,nD=1/UT,iD=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function pd(c){return c.type===dr.Bytes?c.readVarint()+c.pos:c.pos+1}function n_(c,a,u){return u?4294967296*a+(c>>>0):4294967296*(a>>>0)+(c>>>0)}function rD(c,a,u){var f=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));u.realloc(f);for(var g=u.pos-1;g>=c;g--)u.buf[g+f]=u.buf[g]}function eW(c,a){for(var u=0;u<c.length;u++)a.writeVarint(c[u])}function tW(c,a){for(var u=0;u<c.length;u++)a.writeSVarint(c[u])}function nW(c,a){for(var u=0;u<c.length;u++)a.writeFloat(c[u])}function iW(c,a){for(var u=0;u<c.length;u++)a.writeDouble(c[u])}function rW(c,a){for(var u=0;u<c.length;u++)a.writeBoolean(c[u])}function sW(c,a){for(var u=0;u<c.length;u++)a.writeFixed32(c[u])}function oW(c,a){for(var u=0;u<c.length;u++)a.writeSFixed32(c[u])}function aW(c,a){for(var u=0;u<c.length;u++)a.writeFixed64(c[u])}function lW(c,a){for(var u=0;u<c.length;u++)a.writeSFixed64(c[u])}function hw(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+16777216*c[a+3]}function i_(c,a,u){c[u]=a,c[u+1]=a>>>8,c[u+2]=a>>>16,c[u+3]=a>>>24}function sD(c,a){return(c[a]|c[a+1]<<8|c[a+2]<<16)+(c[a+3]<<24)}function cW(c,a,u){a.glyphs=[],c===1&&u.readMessage(uW,a)}function uW(c,a,u){if(c===3){const{id:f,bitmap:g,width:v,height:T,left:C,top:k,advance:O}=u.readMessage(hW,{});a.glyphs.push({id:f,bitmap:new fd({width:v+6,height:T+6},g),metrics:{width:v,height:T,left:C,top:k,advance:O}})}else c===4?a.ascender=u.readSVarint():c===5&&(a.descender=u.readSVarint())}function hW(c,a,u){c===1?a.id=u.readVarint():c===2?a.bitmap=u.readBytes():c===3?a.width=u.readVarint():c===4?a.height=u.readVarint():c===5?a.left=u.readSVarint():c===6?a.top=u.readSVarint():c===7&&(a.advance=u.readVarint())}function VT(c){let a=0,u=0;for(const T of c)a+=T.w*T.h,u=Math.max(u,T.w);c.sort((T,C)=>C.h-T.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),u),h:1/0}];let g=0,v=0;for(const T of c)for(let C=f.length-1;C>=0;C--){const k=f[C];if(!(T.w>k.w||T.h>k.h)){if(T.x=k.x,T.y=k.y,v=Math.max(v,T.y+T.h),g=Math.max(g,T.x+T.w),T.w===k.w&&T.h===k.h){const O=f.pop();C<f.length&&(f[C]=O)}else T.h===k.h?(k.x+=T.w,k.w-=T.w):T.w===k.w?(k.y+=T.h,k.h-=T.h):(f.push({x:k.x+T.w,y:k.y,w:k.w-T.w,h:T.h}),k.y+=T.h,k.h-=T.h);break}}return{w:g,h:v,fill:a/(g*v)||0}}dr.prototype={destroy:function(){this.buf=null},readFields:function(c,a,u){for(u=u||this.length;this.pos<u;){var f=this.readVarint(),g=f>>3,v=this.pos;this.type=7&f,c(g,a,this),this.pos===v&&this.skip(f)}return a},readMessage:function(c,a){return this.readFields(c,a,this.readVarint()+this.pos)},readFixed32:function(){var c=hw(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=sD(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=hw(this.buf,this.pos)+hw(this.buf,this.pos+4)*UT;return this.pos+=8,c},readSFixed64:function(){var c=hw(this.buf,this.pos)+sD(this.buf,this.pos+4)*UT;return this.pos+=8,c},readFloat:function(){var c=eD(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=eD(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var a,u,f=this.buf;return a=127&(u=f[this.pos++]),u<128?a:(a|=(127&(u=f[this.pos++]))<<7,u<128?a:(a|=(127&(u=f[this.pos++]))<<14,u<128?a:(a|=(127&(u=f[this.pos++]))<<21,u<128?a:function(g,v,T){var C,k,O=T.buf;if(C=(112&(k=O[T.pos++]))>>4,k<128||(C|=(127&(k=O[T.pos++]))<<3,k<128)||(C|=(127&(k=O[T.pos++]))<<10,k<128)||(C|=(127&(k=O[T.pos++]))<<17,k<128)||(C|=(127&(k=O[T.pos++]))<<24,k<128)||(C|=(1&(k=O[T.pos++]))<<31,k<128))return n_(g,C,v);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(u=f[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var c=this.readVarint()+this.pos,a=this.pos;return this.pos=c,c-a>=12&&iD?function(u,f,g){return iD.decode(u.subarray(f,g))}(this.buf,a,c):function(u,f,g){for(var v="",T=f;T<g;){var C,k,O,W=u[T],q=null,$=W>239?4:W>223?3:W>191?2:1;if(T+$>g)break;$===1?W<128&&(q=W):$===2?(192&(C=u[T+1]))==128&&(q=(31&W)<<6|63&C)<=127&&(q=null):$===3?(k=u[T+2],(192&(C=u[T+1]))==128&&(192&k)==128&&((q=(15&W)<<12|(63&C)<<6|63&k)<=2047||q>=55296&&q<=57343)&&(q=null)):$===4&&(k=u[T+2],O=u[T+3],(192&(C=u[T+1]))==128&&(192&k)==128&&(192&O)==128&&((q=(15&W)<<18|(63&C)<<12|(63&k)<<6|63&O)<=65535||q>=1114112)&&(q=null)),q===null?(q=65533,$=1):q>65535&&(q-=65536,v+=String.fromCharCode(q>>>10&1023|55296),q=56320|1023&q),v+=String.fromCharCode(q),T+=$}return v}(this.buf,a,c)},readBytes:function(){var c=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,c);return this.pos=c,a},readPackedVarint:function(c,a){if(this.type!==dr.Bytes)return c.push(this.readVarint(a));var u=pd(this);for(c=c||[];this.pos<u;)c.push(this.readVarint(a));return c},readPackedSVarint:function(c){if(this.type!==dr.Bytes)return c.push(this.readSVarint());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==dr.Bytes)return c.push(this.readBoolean());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==dr.Bytes)return c.push(this.readFloat());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==dr.Bytes)return c.push(this.readDouble());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==dr.Bytes)return c.push(this.readFixed32());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==dr.Bytes)return c.push(this.readSFixed32());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==dr.Bytes)return c.push(this.readFixed64());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==dr.Bytes)return c.push(this.readSFixed64());var a=pd(this);for(c=c||[];this.pos<a;)c.push(this.readSFixed64());return c},skip:function(c){var a=7&c;if(a===dr.Varint)for(;this.buf[this.pos++]>127;);else if(a===dr.Bytes)this.pos=this.readVarint()+this.pos;else if(a===dr.Fixed32)this.pos+=4;else{if(a!==dr.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(c,a){this.writeVarint(c<<3|a)},realloc:function(c){for(var a=this.length||16;a<this.pos+c;)a*=2;if(a!==this.length){var u=new Uint8Array(a);u.set(this.buf),this.buf=u,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),i_(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),i_(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),i_(this.buf,-1&c,this.pos),i_(this.buf,Math.floor(c*nD),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),i_(this.buf,-1&c,this.pos),i_(this.buf,Math.floor(c*nD),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(a,u){var f,g;if(a>=0?(f=a%4294967296|0,g=a/4294967296|0):(g=~(-a/4294967296),4294967295^(f=~(-a%4294967296))?f=f+1|0:(f=0,g=g+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");u.realloc(10),function(v,T,C){C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,v>>>=7,C.buf[C.pos++]=127&v|128,C.buf[C.pos]=127&(v>>>=7)}(f,0,u),function(v,T){var C=(7&v)<<4;T.buf[T.pos++]|=C|((v>>>=3)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v|((v>>>=7)?128:0),v&&(T.buf[T.pos++]=127&v)))))}(g,u)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(Boolean(c))},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var a=this.pos;this.pos=function(f,g,v){for(var T,C,k=0;k<g.length;k++){if((T=g.charCodeAt(k))>55295&&T<57344){if(!C){T>56319||k+1===g.length?(f[v++]=239,f[v++]=191,f[v++]=189):C=T;continue}if(T<56320){f[v++]=239,f[v++]=191,f[v++]=189,C=T;continue}T=C-55296<<10|T-56320|65536,C=null}else C&&(f[v++]=239,f[v++]=191,f[v++]=189,C=null);T<128?f[v++]=T:(T<2048?f[v++]=T>>6|192:(T<65536?f[v++]=T>>12|224:(f[v++]=T>>18|240,f[v++]=T>>12&63|128),f[v++]=T>>6&63|128),f[v++]=63&T|128)}return v}(this.buf,c,this.pos);var u=this.pos-a;u>=128&&rD(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeFloat:function(c){this.realloc(4),tD(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),tD(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var a=c.length;this.writeVarint(a),this.realloc(a);for(var u=0;u<a;u++)this.buf[this.pos++]=c[u]},writeRawMessage:function(c,a){this.pos++;var u=this.pos;c(a,this);var f=this.pos-u;f>=128&&rD(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f},writeMessage:function(c,a,u){this.writeTag(c,dr.Bytes),this.writeRawMessage(a,u)},writePackedVarint:function(c,a){a.length&&this.writeMessage(c,eW,a)},writePackedSVarint:function(c,a){a.length&&this.writeMessage(c,tW,a)},writePackedBoolean:function(c,a){a.length&&this.writeMessage(c,rW,a)},writePackedFloat:function(c,a){a.length&&this.writeMessage(c,nW,a)},writePackedDouble:function(c,a){a.length&&this.writeMessage(c,iW,a)},writePackedFixed32:function(c,a){a.length&&this.writeMessage(c,sW,a)},writePackedSFixed32:function(c,a){a.length&&this.writeMessage(c,oW,a)},writePackedFixed64:function(c,a){a.length&&this.writeMessage(c,aW,a)},writePackedSFixed64:function(c,a){a.length&&this.writeMessage(c,lW,a)},writeBytesField:function(c,a){this.writeTag(c,dr.Bytes),this.writeBytes(a)},writeFixed32Field:function(c,a){this.writeTag(c,dr.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(c,a){this.writeTag(c,dr.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(c,a){this.writeTag(c,dr.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(c,a){this.writeTag(c,dr.Fixed64),this.writeSFixed64(a)},writeVarintField:function(c,a){this.writeTag(c,dr.Varint),this.writeVarint(a)},writeSVarintField:function(c,a){this.writeTag(c,dr.Varint),this.writeSVarint(a)},writeStringField:function(c,a){this.writeTag(c,dr.Bytes),this.writeString(a)},writeFloatField:function(c,a){this.writeTag(c,dr.Fixed32),this.writeFloat(a)},writeDoubleField:function(c,a){this.writeTag(c,dr.Fixed64),this.writeDouble(a)},writeBooleanField:function(c,a){this.writeVarintField(c,Boolean(a))}};class GT{constructor(a,{pixelRatio:u,version:f,stretchX:g,stretchY:v,content:T}){this.paddedRect=a,this.pixelRatio=u,this.stretchX=g,this.stretchY=v,this.content=T,this.version=f}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class oD{constructor(a,u){const f={},g={};this.haveRenderCallbacks=[];const v=[];this.addImages(a,f,v),this.addImages(u,g,v);const{w:T,h:C}=VT(v),k=new Ga({width:T||1,height:C||1});for(const O in a){const W=a[O],q=f[O].paddedRect;Ga.copy(W.data,k,{x:0,y:0},{x:q.x+1,y:q.y+1},W.data)}for(const O in u){const W=u[O],q=g[O].paddedRect,$=q.x+1,J=q.y+1,ie=W.data.width,ue=W.data.height;Ga.copy(W.data,k,{x:0,y:0},{x:$,y:J},W.data),Ga.copy(W.data,k,{x:0,y:ue-1},{x:$,y:J-1},{width:ie,height:1}),Ga.copy(W.data,k,{x:0,y:0},{x:$,y:J+ue},{width:ie,height:1}),Ga.copy(W.data,k,{x:ie-1,y:0},{x:$-1,y:J},{width:1,height:ue}),Ga.copy(W.data,k,{x:0,y:0},{x:$+ie,y:J},{width:1,height:ue})}this.image=k,this.iconPositions=f,this.patternPositions=g}addImages(a,u,f){for(const g in a){const v=a[g],T={x:0,y:0,w:v.data.width+2,h:v.data.height+2};f.push(T),u[g]=new GT(T,v),v.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(a,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(f=>a.hasImage(f)),a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in a.updatedImages)this.patchUpdatedImage(this.iconPositions[f],a.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],a.getImage(f),u)}patchUpdatedImage(a,u,f){if(!a||!u||a.version===u.version)return;a.version=u.version;const[g,v]=a.tl;f.update(u.data,void 0,{x:g,y:v})}}dn(GT,"ImagePosition"),dn(oD,"ImageAtlas");const El={horizontal:1,vertical:2,horizontalOnly:3};class z0{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,u){const f=new z0;return f.scale=a||1,f.fontStack=u,f}static forImage(a){const u=new z0;return u.imageName=a,u}}class r_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,u){const f=new r_;for(let g=0;g<a.sections.length;g++){const v=a.sections[g];v.image?f.addImageSection(v):f.addTextSection(v,u)}return f}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSections(){return this.sections}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(a){this.text=function(u,f){let g="";for(let v=0;v<u.length;v++){const T=u.charCodeAt(v+1)||null,C=u.charCodeAt(v-1)||null;g+=!f&&(T&&Y(T)&&!D0[u[v+1]]||C&&Y(C)&&!D0[u[v-1]])||!D0[u[v]]?u[v]:D0[u[v]]}return g}(this.text,a)}trim(){let a=0;for(let f=0;f<this.text.length&&dw[this.text.charCodeAt(f)];f++)a++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=a&&dw[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(a,u),this.sectionIndex=this.sectionIndex.slice(a,u)}substring(a,u){const f=new r_;return f.text=this.text.substring(a,u),f.sectionIndex=this.sectionIndex.slice(a,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,u)=>Math.max(a,this.sections[u].scale),0)}addTextSection(a,u){this.text+=a.text,this.sections.push(z0.forText(a.scale,a.fontStack||u));const f=this.sections.length-1;for(let g=0;g<a.text.length;++g)this.sectionIndex.push(f)}addImageSection(a){const u=a.image?a.image.name:"";if(u.length===0)return void At("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(z0.forImage(u)),this.sectionIndex.push(this.sections.length-1)):At("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function WT(c,a,u,f,g,v,T,C,k,O,W,q,$,J,ie){const ue=r_.fromFeature(c,g);q===El.vertical&&ue.verticalizePunctuation($);let ge=[];const Re=function(qe,dt,ut,Tt,Ht,yt){if(!qe)return[];const Pt=[],Rt=function(en,Wn,un,Tn,rn,jn){let gi=0;for(let pi=0;pi<en.length();pi++){const ui=en.getSection(pi);gi+=aD(en.getCharCode(pi),ui,Tn,rn,Wn,jn)}return gi/Math.max(1,Math.ceil(gi/un))}(qe,dt,ut,Tt,Ht,yt),Bt=qe.text.indexOf("​")>=0;let jt=0;for(let en=0;en<qe.length();en++){const Wn=qe.getSection(en),un=qe.getCharCode(en);if(dw[un]||(jt+=aD(un,Wn,Tt,Ht,dt,yt)),en<qe.length()-1){const Tn=!((xt=un)<11904||!(va(xt)||cm(xt)||m(xt)||cd(xt)||nc(xt)||od(xt)||Vg(xt)||bl(xt)||Wg(xt)||xn(xt)||ad(xt)||I(xt)||ih(xt)||Mf(xt)||Sf(xt)||Gg(xt)||rh(xt)||h(xt)||Tf(xt)||ld(xt)));(dW[un]||Tn||Wn.imageName)&&Pt.push(cD(en+1,jt,Rt,Pt,fW(un,qe.getCharCode(en+1),Tn&&Bt),!1))}}var xt;return uD(cD(qe.length(),jt,Rt,Pt,0,!0))}(ue,O,v,a,f,J),{processBidirectionalText:je,processStyledBidirectionalText:ke}=lt;if(je&&ue.sections.length===1){const qe=je(ue.toString(),Re);for(const dt of qe){const ut=new r_;ut.text=dt,ut.sections=ue.sections;for(let Tt=0;Tt<dt.length;Tt++)ut.sectionIndex.push(0);ge.push(ut)}}else if(ke){const qe=ke(ue.text,ue.sectionIndex,Re);for(const dt of qe){const ut=new r_;ut.text=dt[0],ut.sectionIndex=dt[1],ut.sections=ue.sections,ge.push(ut)}}else ge=function(qe,dt){const ut=[],Tt=qe.text;let Ht=0;for(const yt of dt)ut.push(qe.substring(Ht,yt)),Ht=yt;return Ht<Tt.length&&ut.push(qe.substring(Ht,Tt.length)),ut}(ue,Re);const Ge=[],$e={positionedLines:Ge,text:ue.toString(),top:W[1],bottom:W[1],left:W[0],right:W[0],writingMode:q,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(qe,dt,ut,Tt,Ht,yt,Pt,Rt,Bt,jt,xt,en){let Wn=0,un=0,Tn=0;const rn=Rt==="right"?1:Rt==="left"?0:.5;let jn=!1;for(const ei of Ht){const _i=ei.getSections();for(const sr of _i){if(sr.imageName)continue;const mr=dt[sr.fontStack];if(mr&&(jn=mr.ascender!==void 0&&mr.descender!==void 0,!jn))break}if(!jn)break}let gi=0;for(const ei of Ht){ei.trim();const _i=ei.getMaxScale(),sr=(_i-1)*bo,mr={positionedGlyphs:[],lineOffset:0};qe.positionedLines[gi]=mr;const fr=mr.positionedGlyphs;let gr=0;if(!ei.length()){un+=yt,++gi;continue}let Mr=0,Gr=0;for(let Ki=0;Ki<ei.length();Ki++){const xs=ei.getSection(Ki),os=ei.getSectionIndex(Ki),Di=ei.getCharCode(Ki);let Lr=xs.scale,Ds=null,or=null,Yr=null,Oo=bo,eo=0;const to=!(Bt===El.horizontal||!xt&&!K(Di)||xt&&(dw[Di]||(pi=Di,nh(pi)||sd(pi)||bf(pi)||y(pi)||E(pi))));if(xs.imageName){const ta=Tt[xs.imageName];if(!ta)continue;Yr=xs.imageName,qe.iconsInText=qe.iconsInText||!0,or=ta.paddedRect;const no=ta.displaySize;Lr=Lr*bo/en,Ds={width:no[0],height:no[1],left:1,top:-3,advance:to?no[1]:no[0],localGlyph:!1},eo=jn?-Ds.height*Lr:_i*bo-17-no[1]*Lr,Oo=Ds.advance;const _d=(to?no[0]:no[1])*Lr-bo*_i;_d>0&&_d>gr&&(gr=_d)}else{const ta=ut[xs.fontStack];if(!ta)continue;ta[Di]&&(or=ta[Di]);const no=dt[xs.fontStack];if(!no)continue;const _d=no.glyphs[Di];if(!_d)continue;if(Ds=_d.metrics,Oo=Di!==8203?bo:0,jn){const f_=no.ascender!==void 0?Math.abs(no.ascender):0,Z0=no.descender!==void 0?Math.abs(no.descender):0,X0=(f_+Z0)*Lr;Mr<X0&&(Mr=X0,Gr=(f_-Z0)/2*Lr),eo=-f_*Lr}else eo=(_i-Lr)*bo-17}to?(qe.verticalizable=!0,fr.push({glyph:Di,imageName:Yr,x:Wn,y:un+eo,vertical:to,scale:Lr,localGlyph:Ds.localGlyph,fontStack:xs.fontStack,sectionIndex:os,metrics:Ds,rect:or}),Wn+=Oo*Lr+jt):(fr.push({glyph:Di,imageName:Yr,x:Wn,y:un+eo,vertical:to,scale:Lr,localGlyph:Ds.localGlyph,fontStack:xs.fontStack,sectionIndex:os,metrics:Ds,rect:or}),Wn+=Ds.advance*Lr+jt)}fr.length!==0&&(Tn=Math.max(Wn-jt,Tn),jn?hD(fr,rn,gr,Gr,yt*_i/2):hD(fr,rn,gr,0,yt/2)),Wn=0;const Qs=yt*_i+gr;mr.lineOffset=Math.max(gr,sr),un+=Qs,++gi}var pi;const ui=un,{horizontalAlign:$n,verticalAlign:Yi}=HT(Pt);(function(ei,_i,sr,mr,fr,gr){const Mr=(_i-sr)*fr,Gr=-gr*mr;for(const Qs of ei)for(const Ki of Qs.positionedGlyphs)Ki.x+=Mr,Ki.y+=Gr})(qe.positionedLines,rn,$n,Yi,Tn,ui),qe.top+=-Yi*ui,qe.bottom=qe.top+ui,qe.left+=-$n*Tn,qe.right=qe.left+Tn,qe.hasBaseline=jn}($e,a,u,f,ge,T,C,k,q,O,$,ie),!function(qe){for(const dt of qe)if(dt.positionedGlyphs.length!==0)return!1;return!0}(Ge)&&$e}const dw={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},dW={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function aD(c,a,u,f,g,v){if(a.imageName){const T=f[a.imageName];return T?T.displaySize[0]*a.scale*bo/v+g:0}{const T=u[a.fontStack],C=T&&T.glyphs[c];return C?C.metrics.advance*a.scale+g:0}}function lD(c,a,u,f){const g=Math.pow(c-a,2);return f?c<a?g/2:2*g:g+Math.abs(u)*u}function fW(c,a,u){let f=0;return c===10&&(f-=1e4),u&&(f+=150),c!==40&&c!==65288||(f+=50),a!==41&&a!==65289||(f+=50),f}function cD(c,a,u,f,g,v){let T=null,C=lD(a,u,g,v);for(const k of f){const O=lD(a-k.x,u,g,v)+k.badness;O<=C&&(T=k,C=O)}return{index:c,x:a,priorBreak:T,badness:C}}function uD(c){return c?uD(c.priorBreak).concat(c.index):[]}function HT(c){let a=.5,u=.5;switch(c){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:a,verticalAlign:u}}function hD(c,a,u,f,g){if(!(a||u||f||g))return;const v=c.length-1,T=c[v],C=(T.x+T.metrics.advance*T.scale)*a;for(let k=0;k<=v;k++)c[k].x-=C,c[k].y+=u+f+g}function pW(c,a,u){const{horizontalAlign:f,verticalAlign:g}=HT(u),v=a[0]-c.displaySize[0]*f,T=a[1]-c.displaySize[1]*g;return{image:c,top:T,bottom:T+c.displaySize[1],left:v,right:v+c.displaySize[0]}}function dD(c,a,u,f,g,v){const T=c.image;let C;if(T.content){const ge=T.content,Re=T.pixelRatio||1;C=[ge[0]/Re,ge[1]/Re,T.displaySize[0]-ge[2]/Re,T.displaySize[1]-ge[3]/Re]}const k=a.left*v,O=a.right*v;let W,q,$,J;u==="width"||u==="both"?(J=g[0]+k-f[3],q=g[0]+O+f[1]):(J=g[0]+(k+O-T.displaySize[0])/2,q=J+T.displaySize[0]);const ie=a.top*v,ue=a.bottom*v;return u==="height"||u==="both"?(W=g[1]+ie-f[0],$=g[1]+ue+f[2]):(W=g[1]+(ie+ue-T.displaySize[1])/2,$=W+T.displaySize[1]),{image:T,top:W,right:q,bottom:$,left:J,collisionPadding:C}}class md extends j{constructor(a,u,f,g,v){super(a,u),this.angle=g,this.z=f,v!==void 0&&(this.segment=v)}clone(){return new md(this.x,this.y,this.z,this.angle,this.segment)}}function fD(c,a,u,f,g){if(a.segment===void 0)return!0;let v=a,T=a.segment+1,C=0;for(;C>-u/2;){if(T--,T<0)return!1;C-=c[T].dist(v),v=c[T]}C+=c[T].dist(c[T+1]),T++;const k=[];let O=0;for(;C<u/2;){const W=c[T],q=c[T+1];if(!q)return!1;let $=c[T-1].angleTo(W)-W.angleTo(q);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:C,angleDelta:$}),O+=$;C-k[0].distance>f;)O-=k.shift().angleDelta;if(O>g)return!1;T++,C+=W.dist(q)}return!0}function pD(c){let a=0;for(let u=0;u<c.length-1;u++)a+=c[u].dist(c[u+1]);return a}function mD(c,a,u){return c?.6*a*u:0}function gD(c,a){return Math.max(c?c.right-c.left:0,a?a.right-a.left:0)}function mW(c,a,u,f,g,v){const T=mD(u,g,v),C=gD(u,f)*v;let k=0;const O=pD(c)/2;for(let W=0;W<c.length-1;W++){const q=c[W],$=c[W+1],J=q.dist($);if(k+J>O){const ie=(O-k)/J,ue=di(q.x,$.x,ie),ge=di(q.y,$.y,ie),Re=new md(ue,ge,0,$.angleTo(q),W);return!T||fD(c,Re,C,T,a)?Re:void 0}k+=J}}function gW(c,a,u,f,g,v,T,C,k){const O=mD(f,v,T),W=gD(f,g),q=W*T,$=c[0].x===0||c[0].x===k||c[0].y===0||c[0].y===k;return a-q<a/4&&(a=q+a/4),_D(c,$?a/2*C%a:(W/2+2*v)*T*C%a,a,O,u,q,$,!1,k)}function _D(c,a,u,f,g,v,T,C,k){const O=v/2,W=pD(c);let q=0,$=a-u,J=[];for(let ie=0;ie<c.length-1;ie++){const ue=c[ie],ge=c[ie+1],Re=ue.dist(ge),je=ge.angleTo(ue);for(;$+u<q+Re;){$+=u;const ke=($-q)/Re,Ge=di(ue.x,ge.x,ke),$e=di(ue.y,ge.y,ke);if(Ge>=0&&Ge<k&&$e>=0&&$e<k&&$-O>=0&&$+O<=W){const qe=new md(Ge,$e,0,je,ie);qe._round(),f&&!fD(c,qe,v,f,g)||J.push(qe)}}q+=Re}return C||J.length||T||(J=_D(c,q/2,u,f,g,v,T,!0,k)),J}function yD(c,a,u,f,g){const v=[];for(let T=0;T<c.length;T++){const C=c[T];let k;for(let O=0;O<C.length-1;O++){let W=C[O],q=C[O+1];W.x<a&&q.x<a||(W.x<a?W=new j(a,W.y+(a-W.x)/(q.x-W.x)*(q.y-W.y))._round():q.x<a&&(q=new j(a,W.y+(a-W.x)/(q.x-W.x)*(q.y-W.y))._round()),W.y<u&&q.y<u||(W.y<u?W=new j(W.x+(u-W.y)/(q.y-W.y)*(q.x-W.x),u)._round():q.y<u&&(q=new j(W.x+(u-W.y)/(q.y-W.y)*(q.x-W.x),u)._round()),W.x>=f&&q.x>=f||(W.x>=f?W=new j(f,W.y+(f-W.x)/(q.x-W.x)*(q.y-W.y))._round():q.x>=f&&(q=new j(f,W.y+(f-W.x)/(q.x-W.x)*(q.y-W.y))._round()),W.y>=g&&q.y>=g||(W.y>=g?W=new j(W.x+(g-W.y)/(q.y-W.y)*(q.x-W.x),g)._round():q.y>=g&&(q=new j(W.x+(g-W.y)/(q.y-W.y)*(q.x-W.x),g)._round()),k&&W.equals(k[k.length-1])||(k=[W],v.push(k)),k.push(q)))))}}return v}dn(md,"Anchor");const O0=1e20;function xD(c,a,u,f,g,v,T,C,k){for(let O=a;O<a+f;O++)vD(c,u*v+O,v,g,T,C,k);for(let O=u;O<u+g;O++)vD(c,O*v+a,1,f,T,C,k)}function vD(c,a,u,f,g,v,T){v[0]=0,T[0]=-O0,T[1]=O0,g[0]=c[a];for(let C=1,k=0,O=0;C<f;C++){g[C]=c[a+C*u];const W=C*C;do{const q=v[k];O=(g[C]-g[q]+W-q*q)/(C-q)/2}while(O<=T[k]&&--k>-1);k++,v[k]=C,T[k]=O,T[k+1]=O0}for(let C=0,k=0;C<f;C++){for(;T[k+1]<C;)k++;const O=v[k],W=C-O;c[a+C*u]=g[O]+W*W}}const jT={none:0,ideographs:1,all:2};class s_{constructor(a,u,f){this.requestManager=a,this.localGlyphMode=u,this.localFontFamily=f,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(a){this.url=a}getGlyphs(a,u){const f=[];for(const g in a)for(const v of a[g])f.push({stack:g,id:v});ce(f,({stack:g,id:v},T)=>{let C=this.entries[g];C||(C=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=C.glyphs[v];if(k!==void 0)return void T(null,{stack:g,id:v,glyph:k});if(k=this._tinySDF(C,g,v),k)return C.glyphs[v]=k,void T(null,{stack:g,id:v,glyph:k});const O=Math.floor(v/256);if(256*O>65535)return void T(new Error("glyphs > 65535 not supported"));if(C.ranges[O])return void T(null,{stack:g,id:v,glyph:k});let W=C.requests[O];W||(W=C.requests[O]=[],s_.loadGlyphRange(g,O,this.url,this.requestManager,(q,$)=>{if($){C.ascender=$.ascender,C.descender=$.descender;for(const J in $.glyphs)this._doesCharSupportLocalGlyph(+J)||(C.glyphs[+J]=$.glyphs[+J]);C.ranges[O]=!0}for(const J of W)J(q,$);delete C.requests[O]})),W.push((q,$)=>{q?T(q):$&&T(null,{stack:g,id:v,glyph:$.glyphs[v]||null})})},(g,v)=>{if(g)u(g);else if(v){const T={};for(const{stack:C,id:k,glyph:O}of v)T[C]===void 0&&(T[C]={}),T[C].glyphs===void 0&&(T[C].glyphs={}),T[C].glyphs[k]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics},T[C].ascender=this.entries[C].ascender,T[C].descender=this.entries[C].descender;u(null,T)}})}_doesCharSupportLocalGlyph(a){return this.localGlyphMode!==jT.none&&(this.localGlyphMode===jT.all?!!this.localFontFamily:!!this.localFontFamily&&(xn(a)||Ef(a)||ih(a)||rh(a)||bl(a)))}_tinySDF(a,u,f){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(f))return;let v=a.tinySDF;if(!v){let ue="400";/bold/i.test(u)?ue="900":/medium/i.test(u)?ue="500":/light/i.test(u)&&(ue="200"),v=a.tinySDF=new s_.TinySDF({fontFamily:g,fontWeight:ue,fontSize:48,buffer:6,radius:16}),v.fontWeight=ue}if(this.localGlyphs[v.fontWeight][f])return this.localGlyphs[v.fontWeight][f];const T=String.fromCharCode(f),{data:C,width:k,height:O,glyphWidth:W,glyphHeight:q,glyphLeft:$,glyphTop:J,glyphAdvance:ie}=v.draw(T);return this.localGlyphs[v.fontWeight][f]={id:f,bitmap:new fd({width:k,height:O},C),metrics:{width:W/2,height:q/2,left:$/2,top:J/2-27,advance:ie/2,localGlyph:!0}}}}function wD(c,a,u,f){const g=[],v=c.image,T=v.pixelRatio,C=v.paddedRect.w-2,k=v.paddedRect.h-2,O=c.right-c.left,W=c.bottom-c.top,q=v.stretchX||[[0,C]],$=v.stretchY||[[0,k]],J=(yt,Pt)=>yt+Pt[1]-Pt[0],ie=q.reduce(J,0),ue=$.reduce(J,0),ge=C-ie,Re=k-ue;let je=0,ke=ie,Ge=0,$e=ue,qe=0,dt=ge,ut=0,Tt=Re;if(v.content&&f){const yt=v.content;je=fw(q,0,yt[0]),Ge=fw($,0,yt[1]),ke=fw(q,yt[0],yt[2]),$e=fw($,yt[1],yt[3]),qe=yt[0]-je,ut=yt[1]-Ge,dt=yt[2]-yt[0]-ke,Tt=yt[3]-yt[1]-$e}const Ht=(yt,Pt,Rt,Bt)=>{const jt=pw(yt.stretch-je,ke,O,c.left),xt=mw(yt.fixed-qe,dt,yt.stretch,ie),en=pw(Pt.stretch-Ge,$e,W,c.top),Wn=mw(Pt.fixed-ut,Tt,Pt.stretch,ue),un=pw(Rt.stretch-je,ke,O,c.left),Tn=mw(Rt.fixed-qe,dt,Rt.stretch,ie),rn=pw(Bt.stretch-Ge,$e,W,c.top),jn=mw(Bt.fixed-ut,Tt,Bt.stretch,ue),gi=new j(jt,en),pi=new j(un,en),ui=new j(un,rn),$n=new j(jt,rn),Yi=new j(xt/T,Wn/T),ei=new j(Tn/T,jn/T),_i=a*Math.PI/180;if(_i){const fr=Math.sin(_i),gr=Math.cos(_i),Mr=[gr,-fr,fr,gr];gi._matMult(Mr),pi._matMult(Mr),$n._matMult(Mr),ui._matMult(Mr)}const sr=yt.stretch+yt.fixed,mr=Pt.stretch+Pt.fixed;return{tl:gi,tr:pi,bl:$n,br:ui,tex:{x:v.paddedRect.x+1+sr,y:v.paddedRect.y+1+mr,w:Rt.stretch+Rt.fixed-sr,h:Bt.stretch+Bt.fixed-mr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yi,pixelOffsetBR:ei,minFontScaleX:dt/T/O,minFontScaleY:Tt/T/W,isSDF:u}};if(f&&(v.stretchX||v.stretchY)){const yt=bD(q,ge,ie),Pt=bD($,Re,ue);for(let Rt=0;Rt<yt.length-1;Rt++){const Bt=yt[Rt],jt=yt[Rt+1];for(let xt=0;xt<Pt.length-1;xt++)g.push(Ht(Bt,Pt[xt],jt,Pt[xt+1]))}}else g.push(Ht({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:k+1}));return g}function fw(c,a,u){let f=0;for(const g of c)f+=Math.max(a,Math.min(u,g[1]))-Math.max(a,Math.min(u,g[0]));return f}function bD(c,a,u){const f=[{fixed:-1,stretch:0}];for(const[g,v]of c){const T=f[f.length-1];f.push({fixed:g-T.stretch,stretch:T.stretch}),f.push({fixed:g-T.stretch,stretch:T.stretch+(v-g)})}return f.push({fixed:a+1,stretch:u}),f}function pw(c,a,u,f){return c/a*u+f}function mw(c,a,u,f){return c-a*u/f}function _W(c,a,u,f){const g=a+c.positionedLines[f].lineOffset;return f===0?u+g/2:u+(g+(a+c.positionedLines[f-1].lineOffset))/2}s_.loadGlyphRange=function(c,a,u,f,g){const v=256*a,T=v+255,C=f.transformRequest(f.normalizeGlyphsURL(u).replace("{fontstack}",c).replace("{range}",`${v}-${T}`),Dt.Glyphs);Zt(C,(k,O)=>{if(k)g(k);else if(O){const W={},q=function($){return new R0($).readFields(cW,{})}(O);for(const $ of q.glyphs)W[$.id]=$;g(null,{glyphs:W,ascender:q.ascender,descender:q.descender})}})},s_.TinySDF=class{constructor({fontSize:c=24,buffer:a=3,radius:u=8,cutoff:f=.25,fontFamily:g="sans-serif",fontWeight:v="normal",fontStyle:T="normal"}={}){this.buffer=a,this.cutoff=f,this.radius=u;const C=this.size=c+4*a,k=this._createCanvas(C),O=this.ctx=k.getContext("2d",{willReadFrequently:!0});O.font=`${T} ${v} ${c}px ${g}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(c){const a=document.createElement("canvas");return a.width=a.height=c,a}draw(c){const{width:a,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:g,actualBoundingBoxRight:v}=this.ctx.measureText(c),T=Math.ceil(u),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(v-g))),k=Math.min(this.size-this.buffer,T+Math.ceil(f)),O=C+2*this.buffer,W=k+2*this.buffer,q=Math.max(O*W,0),$=new Uint8ClampedArray(q),J={data:$,width:O,height:W,glyphWidth:C,glyphHeight:k,glyphTop:T,glyphLeft:0,glyphAdvance:a};if(C===0||k===0)return J;const{ctx:ie,buffer:ue,gridInner:ge,gridOuter:Re}=this;ie.clearRect(ue,ue,C,k),ie.fillText(c,ue,ue+T);const je=ie.getImageData(ue,ue,C,k);Re.fill(O0,0,q),ge.fill(0,0,q);for(let ke=0;ke<k;ke++)for(let Ge=0;Ge<C;Ge++){const $e=je.data[4*(ke*C+Ge)+3]/255;if($e===0)continue;const qe=(ke+ue)*O+Ge+ue;if($e===1)Re[qe]=0,ge[qe]=O0;else{const dt=.5-$e;Re[qe]=dt>0?dt*dt:0,ge[qe]=dt<0?dt*dt:0}}xD(Re,0,0,O,W,O,this.f,this.v,this.z),xD(ge,ue,ue,C,k,O,this.f,this.v,this.z);for(let ke=0;ke<q;ke++){const Ge=Math.sqrt(Re[ke])-Math.sqrt(ge[ke]);$[ke]=Math.round(255-255*(Ge/this.radius+this.cutoff))}return J}};class yW{constructor(a=[],u=xW){if(this.data=a,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],u=this.data.pop();return this.length--,this.length>0&&(this.data[0]=u,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:u,compare:f}=this,g=u[a];for(;a>0;){const v=a-1>>1,T=u[v];if(f(g,T)>=0)break;u[a]=T,a=v}u[a]=g}_down(a){const{data:u,compare:f}=this,g=this.length>>1,v=u[a];for(;a<g;){let T=1+(a<<1),C=u[T];const k=T+1;if(k<this.length&&f(u[k],C)<0&&(T=k,C=u[k]),f(C,v)>=0)break;u[a]=C,a=T}u[a]=v}}function xW(c,a){return c<a?-1:c>a?1:0}function vW(c,a=1,u=!1){let f=1/0,g=1/0,v=-1/0,T=-1/0;const C=c[0];for(let J=0;J<C.length;J++){const ie=C[J];(!J||ie.x<f)&&(f=ie.x),(!J||ie.y<g)&&(g=ie.y),(!J||ie.x>v)&&(v=ie.x),(!J||ie.y>T)&&(T=ie.y)}const k=Math.min(v-f,T-g);let O=k/2;const W=new yW([],wW);if(k===0)return new j(f,g);for(let J=f;J<v;J+=k)for(let ie=g;ie<T;ie+=k)W.push(new o_(J+O,ie+O,O,c));let q=function(J){let ie=0,ue=0,ge=0;const Re=J[0];for(let je=0,ke=Re.length,Ge=ke-1;je<ke;Ge=je++){const $e=Re[je],qe=Re[Ge],dt=$e.x*qe.y-qe.x*$e.y;ue+=($e.x+qe.x)*dt,ge+=($e.y+qe.y)*dt,ie+=3*dt}return new o_(ue/ie,ge/ie,0,J)}(c),$=W.length;for(;W.length;){const J=W.pop();(J.d>q.d||!q.d)&&(q=J,u&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,$)),J.max-q.d<=a||(O=J.h/2,W.push(new o_(J.p.x-O,J.p.y-O,O,c)),W.push(new o_(J.p.x+O,J.p.y-O,O,c)),W.push(new o_(J.p.x-O,J.p.y+O,O,c)),W.push(new o_(J.p.x+O,J.p.y+O,O,c)),$+=4)}return u&&(console.log(`num probes: ${$}`),console.log(`best distance: ${q.d}`)),q.p}function wW(c,a){return a.max-c.max}function o_(c,a,u,f){this.p=new j(c,a),this.h=u,this.d=function(g,v){let T=!1,C=1/0;for(let k=0;k<v.length;k++){const O=v[k];for(let W=0,q=O.length,$=q-1;W<q;$=W++){const J=O[W],ie=O[$];J.y>g.y!=ie.y>g.y&&g.x<(ie.x-J.x)*(g.y-J.y)/(ie.y-J.y)+J.x&&(T=!T),C=Math.min(C,ak(g,J,ie))}}return(T?1:-1)*Math.sqrt(C)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}const qT=Number.POSITIVE_INFINITY,bW=Math.sqrt(2);function SD(c,[a,u]){let f=0,g=0;if(u===qT){a<0&&(a=0);const v=a/bW;switch(c){case"top-right":case"top-left":g=v-7;break;case"bottom-right":case"bottom-left":g=7-v;break;case"bottom":g=7-a;break;case"top":g=a-7}switch(c){case"top-right":case"bottom-right":f=-v;break;case"top-left":case"bottom-left":f=v;break;case"left":f=a;break;case"right":f=-a}}else{switch(a=Math.abs(a),u=Math.abs(u),c){case"top-right":case"top-left":case"top":g=u-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-u}switch(c){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}}return[f,g]}function SW(c,a,u,f,g,v,T,C,k,O){c.createArrays(),c.tilePixelRatio=te/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const W=c.layers[0].layout,q=c.layers[0]._unevaluatedLayout._values,$={};if(c.textSizeData.kind==="composite"){const{minZoom:ue,maxZoom:ge}=c.textSizeData;$.compositeTextSizes=[q["text-size"].possiblyEvaluate(new it(ue),C),q["text-size"].possiblyEvaluate(new it(ge),C)]}if(c.iconSizeData.kind==="composite"){const{minZoom:ue,maxZoom:ge}=c.iconSizeData;$.compositeIconSizes=[q["icon-size"].possiblyEvaluate(new it(ue),C),q["icon-size"].possiblyEvaluate(new it(ge),C)]}$.layoutTextSize=q["text-size"].possiblyEvaluate(new it(k+1),C),$.layoutIconSize=q["icon-size"].possiblyEvaluate(new it(k+1),C),$.textMaxSize=q["text-size"].possiblyEvaluate(new it(18),C);const J=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",ie=W.get("text-size");for(const ue of c.features){const ge=W.get("text-font").evaluate(ue,{},C).join(","),Re=ie.evaluate(ue,{},C),je=$.layoutTextSize.evaluate(ue,{},C),ke=($.layoutIconSize.evaluate(ue,{},C),{horizontal:{},vertical:void 0}),Ge=ue.text;let $e,qe=[0,0];if(Ge){const Tt=Ge.toString(),Ht=W.get("text-letter-spacing").evaluate(ue,{},C)*bo,yt=W.get("text-line-height").evaluate(ue,{},C)*bo,Pt=U(Tt)?Ht:0,Rt=W.get("text-anchor").evaluate(ue,{},C),Bt=W.get("text-variable-anchor");if(!Bt){const un=W.get("text-radial-offset").evaluate(ue,{},C);qe=un?SD(Rt,[un*bo,qT]):W.get("text-offset").evaluate(ue,{},C).map(Tn=>Tn*bo)}let jt=J?"center":W.get("text-justify").evaluate(ue,{},C);const xt=W.get("symbol-placement")==="point",en=xt?W.get("text-max-width").evaluate(ue,{},C)*bo:1/0,Wn=un=>{c.allowVerticalPlacement&&B(Tt)&&(ke.vertical=WT(Ge,a,u,g,ge,en,yt,Rt,un,Pt,qe,El.vertical,!0,je,Re))};if(!J&&Bt){const un=jt==="auto"?Bt.map(rn=>ZT(rn)):[jt];let Tn=!1;for(let rn=0;rn<un.length;rn++){const jn=un[rn];if(!ke.horizontal[jn])if(Tn)ke.horizontal[jn]=ke.horizontal[0];else{const gi=WT(Ge,a,u,g,ge,en,yt,"center",jn,Pt,qe,El.horizontal,!1,je,Re);gi&&(ke.horizontal[jn]=gi,Tn=gi.positionedLines.length===1)}}Wn("left")}else{if(jt==="auto"&&(jt=ZT(Rt)),xt||W.get("text-writing-mode").indexOf("horizontal")>=0||!B(Tt)){const un=WT(Ge,a,u,g,ge,en,yt,Rt,jt,Pt,qe,El.horizontal,!1,je,Re);un&&(ke.horizontal[jt]=un)}Wn(xt?"left":jt)}}let dt=!1;if(ue.icon&&ue.icon.name){const Tt=f[ue.icon.name];Tt&&($e=pW(g[ue.icon.name],W.get("icon-offset").evaluate(ue,{},C),W.get("icon-anchor").evaluate(ue,{},C)),dt=Tt.sdf,c.sdfIcons===void 0?c.sdfIcons=Tt.sdf:c.sdfIcons!==Tt.sdf&&At("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Tt.pixelRatio!==c.pixelRatio||W.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const ut=TD(ke.horizontal)||ke.vertical;c.iconsInText||(c.iconsInText=!!ut&&ut.iconsInText),(ut||$e)&&MW(c,ue,ke,$e,f,$,je,0,qe,dt,T,C,O)}v&&c.generateCollisionDebugBuffers(k,c.collisionBoxArray)}function ZT(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function MW(c,a,u,f,g,v,T,C,k,O,W,q,$){let J=v.textMaxSize.evaluate(a,{},q);J===void 0&&(J=T);const ie=c.layers[0].layout,ue=ie.get("icon-offset").evaluate(a,{},q),ge=TD(u.horizontal)||u.vertical,Re=$.name==="globe",je=T/24,ke=c.tilePixelRatio*J/24,Ge=(Pt=c.overscaling,c.zoom>18&&Pt>2&&(Pt>>=1),Math.max(te/(512*Pt),1)*ie.get("symbol-spacing")),$e=ie.get("text-padding")*c.tilePixelRatio,qe=ie.get("icon-padding")*c.tilePixelRatio,dt=ne(ie.get("text-max-angle")),ut=ie.get("text-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",Tt=ie.get("icon-rotation-alignment")==="map"&&ie.get("symbol-placement")!=="point",Ht=ie.get("symbol-placement"),yt=Ge/2;var Pt;const Rt=ie.get("icon-text-fit");let Bt;f&&Rt!=="none"&&(c.allowVerticalPlacement&&u.vertical&&(Bt=dD(f,u.vertical,Rt,ie.get("icon-text-fit-padding"),ue,je)),ge&&(f=dD(f,ge,Rt,ie.get("icon-text-fit-padding"),ue,je)));const jt=(xt,en,Wn)=>{if(en.x<0||en.x>=te||en.y<0||en.y>=te)return;let un=null;if(Re){const{x:Tn,y:rn,z:jn}=$.projectTilePoint(en.x,en.y,Wn);un={anchor:new md(Tn,rn,jn,0,void 0),up:$.upVector(Wn,en.x,en.y)}}(function(Tn,rn,jn,gi,pi,ui,$n,Yi,ei,_i,sr,mr,fr,gr,Mr,Gr,Qs,Ki,xs,os,Di,Lr,Ds,or,Yr){const Oo=Tn.addToLineVertexArray(rn,gi);let eo,to,ta,no,_d,f_,Z0,X0=0,c3=0,u3=0,h3=0,uE=-1,hE=-1;const mh={};let d3=Ua.exports("");const vm=jn?jn.anchor:rn;let dE=0,fE=0;if(ei._unevaluatedLayout.getValue("text-radial-offset")===void 0?[dE,fE]=ei.layout.get("text-offset").evaluate(Di,{},Yr).map(Wa=>Wa*bo):(dE=ei.layout.get("text-radial-offset").evaluate(Di,{},Yr)*bo,fE=qT),Tn.allowVerticalPlacement&&pi.vertical){const Wa=pi.vertical;if(Mr)f_=XT(Wa),Yi&&(Z0=XT(Yi));else{const Ha=ei.layout.get("text-rotate").evaluate(Di,{},Yr)+90;ta=gw(_i,vm,rn,sr,mr,fr,Wa,gr,Ha,Gr),Yi&&(no=gw(_i,vm,rn,sr,mr,fr,Yi,Ki,Ha))}}if(ui){const Wa=ei.layout.get("icon-rotate").evaluate(Di,{},Yr),Ha=ei.layout.get("icon-text-fit")!=="none",$0=wD(ui,Wa,Ds,Ha),mE=Yi?wD(Yi,Wa,Ds,Ha):void 0;to=gw(_i,vm,rn,sr,mr,fr,ui,Ki,Wa),X0=4*$0.length;const f3=Tn.iconSizeData;let wm=null;f3.kind==="source"?(wm=[uh*ei.layout.get("icon-size").evaluate(Di,{},Yr)],wm[0]>Cf&&At(`${Tn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):f3.kind==="composite"&&(wm=[uh*Lr.compositeIconSizes[0].evaluate(Di,{},Yr),uh*Lr.compositeIconSizes[1].evaluate(Di,{},Yr)],(wm[0]>Cf||wm[1]>Cf)&&At(`${Tn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Tn.addSymbols(Tn.icon,$0,wm,os,xs,Di,!1,jn,rn,Oo.lineStartIndex,Oo.lineLength,-1,or,Yr),uE=Tn.icon.placedSymbolArray.length-1,mE&&(c3=4*mE.length,Tn.addSymbols(Tn.icon,mE,wm,os,xs,Di,El.vertical,jn,rn,Oo.lineStartIndex,Oo.lineLength,-1,or,Yr),hE=Tn.icon.placedSymbolArray.length-1)}for(const Wa in pi.horizontal){const Ha=pi.horizontal[Wa];eo||(d3=Ua.exports(Ha.text),Mr?_d=XT(Ha):eo=gw(_i,vm,rn,sr,mr,fr,Ha,gr,ei.layout.get("text-rotate").evaluate(Di,{},Yr),Gr));const $0=Ha.positionedLines.length===1;if(u3+=MD(Tn,jn,rn,Ha,$n,ei,Mr,Di,Gr,Oo,pi.vertical?El.horizontal:El.horizontalOnly,$0?Object.keys(pi.horizontal):[Wa],mh,uE,Lr,or,Yr),$0)break}pi.vertical&&(h3+=MD(Tn,jn,rn,pi.vertical,$n,ei,Mr,Di,Gr,Oo,El.vertical,["vertical"],mh,hE,Lr,or,Yr));let Rf=-1;const pE=(Wa,Ha)=>Wa?Math.max(Wa,Ha):Ha;Rf=pE(_d,Rf),Rf=pE(f_,Rf),Rf=pE(Z0,Rf);const nH=Rf>-1?1:0;Tn.glyphOffsetArray.length>=Pf.MAX_GLYPHS&&At("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Di.sortKey!==void 0&&Tn.addToSortKeyRanges(Tn.symbolInstances.length,Di.sortKey),Tn.symbolInstances.emplaceBack(vm.x,vm.y,vm.z,rn.x,rn.y,mh.right>=0?mh.right:-1,mh.center>=0?mh.center:-1,mh.left>=0?mh.left:-1,mh.vertical>=0?mh.vertical:-1,uE,hE,d3,eo!==void 0?eo:Tn.collisionBoxArray.length,eo!==void 0?eo+1:Tn.collisionBoxArray.length,ta!==void 0?ta:Tn.collisionBoxArray.length,ta!==void 0?ta+1:Tn.collisionBoxArray.length,to!==void 0?to:Tn.collisionBoxArray.length,to!==void 0?to+1:Tn.collisionBoxArray.length,no||Tn.collisionBoxArray.length,no?no+1:Tn.collisionBoxArray.length,sr,u3,h3,X0,c3,nH,0,dE,fE,Rf)})(c,en,un,xt,u,f,g,Bt,c.layers[0],c.collisionBoxArray,a.index,a.sourceLayerIndex,c.index,$e,ut,k,0,qe,Tt,ue,a,v,O,W,q)};if(Ht==="line")for(const xt of yD(a.geometry,0,0,te,te)){const en=gW(xt,Ge,dt,u.vertical||ge,f,24,ke,c.overscaling,te);for(const Wn of en){const un=ge;un&&TW(c,un.text,yt,Wn)||jt(xt,Wn,q)}}else if(Ht==="line-center"){for(const xt of a.geometry)if(xt.length>1){const en=mW(xt,dt,u.vertical||ge,f,24,ke);en&&jt(xt,en,q)}}else if(a.type==="Polygon")for(const xt of zT(a.geometry,0)){const en=vW(xt,16);jt(xt[0],new md(en.x,en.y,0,0,void 0),q)}else if(a.type==="LineString")for(const xt of a.geometry)jt(xt,new md(xt[0].x,xt[0].y,0,0,void 0),q);else if(a.type==="Point")for(const xt of a.geometry)for(const en of xt)jt([en],new md(en.x,en.y,0,0,void 0),q)}const Cf=32640;function MD(c,a,u,f,g,v,T,C,k,O,W,q,$,J,ie,ue,ge){const Re=function(Ge,$e,qe,dt,ut,Tt,Ht,yt){const Pt=[];if($e.positionedLines.length===0)return Pt;const Rt=dt.layout.get("text-rotate").evaluate(Tt,{})*Math.PI/180,Bt=function(un){const Tn=un[0],rn=un[1],jn=Tn*rn;return jn>0?[Tn,-rn]:jn<0?[-Tn,rn]:Tn===0?[rn,Tn]:[rn,-Tn]}(qe);let jt=Math.abs($e.top-$e.bottom);for(const un of $e.positionedLines)jt-=un.lineOffset;const xt=$e.positionedLines.length,en=jt/xt;let Wn=$e.top-qe[1];for(let un=0;un<xt;++un){const Tn=$e.positionedLines[un];Wn=_W($e,en,Wn,un);for(const rn of Tn.positionedGlyphs){if(!rn.rect)continue;const jn=rn.rect||{};let gi=4,pi=!0,ui=1,$n=0;if(rn.imageName){const or=Ht[rn.imageName];if(!or)continue;if(or.sdf){At("SDF images are not supported in formatted text and will be ignored.");continue}pi=!1,ui=or.pixelRatio,gi=1/ui}const Yi=(ut||yt)&&rn.vertical,ei=rn.metrics.advance*rn.scale/2,_i=rn.metrics,sr=rn.rect;if(sr===null)continue;yt&&$e.verticalizable&&($n=rn.imageName?ei-rn.metrics.width*rn.scale/2:0);const mr=ut?[rn.x+ei,rn.y]:[0,0];let fr=[0,0],gr=[0,0],Mr=!1;ut||(Yi?(gr=[rn.x+ei+Bt[0],rn.y+Bt[1]-$n],Mr=!0):fr=[rn.x+ei+qe[0],rn.y+qe[1]-$n]);const Gr=sr.w*rn.scale/(ui*(rn.localGlyph?2:1)),Qs=sr.h*rn.scale/(ui*(rn.localGlyph?2:1));let Ki,xs,os,Di;if(Yi){const or=rn.y-Wn,Yr=new j(-ei,ei-or),Oo=-Math.PI/2,eo=new j(...gr);Ki=new j(-ei+fr[0],fr[1]),Ki._rotateAround(Oo,Yr)._add(eo),Ki.x+=-or+ei,Ki.y-=(_i.left-gi)*rn.scale;const to=rn.imageName?_i.advance*rn.scale:bo*rn.scale,ta=String.fromCharCode(rn.glyph);J8(ta)?Ki.x+=(1-gi)*rn.scale:Q8(ta)?Ki.x+=to-_i.height*rn.scale+(-gi-1)*rn.scale:Ki.x+=rn.imageName||_i.width+2*gi===sr.w&&_i.height+2*gi===sr.h?(to-Qs)/2:(to-(_i.height+2*gi)*rn.scale)/2,xs=new j(Ki.x,Ki.y-Gr),os=new j(Ki.x+Qs,Ki.y),Di=new j(Ki.x+Qs,Ki.y-Gr)}else{const or=(_i.left-gi)*rn.scale-ei+fr[0],Yr=(-_i.top-gi)*rn.scale+fr[1],Oo=or+Gr,eo=Yr+Qs;Ki=new j(or,Yr),xs=new j(Oo,Yr),os=new j(or,eo),Di=new j(Oo,eo)}if(Rt){let or;or=ut?new j(0,0):Mr?new j(Bt[0],Bt[1]):new j(qe[0],qe[1]),Ki._rotateAround(Rt,or),xs._rotateAround(Rt,or),os._rotateAround(Rt,or),Di._rotateAround(Rt,or)}const Lr=new j(0,0),Ds=new j(0,0);Pt.push({tl:Ki,tr:xs,bl:os,br:Di,tex:jn,writingMode:$e.writingMode,glyphOffset:mr,sectionIndex:rn.sectionIndex,isSDF:pi,pixelOffsetTL:Lr,pixelOffsetBR:Ds,minFontScaleX:0,minFontScaleY:0})}}return Pt}(0,f,k,v,T,C,g,c.allowVerticalPlacement),je=c.textSizeData;let ke=null;je.kind==="source"?(ke=[uh*v.layout.get("text-size").evaluate(C,{},ge)],ke[0]>Cf&&At(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):je.kind==="composite"&&(ke=[uh*ie.compositeTextSizes[0].evaluate(C,{},ge),uh*ie.compositeTextSizes[1].evaluate(C,{},ge)],(ke[0]>Cf||ke[1]>Cf)&&At(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,Re,ke,k,T,C,W,a,u,O.lineStartIndex,O.lineLength,J,ue,ge);for(const Ge of q)$[Ge]=c.text.placedSymbolArray.length-1;return 4*Re.length}function TD(c){for(const a in c)return c[a];return null}function gw(c,a,u,f,g,v,T,C,k,O){let W=T.top,q=T.bottom,$=T.left,J=T.right;const ie=T.collisionPadding;if(ie&&($-=ie[0],W-=ie[1],J+=ie[2],q+=ie[3]),k){const ue=new j($,W),ge=new j(J,W),Re=new j($,q),je=new j(J,q),ke=ne(k);let Ge=new j(0,0);O&&(Ge=new j(O[0],O[1])),ue._rotateAround(ke,Ge),ge._rotateAround(ke,Ge),Re._rotateAround(ke,Ge),je._rotateAround(ke,Ge),$=Math.min(ue.x,ge.x,Re.x,je.x),J=Math.max(ue.x,ge.x,Re.x,je.x),W=Math.min(ue.y,ge.y,Re.y,je.y),q=Math.max(ue.y,ge.y,Re.y,je.y)}return c.emplaceBack(a.x,a.y,a.z,u.x,u.y,$,W,J,q,C,f,g,v),c.length-1}function XT(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const a=c.bottom-c.top;return a>0?Math.max(10,a):null}function TW(c,a,u,f){const g=c.compareText;if(a in g){const v=g[a];for(let T=v.length-1;T>=0;T--)if(f.dist(v[T])<u)return!0}else g[a]=[];return g[a].push(f),!1}const EW=an([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:ED}=EW,AD=an([{name:"a_pos_3",components:3,type:"Int16"}]);var F0=an([{name:"a_pos",type:"Int16",components:2}]);const gd=te/Math.PI/2,$T=2*Ii(1,0)*gd*Math.PI,a_=64,l_=[a_,32,16],oc=-gd,ac=gd,AW=[new Qo([oc,oc,oc],[ac,ac,ac]),new Qo([oc,oc,oc],[0,0,ac]),new Qo([0,oc,oc],[ac,0,ac]),new Qo([oc,0,oc],[0,ac,ac]),new Qo([0,0,oc],[ac,ac,ac])];function CD(c,a,u,f=!0){const g=Tl([],c._camera.position,c.worldSize),v=[a,u,1,1];mm(v,v,c.pixelMatrixInverse),xk(v,v,1/v[3]);const T=Jo([],uu([],v,g)),C=c.globeMatrix,k=[C[12],C[13],C[14]],O=uu([],k,g),W=y0(O),q=Jo([],O),$=c.worldSize/(2*Math.PI),J=sc(q,T),ie=Math.asin($/W);if(ie<Math.acos(J)){if(!f)return null;const Ht=[],yt=[];Tl(Ht,T,W/J),Jo(yt,uu(yt,Ht,O)),Jo(T,dd(T,O,Tl(T,yt,Math.tan(ie)*W)))}const ue=[];new AT(g,T).closestPointOnSphere(k,$,ue);const ge=Jo([],ai(C,0)),Re=Jo([],ai(C,1)),je=Jo([],ai(C,2)),ke=sc(ge,ue),Ge=sc(Re,ue),$e=sc(je,ue),qe=he(Math.asin(-Ge/$));let dt=he(Math.atan2(ke,$e));dt=c.center.lng+function(Ht,yt){const Pt=(yt-Ht+180)%360-180;return Pt<-180?Pt+360:Pt}(c.center.lng,dt);const ut=Qn(dt),Tt=fe(Gn(qe),0,1);return new Mt(ut,Tt)}class CW{constructor(a,u,f){this.a=uu([],a,f),this.b=uu([],u,f),this.center=f;const g=Jo([],this.a),v=Jo([],this.b);this.angle=Math.acos(sc(g,v))}}function YT(c,a){if(c.angle===0)return null;let u;return u=c.a[a]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[a]/c.a[a]/Math.sin(c.angle)-1/Math.tan(c.angle)),u<0||u>1?null:function(f,g,v,T){const C=Math.sin(v);return f*(Math.sin((1-T)*v)/C)+g*(Math.sin(T*v)/C)}(c.a[a],c.b[a],c.angle,fe(u,0,1))+c.center[a]}function hh(c){if(c.z<=1)return AW[c.z+2*c.y+c.x];const a=KT(_w(c));return Qo.fromPoints(a)}function _m(c,a,u){return Tl(c,c,1-u),w0(c,c,a,u)}function ID(c,a){const u=u_(a.zoom);if(u===0)return hh(c);const f=_w(c),g=KT(f),v=Qn(f.getWest())*a.worldSize,T=Qn(f.getEast())*a.worldSize,C=Gn(f.getNorth())*a.worldSize,k=Gn(f.getSouth())*a.worldSize,O=[v,C,0],W=[T,C,0],q=[v,k,0],$=[T,k,0],J=bT([],a.globeMatrix);return $r(O,O,J),$r(W,W,J),$r(q,q,J),$r($,$,J),g[0]=_m(g[0],q,u),g[1]=_m(g[1],$,u),g[2]=_m(g[2],W,u),g[3]=_m(g[3],O,u),Qo.fromPoints(g)}function PD(c,a,u){for(const f of c)$r(f,f,a),Tl(f,f,u)}function IW(c,a,u){const f=a/c.worldSize,g=c.globeMatrix;if(u.z<=1){const ut=hh(u).getCorners();return PD(ut,g,f),Qo.fromPoints(ut)}const v=_w(u),T=KT(v);PD(T,g,f);const C=Number.MAX_VALUE,k=[-C,-C,-C],O=[C,C,C];if(v.contains(c.center)){for(const Ht of T)x0(O,O,Ht),v0(k,k,Ht);k[2]=0;const ut=c.point,Tt=[ut.x*f,ut.y*f,0];return x0(O,O,Tt),v0(k,k,Tt),new Qo(O,k)}const W=[g[12]*f,g[13]*f,g[14]*f],q=v.getCenter(),$=fe(c.center.lat,-85.051129,_t),J=fe(q.lat,-85.051129,_t),ie=Qn(c.center.lng),ue=Gn($);let ge=ie-Qn(q.lng);const Re=ue-Gn(J);ge>.5?ge-=1:ge<-.5&&(ge+=1);let je=0;Math.abs(ge)>Math.abs(Re)?je=ge>=0?1:3:(je=Re>=0?0:2,w0(W,W,[g[4]*f,g[5]*f,g[6]*f],-Math.sin(ne(Re>=0?v.getSouth():v.getNorth()))*gd));const ke=T[je],Ge=T[(je+1)%4],$e=new CW(ke,Ge,W),qe=[YT($e,0)||ke[0],YT($e,1)||ke[1],YT($e,2)||ke[2]],dt=u_(c.zoom);if(dt>0){const ut=function({x:Ht,y:yt,z:Pt},Rt,Bt,jt,xt){const en=1/(1<<Pt);let Wn=Ht*en,un=Wn+en,Tn=yt*en,rn=Tn+en,jn=0;const gi=(Wn+un)/2-jt;return gi>.5?jn=-1:gi<-.5&&(jn=1),Wn=((Wn+jn)*Rt-(jt*=Rt))*Bt+jt,un=((un+jn)*Rt-jt)*Bt+jt,Tn=(Tn*Rt-(xt*=Rt))*Bt+xt,rn=(rn*Rt-xt)*Bt+xt,[[Wn,rn,0],[un,rn,0],[un,Tn,0],[Wn,Tn,0]]}(u,a,c._pixelsPerMercatorPixel,ie,ue);for(let Ht=0;Ht<T.length;Ht++)_m(T[Ht],ut[Ht],dt);const Tt=dd([],ut[je],ut[(je+1)%4]);Tl(Tt,Tt,.5),_m(qe,Tt,dt)}for(const ut of T)x0(O,O,ut),v0(k,k,ut);return O[2]=Math.min(ke[2],Ge[2]),x0(O,O,qe),v0(k,k,qe),new Qo(O,k)}function _w({x:c,y:a,z:u}){const f=1/(1<<u),g=new pt(Pn(c*f),Hi((a+1)*f)),v=new pt(Pn((c+1)*f),Hi(a*f));return new Ve(g,v)}function KT(c){const a=ne(c.getNorth()),u=ne(c.getSouth()),f=Math.cos(a),g=Math.cos(u),v=Math.sin(a),T=Math.sin(u),C=c.getWest(),k=c.getEast();return[c_(g,T,C),c_(g,T,k),c_(f,v,k),c_(f,v,C)]}function c_(c,a,u,f=gd){return u=ne(u),[c*Math.sin(u)*f,-a*f,c*Math.cos(u)*f]}function B0(c,a,u){return c_(Math.cos(ne(c)),Math.sin(ne(c)),a,u)}function N0(c,a,u,f){const g=1<<u.z,v=(c/te+u.x)/g;return B0(Hi((a/te+u.y)/g),Pn(v),f)}function yw({min:c,max:a}){return 16383/Math.max(a[0]-c[0],a[1]-c[1],a[2]-c[2])}const LD=new Float64Array(16);function U0(c){const a=yw(c),u=pk(LD,[a,a,a]);return _0(u,u,((f=[])[0]=-(g=c.min)[0],f[1]=-g[1],f[2]=-g[2],f));var f,g}function JT(c){const a=(f=c.min,(u=LD)[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=f[0],u[13]=f[1],u[14]=f[2],u[15]=1,u);var u,f;const g=1/yw(c);return pm(a,a,[g,g,g])}function kD(c,a,u,f,g){const v=function(k){const O=te/(2*Math.PI);return k/(2*Math.PI)/O}(u),T=[c,a,-u/(2*Math.PI)],C=cu(new Float64Array(16));return _0(C,C,T),pm(C,C,[v,v,v]),ST(C,C,ne(-g)),Q1(C,C,ne(-f)),C}function u_(c){return Oe(5,6,c)}function DD(c,a){const u=B0(a.lat,a.lng),f=function(ie){const ue=B0(ie._center.lat,ie._center.lng);let ge=ET([],Kg(0,1,0),ue);const Re=mk([],-ie.angle,ue);ge=$r(ge,ge,Re),mk(Re,-ie._pitch,ge);const je=Jo([],ue);return Tl(je,je,ie.cameraToCenterDistance/ie.pixelsPerMeter*$T),$r(je,je,Re),dd([],ue,je)}(c);return T=(g=TT([],f,u))[0],C=g[1],k=g[2],O=(v=u)[0],W=v[1],q=v[2],J=($=Math.sqrt(T*T+C*C+k*k)*Math.sqrt(O*O+W*W+q*q))&&sc(g,v)/$,Math.acos(Math.min(Math.max(J,-1),1));var g,v,T,C,k,O,W,q,$,J}function QT(c,a){return DD(c,a)>Math.PI/2*1.01}const RD=ne(85),PW=Math.cos(RD),LW=Math.sin(RD);function zD(c,a){const u=c.fovAboveCenter,f=c.elevation?c.elevation.getMinElevationBelowMSL()*a:0,g=(c._camera.position[2]*c.worldSize-f)/Math.cos(c._pitch),v=Math.sin(u)*g/Math.sin(Math.max(Math.PI/2-c._pitch-u,.01)),T=Math.sin(c._pitch)*v+g;return Math.min(1.01*T,g*(1/c._horizonShift))}function ym(c,a){if(!a.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:a};const u=Math.pow(2,-c.z),f=c.x*u,g=(c.x+1)*u,v=c.y*u,T=(c.y+1)*u,C=Pn(f),k=Pn(g),O=Hi(v),W=Hi(T),q=a.project(C,O),$=a.project(k,O),J=a.project(k,W),ie=a.project(C,W);let ue=Math.min(q.x,$.x,J.x,ie.x),ge=Math.min(q.y,$.y,J.y,ie.y),Re=Math.max(q.x,$.x,J.x,ie.x),je=Math.max(q.y,$.y,J.y,ie.y);const ke=u/16;function Ge(qe,dt,ut,Tt,Ht,yt){const Pt=(ut+Ht)/2,Rt=(Tt+yt)/2,Bt=a.project(Pn(Pt),Hi(Rt)),jt=Math.max(0,ue-Bt.x,ge-Bt.y,Bt.x-Re,Bt.y-je);ue=Math.min(ue,Bt.x),Re=Math.max(Re,Bt.x),ge=Math.min(ge,Bt.y),je=Math.max(je,Bt.y),jt>ke&&(Ge(qe,Bt,ut,Tt,Pt,Rt),Ge(Bt,dt,Pt,Rt,Ht,yt))}Ge(q,$,f,v,g,v),Ge($,J,g,v,g,T),Ge(J,ie,g,T,f,T),Ge(ie,q,f,T,f,v),ue-=ke,ge-=ke,Re+=ke,je+=ke;const $e=1/Math.max(Re-ue,je-ge);return{scale:$e,x:ue*$e,y:ge*$e,x2:Re*$e,y2:je*$e,projection:a}}const kW=cu(new Float32Array(16));class If{constructor(a){this.spec=a,this.name=a.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(a,u){return{x:0,y:0,z:0}}unproject(a,u){return new pt(0,0)}projectTilePoint(a,u,f){return{x:a,y:u,z:0}}locationPoint(a,u,f=!0){return a._coordinatePoint(a.locationCoordinate(u),f)}pixelsPerMeter(a,u){return Ii(1,a)*u}pixelSpaceConversion(a,u,f){return 1}farthestPixelDistance(a){return zD(a,a.pixelsPerMeter)}pointCoordinate(a,u,f,g){const v=a.horizonLineFromTop(!1),T=new j(u,Math.max(v,f));return a.rayIntersectionCoordinate(a.pointRayIntersection(T,g))}pointCoordinate3D(a,u,f){const g=new j(u,f);if(a.elevation)return a.elevation.pointCoordinate(g);{const v=this.pointCoordinate(a,g.x,g.y,0);return[v.x,v.y,v.z]}}isPointAboveHorizon(a,u){if(a.elevation)return!this.pointCoordinate3D(a,u.x,u.y);const f=a.horizonLineFromTop();return u.y<f}createInversionMatrix(a,u){return kW}createTileMatrix(a,u,f){let g,v,T;const C=f.canonical,k=cu(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=ym(C,this);g=1,v=O.x+f.wrap*O.scale,T=O.y,pm(k,k,[g/O.scale,g/O.scale,a.pixelsPerMeter/u])}else g=u/a.zoomScale(C.z),v=(C.x+Math.pow(2,C.z)*f.wrap)*g,T=C.y*g;return _0(k,k,[v,T,0]),pm(k,k,[g/te,g/te,1]),k}upVector(a,u,f){return[0,0,1]}upVectorScale(a,u,f){return{metersToTile:1}}}class DW extends If{constructor(a){super(a),this.range=[4,7],this.center=a.center||[-96,37.5];const[u,f]=this.parallels=a.parallels||[29.5,45.5],g=Math.sin(ne(u));this.n=(g+Math.sin(ne(f)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(a,u){const{n:f,c:g,r0:v}=this,T=ne(a-this.center[0]),C=ne(u),k=Math.sqrt(g-2*f*Math.sin(C))/f;return{x:k*Math.sin(T*f),y:k*Math.cos(T*f)-v,z:0}}unproject(a,u){const{n:f,c:g,r0:v}=this,T=v+u;let C=Math.atan2(a,Math.abs(T))*Math.sign(T);T*f<0&&(C-=Math.PI*Math.sign(a)*Math.sign(T));const k=ne(this.center[0])*f;C=We(C,-Math.PI-k,Math.PI-k);const O=fe(he(C/f)+this.center[0],-180,180),W=Math.asin(fe((g-(a*a+T*T)*f*f)/(2*f),-1,1)),q=fe(he(W),-85.051129,_t);return new pt(O,q)}}const V0=1.340264,G0=-.081106,W0=893e-6,H0=.003796,xw=Math.sqrt(3)/2;class RW extends If{project(a,u){u=u/180*Math.PI,a=a/180*Math.PI;const f=Math.asin(xw*Math.sin(u)),g=f*f,v=g*g*g;return{x:.5*(a*Math.cos(f)/(xw*(V0+3*G0*g+v*(7*W0+9*H0*g)))/Math.PI+.5),y:1-.5*(f*(V0+G0*g+v*(W0+H0*g))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=f*f,v=g*g*g;for(let W,q,$,J=0;J<12&&(q=f*(V0+G0*g+v*(W0+H0*g))-u,$=V0+3*G0*g+v*(7*W0+9*H0*g),W=q/$,f=fe(f-W,-Math.PI/3,Math.PI/3),g=f*f,v=g*g*g,!(Math.abs(W)<1e-12));++J);const T=xw*a*(V0+3*G0*g+v*(7*W0+9*H0*g))/Math.cos(f),C=Math.asin(Math.sin(f)/xw),k=fe(180*T/Math.PI,-180,180),O=fe(180*C/Math.PI,-85.051129,_t);return new pt(k,O)}}class zW extends If{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){return{x:.5+a/360,y:.5-u/360,z:0}}unproject(a,u){const f=360*(a-.5),g=fe(360*(.5-u),-85.051129,_t);return new pt(f,g)}}const h_=Math.PI/2;function vw(c){return Math.tan((h_+c)/2)}class OW extends If{constructor(a){super(a),this.center=a.center||[0,30];const[u,f]=this.parallels=a.parallels||[30,30];let g=ne(u),v=ne(f);this.southernCenter=g+v<0,this.southernCenter&&(g=-g,v=-v);const T=Math.cos(g),C=vw(g);this.n=g===v?Math.sin(g):Math.log(T/Math.cos(v))/Math.log(vw(v)/C),this.f=T*Math.pow(vw(g),this.n)/this.n}project(a,u){u=ne(u),this.southernCenter&&(u=-u),a=ne(a-this.center[0]);const f=1e-6,{n:g,f:v}=this;v>0?u<-h_+f&&(u=-h_+f):u>h_-f&&(u=h_-f);const T=v/Math.pow(vw(u),g);let C=T*Math.sin(g*a),k=v-T*Math.cos(g*a);return C=.5*(C/Math.PI+.5),k=.5*(k/Math.PI+.5),{x:C,y:this.southernCenter?k:1-k,z:0}}unproject(a,u){a=(2*a-.5)*Math.PI,this.southernCenter&&(u=1-u),u=(2*(1-u)-.5)*Math.PI;const{n:f,f:g}=this,v=g-u,T=Math.sign(v),C=Math.sign(f)*Math.sqrt(a*a+v*v);let k=Math.atan2(a,Math.abs(v))*T;v*f<0&&(k-=Math.PI*Math.sign(a)*T);const O=fe(he(k/f)+this.center[0],-180,180),W=fe(he(2*Math.atan(Math.pow(g/C,1/f))-h_),-85.051129,_t);return new pt(O,this.southernCenter?-W:W)}}class OD extends If{constructor(a){super(a),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(a,u){return{x:Qn(a),y:Gn(u),z:0}}unproject(a,u){const f=Pn(a),g=Hi(u);return new pt(f,g)}}const FD=ne(_t);class FW extends If{project(a,u){const f=(u=ne(u))*u,g=f*f;return{x:.5*((a=ne(a))*(.8707-.131979*f+g*(g*(.003971*f-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(u*(1.007226+f*(.015085+g*(.028874*f-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(a,u){a=(2*a-.5)*Math.PI;let f=u=(2*(1-u)-1)*Math.PI,g=25,v=0,T=f*f;do{T=f*f;const O=T*T;v=(f*(1.007226+T*(.015085+O*(.028874*T-.044475-.005916*O)))-u)/(1.007226+T*(.045255+O*(.259866*T-.311325-.005916*11*O))),f=fe(f-v,-FD,FD)}while(Math.abs(v)>1e-6&&--g>0);T=f*f;const C=fe(he(a/(.8707+T*(T*(T*T*T*(.003971-.001529*T)-.013791)-.131979))),-180,180),k=he(f);return new pt(C,k)}}const BD=ne(_t);class BW extends If{project(a,u){u=ne(u),a=ne(a);const f=Math.cos(u),g=2/Math.PI,v=Math.acos(f*Math.cos(a/2)),T=Math.sin(v)/v,C=.5*(a*g+2*f*Math.sin(a/2)/T)||0,k=.5*(u+Math.sin(u)/T)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(k/Math.PI+1),z:0}}unproject(a,u){let f=a=(2*a-.5)*Math.PI,g=u=(2*(1-u)-1)*Math.PI,v=25;const T=1e-6;let C=0,k=0;do{const O=Math.cos(g),W=Math.sin(g),q=2*W*O,$=W*W,J=O*O,ie=Math.cos(f/2),ue=Math.sin(f/2),ge=2*ie*ue,Re=ue*ue,je=1-J*ie*ie,ke=je?1/je:0,Ge=je?Math.acos(O*ie)*Math.sqrt(1/je):0,$e=.5*(2*Ge*O*ue+2*f/Math.PI)-a,qe=.5*(Ge*W+g)-u,dt=.5*ke*(J*Re+Ge*O*ie*$)+1/Math.PI,ut=ke*(ge*q/4-Ge*W*ue),Tt=.125*ke*(q*ue-Ge*W*J*ge),Ht=.5*ke*($*ie+Ge*Re*O)+.5,yt=ut*Tt-Ht*dt;C=(qe*ut-$e*Ht)/yt,k=($e*Tt-qe*dt)/yt,f=fe(f-C,-Math.PI,Math.PI),g=fe(g-k,-BD,BD)}while((Math.abs(C)>T||Math.abs(k)>T)&&--v>0);return new pt(he(f),he(g))}}class ND extends If{constructor(a){super(a),this.center=a.center||[0,0],this.parallels=a.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ne(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(a,u){const{scale:f,cosPhi:g}=this;return{x:ne(a)*g*f+.5,y:-Math.sin(ne(u))/g*f+.5,z:0}}unproject(a,u){const{scale:f,cosPhi:g}=this,v=-(u-.5)/f,T=fe(he((a-.5)/f)/g,-180,180),C=Math.asin(fe(v*g,-1,1)),k=fe(he(C),-85.051129,_t);return new pt(T,k)}}class NW extends OD{constructor(a){super(a),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug","custom"],this.range=[3,5]}projectTilePoint(a,u,f){const g=N0(a,u,f);return $r(g,g,U0(hh(f))),{x:g[0],y:g[1],z:g[2]}}locationPoint(a,u){const f=B0(u.lat,u.lng),g=Jo([],f),v=a.elevation?a.elevation.getAtPointOrZero(a.locationCoordinate(u),a._centerAltitude):a._centerAltitude;w0(f,f,g,Ii(1,0)*te*v);const T=cu(new Float64Array(16));return fm(T,a.pixelMatrix,a.globeMatrix),$r(f,f,T),new j(f[0],f[1])}pixelsPerMeter(a,u){return Ii(1,0)*u}pixelSpaceConversion(a,u,f){const g=Ii(1,a)*u,v=di(Ii(1,45)*u,g,f);return this.pixelsPerMeter(a,u)/v}createTileMatrix(a,u,f){const g=JT(hh(f.canonical));return fm(new Float64Array(16),a.globeMatrix,g)}createInversionMatrix(a,u){const{center:f}=a,g=U0(hh(u));return Q1(g,g,ne(f.lng)),ST(g,g,ne(f.lat)),pm(g,g,[a._pixelsPerMercatorPixel,a._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(a,u,f,g){return CD(a,u,f,!0)||new Mt(0,0)}pointCoordinate3D(a,u,f){const g=this.pointCoordinate(a,u,f,0);return[g.x,g.y,g.z]}isPointAboveHorizon(a,u){return!CD(a,u.x,u.y,!1)}farthestPixelDistance(a){const u=function(g,v){const T=g.cameraToCenterDistance,C=g._centerAltitude*v,k=g._camera,O=g._camera.forward(),W=dd([],Tl([],O,-T),[0,0,C]),q=g.worldSize/(2*Math.PI),$=[0,0,-q],J=g.width/g.height,ie=Math.tan(g.fovAboveCenter),ue=Tl([],k.up(),ie),ge=Tl([],k.right(),ie*J),Re=Jo([],dd([],dd([],O,ue),ge)),je=[];let ke;if(new AT(W,Re).closestPointOnSphere($,q,je)){const Ge=dd([],je,$),$e=uu([],Ge,W);ke=Math.cos(g.fovAboveCenter)*y0($e)}else{const Ge=uu([],W,$),$e=uu([],$,W);Jo($e,$e);const qe=y0(Ge)-q;ke=Math.sqrt(qe*(qe+2*q));const dt=Math.acos(ke/(q+qe))-Math.acos(sc(O,$e));ke*=Math.cos(dt)}return 1.01*ke}(a,this.pixelsPerMeter(a.center.lat,a.worldSize)),f=u_(a.zoom);if(f>0){const g=zD(a,Ii(1,a.center.lat)*a.worldSize),v=a.worldSize/(2*Math.PI),T=Math.max(a.width,a.height)/a.worldSize*Math.PI;return di(u,g+v*(1-Math.cos(T)),Math.pow(f,10))}return u}upVector(a,u,f){return N0(u,f,a,1)}upVectorScale(a){return{metersToTile:$T*yw(hh(a))}}}function UD(c){const a=c.parallels,u=!!a&&Math.abs(a[0]+a[1])<.01;switch(c.name){case"mercator":return new OD(c);case"equirectangular":return new zW(c);case"naturalEarth":return new FW(c);case"equalEarth":return new RW(c);case"winkelTripel":return new BW(c);case"albers":return u?new ND(c):new DW(c);case"lambertConformalConic":return u?new ND(c):new OW(c);case"globe":return new NW(c)}throw new Error(`Invalid projection name: ${c.name}`)}const UW=ow.types,VW=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ww(c,a,u,f,g,v,T,C,k,O,W,q,$){const J=C?Math.min(Cf,Math.round(C[0])):0,ie=C?Math.min(Cf,Math.round(C[1])):0;c.emplaceBack(a,u,Math.round(32*f),Math.round(32*g),v,T,(J<<1)+(k?1:0),ie,16*O,16*W,256*q,256*$)}function bw(c,a,u,f,g,v,T){c.emplaceBack(a,u,f,g,v,T)}function Sw(c,a,u,f,g){c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g),c.emplaceBack(a,u,f,g)}function GW(c){for(const a of c.sections)if(be(a.text))return!0;return!1}class eE{constructor(a){this.layoutVertexArray=new Si,this.indexArray=new Xi,this.programConfigurations=a,this.segments=new X,this.dynamicLayoutVertexArray=new Js,this.opacityVertexArray=new rr,this.placedSymbolArray=new qg,this.globeExtVertexArray=new xi}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,H8.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,q8.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,VW,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=a.createVertexBuffer(this.globeExtVertexArray,j8.members,!0)),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}dn(eE,"SymbolBuffers");class tE{constructor(a,u,f){this.layoutVertexArray=new a,this.layoutAttributes=u,this.indexArray=new f,this.segments=new X,this.collisionVertexArray=new ic,this.collisionVertexArrayExt=new $o}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,Z8.members,!0),this.collisionVertexBufferExt=a.createVertexBuffer(this.collisionVertexArrayExt,X8.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(tE,"CollisionBuffers");class Pf{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(T=>T.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=cu([]),this.placementViewportMatrix=cu([]);const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=NT(this.zoom,u["text-size"]),this.iconSizeData=NT(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),v=f.get("symbol-z-order");this.canOverlap=f.get("text-allow-overlap")||f.get("icon-allow-overlap")||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=v!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(v==="viewport-y"||v==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=f.get("text-writing-mode").map(T=>El[T]),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=a.sourceID,this.projection=a.projection}createArrays(){this.text=new eE(new ch(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new eE(new ch(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new h0,this.lineVertexArray=new Zg,this.symbolInstances=new u0}calculateGlyphDependencies(a,u,f,g,v){for(let T=0;T<a.length;T++)if(u[a.charCodeAt(T)]=!0,g&&v){const C=D0[a.charAt(T)];C&&(u[C.charCodeAt(0)]=!0)}}populate(a,u,f,g){const v=this.layers[0],T=v.layout,C=this.projection.name==="globe",k=T.get("text-font"),O=T.get("text-field"),W=T.get("icon-image"),q=(O.value.kind!=="constant"||O.value.value instanceof ts&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),$=W.value.kind!=="constant"||!!W.value.value||Object.keys(W.parameters).length>0,J=T.get("symbol-sort-key");if(this.features=[],!q&&!$)return;const ie=u.iconDependencies,ue=u.glyphDependencies,ge=u.availableImages,Re=new it(this.zoom);for(const{feature:je,id:ke,index:Ge,sourceLayerIndex:$e}of a){const qe=v._featureFilter.needGeometry,dt=hd(je,qe);if(!v._featureFilter.filter(Re,dt,f))continue;if(qe||(dt.geometry=wo(je,f,g)),C&&je.type!==1&&f.z<=5){const yt=dt.geometry,Pt=.98078528056,Rt=(Bt,jt)=>sc(N0(Bt.x,Bt.y,f,1),N0(jt.x,jt.y,f,1))<Pt;for(let Bt=0;Bt<yt.length;Bt++)yt[Bt]=fi(yt[Bt],Rt)}let ut,Tt;if(q){const yt=v.getValueAndResolveTokens("text-field",dt,f,ge),Pt=ts.factory(yt);GW(Pt)&&(this.hasRTLText=!0),(!this.hasRTLText||tt()==="unavailable"||this.hasRTLText&&lt.isParsed())&&(ut=K8(Pt,v,dt))}if($){const yt=v.getValueAndResolveTokens("icon-image",dt,f,ge);Tt=yt instanceof Io?yt:Io.fromString(yt)}if(!ut&&!Tt)continue;const Ht=this.sortFeaturesByKey?J.evaluate(dt,{},f):void 0;if(this.features.push({id:ke,text:ut,icon:Tt,index:Ge,sourceLayerIndex:$e,geometry:dt.geometry,properties:je.properties,type:UW[je.type],sortKey:Ht}),Tt&&(ie[Tt.name]=!0),ut){const yt=k.evaluate(dt,{},f).join(","),Pt=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(El.vertical)>=0;for(const Rt of ut.sections)if(Rt.image)ie[Rt.image.name]=!0;else{const Bt=B(ut.toString()),jt=Rt.fontStack||yt,xt=ue[jt]=ue[jt]||{};this.calculateGlyphDependencies(Rt.text,xt,Pt,this.allowVerticalPlacement,Bt)}}}T.get("symbol-placement")==="line"&&(this.features=function(je){const ke={},Ge={},$e=[];let qe=0;function dt(yt){$e.push(je[yt]),qe++}function ut(yt,Pt,Rt){const Bt=Ge[yt];return delete Ge[yt],Ge[Pt]=Bt,$e[Bt].geometry[0].pop(),$e[Bt].geometry[0]=$e[Bt].geometry[0].concat(Rt[0]),Bt}function Tt(yt,Pt,Rt){const Bt=ke[Pt];return delete ke[Pt],ke[yt]=Bt,$e[Bt].geometry[0].shift(),$e[Bt].geometry[0]=Rt[0].concat($e[Bt].geometry[0]),Bt}function Ht(yt,Pt,Rt){const Bt=Rt?Pt[0][Pt[0].length-1]:Pt[0][0];return`${yt}:${Bt.x}:${Bt.y}`}for(let yt=0;yt<je.length;yt++){const Pt=je[yt],Rt=Pt.geometry,Bt=Pt.text?Pt.text.toString():null;if(!Bt){dt(yt);continue}const jt=Ht(Bt,Rt),xt=Ht(Bt,Rt,!0);if(jt in Ge&&xt in ke&&Ge[jt]!==ke[xt]){const en=Tt(jt,xt,Rt),Wn=ut(jt,xt,$e[en].geometry);delete ke[jt],delete Ge[xt],Ge[Ht(Bt,$e[Wn].geometry,!0)]=Wn,$e[en].geometry=null}else jt in Ge?ut(jt,xt,Rt):xt in ke?Tt(jt,xt,Rt):(dt(yt),ke[jt]=qe-1,Ge[xt]=qe-1)}return $e.filter(yt=>yt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((je,ke)=>je.sortKey-ke.sortKey)}update(a,u,f,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,u,this.layers,f,g),this.icon.programConfigurations.updatePaintArrays(a,u,this.layers,f,g))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=UD(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,u){const f=this.lineVertexArray.length;if(a.segment!==void 0)for(const{x:g,y:v}of u)this.lineVertexArray.emplaceBack(g,v);return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(a,u,f,g,v,T,C,k,O,W,q,$,J,ie){const ue=a.indexArray,ge=a.layoutVertexArray,Re=a.globeExtVertexArray,je=a.segments.prepareSegment(4*u.length,ge,ue,this.canOverlap?T.sortKey:void 0),ke=this.glyphOffsetArray.length,Ge=je.vertexLength,$e=this.allowVerticalPlacement&&C===El.vertical?Math.PI/2:0,qe=T.text&&T.text.sections;for(let ut=0;ut<u.length;ut++){const{tl:Tt,tr:Ht,bl:yt,br:Pt,tex:Rt,pixelOffsetTL:Bt,pixelOffsetBR:jt,minFontScaleX:xt,minFontScaleY:en,glyphOffset:Wn,isSDF:un,sectionIndex:Tn}=u[ut],rn=je.vertexLength,jn=Wn[1];if(ww(ge,O.x,O.y,Tt.x,jn+Tt.y,Rt.x,Rt.y,f,un,Bt.x,Bt.y,xt,en),ww(ge,O.x,O.y,Ht.x,jn+Ht.y,Rt.x+Rt.w,Rt.y,f,un,jt.x,Bt.y,xt,en),ww(ge,O.x,O.y,yt.x,jn+yt.y,Rt.x,Rt.y+Rt.h,f,un,Bt.x,jt.y,xt,en),ww(ge,O.x,O.y,Pt.x,jn+Pt.y,Rt.x+Rt.w,Rt.y+Rt.h,f,un,jt.x,jt.y,xt,en),k){const{x:gi,y:pi,z:ui}=k.anchor,[$n,Yi,ei]=k.up;bw(Re,gi,pi,ui,$n,Yi,ei),bw(Re,gi,pi,ui,$n,Yi,ei),bw(Re,gi,pi,ui,$n,Yi,ei),bw(Re,gi,pi,ui,$n,Yi,ei),Sw(a.dynamicLayoutVertexArray,gi,pi,ui,$e)}else Sw(a.dynamicLayoutVertexArray,O.x,O.y,O.z,$e);ue.emplaceBack(rn,rn+1,rn+2),ue.emplaceBack(rn+1,rn+2,rn+3),je.vertexLength+=4,je.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Wn[0]),ut!==u.length-1&&Tn===u[ut+1].sectionIndex||a.programConfigurations.populatePaintArrays(ge.length,T,T.index,{},J,ie,qe&&qe[Tn])}const dt=k?k.anchor:O;a.placedSymbolArray.emplaceBack(dt.x,dt.y,dt.z,O.x,O.y,ke,this.glyphOffsetArray.length-ke,Ge,W,q,O.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],C,0,!1,0,$,0)}_commitLayoutVertex(a,u,f,g,v,T,C){a.emplaceBack(u,f,g,v,T,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(a,u,f,g,v,T,C){const k=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),O=k.vertexLength,W=C.tileAnchorX,q=C.tileAnchorY;for(let J=0;J<4;J++)f.collisionVertexArray.emplaceBack(0,0,0,0);f.collisionVertexArrayExt.emplaceBack(u,-a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,-a.padding),f.collisionVertexArrayExt.emplaceBack(u,a.padding,a.padding),f.collisionVertexArrayExt.emplaceBack(u,-a.padding,a.padding),this._commitLayoutVertex(f.layoutVertexArray,g,v,T,W,q,new j(a.x1,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,v,T,W,q,new j(a.x2,a.y1)),this._commitLayoutVertex(f.layoutVertexArray,g,v,T,W,q,new j(a.x2,a.y2)),this._commitLayoutVertex(f.layoutVertexArray,g,v,T,W,q,new j(a.x1,a.y2)),k.vertexLength+=4;const $=f.indexArray;$.emplaceBack(O,O+1),$.emplaceBack(O+1,O+2),$.emplaceBack(O+2,O+3),$.emplaceBack(O+3,O),k.primitiveLength+=4}_addTextDebugCollisionBoxes(a,u,f,g,v,T){for(let C=g;C<v;C++){const k=f.get(C),O=this.getSymbolInstanceTextSize(a,T,u,C);this._addCollisionDebugVertices(k,O,this.textCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,T)}}_addIconDebugCollisionBoxes(a,u,f,g,v,T){for(let C=g;C<v;C++){const k=f.get(C),O=this.getSymbolInstanceIconSize(a,u,T.placedIconSymbolIndex);this._addCollisionDebugVertices(k,O,this.iconCollisionBox,k.projectedAnchorX,k.projectedAnchorY,k.projectedAnchorZ,T)}}generateCollisionDebugBuffers(a,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new tE(Oi,Qk.members,Yo),this.iconCollisionBox=new tE(Oi,Qk.members,Yo);const f=t_(this.iconSizeData,a),g=t_(this.textSizeData,a);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(g,a,u,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(g,a,u,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(f,a,u,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(f,a,u,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(a,u,f,g){const v=this.text.placedSymbolArray.get(u.rightJustifiedTextSymbolIndex>=0?u.rightJustifiedTextSymbolIndex:u.centerJustifiedTextSymbolIndex>=0?u.centerJustifiedTextSymbolIndex:u.leftJustifiedTextSymbolIndex>=0?u.leftJustifiedTextSymbolIndex:u.verticalPlacedTextSymbolIndex>=0?u.verticalPlacedTextSymbolIndex:g),T=uw(this.textSizeData,a,v)/bo;return this.tilePixelRatio*T}getSymbolInstanceIconSize(a,u,f){const g=this.icon.placedSymbolArray.get(f),v=uw(this.iconSizeData,a,g);return this.tilePixelRatio*v}_commitDebugCollisionVertexUpdate(a,u,f){a.emplaceBack(u,-f,-f),a.emplaceBack(u,f,-f),a.emplaceBack(u,f,f),a.emplaceBack(u,-f,f)}_updateTextDebugCollisionBoxes(a,u,f,g,v,T){for(let C=g;C<v;C++){const k=f.get(C),O=this.getSymbolInstanceTextSize(a,T,u,C);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,O,k.padding)}}_updateIconDebugCollisionBoxes(a,u,f,g,v,T){for(let C=g;C<v;C++){const k=f.get(C),O=this.getSymbolInstanceIconSize(a,u,T);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,O,k.padding)}}updateCollisionDebugBuffers(a,u){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const f=t_(this.iconSizeData,a),g=t_(this.textSizeData,a);for(let v=0;v<this.symbolInstances.length;v++){const T=this.symbolInstances.get(v);this._updateTextDebugCollisionBoxes(g,a,u,T.textBoxStartIndex,T.textBoxEndIndex,T),this._updateTextDebugCollisionBoxes(g,a,u,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._updateIconDebugCollisionBoxes(f,a,u,T.iconBoxStartIndex,T.iconBoxEndIndex,T.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(f,a,u,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(a,u,f,g,v,T,C,k,O){const W={};if(u<f){const{x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge,featureIndex:$e}=a.get(u);W.textBox={x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge},W.textFeatureIndex=$e}if(g<v){const{x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge,featureIndex:$e}=a.get(g);W.verticalTextBox={x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge},W.verticalTextFeatureIndex=$e}if(T<C){const{x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge,featureIndex:$e}=a.get(T);W.iconBox={x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge},W.iconFeatureIndex=$e}if(k<O){const{x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge,featureIndex:$e}=a.get(k);W.verticalIconBox={x1:q,y1:$,x2:J,y2:ie,padding:ue,projectedAnchorX:ge,projectedAnchorY:Re,projectedAnchorZ:je,tileAnchorX:ke,tileAnchorY:Ge},W.verticalIconFeatureIndex=$e}return W}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,u){const f=a.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let v=f.vertexStartIndex;v<g;v+=4)a.indexArray.emplaceBack(v,v+1,v+2),a.indexArray.emplaceBack(v+1,v+2,v+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(a),f=Math.cos(a),g=[],v=[],T=[];for(let C=0;C<this.symbolInstances.length;++C){T.push(C);const k=this.symbolInstances.get(C);g.push(0|Math.round(u*k.tileAnchorX+f*k.tileAnchorY)),v.push(k.featureIndex)}return T.sort((C,k)=>g[C]-g[k]||v[k]-v[C]),T}addToSortKeyRanges(a,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:v,leftJustifiedTextSymbolIndex:T,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:O}=f;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&v!==g&&this.addIndicesForPlacedSymbol(this.text,v),T>=0&&T!==v&&T!==g&&this.addIndicesForPlacedSymbol(this.text,T),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}dn(Pf,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Pf.MAX_GLYPHS=65535,Pf.addDynamicAttributes=Sw;const WW=new mn({"symbol-placement":new Ye(wt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ye(wt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ye(wt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new at(wt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ye(wt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ye(wt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ye(wt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ye(wt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ye(wt.layout_symbol["icon-rotation-alignment"]),"icon-size":new at(wt.layout_symbol["icon-size"]),"icon-text-fit":new Ye(wt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ye(wt.layout_symbol["icon-text-fit-padding"]),"icon-image":new at(wt.layout_symbol["icon-image"]),"icon-rotate":new at(wt.layout_symbol["icon-rotate"]),"icon-padding":new Ye(wt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ye(wt.layout_symbol["icon-keep-upright"]),"icon-offset":new at(wt.layout_symbol["icon-offset"]),"icon-anchor":new at(wt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ye(wt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ye(wt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ye(wt.layout_symbol["text-rotation-alignment"]),"text-field":new at(wt.layout_symbol["text-field"]),"text-font":new at(wt.layout_symbol["text-font"]),"text-size":new at(wt.layout_symbol["text-size"]),"text-max-width":new at(wt.layout_symbol["text-max-width"]),"text-line-height":new at(wt.layout_symbol["text-line-height"]),"text-letter-spacing":new at(wt.layout_symbol["text-letter-spacing"]),"text-justify":new at(wt.layout_symbol["text-justify"]),"text-radial-offset":new at(wt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ye(wt.layout_symbol["text-variable-anchor"]),"text-anchor":new at(wt.layout_symbol["text-anchor"]),"text-max-angle":new Ye(wt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ye(wt.layout_symbol["text-writing-mode"]),"text-rotate":new at(wt.layout_symbol["text-rotate"]),"text-padding":new Ye(wt.layout_symbol["text-padding"]),"text-keep-upright":new Ye(wt.layout_symbol["text-keep-upright"]),"text-transform":new at(wt.layout_symbol["text-transform"]),"text-offset":new at(wt.layout_symbol["text-offset"]),"text-allow-overlap":new Ye(wt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ye(wt.layout_symbol["text-ignore-placement"]),"text-optional":new Ye(wt.layout_symbol["text-optional"])});var nE={paint:new mn({"icon-opacity":new at(wt.paint_symbol["icon-opacity"]),"icon-color":new at(wt.paint_symbol["icon-color"]),"icon-halo-color":new at(wt.paint_symbol["icon-halo-color"]),"icon-halo-width":new at(wt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new at(wt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ye(wt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ye(wt.paint_symbol["icon-translate-anchor"]),"text-opacity":new at(wt.paint_symbol["text-opacity"]),"text-color":new at(wt.paint_symbol["text-color"],{runtimeType:uo,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new at(wt.paint_symbol["text-halo-color"]),"text-halo-width":new at(wt.paint_symbol["text-halo-width"]),"text-halo-blur":new at(wt.paint_symbol["text-halo-blur"]),"text-translate":new Ye(wt.paint_symbol["text-translate"]),"text-translate-anchor":new Ye(wt.paint_symbol["text-translate-anchor"])}),layout:WW};class VD{constructor(a){this.type=a.property.overrides?a.property.overrides.runtimeType:qi,this.defaultValue=a}evaluate(a){if(a.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(a.formattedSection))return u.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(VD,"FormatSectionOverride",{omit:["defaultValue"]});class Mw extends S{constructor(a){super(a,nE)}recalculate(a,u){super.recalculate(a,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const v of f)g.indexOf(v)<0&&g.push(v);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(a,u,f,g){const v=this.layout.get(a).evaluate(u,{},f,g),T=this._unevaluatedLayout._values[a];return T.isDataDriven()||Kc(T.value)||!v?v:function(C,k){return k.replace(/{([^{}]+)}/g,(O,W)=>W in C?String(C[W]):"")}(u.properties,v)}createBucket(a){return new Pf(a)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const a of nE.paint.overridableProperties){if(!Mw.hasPaintOverride(this.layout,a))continue;const u=this.paint.get(a),f=new VD(u),g=new Qh(f,u.property.specification);let v=null;v=u.value.kind==="constant"||u.value.kind==="source"?new xl("source",g):new Jc("composite",g,u.value.zoomStops,u.value._interpolationType),this.paint._values[a]=new Lt(u.property,v,u.parameters)}}_handleOverridablePaintPropertyUpdate(a,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&Mw.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,u){const f=a.get("text-field"),g=nE.paint.properties[u];let v=!1;const T=C=>{for(const k of C)if(g.overrides&&g.overrides.hasOverride(k))return void(v=!0)};if(f.value.kind==="constant"&&f.value.value instanceof ts)T(f.value.value.sections);else if(f.value.kind==="source"){const C=O=>{v||(O instanceof Bc&&wi(O.value)===Rc?T(O.value.sections):O instanceof Dh?T(O.sections):O.eachChild(C))},k=f.value;k._styleExpression&&C(k._styleExpression.expression)}return v}getProgramConfiguration(a){return new lu(this,a)}}var HW={paint:new mn({"background-color":new Ye(wt.paint_background["background-color"]),"background-pattern":new Ye(wt.paint_background["background-pattern"]),"background-opacity":new Ye(wt.paint_background["background-opacity"])})},jW={paint:new mn({"raster-opacity":new Ye(wt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ye(wt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ye(wt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ye(wt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ye(wt.paint_raster["raster-saturation"]),"raster-contrast":new Ye(wt.paint_raster["raster-contrast"]),"raster-resampling":new Ye(wt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ye(wt.paint_raster["raster-fade-duration"])})};class qW extends S{constructor(a){super(a,{}),this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(a){this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)}onRemove(a){this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)}}var ZW={paint:new mn({"sky-type":new Ye(wt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ye(wt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ye(wt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ye(wt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ye(wt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Qt(wt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ye(wt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ye(wt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ye(wt.paint_sky["sky-opacity"])})};function iE(c,a,u){const f=[0,0,1],g=bk([]);return Mk(g,g,u?-ne(c)+Math.PI:ne(c)),Sk(g,g,-ne(a)),yk(f,f,g),Jo(f,f)}const XW={circle:class extends S{constructor(c){super(c,$G)}createBucket(c){return new xT(c)}queryRadius(c){const a=c;return Yg("circle-radius",this,a)+Yg("circle-stroke-width",this,a)+K1(this.paint.get("circle-translate"))}queryIntersectsFeature(c,a,u,f,g,v,T,C){const k=hk(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(a,u)+this.paint.get("circle-stroke-width").evaluate(a,u);return Tk(c,f,v,T,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",k,O)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new lu(this,c)}},heatmap:class extends S{createBucket(c){return new Ak(c)}constructor(c){super(c,i8),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=LT({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return Yg("heatmap-radius",this,c)}queryIntersectsFeature(c,a,u,f,g,v,T,C){const k=this.paint.get("heatmap-radius").evaluate(a,u);return Tk(c,f,v,T,C,!0,!0,new j(0,0),k)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new lu(this,c)}},hillshade:class extends S{constructor(c){super(c,r8)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends S{constructor(c){super(c,v8)}getProgramIds(){const c=this.paint.get("fill-pattern"),a=c&&c.constantOr(1),u=[a?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&u.push(a&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),u}getProgramConfiguration(c){return new lu(this,c)}recalculate(c,a){super.recalculate(c,a);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new rw(c)}queryRadius(){return K1(this.paint.get("fill-translate"))}queryIntersectsFeature(c,a,u,f,g,v){return!c.queryGeometry.isAboveHorizon&&ok(uk(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),f)}isTileClipped(){return!0}},"fill-extrusion":class extends S{constructor(c){super(c,O8)}createBucket(c){return new P0(c)}queryRadius(){return K1(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new lu(this,c)}queryIntersectsFeature(c,a,u,f,g,v,T,C,k){const O=hk(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),W=this.paint.get("fill-extrusion-height").evaluate(a,u),q=this.paint.get("fill-extrusion-base").evaluate(a,u),$=[0,0],J=C&&v.elevation,ie=v.elevation?v.elevation.exaggeration():1,ue=c.tile.getBucket(this);if(J&&ue instanceof P0){const Ge=ue.centroidVertexArray,$e=k+1;$e<Ge.length&&($[0]=Ge.geta_centroid_pos0($e),$[1]=Ge.geta_centroid_pos1($e))}if($[0]===0&&$[1]===1)return!1;v.projection.name==="globe"&&(f=jk([f],[new j(0,0),new j(te,te)],c.tileID.canonical).map(Ge=>Ge.polygon).flat());const ge=J?C:null,[Re,je]=function(Ge,$e,qe,dt,ut,Tt,Ht,yt,Pt,Rt,Bt){return Ge.projection.name==="globe"?function(jt,xt,en,Wn,un,Tn,rn,jn,gi,pi,ui){const $n=[],Yi=[],ei=jt.projection.upVectorScale(ui,jt.center.lat,jt.worldSize).metersToTile,_i=[0,0,0,1],sr=[0,0,0,1],mr=(gr,Mr,Gr,Qs)=>{gr[0]=Mr,gr[1]=Gr,gr[2]=Qs,gr[3]=1},fr=Hk();en>0&&(en+=fr),Wn+=fr;for(const gr of xt){const Mr=[],Gr=[];for(const Qs of gr){const Ki=Qs.x+un.x,xs=Qs.y+un.y,os=jt.projection.projectTilePoint(Ki,xs,ui),Di=jt.projection.upVector(ui,Qs.x,Qs.y);let Lr=en,Ds=Wn;if(rn){const or=$k(Ki,xs,en,Wn,rn,jn,gi,pi);Lr+=or.base,Ds+=or.top}en!==0?mr(_i,os.x+Di[0]*ei*Lr,os.y+Di[1]*ei*Lr,os.z+Di[2]*ei*Lr):mr(_i,os.x,os.y,os.z),mr(sr,os.x+Di[0]*ei*Ds,os.y+Di[1]*ei*Ds,os.z+Di[2]*ei*Ds),$r(_i,_i,Tn),$r(sr,sr,Tn),Mr.push(new e_(_i[0],_i[1],_i[2])),Gr.push(new e_(sr[0],sr[1],sr[2]))}$n.push(Mr),Yi.push(Gr)}return[$n,Yi]}(Ge,$e,qe,dt,ut,Tt,Ht,yt,Pt,Rt,Bt):Ht?function(jt,xt,en,Wn,un,Tn,rn,jn,gi){const pi=[],ui=[],$n=[0,0,0,1];for(const Yi of jt){const ei=[],_i=[];for(const sr of Yi){const mr=sr.x+Wn.x,fr=sr.y+Wn.y,gr=$k(mr,fr,xt,en,Tn,rn,jn,gi);$n[0]=mr,$n[1]=fr,$n[2]=gr.base,$n[3]=1,mm($n,$n,un),$n[3]=Math.max($n[3],1e-5);const Mr=new e_($n[0]/$n[3],$n[1]/$n[3],$n[2]/$n[3]);$n[0]=mr,$n[1]=fr,$n[2]=gr.top,$n[3]=1,mm($n,$n,un),$n[3]=Math.max($n[3],1e-5);const Gr=new e_($n[0]/$n[3],$n[1]/$n[3],$n[2]/$n[3]);ei.push(Mr),_i.push(Gr)}pi.push(ei),ui.push(_i)}return[pi,ui]}($e,qe,dt,ut,Tt,Ht,yt,Pt,Rt):function(jt,xt,en,Wn,un){const Tn=[],rn=[],jn=un[8]*xt,gi=un[9]*xt,pi=un[10]*xt,ui=un[11]*xt,$n=un[8]*en,Yi=un[9]*en,ei=un[10]*en,_i=un[11]*en;for(const sr of jt){const mr=[],fr=[];for(const gr of sr){const Mr=gr.x+Wn.x,Gr=gr.y+Wn.y,Qs=un[0]*Mr+un[4]*Gr+un[12],Ki=un[1]*Mr+un[5]*Gr+un[13],xs=un[2]*Mr+un[6]*Gr+un[14],os=un[3]*Mr+un[7]*Gr+un[15],Di=Qs+jn,Lr=Ki+gi,Ds=xs+pi,or=Math.max(os+ui,1e-5),Yr=Qs+$n,Oo=Ki+Yi,eo=xs+ei,to=Math.max(os+_i,1e-5);mr.push(new e_(Di/or,Lr/or,Ds/or)),fr.push(new e_(Yr/to,Oo/to,eo/to))}Tn.push(mr),rn.push(fr)}return[Tn,rn]}($e,qe,dt,ut,Tt)}(v,f,q,W,O,T,ge,$,ie,v.center.lat,c.tileID.canonical),ke=c.queryGeometry;return function(Ge,$e,qe){let dt=1/0;ok(qe,$e)&&(dt=Xk(qe,$e[0]));for(let ut=0;ut<$e.length;ut++){const Tt=$e[ut],Ht=Ge[ut];for(let yt=0;yt<Tt.length-1;yt++){const Pt=Tt[yt],Rt=[Pt,Tt[yt+1],Ht[yt+1],Ht[yt],Pt];sk(qe,Rt)&&(dt=Math.min(dt,Xk(qe,Rt)))}}return dt!==1/0&&dt}(Re,je,ke.isPointQuery()?ke.screenBounds:ke.screenGeometry)}},line:class extends S{constructor(c){super(c,Yk),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const a=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=a._styleExpression&&a._styleExpression.expression instanceof Hu,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(c,a){super.recalculate(c,a),this.paint._values["line-floorwidth"]=Kk.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new cw(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new lu(this,c)}queryRadius(c){const a=c,u=Jk(Yg("line-width",this,a),Yg("line-gap-width",this,a)),f=Yg("line-offset",this,a);return u/2+Math.abs(f)+K1(this.paint.get("line-translate"))}queryIntersectsFeature(c,a,u,f,g,v){if(c.queryGeometry.isAboveHorizon)return!1;const T=uk(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,c.pixelToTileUnitsFactor),C=c.pixelToTileUnitsFactor/2*Jk(this.paint.get("line-width").evaluate(a,u),this.paint.get("line-gap-width").evaluate(a,u)),k=this.paint.get("line-offset").evaluate(a,u);return k&&(f=function(O,W){const q=[],$=new j(0,0);for(let J=0;J<O.length;J++){const ie=O[J],ue=[];for(let ge=0;ge<ie.length;ge++){const Re=ie[ge-1],je=ie[ge],ke=ie[ge+1],Ge=ge===0?$:je.sub(Re)._unit()._perp(),$e=ge===ie.length-1?$:ke.sub(je)._unit()._perp(),qe=Ge._add($e)._unit();qe._mult(1/(qe.x*$e.x+qe.y*$e.y)),ue.push(qe._mult(W)._add(je))}q.push(ue)}return q}(f,k*c.pixelToTileUnitsFactor)),function(O,W,q){for(let $=0;$<W.length;$++){const J=W[$];if(O.length>=3){for(let ie=0;ie<J.length;ie++)if(dm(O,J[ie]))return!0}if(jG(O,J,q))return!0}return!1}(T,f,C)}isTileClipped(){return!0}},symbol:Mw,background:class extends S{constructor(c){super(c,HW)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends S{constructor(c){super(c,jW)}getProgramIds(){return["raster"]}},sky:class extends S{constructor(c){super(c,ZW),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=LT({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const a=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==a.azimuthal||this._lightPosition.polar!==a.polar}return!1}getCenter(c,a){if(this.paint.get("sky-type")==="atmosphere"){const f=this.paint.get("sky-atmosphere-sun"),g=!f,v=c.style.light,T=v.properties.get("position");return g&&v.properties.get("anchor")==="viewport"&&At("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?iE(T.azimuthal,90-T.polar,a):iE(f[0],90-f[1],a)}const u=this.paint.get("sky-gradient-center");return iE(u[0],90-u[1],a)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}}};class j0{constructor(a,u,f,g){this.context=a,this.format=f,this.texture=a.gl.createTexture(),this.update(u,g)}update(a,u,f){const{width:g,height:v}=a,{context:T}=this,{gl:C}=T,{HTMLImageElement:k,HTMLCanvasElement:O,HTMLVideoElement:W,ImageData:q,ImageBitmap:$}=d;if(C.bindTexture(C.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!u||u.premultiply!==!1)),f||this.size&&this.size[0]===g&&this.size[1]===v){const{x:J,y:ie}=f||{x:0,y:0};a instanceof k||a instanceof O||a instanceof W||a instanceof q||$&&a instanceof $?C.texSubImage2D(C.TEXTURE_2D,0,J,ie,C.RGBA,C.UNSIGNED_BYTE,a):C.texSubImage2D(C.TEXTURE_2D,0,J,ie,g,v,C.RGBA,C.UNSIGNED_BYTE,a.data)}else this.size=[g,v],a instanceof k||a instanceof O||a instanceof W||a instanceof q||$&&a instanceof $?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,a):C.texImage2D(C.TEXTURE_2D,0,this.format,g,v,0,this.format,C.UNSIGNED_BYTE,a.data);this.useMipmap=Boolean(u&&u.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&C.generateMipmap(C.TEXTURE_2D)}bind(a,u){const{context:f}=this,{gl:g}=f;g.bindTexture(g.TEXTURE_2D,this.texture),a!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,a),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?a===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_NEAREST:a),this.filter=a),u!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}}class $W{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class YW{constructor(){this.tasks={},this.taskQueue=[],Et(["process"],this),this.invoker=new $W(this.process),this.nextId=0}add(a,u){const f=this.nextId++,g=function({type:v,isSymbolTile:T,zoom:C}){return C=C||0,v==="message"?0:v!=="maybePrepare"||T?v!=="parseTile"||T?v==="parseTile"&&T?300-C:v==="maybePrepare"&&T?400-C:500:200-C:100-C}(u);if(g===0){Cn();try{a()}finally{}return{cancel:()=>{}}}return this.tasks[f]={fn:a,metadata:u,priority:g,id:f},this.taskQueue.push(f),this.invoker.trigger(),{cancel:()=>{delete this.tasks[f]}}}process(){Cn();try{if(this.taskQueue=this.taskQueue.filter(f=>!!this.tasks[f]),!this.taskQueue.length)return;const a=this.pick();if(a===null)return;const u=this.tasks[a];if(delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),!u)return;u.fn()}finally{}}pick(){let a=null,u=1/0;for(let g=0;g<this.taskQueue.length;g++){const v=this.tasks[this.taskQueue[g]];v.priority<u&&(u=v.priority,a=g)}if(a===null)return null;const f=this.taskQueue[a];return this.taskQueue.splice(a,1),f}remove(){this.invoker.remove()}}class GD{constructor(a){this._stringToNumber={},this._numberToString=[];for(let u=0;u<a.length;u++){const f=a[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(a){return this._stringToNumber[a]}decode(a){return this._numberToString[a]}}const KW=["tile","layer","source","sourceLayer","state"];class WD{constructor(a,u,f,g,v){this.type="Feature",this._vectorTileFeature=a,this._z=u,this._x=f,this._y=g,this.properties=a.properties,this.id=v}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(a.id=this.id);for(const u of KW)this[u]!==void 0&&(a[u]=this[u]);return a}}const lc=32,dh=33,Lf=new Uint16Array(8184);for(let c=0;c<2046;c++){let a=c+2,u=0,f=0,g=0,v=0,T=0,C=0;for(1&a?g=v=T=lc:u=f=C=lc;(a>>=1)>1;){const O=u+g>>1,W=f+v>>1;1&a?(g=u,v=f,u=T,f=C):(u=g,f=v,g=T,v=C),T=O,C=W}const k=4*c;Lf[k+0]=u,Lf[k+1]=f,Lf[k+2]=g,Lf[k+3]=v}const fh=new Uint16Array(2178),kf=new Uint8Array(1089),Tw=new Uint16Array(1089);function HD(c){return c===0?-.03125:c===32?.03125:0}var jD=an([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const qD={type:2,extent:te,loadGeometry:()=>[[new j(0,0),new j(8193,0),new j(8193,8193),new j(0,8193),new j(0,0)]]};class rE{constructor(a,u,f,g,v){this.tileID=a,this.uid=Ne(),this.uses=0,this.tileSize=u,this.tileZoom=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,this.expiredRequestCount=0,this.state="loading",g&&g.transform&&(this.projection=g.transform.projection)}registerFadeDuration(a){const u=a+this.timeAdded;u<Sn.now()||this.fadeEndTime&&u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=ym(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(a,u,f){if(this.unloadVectorData(),this.state="loaded",a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=a.collisionBoxArray,this.buckets=function(g,v){const T={};if(!v)return T;for(const C of g){const k=C.layerIds.map(O=>v.getLayer(O)).filter(Boolean);if(k.length!==0){C.layers=k,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(O=>k.filter(W=>W.id===O)[0]));for(const O of k)T[O.id]=C}}return T}(a.buckets,u.style),this.hasSymbolBuckets=!1;for(const g in this.buckets){const v=this.buckets[g];if(v instanceof Pf){if(this.hasSymbolBuckets=!0,!f)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const g in this.buckets){const v=this.buckets[g];if(v instanceof Pf&&v.hasRTLText){this.hasRTLText=!0,lt.isLoading()||lt.isLoaded()||tt()!=="deferred"||ft();break}}this.queryPadding=0;for(const g in this.buckets){const v=this.buckets[g];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(g).queryRadius(v))}a.imageAtlas&&(this.imageAtlas=a.imageAtlas),a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage),a.lineAtlas&&(this.lineAtlas=a.lineAtlas)}else this.collisionBoxArray=new jg}unloadVectorData(){if(this.hasData()){for(const a in this.buckets)this.buckets[a].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(a){return this.buckets[a.id]}upload(a){for(const f in this.buckets){const g=this.buckets[f];g.uploadPending()&&g.upload(a)}const u=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new j0(a,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new j0(a,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new j0(a,this.lineAtlas.image,u.ALPHA),this.lineAtlas.uploaded=!0)}prepare(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)}queryRenderedFeatures(a,u,f,g,v,T,C,k){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:g,pixelPosMatrix:C,transform:T,params:v,tileTransform:this.tileTransform},a,u,f):{}}querySourceFeatures(a,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const g=f.loadVTLayers(),v=u?u.sourceLayer:"",T=g._geojsonTileLayer||g[v];if(!T)return;const C=tu(u&&u.filter),{z:k,x:O,y:W}=this.tileID.canonical,q={z:k,x:O,y:W};for(let $=0;$<T.length;$++){const J=T.feature($);if(C.needGeometry){const ge=hd(J,!0);if(!C.filter(new it(this.tileID.overscaledZ),ge,this.tileID.canonical))continue}else if(!C.filter(new it(this.tileID.overscaledZ),J))continue;const ie=f.getId(J,v),ue=new WD(J,k,O,W,ie);ue.tile=q,a.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(a){const u=this.expirationTime;if(a.cacheControl){const f=pn(a.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else a.expires&&(this.expirationTime=new Date(a.expires).getTime());if(this.expirationTime){const f=Date.now();let g=!1;if(this.expirationTime>f)g=!1;else if(u)if(this.expirationTime<u)g=!0;else{const v=this.expirationTime-u;v?this.expirationTime=f+Math.max(v,3e4):g=!0}else g=!0;g?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(a,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(a).length===0||!u)return;const f=this.latestFeatureIndex.loadVTLayers(),g=u.style.listImages();for(const v in this.buckets){if(!u.style.hasLayer(v))continue;const T=this.buckets[v],C=T.layers[0].sourceLayer||"_geojsonTileLayer",k=f[C],O=a[C];if(!k||!O||Object.keys(O).length===0)continue;if(T.update(O,k,g,this.imageAtlas&&this.imageAtlas.patternPositions||{}),T instanceof cw||T instanceof rw){const q=u.style._getSourceCache(T.layers[0].source);u._terrain&&u._terrain.enabled&&q&&T.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(q.id,this.tileID)}const W=u&&u.style&&u.style.getLayer(v);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(T)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Sn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(a){this.symbolFadeHoldUntil=Sn.now()+a}setTexture(a,u){const f=u.context,g=f.gl;this.texture=this.texture||u.getTileTexture(a.width),this.texture?this.texture.update(a,{useMipmap:!0}):(this.texture=new j0(f,a,g.RGBA,{useMipmap:!0}),this.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE),f.extTextureFilterAnisotropic&&g.texParameterf(g.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax))}setDependencies(a,u){const f={};for(const g of u)f[g]=!0;this.dependencies[a]=f}hasDependency(a,u){for(const f of a){const g=this.dependencies[f];if(g){for(const v of u)if(g[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(a,u){if(!u||u.name==="mercator"||this._tileDebugBuffer)return;const f=wo(qD,this.tileID.canonical,this.tileTransform)[0],g=new bi,v=new ud;for(let T=0;T<f.length;T++){const{x:C,y:k}=f[T];g.emplaceBack(C,k),v.emplaceBack(T)}v.emplaceBack(0),this._tileDebugIndexBuffer=a.createIndexBuffer(v),this._tileDebugBuffer=a.createVertexBuffer(g,F0.members),this._tileDebugSegments=X.simpleSegment(0,0,g.length,v.length)}_makeTileBoundsBuffers(a,u){if(this._tileBoundsBuffer||!u||u.name==="mercator")return;const f=wo(qD,this.tileID.canonical,this.tileTransform)[0];let g,v;if(this.isRaster){const T=function(C,k){const O=ym(C,k),W=Math.pow(2,C.z);for(let ge=0;ge<dh;ge++)for(let Re=0;Re<dh;Re++){const je=Pn((C.x+(Re+HD(Re))/lc)/W),ke=Hi((C.y+(ge+HD(ge))/lc)/W),Ge=k.project(je,ke),$e=ge*dh+Re;fh[2*$e+0]=Math.round((Ge.x*O.scale-O.x)*te),fh[2*$e+1]=Math.round((Ge.y*O.scale-O.y)*te)}kf.fill(0),Tw.fill(0);for(let ge=2045;ge>=0;ge--){const Re=4*ge,je=Lf[Re+0],ke=Lf[Re+1],Ge=Lf[Re+2],$e=Lf[Re+3],qe=je+Ge>>1,dt=ke+$e>>1,ut=qe+dt-ke,Tt=dt+je-qe,Ht=ke*dh+je,yt=$e*dh+Ge,Pt=dt*dh+qe,Rt=Math.hypot((fh[2*Ht+0]+fh[2*yt+0])/2-fh[2*Pt+0],(fh[2*Ht+1]+fh[2*yt+1])/2-fh[2*Pt+1])>=16;if(kf[Pt]=kf[Pt]||(Rt?1:0),ge<1022){const Bt=(ke+Tt>>1)*dh+(je+ut>>1),jt=($e+Tt>>1)*dh+(Ge+ut>>1);kf[Pt]=kf[Pt]||kf[Bt]||kf[jt]}}const q=new si,$=new Xi;let J=0;function ie(ge,Re){const je=Re*dh+ge;return Tw[je]===0&&(q.emplaceBack(fh[2*je+0],fh[2*je+1],ge*te/lc,Re*te/lc),Tw[je]=++J),Tw[je]-1}function ue(ge,Re,je,ke,Ge,$e){const qe=ge+je>>1,dt=Re+ke>>1;if(Math.abs(ge-Ge)+Math.abs(Re-$e)>1&&kf[dt*dh+qe])ue(Ge,$e,ge,Re,qe,dt),ue(je,ke,Ge,$e,qe,dt);else{const ut=ie(ge,Re),Tt=ie(je,ke),Ht=ie(Ge,$e);$.emplaceBack(ut,Tt,Ht)}}return ue(0,0,lc,lc,lc,0),ue(lc,lc,0,0,0,lc),{vertices:q,indices:$}}(this.tileID.canonical,u);g=T.vertices,v=T.indices}else{g=new si,v=new Xi;for(const{x:C,y:k}of f)g.emplaceBack(C,k,0,0);const T=S0.exports(g.int16,void 0,4);for(let C=0;C<T.length;C+=3)v.emplaceBack(T[C],T[C+1],T[C+2])}this._tileBoundsBuffer=a.createVertexBuffer(g,jD.members),this._tileBoundsIndexBuffer=a.createIndexBuffer(v),this._tileBoundsSegments=X.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugBuffers(a,u){const f=u.projection;if(!f||f.name!=="globe"||u.freezeTileCoverage)return;const g=this.tileID.canonical,v=U0(ID(g,u)),T=u_(u.zoom);let C;T>0&&(C=bT(new Float64Array(16),u.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(a,g,u,v,C,T),this._makeGlobeTileDebugTextBuffer(a,g,u,v,C,T)}_globePoint(a,u,f,g,v,T,C){let k=N0(a,u,f);if(T){const O=1<<f.z,W=Qn(g.center.lng),q=Gn(g.center.lat),$=(f.x+.5)/O-W;let J=0;$>.5?J=-1:$<-.5&&(J=1);let ie=(a/te+f.x)/O+J,ue=(u/te+f.y)/O;ie=(ie-W)*g._pixelsPerMercatorPixel+W,ue=(ue-q)*g._pixelsPerMercatorPixel+q;const ge=[ie*g.worldSize,ue*g.worldSize,0];$r(ge,ge,T),k=_m(k,ge,C)}return $r(k,k,v)}_makeGlobeTileDebugBorderBuffer(a,u,f,g,v,T){const C=new bi,k=new ud,O=new ki,W=($,J,ie,ue,ge)=>{const Re=(ie-$)/(ge-1),je=(ue-J)/(ge-1),ke=C.length;for(let Ge=0;Ge<ge;Ge++){const $e=$+Ge*Re,qe=J+Ge*je;C.emplaceBack($e,qe);const dt=this._globePoint($e,qe,u,f,g,v,T);O.emplaceBack(dt[0],dt[1],dt[2]),k.emplaceBack(ke+Ge)}},q=te;W(0,0,q,0,16),W(q,0,q,q,16),W(q,q,0,q,16),W(0,q,0,0,16),this._tileDebugIndexBuffer=a.createIndexBuffer(k),this._tileDebugBuffer=a.createVertexBuffer(C,F0.members),this._globeTileDebugBorderBuffer=a.createVertexBuffer(O,AD.members),this._tileDebugSegments=X.simpleSegment(0,0,C.length,k.length)}_makeGlobeTileDebugTextBuffer(a,u,f,g,v,T){const C=new bi,k=new Xi,O=new ki,W=25;k.reserve(32),C.reserve(W),O.reserve(W);const q=($,J)=>W*$+J;for(let $=0;$<W;$++){const J=2048*$;for(let ie=0;ie<W;ie++){const ue=2048*ie;C.emplaceBack(ue,J);const ge=this._globePoint(ue,J,u,f,g,v,T);O.emplaceBack(ge[0],ge[1],ge[2])}}for(let $=0;$<4;$++)for(let J=0;J<4;J++){const ie=q($,J),ue=q($,J+1),ge=q($+1,J),Re=q($+1,J+1);k.emplaceBack(ie,ue,ge),k.emplaceBack(ge,ue,Re)}this._tileDebugTextIndexBuffer=a.createIndexBuffer(k),this._tileDebugTextBuffer=a.createVertexBuffer(C,F0.members),this._globeTileDebugTextBuffer=a.createVertexBuffer(O,AD.members),this._tileDebugTextSegments=X.simpleSegment(0,0,W,32)}}class JW{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(a,u,f){const g=String(u);if(this.stateChanges[a]=this.stateChanges[a]||{},this.stateChanges[a][g]=this.stateChanges[a][g]||{},Pe(this.stateChanges[a][g],f),this.deletedStates[a]===null){this.deletedStates[a]={};for(const v in this.state[a])v!==g&&(this.deletedStates[a][v]=null)}else if(this.deletedStates[a]&&this.deletedStates[a][g]===null){this.deletedStates[a][g]={};for(const v in this.state[a][g])f[v]||(this.deletedStates[a][g][v]=null)}else for(const v in f)this.deletedStates[a]&&this.deletedStates[a][g]&&this.deletedStates[a][g][v]===null&&delete this.deletedStates[a][g][v]}removeFeatureState(a,u,f){if(this.deletedStates[a]===null)return;const g=String(u);if(this.deletedStates[a]=this.deletedStates[a]||{},f&&u!==void 0)this.deletedStates[a][g]!==null&&(this.deletedStates[a][g]=this.deletedStates[a][g]||{},this.deletedStates[a][g][f]=null);else if(u!==void 0)if(this.stateChanges[a]&&this.stateChanges[a][g])for(f in this.deletedStates[a][g]={},this.stateChanges[a][g])this.deletedStates[a][g][f]=null;else this.deletedStates[a][g]=null;else this.deletedStates[a]=null}getState(a,u){const f=String(u),g=Pe({},(this.state[a]||{})[f],(this.stateChanges[a]||{})[f]);if(this.deletedStates[a]===null)return{};if(this.deletedStates[a]){const v=this.deletedStates[a][u];if(v===null)return{};for(const T in v)delete g[T]}return g}initializeTileState(a,u){a.setFeatureState(this.state,u)}coalesceChanges(a,u){const f={};for(const g in this.stateChanges){this.state[g]=this.state[g]||{};const v={};for(const T in this.stateChanges[g])this.state[g][T]||(this.state[g][T]={}),Pe(this.state[g][T],this.stateChanges[g][T]),v[T]=this.state[g][T];f[g]=v}for(const g in this.deletedStates){this.state[g]=this.state[g]||{};const v={};if(this.deletedStates[g]===null)for(const T in this.state[g])v[T]={},this.state[g][T]={};else for(const T in this.deletedStates[g]){if(this.deletedStates[g][T]===null)this.state[g][T]={};else for(const C of Object.keys(this.deletedStates[g][T]))delete this.state[g][T][C];v[T]=this.state[g][T]}f[g]=f[g]||{},Pe(f[g],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const g in a)a[g].setFeatureState(f,u)}}class ZD{constructor(a){this.size=a,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(a,u){const f=this.toIdx(a,u);return{min:this.minimums[f],max:this.maximums[f]}}isLeaf(a,u){return this.leaves[this.toIdx(a,u)]}toIdx(a,u){return u*this.size+a}}function XD(c,a,u,f){let g=0,v=Number.MAX_VALUE;for(let T=0;T<3;T++)if(Math.abs(f[T])<1e-15){if(u[T]<c[T]||u[T]>a[T])return null}else{const C=1/f[T];let k=(c[T]-u[T])*C,O=(a[T]-u[T])*C;if(k>O){const W=k;k=O,O=W}if(k>g&&(g=k),O<v&&(v=O),g>v)return null}return g}function $D(c,a,u,f,g,v,T,C,k,O,W){const q=f-c,$=g-a,J=v-u,ie=T-c,ue=C-a,ge=k-u,Re=W[1]*ge-W[2]*ue,je=W[2]*ie-W[0]*ge,ke=W[0]*ue-W[1]*ie,Ge=q*Re+$*je+J*ke;if(Math.abs(Ge)<1e-15)return null;const $e=1/Ge,qe=O[0]-c,dt=O[1]-a,ut=O[2]-u,Tt=(qe*Re+dt*je+ut*ke)*$e;if(Tt<0||Tt>1)return null;const Ht=dt*J-ut*$,yt=ut*q-qe*J,Pt=qe*$-dt*q,Rt=(W[0]*Ht+W[1]*yt+W[2]*Pt)*$e;return Rt<0||Tt+Rt>1?null:(ie*Ht+ue*yt+ge*Pt)*$e}function YD(c,a,u){return(c-a)/(u-a)}function KD(c,a,u,f,g,v,T,C,k){const O=1<<u,W=v-f,q=T-g,$=(c+1)/O*W+f,J=(a+0)/O*q+g,ie=(a+1)/O*q+g;C[0]=(c+0)/O*W+f,C[1]=J,k[0]=$,k[1]=ie}class JD{constructor(a){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=a,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const u=function(v){const T=Math.ceil(Math.log2(v.dim/8)),C=[];let k=Math.ceil(Math.pow(2,T));const O=1/k,W=(J,ie,ue,ge,Re)=>{const je=ge?1:0,ke=(J+1)*ue-je,Ge=ie*ue,$e=(ie+1)*ue-je;Re[0]=J*ue,Re[1]=Ge,Re[2]=ke,Re[3]=$e};let q=new ZD(k);const $=[];for(let J=0;J<k*k;J++){W(J%k,Math.floor(J/k),O,!1,$);const ie=Df($[0],$[1],v),ue=Df($[2],$[1],v),ge=Df($[2],$[3],v),Re=Df($[0],$[3],v);q.minimums.push(Math.min(ie,ue,ge,Re)),q.maximums.push(Math.max(ie,ue,ge,Re)),q.leaves.push(1)}for(C.push(q),k/=2;k>=1;k/=2){const J=C[C.length-1];q=new ZD(k);for(let ie=0;ie<k*k;ie++){W(ie%k,Math.floor(ie/k),2,!0,$);const ue=J.getElevation($[0],$[1]),ge=J.getElevation($[2],$[1]),Re=J.getElevation($[2],$[3]),je=J.getElevation($[0],$[3]),ke=J.isLeaf($[0],$[1]),Ge=J.isLeaf($[2],$[1]),$e=J.isLeaf($[2],$[3]),qe=J.isLeaf($[0],$[3]),dt=Math.min(ue.min,ge.min,Re.min,je.min),ut=Math.max(ue.max,ge.max,Re.max,je.max),Tt=ke&&Ge&&$e&&qe;q.maximums.push(ut),q.minimums.push(dt),q.leaves.push(ut-dt<=5&&Tt?1:0)}C.push(q)}return C}(this.dem),f=u.length-1,g=u[f];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(u,0,0,f,0)}raycastRoot(a,u,f,g,v,T,C=1){return XD([a,u,-100],[f,g,this.maximums[0]*C],v,T)}raycast(a,u,f,g,v,T,C=1){if(!this.nodeCount)return null;const k=this.raycastRoot(a,u,f,g,v,T,C);if(k==null)return null;const O=[],W=[],q=[],$=[],J=[{idx:0,t:k,nodex:0,nodey:0,depth:0}];for(;J.length>0;){const{idx:ie,t:ue,nodex:ge,nodey:Re,depth:je}=J.pop();if(this.leaves[ie]){KD(ge,Re,je,a,u,f,g,q,$);const Ge=1<<je,$e=(ge+0)/Ge,qe=(ge+1)/Ge,dt=(Re+0)/Ge,ut=(Re+1)/Ge,Tt=Df($e,dt,this.dem)*C,Ht=Df(qe,dt,this.dem)*C,yt=Df(qe,ut,this.dem)*C,Pt=Df($e,ut,this.dem)*C,Rt=$D(q[0],q[1],Tt,$[0],q[1],Ht,$[0],$[1],yt,v,T),Bt=$D($[0],$[1],yt,q[0],$[1],Pt,q[0],q[1],Tt,v,T),jt=Math.min(Rt!==null?Rt:Number.MAX_VALUE,Bt!==null?Bt:Number.MAX_VALUE);if(jt!==Number.MAX_VALUE)return jt;{const xt=w0([],v,T,ue);if(QD(Tt,Ht,Pt,yt,YD(xt[0],q[0],$[0]),YD(xt[1],q[1],$[1]))>=xt[2])return ue}continue}let ke=0;for(let Ge=0;Ge<this._siblingOffset.length;Ge++){KD((ge<<1)+this._siblingOffset[Ge][0],(Re<<1)+this._siblingOffset[Ge][1],je+1,a,u,f,g,q,$),q[2]=-100,$[2]=this.maximums[this.childOffsets[ie]+Ge]*C;const $e=XD(q,$,v,T);if($e!=null){const qe=$e;O[Ge]=qe;let dt=!1;for(let ut=0;ut<ke&&!dt;ut++)qe>=O[W[ut]]&&(W.splice(ut,0,Ge),dt=!0);dt||(W[ke]=Ge),ke++}}for(let Ge=0;Ge<ke;Ge++){const $e=W[Ge];J.push({idx:this.childOffsets[ie]+$e,t:O[$e],nodex:(ge<<1)+this._siblingOffset[$e][0],nodey:(Re<<1)+this._siblingOffset[$e][1],depth:je+1})}}return null}_addNode(a,u,f){return this.minimums.push(a),this.maximums.push(u),this.leaves.push(f),this.childOffsets.push(0),this.nodeCount++}_construct(a,u,f,g,v){if(a[g].isLeaf(u,f)===1)return;this.childOffsets[v]||(this.childOffsets[v]=this.nodeCount);const T=g-1,C=a[T];let k=0,O=0;for(let W=0;W<this._siblingOffset.length;W++){const q=2*u+this._siblingOffset[W][0],$=2*f+this._siblingOffset[W][1],J=C.getElevation(q,$),ie=C.isLeaf(q,$),ue=this._addNode(J.min,J.max,ie);ie&&(k|=1<<W),O||(O=ue)}for(let W=0;W<this._siblingOffset.length;W++)k&1<<W||this._construct(a,2*u+this._siblingOffset[W][0],2*f+this._siblingOffset[W][1],T,O+W)}}function QD(c,a,u,f,g,v){return di(di(c,u,v),di(a,f,v),g)}function Df(c,a,u){const f=u.dim,g=fe(c*f-.5,0,f-1),v=fe(a*f-.5,0,f-1),T=Math.floor(g),C=Math.floor(v),k=Math.min(T+1,f-1),O=Math.min(C+1,f-1);return QD(u.get(T,C),u.get(k,C),u.get(T,O),u.get(k,O),g-T,v-C)}const e3={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Ew{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(a,u,f,g=!1,v=!1){if(this.uid=a,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&f!=="mapbox"&&f!=="terrarium")return At(`"${f}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=u.height;const T=this.dim=u.height-2,C=new Uint32Array(u.data.buffer);if(this.pixels=new Uint8Array(u.data.buffer),this.encoding=f||"mapbox",this.borderReady=g,!g){for(let k=0;k<T;k++)C[this._idx(-1,k)]=C[this._idx(0,k)],C[this._idx(T,k)]=C[this._idx(T-1,k)],C[this._idx(k,-1)]=C[this._idx(k,0)],C[this._idx(k,T)]=C[this._idx(k,T-1)];C[this._idx(-1,-1)]=C[this._idx(0,0)],C[this._idx(T,-1)]=C[this._idx(T-1,0)],C[this._idx(-1,T)]=C[this._idx(0,T-1)],C[this._idx(T,T)]=C[this._idx(T-1,T-1)],v&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new JD(this)}get(a,u,f=!1){f&&(a=fe(a,-1,this.dim),u=fe(u,-1,this.dim));const g=4*this._idx(a,u);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[g],this.pixels[g+1],this.pixels[g+2])}static getUnpackVector(a){return e3[a]}get unpackVector(){return e3[this.encoding]}_idx(a,u){if(a<-1||a>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(a+1)}_unpackMapbox(a,u,f){return(256*a*256+256*u+f)/10-1e4}_unpackTerrarium(a,u,f){return 256*a+u+f/256-32768}static pack(a,u){const f=[0,0,0,0],g=Ew.getUnpackVector(u);let v=Math.floor((a+g[3])/g[2]);return f[2]=v%256,v=Math.floor(v/256),f[1]=v%256,v=Math.floor(v/256),f[0]=v,f}getPixels(){return new Ga({width:this.stride,height:this.stride},this.pixels)}backfillBorder(a,u,f){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,v=u*this.dim+this.dim,T=f*this.dim,C=f*this.dim+this.dim;switch(u){case-1:g=v-1;break;case 1:v=g+1}switch(f){case-1:T=C-1;break;case 1:C=T+1}const k=-u*this.dim,O=-f*this.dim;for(let W=T;W<C;W++)for(let q=g;q<v;q++){const $=4*this._idx(q,W),J=4*this._idx(q+k,W+O);this.pixels[$+0]=a.pixels[J+0],this.pixels[$+1]=a.pixels[J+1],this.pixels[$+2]=a.pixels[J+2],this.pixels[$+3]=a.pixels[J+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}dn(Ew,"DEMData"),dn(JD,"DemMinMaxQuadTree",{omit:["dem"]});class QW{constructor(a,u){this.max=a,this.onRemove=u,this.reset()}reset(){for(const a in this.data)for(const u of this.data[a])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(a,u,f){const g=a.wrapped().key;this.data[g]===void 0&&(this.data[g]=[]);const v={value:u,timeout:void 0};if(f!==void 0&&(v.timeout=setTimeout(()=>{this.remove(a,v)},f)),this.data[g].push(v),this.order.push(g),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(a){return a.wrapped().key in this.data}getAndRemove(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null}_getAndRemoveByKey(a){const u=this.data[a].shift();return u.timeout&&clearTimeout(u.timeout),this.data[a].length===0&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),u.value}getByKey(a){const u=this.data[a];return u?u[0].value:null}get(a){return this.has(a)?this.data[a.wrapped().key][0].value:null}remove(a,u){if(!this.has(a))return this;const f=a.wrapped().key,g=u===void 0?0:this.data[f].indexOf(u),v=this.data[f][g];return this.data[f].splice(g,1),v.timeout&&clearTimeout(v.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(v.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(a){for(this.max=a;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(a){const u=[];for(const f in this.data)for(const g of this.data[f])a(g.value)||u.push(g);for(const f of u)this.remove(f.value.tileID,f)}}class d_{constructor(a,u,f){this.func=a,this.mask=u,this.range=f}}d_.ReadOnly=!1,d_.ReadWrite=!0,d_.disabled=new d_(519,d_.ReadOnly,[0,1]);const sE=7680;class oE{constructor(a,u,f,g,v,T){this.test=a,this.ref=u,this.mask=f,this.fail=g,this.depthFail=v,this.pass=T}}oE.disabled=new oE({func:519,mask:0},0,0,sE,sE,sE);class ph{constructor(a,u,f){this.blendFunction=a,this.blendColor=u,this.mask=f}}ph.Replace=[1,0],ph.disabled=new ph(ph.Replace,Sr.transparent,[!1,!1,!1,!1]),ph.unblended=new ph(ph.Replace,Sr.transparent,[!0,!0,!0,!0]),ph.alphaBlended=new ph([1,771],Sr.transparent,[!0,!0,!0,!0]);const aE=1029,lE=2305;class hu{constructor(a,u,f){this.enable=a,this.mode=u,this.frontFace=f}}hu.disabled=new hu(!1,aE,lE),hu.backCCW=new hu(!0,aE,lE),hu.backCW=new hu(!0,aE,2304),hu.frontCW=new hu(!0,1028,2304),hu.frontCCW=new hu(!0,1028,lE);class xm extends Br{constructor(a,u,f){super(),this.id=a,this._onlySymbols=f,u.on("data",g=>{g.dataType==="source"&&g.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),u.on("error",()=>{this._sourceErrored=!0}),this._source=u,this._tiles={},this._cache=new QW(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new JW,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(a){this.map=a,this._minTileCacheSize=this._minTileCacheSize===void 0&&a?a._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&a?a._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const a in this._tiles){const u=this._tiles[a];if(u.state!=="loaded"&&u.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(a,u){return a.isSymbolTile=this._onlySymbols,this._source.loadTile(a,u)}_unloadTile(a){if(this._source.unloadTile)return this._source.unloadTile(a,()=>{})}_abortTile(a){if(this._source.abortTile)return this._source.abortTile(a,()=>{})}serialize(){return this._source.serialize()}prepare(a){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(a),f.prepare(this.map.style.imageManager)}}getIds(){return Te(this._tiles).map(a=>a.tileID).sort(t3).map(a=>a.key)}getRenderableIds(a){const u=[];for(const f in this._tiles)this._isIdRenderable(+f,a)&&u.push(this._tiles[f]);return a?u.sort((f,g)=>{const v=f.tileID,T=g.tileID,C=new j(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),k=new j(T.canonical.x,T.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-T.overscaledZ||k.y-C.y||k.x-C.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(t3).map(f=>f.key)}hasRenderableParent(a){const u=this.findLoadedParent(a,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(a,u){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(u||!this._tiles[a].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(+a,"reloading")}}_reloadTile(a,u){const f=this._tiles[a];f&&(f.state!=="loading"&&(f.state=u),this._loadTile(f,this._tileLoaded.bind(this,f,a,u)))}_tileLoaded(a,u,f,g){if(g)if(a.state="errored",g.status!==404)this._source.fire(new nr(g,{tile:a}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform);else a.timeAdded=Sn.now(),f==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(u,a),this._source.type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new ps("data",{dataType:"source",tile:a,coord:a.tileID,sourceCacheId:this.id}))}_backfillDEM(a){const u=this.getRenderableIds();for(let g=0;g<u.length;g++){const v=u[g];if(a.neighboringTiles&&a.neighboringTiles[v]){const T=this.getTileByID(v);f(a,T),f(T,a)}}function f(g,v){if(!g.dem||g.dem.borderReady)return;g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0;let T=v.tileID.canonical.x-g.tileID.canonical.x;const C=v.tileID.canonical.y-g.tileID.canonical.y,k=Math.pow(2,g.tileID.canonical.z),O=v.tileID.key;T===0&&C===0||Math.abs(C)>1||(Math.abs(T)>1&&(Math.abs(T+k)===1?T+=k:Math.abs(T-k)===1&&(T-=k)),v.dem&&g.dem&&(g.dem.backfillBorder(v.dem,T,C),g.neighboringTiles&&g.neighboringTiles[O]&&(g.neighboringTiles[O].backfilled=!0)))}}getTile(a){return this.getTileByID(a.key)}getTileByID(a){return this._tiles[a]}_retainLoadedChildren(a,u,f,g){for(const v in this._tiles){let T=this._tiles[v];if(g[v]||!T.hasData()||T.tileID.overscaledZ<=u||T.tileID.overscaledZ>f)continue;let C=T.tileID;for(;T&&T.tileID.overscaledZ>u+1;){const O=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[O.key],T&&T.hasData()&&(C=O)}let k=C;for(;k.overscaledZ>u;)if(k=k.scaledTo(k.overscaledZ-1),a[k.key]){g[C.key]=C;break}}}findLoadedParent(a,u){if(a.key in this._loadedParentTiles){const f=this._loadedParentTiles[a.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=a.overscaledZ-1;f>=u;f--){const g=a.scaledTo(f),v=this._getLoadedTile(g);if(v)return v}}_getLoadedTile(a){const u=this._tiles[a.key];return u&&u.hasData()?u:this._cache.getByKey(this._source.reparseOverscaled?a.wrapped().key:a.canonical.key)}updateCacheSize(a,u){u=u||this._source.tileSize;const f=Math.ceil(a.width/u)+1,g=Math.ceil(a.height/u)+1,v=Math.floor(f*g*5),T=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,T):T;this._cache.setMaxSize(C)}handleWrapJump(a){const u=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,u){const f={};for(const g in this._tiles){const v=this._tiles[g];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+u),f[v.tileID.key]=v}this._tiles=f;for(const g in this._timers)clearTimeout(this._timers[g]),delete this._timers[g];for(const g in this._tiles)this._setTileReloadTimer(+g,this._tiles[g])}}update(a,u,f){if(this.transform=a,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!f)return;let g;this.updateCacheSize(a,u),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(C=>new ea(C.canonical.z,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y)):(g=a.coveringTiles({tileSize:u||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!f,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(g=g.filter(C=>this._source.hasTile(C)))):g=[];const v=this._updateRetainedTiles(g);if(n3(this._source.type)&&g.length!==0){const C={},k={},O=Object.keys(v);for(const q of O){const $=v[q],J=this._tiles[q];if(!J||J.fadeEndTime&&J.fadeEndTime<=Sn.now())continue;const ie=this.findLoadedParent($,Math.max($.overscaledZ-xm.maxOverzooming,this._source.minzoom));ie&&(this._addTile(ie.tileID),C[ie.tileID.key]=ie.tileID),k[q]=$}const W=g[g.length-1].overscaledZ;for(const q in this._tiles){const $=this._tiles[q];if(v[q]||!$.hasData())continue;let J=$.tileID;for(;J.overscaledZ>W;){J=J.scaledTo(J.overscaledZ-1);const ie=this._tiles[J.key];if(ie&&ie.hasData()&&k[J.key]){v[q]=$.tileID;break}}}for(const q in C)v[q]||(this._coveredTiles[q]=!0,v[q]=C[q])}for(const C in v)this._tiles[C].clearFadeHold();const T=function(C,k){const O=[];for(const W in C)W in k||O.push(W);return O}(this._tiles,v);for(const C of T){const k=this._tiles[C];k.hasSymbolBuckets&&!k.holdingForFade()?k.setHoldDuration(this.map._fadeDuration):k.hasSymbolBuckets&&!k.symbolFadeFinished()||this._removeTile(+C)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(+a)}_updateRetainedTiles(a){const u={};if(a.length===0)return u;const f={},g=a.reduce((O,W)=>Math.min(O,W.overscaledZ),1/0),v=a[0].overscaledZ,T=Math.max(v-xm.maxOverzooming,this._source.minzoom),C=Math.max(v+xm.maxUnderzooming,this._source.minzoom),k={};for(const O of a){const W=this._addTile(O);u[O.key]=O,W.hasData()||g<this._source.maxzoom&&(k[O.key]=O)}this._retainLoadedChildren(k,g,C,u);for(const O of a){let W=this._tiles[O.key];if(W.hasData())continue;if(O.canonical.z>=this._source.maxzoom){const $=O.children(this._source.maxzoom)[0],J=this.getTile($);if(J&&J.hasData()){u[$.key]=$;continue}}else{const $=O.children(this._source.maxzoom);if(u[$[0].key]&&u[$[1].key]&&u[$[2].key]&&u[$[3].key])continue}let q=W.wasRequested();for(let $=O.overscaledZ-1;$>=T;--$){const J=O.scaledTo($);if(f[J.key]||(f[J.key]=!0,W=this.getTile(J),!W&&q&&(W=this._addTile(J)),W&&(u[J.key]=J,q=W.wasRequested(),W.hasData())))break}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const a in this._tiles){const u=[];let f,g=this._tiles[a].tileID;for(;g.overscaledZ>0;){if(g.key in this._loadedParentTiles){f=this._loadedParentTiles[g.key];break}u.push(g.key);const v=g.scaledTo(g.overscaledZ-1);if(f=this._getLoadedTile(v),f)break;g=v}for(const v of u)this._loadedParentTiles[v]=f}}_addTile(a){let u=this._tiles[a.key];if(u)return u;u=this._cache.getAndRemove(a),u&&(this._setTileReloadTimer(a.key,u),u.tileID=a,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,u)));const f=Boolean(u);if(!f){const g=this.map?this.map.painter:null;u=new rE(a,this._source.tileSize*a.overscaleFactor(),this.transform.tileZoom,g,this._isRaster),this._loadTile(u,this._tileLoaded.bind(this,u,a.key,u.state))}return u?(u.uses++,this._tiles[a.key]=u,f||this._source.fire(new ps("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u):null}_setTileReloadTimer(a,u){a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);const f=u.getExpiryTimeout();f&&(this._timers[a]=setTimeout(()=>{this._reloadTile(a,"expired"),delete this._timers[a]},f))}_removeTile(a){const u=this._tiles[a];u&&(u.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),u.uses>0||(u.hasData()&&u.state!=="reloading"?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const a in this._tiles)this._removeTile(+a);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(a,u,f){const g=[],v=this.transform;if(!v)return g;const T=v.projection.name==="globe",C=Qn(v.center.lng);for(const k in this._tiles){const O=this._tiles[k];if(f&&O.clearQueryDebugViz(),O.holdingForFade())continue;let W;if(T){const q=O.tileID.canonical;if(q.z===0){const $=[Math.abs(fe(C,...q0(q,-1))-C),Math.abs(fe(C,...q0(q,1))-C)];W=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(fe(C,...q0(q,-1))-C),Math.abs(fe(C,...q0(q,0))-C),Math.abs(fe(C,...q0(q,1))-C)];W=[$.indexOf(Math.min(...$))-1]}}else W=[0];for(const q of W){const $=a.containsTile(O,v,u,q);$&&g.push($)}}return g}getVisibleCoordinates(a){const u=this.getRenderableIds(a).map(f=>this._tiles[f].tileID);for(const f of u)f.projMatrix=this.transform.calculateProjMatrix(f.toUnwrapped());return u}hasTransition(){if(this._source.hasTransition())return!0;if(n3(this._source.type))for(const a in this._tiles){const u=this._tiles[a];if(u.fadeEndTime!==void 0&&u.fadeEndTime>=Sn.now())return!0}return!1}setFeatureState(a,u,f){this._state.updateState(a=a||"_geojsonTileLayer",u,f)}removeFeatureState(a,u,f){this._state.removeFeatureState(a=a||"_geojsonTileLayer",u,f)}getFeatureState(a,u){return this._state.getState(a=a||"_geojsonTileLayer",u)}setDependencies(a,u,f){const g=this._tiles[a];g&&g.setDependencies(u,f)}reloadTilesForDependencies(a,u){for(const f in this._tiles)this._tiles[f].hasDependency(a,u)&&this._reloadTile(+f,"reloading");this._cache.filter(f=>!f.hasDependency(a,u))}_preloadTiles(a,u){const f=new Map,g=Array.isArray(a)?a:[a],v=this.map.painter.terrain,T=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const C of g){const k=C.coveringTiles({tileSize:T,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const O of k)f.set(O.key,O);this.usedForTerrain&&C.updateElevation(!1)}ce(Array.from(f.values()),(C,k)=>{const O=new rE(C,this._source.tileSize*C.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(O,W=>{this._source.type==="raster-dem"&&O.dem&&this._backfillDEM(O),k(W,O)})},u)}}function t3(c,a){const u=Math.abs(2*c.wrap)-+(c.wrap<0),f=Math.abs(2*a.wrap)-+(a.wrap<0);return c.overscaledZ-a.overscaledZ||f-u||a.canonical.y-c.canonical.y||a.canonical.x-c.canonical.x}function n3(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function q0(c,a){const u=1<<c.z;return[c.x/u+a,(c.x+1)/u+a]}xm.maxOverzooming=10,xm.maxUnderzooming=3;class Aw{constructor(a,u,f){this._demTile=a,this._dem=this._demTile.dem,this._scale=u,this._offset=f}static create(a,u,f){const g=f||a.findDEMTileFor(u);if(!g||!g.dem)return;const v=g.dem,T=g.tileID,C=1<<u.canonical.z-T.canonical.z;return new Aw(g,g.tileSize/te/C,[(u.canonical.x/C-T.canonical.x)*v.dim,(u.canonical.y/C-T.canonical.y)*v.dim])}tileCoordToPixel(a,u){const f=u*this._scale+this._offset[1],g=Math.floor(a*this._scale+this._offset[0]),v=Math.floor(f);return new j(g,v)}getElevationAt(a,u,f,g){const v=a*this._scale+this._offset[0],T=u*this._scale+this._offset[1],C=Math.floor(v),k=Math.floor(T),O=this._dem;return g=!!g,f?di(di(O.get(C,k,g),O.get(C,k+1,g),T-k),di(O.get(C+1,k,g),O.get(C+1,k+1,g),T-k),v-C):O.get(C,k,g)}getElevationAtPixel(a,u,f){return this._dem.get(a,u,!!f)}getMeterToDEM(a){return(1<<this._demTile.tileID.canonical.z)*Ii(1,a)*this._dem.stride}}class i3{constructor(a,u){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new ru(te,16,0),this.featureIndexArray=new U1,this.promoteId=u}insert(a,u,f,g,v,T=0){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,v,T);const k=this.grid;for(let O=0;O<u.length;O++){const W=u[O],q=[1/0,1/0,-1/0,-1/0];for(let $=0;$<W.length;$++){const J=W[$];q[0]=Math.min(q[0],J.x),q[1]=Math.min(q[1],J.y),q[2]=Math.max(q[2],J.x),q[3]=Math.max(q[3],J.y)}q[0]<te&&q[1]<te&&q[2]>=0&&q[3]>=0&&k.insert(C,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new BT(new R0(this.rawTileData)).layers,this.sourceLayerCoder=new GD(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const a in this.vtLayers)this.vtFeatures[a]=[]}return this.vtLayers}query(a,u,f,g){this.loadVTLayers();const v=a.params||{},T=tu(v.filter),C=a.tileResult,k=a.transform,O=C.bufferedTilespaceBounds,W=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,(ie,ue,ge,Re)=>ck(C.bufferedTilespaceGeometry,ie,ue,ge,Re));W.sort(eH);let q=null;k.elevation&&W.length>0&&(q=Aw.create(k.elevation,this.tileID));const $={};let J;for(let ie=0;ie<W.length;ie++){const ue=W[ie];if(ue===J)continue;J=ue;const ge=this.featureIndexArray.get(ue);let Re=null;this.loadMatchingFeature($,ge,T,v.layers,v.availableImages,u,f,g,(je,ke,Ge,$e=0)=>(Re||(Re=wo(je,this.tileID.canonical,a.tileTransform)),ke.queryIntersectsFeature(C,je,Ge,Re,this.z,a.transform,a.pixelPosMatrix,q,$e)))}return $}loadMatchingFeature(a,u,f,g,v,T,C,k,O){const{featureIndex:W,bucketIndex:q,sourceLayerIndex:$,layoutVertexArrayOffset:J}=u,ie=this.bucketLayerIDs[q];if(g&&!function(je,ke){for(let Ge=0;Ge<je.length;Ge++)if(ke.indexOf(je[Ge])>=0)return!0;return!1}(g,ie))return;const ue=this.sourceLayerCoder.decode($),ge=this.vtLayers[ue].feature(W);if(f.needGeometry){const je=hd(ge,!0);if(!f.filter(new it(this.tileID.overscaledZ),je,this.tileID.canonical))return}else if(!f.filter(new it(this.tileID.overscaledZ),ge))return;const Re=this.getId(ge,ue);for(let je=0;je<ie.length;je++){const ke=ie[je];if(g&&g.indexOf(ke)<0)continue;const Ge=T[ke];if(!Ge)continue;let $e={};Re!==void 0&&k&&($e=k.getState(Ge.sourceLayer||"_geojsonTileLayer",Re));const qe=Pe({},C[ke]);qe.paint=r3(qe.paint,Ge.paint,ge,$e,v),qe.layout=r3(qe.layout,Ge.layout,ge,$e,v);const dt=!O||O(ge,Ge,$e,J);if(!dt)continue;const ut=new WD(ge,this.z,this.x,this.y,Re);ut.layer=qe;let Tt=a[ke];Tt===void 0&&(Tt=a[ke]=[]),Tt.push({featureIndex:W,feature:ut,intersectionZ:dt})}}lookupSymbolFeatures(a,u,f,g,v,T,C,k){const O={};this.loadVTLayers();const W=tu(v);for(const q of a)this.loadMatchingFeature(O,{bucketIndex:f,sourceLayerIndex:g,featureIndex:q,layoutVertexArrayOffset:0},W,T,C,k,u);return O}loadFeature(a){const{featureIndex:u,sourceLayerIndex:f}=a;this.loadVTLayers();const g=this.sourceLayerCoder.decode(f),v=this.vtFeatures[g];if(v[u])return v[u];const T=this.vtLayers[g].feature(u);return v[u]=T,T}hasLayer(a){for(const u of this.bucketLayerIDs)for(const f of u)if(a===f)return!0;return!1}getId(a,u){let f=a.id;if(this.promoteId){const g=typeof this.promoteId=="string"?this.promoteId:this.promoteId[u];g!=null&&(f=a.properties[g]),typeof f=="boolean"&&(f=Number(f))}return f}}function r3(c,a,u,f,g){return qt(c,(v,T)=>{const C=a instanceof kt?a.get(T):null;return C&&C.evaluate?C.evaluate(u,f,g):C})}function eH(c,a){return a-c}dn(i3,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class s3{constructor(a,u){this.width=a,this.height=u,this.nextRow=0,this.image=new fd({width:a,height:u}),this.positions={},this.uploaded=!1}getDash(a,u){const f=this.getKey(a,u);return this.positions[f]}trim(){const a=this.width,u=this.height=ze(this.nextRow);this.image.resize({width:a,height:u})}getKey(a,u){return a.join(",")+u}getDashRanges(a,u,f){const g=[];let v=a.length%2==1?-a[a.length-1]*f:0,T=a[0]*f,C=!0;g.push({left:v,right:T,isDash:C,zeroLength:a[0]===0});let k=a[0];for(let O=1;O<a.length;O++){C=!C;const W=a[O];v=k*f,k+=W,T=k*f,g.push({left:v,right:T,isDash:C,zeroLength:W===0})}return g}addRoundDash(a,u,f){const g=u/2;for(let v=-f;v<=f;v++){const T=this.width*(this.nextRow+f+v);let C=0,k=a[C];for(let O=0;O<this.width;O++){O/k.right>1&&(k=a[++C]);const W=Math.abs(O-k.left),q=Math.abs(O-k.right),$=Math.min(W,q);let J;const ie=v/f*(g+1);if(k.isDash){const ue=g-Math.abs(ie);J=Math.sqrt($*$+ue*ue)}else J=g-Math.sqrt($*$+ie*ie);this.image.data[T+O]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(a,u){for(let k=a.length-1;k>=0;--k){const O=a[k],W=a[k+1];O.zeroLength?a.splice(k,1):W&&W.isDash===O.isDash&&(W.left=O.left,a.splice(k,1))}const f=a[0],g=a[a.length-1];f.isDash===g.isDash&&(f.left=g.left-this.width,g.right=f.right+this.width);const v=this.width*this.nextRow;let T=0,C=a[T];for(let k=0;k<this.width;k++){k/C.right>1&&(C=a[++T]);const O=Math.abs(k-C.left),W=Math.abs(k-C.right),q=Math.min(O,W);this.image.data[v+k]=Math.max(0,Math.min(255,(C.isDash?q:-q)+u+128))}}addDash(a,u){const f=this.getKey(a,u);if(this.positions[f])return this.positions[f];const g=u==="round",v=g?7:0,T=2*v+1;if(this.nextRow+T>this.height)return At("LineAtlas out of space"),null;a.length===0&&a.push(1);let C=0;for(let W=0;W<a.length;W++)a[W]<0&&(At("Negative value is found in line dasharray, replacing values with 0"),a[W]=0),C+=a[W];if(C!==0){const W=this.width/C,q=this.getDashRanges(a,this.width,W);g?this.addRoundDash(q,W,v):this.addRegularDash(q,u==="square"?.5*W:0)}const k=this.nextRow+v;this.nextRow+=T;const O={tl:[k,v],br:[C,0]};return this.positions[f]=O,O}}dn(s3,"LineAtlas");class o3{constructor(a){const u={},f=[];for(const C in a){const k=a[C],O=u[C]={};for(const W in k.glyphs){const q=k.glyphs[+W];if(!q||q.bitmap.width===0||q.bitmap.height===0)continue;const $=q.metrics.localGlyph?2:1,J={x:0,y:0,w:q.bitmap.width+2*$,h:q.bitmap.height+2*$};f.push(J),O[W]=J}}const{w:g,h:v}=VT(f),T=new fd({width:g||1,height:v||1});for(const C in a){const k=a[C];for(const O in k.glyphs){const W=k.glyphs[+O];if(!W||W.bitmap.width===0||W.bitmap.height===0)continue;const q=u[C][O],$=W.metrics.localGlyph?2:1;fd.copy(W.bitmap,T,{x:0,y:0},{x:q.x+$,y:q.y+$},W.bitmap)}}this.image=T,this.positions=u}}dn(o3,"GlyphAtlas");class tH{constructor(a){this.tileID=new ea(a.tileID.overscaledZ,a.tileID.wrap,a.tileID.canonical.z,a.tileID.canonical.x,a.tileID.canonical.y),this.tileZoom=a.tileZoom,this.uid=a.uid,this.zoom=a.zoom,this.canonical=a.tileID.canonical,this.pixelRatio=a.pixelRatio,this.tileSize=a.tileSize,this.source=a.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=a.showCollisionBoxes,this.collectResourceTiming=!!a.collectResourceTiming,this.returnDependencies=!!a.returnDependencies,this.promoteId=a.promoteId,this.enableTerrain=!!a.enableTerrain,this.isSymbolTile=a.isSymbolTile,this.tileTransform=ym(a.tileID.canonical,a.projection),this.projection=a.projection}parse(a,u,f,g,v){this.status="parsing",this.data=a,this.collisionBoxArray=new jg;const T=new GD(Object.keys(a.layers).sort()),C=new i3(this.tileID,this.promoteId);C.bucketLayerIDs=[];const k={},O=new s3(256,256),W={featureIndex:C,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:O,availableImages:f},q=u.familiesBySource[this.source];for(const $e in q){const qe=a.layers[$e];if(!qe)continue;let dt=!1,ut=!1;for(const yt of q[$e])yt[0].type==="symbol"?dt=!0:ut=!0;if(this.isSymbolTile===!0&&!dt||this.isSymbolTile===!1&&!ut)continue;qe.version===1&&At(`Vector tile source "${this.source}" layer "${$e}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Tt=T.encode($e),Ht=[];for(let yt=0;yt<qe.length;yt++){const Pt=qe.feature(yt),Rt=C.getId(Pt,$e);Ht.push({feature:Pt,id:Rt,index:yt,sourceLayerIndex:Tt})}for(const yt of q[$e]){const Pt=yt[0];this.isSymbolTile!==void 0&&Pt.type==="symbol"!==this.isSymbolTile||Pt.minzoom&&this.zoom<Math.floor(Pt.minzoom)||Pt.maxzoom&&this.zoom>=Pt.maxzoom||Pt.visibility!=="none"&&(cE(yt,this.zoom,f),(k[Pt.id]=Pt.createBucket({index:C.bucketLayerIDs.length,layers:yt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Tt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:f})).populate(Ht,W,this.tileID.canonical,this.tileTransform),C.bucketLayerIDs.push(yt.map(Rt=>Rt.id)))}}let $,J,ie,ue;O.trim();const ge={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Re=qt(W.glyphDependencies,$e=>Object.keys($e).map(Number));Object.keys(Re).length?g.send("getGlyphs",{uid:this.uid,stacks:Re},($e,qe)=>{$||($=$e,J=qe,Ge.call(this))},void 0,!1,ge):J={};const je=Object.keys(W.iconDependencies);je.length?g.send("getImages",{icons:je,source:this.source,tileID:this.tileID,type:"icons"},($e,qe)=>{$||($=$e,ie=qe,Ge.call(this))},void 0,!1,ge):ie={};const ke=Object.keys(W.patternDependencies);function Ge(){if($)return v($);if(J&&ie&&ue){const $e=new o3(J),qe=new oD(ie,ue);for(const dt in k){const ut=k[dt];ut instanceof Pf?(cE(ut.layers,this.zoom,f),SW(ut,J,$e.positions,ie,qe.iconPositions,this.showCollisionBoxes,f,this.tileID.canonical,this.tileZoom,this.projection)):ut.hasPattern&&(ut instanceof cw||ut instanceof rw||ut instanceof P0)&&(cE(ut.layers,this.zoom,f),ut.addFeatures(W,this.tileID.canonical,qe.patternPositions,f,this.tileTransform))}this.status="done",v(null,{buckets:Te(k).filter(dt=>!dt.isEmpty()),featureIndex:C,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:$e.image,lineAtlas:O,imageAtlas:qe,glyphMap:this.returnDependencies?J:null,iconMap:this.returnDependencies?ie:null,glyphPositions:this.returnDependencies?$e.positions:null})}}ke.length?g.send("getImages",{icons:ke,source:this.source,tileID:this.tileID,type:"patterns"},($e,qe)=>{$||($=$e,ue=qe,Ge.call(this))},void 0,!1,ge):ue={},Ge.call(this)}}function cE(c,a,u){const f=new it(a);for(const g of c)g.recalculate(f,u)}class a3{constructor(a){this.entries={},this.scheduler=a}request(a,u,f,g){const v=this.entries[a]=this.entries[a]||{callbacks:[]};if(v.result){const[T,C]=v.result;return this.scheduler?this.scheduler.add(()=>{g(T,C)},u):g(T,C),()=>{}}return v.callbacks.push(g),v.cancel||(v.cancel=f((T,C)=>{v.result=[T,C];for(const k of v.callbacks)this.scheduler?this.scheduler.add(()=>{k(T,C)},u):k(T,C);setTimeout(()=>delete this.entries[a],3e3)})),()=>{v.result||(v.callbacks=v.callbacks.filter(T=>T!==g),v.callbacks.length||(v.cancel(),delete this.entries[a]))}}}function l3(c,a,u){const f=JSON.stringify(c.request);return c.data&&(this.deduped.entries[f]={result:[null,c.data]}),this.deduped.request(f,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},g=>{const v=Zt(c.request,(T,C,k,O)=>{T?g(T):C&&g(null,{vectorTile:u?void 0:new BT(new R0(C)),rawData:C,cacheControl:k,expires:O})});return()=>{v.cancel(),g()}},a)}s.ARRAY_TYPE=Va,s.AUTH_ERR_MSG=Ct,s.Aabb=Qo,s.Actor=class{constructor(c,a,u){this.target=c,this.parent=a,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Et(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Cn()?c:d,this.scheduler=new YW}send(c,a,u,f,g=!1,v){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[T]=u);const C=On(this.globalScope)?void 0:[];return this.target.postMessage({id:T,type:c,hasCallback:!!u,targetMapId:f,mustQueue:g,sourceMapId:this.mapId,data:wl(a,C)},C),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(c){const a=c.data,u=a.id;if(u&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(a.mustQueue||Cn()){const f=this.callbacks[u];this.cancelCallbacks[u]=this.scheduler.add(()=>this.processTask(u,a),f&&f.metadata||{type:"message"})}else this.processTask(u,a)}processTask(c,a){if(a.type==="<response>"){const u=this.callbacks[c];delete this.callbacks[c],u&&(a.error?u(th(a.error)):u(null,th(a.data)))}else{const u=On(this.globalScope)?void 0:[],f=a.hasCallback?(v,T)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:v?wl(v):null,data:wl(T,u)},u)}:v=>{},g=th(a.data);if(this.parent[a.type])this.parent[a.type](a.sourceMapId,g,f);else if(this.parent.getWorkerSource){const v=a.type.split(".");this.parent.getWorkerSource(a.sourceMapId,v[0],g.source)[v[1]](g,f)}else f(new Error(`Could not find function ${a.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=lw,s.Color=Sr,s.ColorMode=ph,s.CullFaceMode=hu,s.DEMData=Ew,s.DataConstantProperty=Ye,s.DedupedRequest=a3,s.DepthMode=d_,s.EXTENT=te,s.Elevation=class{isDataAvailableAtPoint(c){const a=this._source();if(this.isUsingMockSource()||!a||c.y<0||c.y>1)return!1;const u=a.getSource().maxzoom,f=1<<u,g=Math.floor(c.x),v=Math.floor((c.x-g)*f),T=Math.floor(c.y*f),C=this.findDEMTileFor(new ea(u,g,u,v,T));return!(!C||!C.dem)}getAtPointOrZero(c,a=0){return this.getAtPoint(c,a)||0}getAtPoint(c,a,u=!0){if(this.isUsingMockSource())return null;a==null&&(a=null);const f=this._source();if(!f||c.y<0||c.y>1)return a;const g=f.getSource().maxzoom,v=1<<g,T=Math.floor(c.x),C=c.x-T,k=new ea(g,T,g,Math.floor(C*v),Math.floor(c.y*v)),O=this.findDEMTileFor(k);if(!O||!O.dem)return a;const W=O.dem,q=1<<O.tileID.canonical.z,$=(C*q-O.tileID.canonical.x)*W.dim,J=(c.y*q-O.tileID.canonical.y)*W.dim,ie=Math.floor($),ue=Math.floor(J);return(u?this.exaggeration():1)*di(di(W.get(ie,ue),W.get(ie,ue+1),J-ue),di(W.get(ie+1,ue),W.get(ie+1,ue+1),J-ue),$-ie)}getAtTileOffset(c,a,u){const f=1<<c.canonical.z;return this.getAtPointOrZero(new Mt(c.wrap+(c.canonical.x+a/te)/f,(c.canonical.y+u/te)/f))}getAtTileOffsetFunc(c,a,u,f){return g=>{const v=this.getAtTileOffset(c,g.x,g.y),T=f.upVector(c.canonical,g.x,g.y);return Tl(T,T,v*f.upVectorScale(c.canonical,a,u).metersToTile),T}}getForTilePoints(c,a,u,f){if(this.isUsingMockSource())return!1;const g=Aw.create(this,c,f);return!!g&&(a.forEach(v=>{v[2]=this.exaggeration()*g.getElevationAt(v[0],v[1],u)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const a=this.findDEMTileFor(c);if(!a||!a.dem)return null;const u=a.dem.tree,f=a.tileID,g=1<<c.canonical.z-f.canonical.z;let v=c.canonical.x/g-f.canonical.x,T=c.canonical.y/g-f.canonical.y,C=0;for(let k=0;k<c.canonical.z-f.canonical.z&&!u.leaves[C];k++){v*=2,T*=2;const O=2*Math.floor(T)+Math.floor(v);C=u.childOffsets[C]+O,v%=1,T%=1}return{min:this.exaggeration()*u.minimums[C],max:this.exaggeration()*u.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,a,u){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=nr,s.EvaluationParameters=it,s.Event=ps,s.Evented=Br,s.FillExtrusionBucket=P0,s.Frustum=IT,s.FrustumCorners=CT,s.GLOBE_METERS_TO_ECEF=$T,s.GLOBE_RADIUS=gd,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=6,s.GLOBE_ZOOM_THRESHOLD_MIN=5,s.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_createGrid(c){const a=new bi,u=new Xi,f=65;for(let g=0;g<f;g++)for(let v=0;v<f;v++)a.emplaceBack(v,g);this._gridSegments=[];for(let g=0,v=0;g<l_.length;g++){const T=l_[g];for(let k=0;k<T;k++)for(let O=0;O<64;O++){const W=k*f+O;u.emplaceBack(W+1,W,W+f),u.emplaceBack(W+f,W+f+1,W+1)}const C=64*T*2;this._gridSegments.push(X.simpleSegment(0,v,(T+1)*f,C)),v+=C}this._gridBuffer=c.createVertexBuffer(a,F0.members),this._gridIndexBuffer=c.createIndexBuffer(u,!0)}_createPoles(c){const a=new Xi;for(let g=0;g<=a_;g++)a.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=c.createIndexBuffer(a,!0);const u=new ys,f=new ys;this._poleSegments=[];for(let g=0,v=0;g<5;g++){const T=360/(1<<g);u.emplaceBack(0,-gd,0,.5,0),f.emplaceBack(0,-gd,0,.5,1);for(let C=0;C<=a_;C++){const k=C/a_,O=di(0,T,k),[W,q,$]=c_(PW,LW,O,gd);u.emplaceBack(W,q,$,k,0),f.emplaceBack(W,q,$,k,1)}this._poleSegments.push(X.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(u,ED,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(f,ED,!1)}getGridBuffers(c){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments[c]]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,a){if(!this._wireframeSegments){const u=new Yo,f=a_,g=f+1;this._wireframeSegments=[];for(let v=0,T=0;v<l_.length;v++){const C=l_[v];for(let O=0;O<C;O++)for(let W=0;W<f;W++){const q=O*g+W;u.emplaceBack(q,q+1),u.emplaceBack(q,q+g),u.emplaceBack(q,q+g+1)}const k=C*f*3;this._wireframeSegments.push(X.simpleSegment(0,T,(C+1)*g,k)),T+=k}this._wireframeIndexBuffer=c.createIndexBuffer(u)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[a]]}},s.GlyphManager=s_,s.ImagePosition=GT,s.LivePerformanceUtils=zt,s.LngLat=pt,s.LngLatBounds=Ve,s.LocalGlyphMode=jT,s.MAX_MERCATOR_LATITUDE=_t,s.MercatorCoordinate=Mt,s.ONE_EM=bo,s.OverscaledTileID=ea,s.PerformanceMarkers=ht,s.Properties=mn,s.RGBAImage=Ga,s.Ray=AT,s.RequestManager=class{constructor(c,a,u){this._transformRequestFn=c,this._customAccessToken=a,this._silenceAuthErrors=!!u,this._createSkuToken()}_createSkuToken(){const c=function(){let a="";for(let u=0;u<10;u++)a+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",F,a].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,a){return this._transformRequestFn&&this._transformRequestFn(c,a)||{url:c}}normalizeStyleURL(c,a){if(!Vt(c))return c;const u=Pr(c);return u.path=`/styles/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeGlyphsURL(c,a){if(!Vt(c))return c;const u=Pr(c);return u.path=`/fonts/v1${u.path}`,this._makeAPIURL(u,this._customAccessToken||a)}normalizeSourceURL(c,a,u,f){if(!Vt(c))return c;const g=Pr(c);return g.path=`/v4/${g.authority}.json`,g.params.push("secure"),u&&g.params.push(`language=${u}`),f&&g.params.push(`worldview=${f}`),this._makeAPIURL(g,this._customAccessToken||a)}normalizeSpriteURL(c,a,u,f){const g=Pr(c);return Vt(c)?(g.path=`/styles/v1${g.path}/sprite${a}${u}`,this._makeAPIURL(g,this._customAccessToken||f)):(g.path+=`${a}${u}`,Gi(g))}normalizeTileURL(c,a,u){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!Vt(c))return c;const f=Pr(c);f.path=f.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${a||u&&f.authority!=="raster"&&u===512?"@2x":""}${M.supported?".webp":"$1"}`),f.authority==="raster"?f.path=`/${w.RASTER_URL_PREFIX}${f.path}`:(f.path=f.path.replace(/^.+\/v4\//,"/"),f.path=`/${w.TILE_URL_VERSION}${f.path}`);const g=this._customAccessToken||function(v){for(const T of v){const C=T.match(/^access_token=(.*)$/);if(C)return C[1]}return null}(f.params)||w.ACCESS_TOKEN;return w.REQUIRE_ACCESS_TOKEN&&g&&this._skuToken&&f.params.push(`sku=${this._skuToken}`),this._makeAPIURL(f,g)}canonicalizeTileURL(c,a){const u=Pr(c);if(!u.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!u.path.match(/\.[\w]+$/))return c;let f="mapbox://";u.path.match(/^\/raster\/v1\//)?f+=`raster/${u.path.replace(`/${w.RASTER_URL_PREFIX}/`,"")}`:f+=`tiles/${u.path.replace(`/${w.TILE_URL_VERSION}/`,"")}`;let g=u.params;return a&&(g=g.filter(v=>!v.match(/^access_token=/))),g.length&&(f+=`?${g.join("&")}`),f}canonicalizeTileset(c,a){const u=!!a&&Vt(a),f=[];for(const g of c.tiles||[])bn(g)?f.push(this.canonicalizeTileURL(g,u)):f.push(g);return f}_makeAPIURL(c,a){const u="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",f=Pr(w.API_URL);if(c.protocol=f.protocol,c.authority=f.authority,c.protocol==="http"){const g=c.params.indexOf("secure");g>=0&&c.params.splice(g,1)}if(f.path!=="/"&&(c.path=`${f.path}${c.path}`),!w.REQUIRE_ACCESS_TOKEN)return Gi(c);if(a=a||w.ACCESS_TOKEN,!this._silenceAuthErrors){if(!a)throw new Error(`An API access token is required to use Mapbox GL. ${u}`);if(a[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${u}`)}return c.params=c.params.filter(g=>g.indexOf("access_token")===-1),c.params.push(`access_token=${a||""}`),Gi(c)}},s.ResourceType=Dt,s.SegmentVector=X,s.SourceCache=xm,s.StencilMode=oE,s.StructArrayLayout1ui2=ud,s.StructArrayLayout2f1f2i16=Ls,s.StructArrayLayout2i4=bi,s.StructArrayLayout2ui4=Yo,s.StructArrayLayout3f12=$o,s.StructArrayLayout3ui6=Xi,s.StructArrayLayout4i8=si,s.StructArrayLayout5f20=ys,s.Texture=j0,s.Tile=rE,s.Transitionable=bt,s.Uniform1f=hm,s.Uniform1i=class extends rc{constructor(c){super(c),this.current=0}set(c,a,u){this.fetchUniformLocation(c,a)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},s.Uniform2f=class extends rc{constructor(c){super(c),this.current=[0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}},s.Uniform3f=class extends rc{constructor(c){super(c),this.current=[0,0,0]}set(c,a,u){this.fetchUniformLocation(c,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}},s.Uniform4f=j1,s.UniformColor=wa,s.UniformMatrix2f=class extends rc{constructor(c){super(c),this.current=ah}set(c,a,u){if(this.fetchUniformLocation(c,a)){for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}},s.UniformMatrix3f=class extends rc{constructor(c){super(c),this.current=_T}set(c,a,u){if(this.fetchUniformLocation(c,a)){for(let f=0;f<9;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix3fv(this.location,!1,u);break}}}},s.UniformMatrix4f=class extends rc{constructor(c){super(c),this.current=m0}set(c,a,u){if(this.fetchUniformLocation(c,a)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}},s.UnwrappedTileID=Zk,s.ValidationError=hn,s.VectorTileFeature=ow,s.VectorTileWorkerSource=class extends Br{constructor(c,a,u,f,g){super(),this.actor=c,this.layerIndex=a,this.availableImages=u,this.loadVectorData=g||l3,this.loading={},this.loaded={},this.deduped=new a3(c.scheduler),this.isSpriteLoaded=f,this.scheduler=c.scheduler}loadTile(c,a){const u=c.uid,f=c&&c.request,g=f&&f.collectResourceTiming,v=this.loading[u]=new tH(c);v.abort=this.loadVectorData(c,(T,C)=>{const k=!this.loading[u];if(delete this.loading[u],k||T||!C)return v.status="done",k||(this.loaded[u]=v),a(T);const O=C.rawData,W={};C.expires&&(W.expires=C.expires),C.cacheControl&&(W.cacheControl=C.cacheControl),v.vectorTile=C.vectorTile||new BT(new R0(O));const q=()=>{v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,($,J)=>{if($||!J)return a($);const ie={};if(g){const ue=Yt(f);ue.length>0&&(ie.resourceTiming=JSON.parse(JSON.stringify(ue)))}a(null,Pe({rawTileData:O.slice(0)},J,W,ie))})};this.isSpriteLoaded?q():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(q,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):q()}),this.loaded=this.loaded||{},this.loaded[u]=v})}reloadTile(c,a){const u=this.loaded,f=c.uid,g=this;if(u&&u[f]){const v=u[f];v.showCollisionBoxes=c.showCollisionBoxes,v.enableTerrain=!!c.enableTerrain,v.projection=c.projection,v.tileTransform=ym(c.tileID.canonical,c.projection);const T=(C,k)=>{const O=v.reloadCallback;O&&(delete v.reloadCallback,v.parse(v.vectorTile,g.layerIndex,this.availableImages,g.actor,O)),a(C,k)};v.status==="parsing"?v.reloadCallback=T:v.status==="done"&&(v.vectorTile?v.parse(v.vectorTile,this.layerIndex,this.availableImages,this.actor,T):T())}}abortTile(c,a){const u=c.uid,f=this.loading[u];f&&(f.abort&&f.abort(),delete this.loading[u]),a()}removeTile(c,a){const u=this.loaded,f=c.uid;u&&u[f]&&delete u[f],a()}},s.WritingMode=El,s.add=dd,s.addDynamicAttributes=Sw,s.adjoint=function(c,a){var u=a[0],f=a[1],g=a[2],v=a[3],T=a[4],C=a[5],k=a[6],O=a[7],W=a[8];return c[0]=T*W-C*O,c[1]=g*O-f*W,c[2]=f*C-g*T,c[3]=C*k-v*W,c[4]=u*W-g*k,c[5]=g*v-u*C,c[6]=v*O-T*k,c[7]=f*k-u*O,c[8]=u*T-f*v,c},s.asyncAll=ce,s.bezier=ae,s.bindAll=Et,s.boundsAttributes=jD,s.bufferConvexPolygon=function(c,a){const u=[];for(let f=0;f<c.length;f++){const g=We(f-1,-1,c.length-1),v=We(f+1,-1,c.length-1),T=c[f],C=c[v],k=c[g].sub(T).unit(),O=C.sub(T).unit(),W=O.angleWithSep(k.x,k.y),q=k.add(O).unit().mult(-1*a/Math.sin(W/2));u.push(T.add(q))}return u},s.cacheEntryPossiblyAdded=function(c){yn++,yn>tn&&(c.getActor().send("enforceCacheSizeLimit",St),yn=0)},s.calculateGlobeLabelMatrix=function(c,a){const{x:u,y:f}=c.point,g=kD(u,f,c.worldSize/c._pixelsPerMercatorPixel,0,0);return fm(g,g,JT(hh(a)))},s.calculateGlobeMatrix=function(c){const{x:a,y:u}=c.point,{lng:f,lat:g}=c._center;return kD(a,u,c.worldSize,f,g)},s.calculateGlobeMercatorMatrix=function(c){const a=c.pixelsPerMeter,u=a/Ii(1,c.center.lat),f=cu(new Float64Array(16));return _0(f,f,[c.point.x,c.point.y,0]),pm(f,f,[u,u,a]),Float32Array.from(f)},s.circumferenceAtLatitude=Dn,s.clamp=fe,s.clearTileCache=function(c){if(!nn())return;const a=d.caches.delete(Ei);c&&a.catch(c).then(()=>c())},s.clipLine=yD,s.clone=function(c){var a=new Va(16);return a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[4]=c[4],a[5]=c[5],a[6]=c[6],a[7]=c[7],a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15],a},s.clone$1=_n,s.collisionCircleLayout=$8,s.config=w,s.conjugate=function(c,a){return c[0]=-a[0],c[1]=-a[1],c[2]=-a[2],c[3]=a[3],c},s.create=function(){var c=new Va(16);return Va!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},s.create$1=dk,s.createExpression=Xo,s.createLayout=an,s.createStyleLayer=function(c){return c.type==="custom"?new qW(c):new XW[c.type](c)},s.cross=ET,s.degToRad=ne,s.distance=function(c,a){return Math.hypot(a[0]-c[0],a[1]-c[1],a[2]-c[2])},s.div=function(c,a,u){return c[0]=a[0]/u[0],c[1]=a[1]/u[1],c[2]=a[2]/u[2],c},s.dot=sc,s.earthRadius=st,s.ease=le,s.easeCubicInOut=He,s.ecefToLatLng=function([c,a,u]){const f=Math.hypot(c,a,u),g=Math.atan2(c,u),v=.5*Math.PI-Math.acos(-a/f);return new pt(he(g),he(v))},s.emitValidationErrors=am,s.endsWith=Nt,s.enforceCacheSizeLimit=function(c){fn(),Be&&Be.then(a=>{a.keys().then(u=>{for(let f=0;f<u.length-c;f++)a.delete(u[f])})})},s.evaluateSizeForFeature=uw,s.evaluateSizeForZoom=t_,s.evaluateVariableOffset=SD,s.evented=Ze,s.exactEquals=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]&&c[3]===a[3]},s.exactEquals$1=function(c,a){return c[0]===a[0]&&c[1]===a[1]&&c[2]===a[2]},s.exported=Sn,s.exported$1=M,s.extend=Pe,s.extend$1=Es,s.fillExtrusionHeightLift=Hk,s.filterObject=wn,s.fromMat4=function(c,a){return c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[4],c[4]=a[5],c[5]=a[6],c[6]=a[8],c[7]=a[9],c[8]=a[10],c},s.fromQuat=function(c,a){var u=a[0],f=a[1],g=a[2],v=a[3],T=u+u,C=f+f,k=g+g,O=u*T,W=f*T,q=f*C,$=g*T,J=g*C,ie=g*k,ue=v*T,ge=v*C,Re=v*k;return c[0]=1-q-ie,c[1]=W+Re,c[2]=$-ge,c[3]=0,c[4]=W-Re,c[5]=1-O-ie,c[6]=J+ue,c[7]=0,c[8]=$+ge,c[9]=J-ue,c[10]=1-O-q,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},s.fromRotation=function(c,a){var u=Math.sin(a),f=Math.cos(a);return c[0]=f,c[1]=u,c[2]=0,c[3]=-u,c[4]=f,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},s.fromScaling=pk,s.furthestTileCorner=function(c){const a=Math.round((c+45+360)%360/90)%4;return De[a]},s.getAABBPointSquareDist=function(c,a,u){let f=0;for(let g=0;g<2;++g){const v=u?u[g]:0;c[g]>v&&(f+=(c[g]-v)*(c[g]-v)),a[g]<v&&(f+=(v-a[g])*(v-a[g]))}return f},s.getAnchorAlignment=HT,s.getAnchorJustification=ZT,s.getBounds=function(c){let a=1/0,u=1/0,f=-1/0,g=-1/0;for(const v of c)a=Math.min(a,v.x),u=Math.min(u,v.y),f=Math.max(f,v.x),g=Math.max(g,v.y);return{min:new j(a,u),max:new j(f,g)}},s.getColumn=ai,s.getGridMatrix=function(c,a,u,f){const g=a.getNorth(),v=a.getSouth(),T=a.getWest(),C=a.getEast(),k=1<<c.z,O=C-T,W=g-v,q=O/a_,$=-W/l_[u],J=[0,q,0,$,0,0,g,T,0];if(c.z>0){const ie=180/f;fk(J,J,[ie/O+1,0,0,0,ie/W+1,0,-.5*ie/q,.5*ie/$,1])}return J[2]=k,J[5]=c.x,J[8]=c.y,J},s.getImage=rt,s.getJSON=function(c,a){return It(Pe(c,{type:"json"}),a)},s.getLatitudinalLod=function(c){const a=80.051129;c=fe(c,-80.051129,a)/a*90;const u=Math.pow(Math.abs(Math.sin(ne(c))),3);return Math.round(u*(l_.length-1))},s.getMapSessionAPI=ve,s.getPerformanceMeasurement=Yt,s.getProjection=UD,s.getRTLTextPluginStatus=tt,s.getReferrer=Je,s.getTilePoint=function(c,{x:a,y:u},f=0){return new j(((a-f)*c.scale-c.x)*te,(u*c.scale-c.y)*te)},s.getTileVec3=function(c,a,u=0){return Kg(((a.x-u)*c.scale-c.x)*te,(a.y*c.scale-c.y)*te,Sa(a.z,a.y))},s.getVideo=function(c,a){const u=d.document.createElement("video");u.muted=!0,u.onloadstart=function(){a(null,u)};for(let f=0;f<c.length;f++){const g=d.document.createElement("source");sn(c[f])||(u.crossOrigin="Anonymous"),g.src=c[f],u.appendChild(g)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(c){const a=[0,0,0],u=cu(new Float64Array(16));return fm(u,c.pixelMatrix,c.globeMatrix),$r(a,a,u),new j(a[0],a[1])},s.globeDenormalizeECEF=JT,s.globeECEFOrigin=function(c,a){const u=[0,0,0];return $r(u,u,U0(hh(a.canonical))),$r(u,u,c),u},s.globeNormalizeECEF=U0,s.globePixelsToTileUnits=function(c,a){return te/(512*Math.pow(2,c))*yw(hh(a))},s.globePoleMatrixForTile=function(c,a,u){const f=cu(new Float64Array(16)),g=(a/(1<<c)-.5)*Math.PI*2;return Q1(f,u.globeMatrix,g),Float32Array.from(f)},s.globeTileBounds=hh,s.globeTiltAtLngLat=DD,s.globeToMercatorTransition=u_,s.globeUseCustomAntiAliasing=function(c,a,u){const f=u_(u.zoom),g=c.style.map._antialias,v=!!a.extStandardDerivatives,T=a.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return f===0&&!g&&!T&&v},s.identity=cu,s.identity$1=bk,s.invert=bT,s.isFullscreen=function(){return!!d.document.fullscreenElement||!!d.document.webkitFullscreenElement},s.isLngLatBehindGlobe=QT,s.isMapAuthenticated=function(c){return Ke.has(c)},s.isMapboxURL=Vt,s.isSafariWithAntialiasingBug=function(c){const a=c.navigator?c.navigator.userAgent:null;return!!On(c)&&a&&(a.match("Version/15.4")||a.match("Version/15.5")||a.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=Hi,s.latLngToECEF=B0,s.len=JG,s.length=y0,s.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},s.lngFromMercatorX=Pn,s.loadVectorTile=l3,s.makeRequest=It,s.mapValue=function(c,a,u,f,g){return fe((c-a)/(u-a)*(g-f)+f,f,g)},s.mercatorScale=ct,s.mercatorXfromLng=Qn,s.mercatorYfromLat=Gn,s.mercatorZfromAltitude=Ii,s.mul=YG,s.mul$1=KG,s.multiply=fm,s.multiply$1=fk,s.multiply$2=_k,s.nextPowerOfTwo=ze,s.normalize=Jo,s.normalize$1=QG,s.normalize$2=vk,s.number=di,s.ortho=function(c,a,u,f,g,v,T){var C=1/(a-u),k=1/(f-g),O=1/(v-T);return c[0]=-2*C,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*k,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*O,c[11]=0,c[12]=(a+u)*C,c[13]=(g+f)*k,c[14]=(T+v)*O,c[15]=1,c},s.pbf=R0,s.perspective=function(c,a,u,f,g){var v,T=1/Math.tan(a/2);return c[0]=T/u,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=T,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,g!=null&&g!==1/0?(c[10]=(g+f)*(v=1/(f-g)),c[14]=2*g*f*v):(c[10]=-1,c[14]=-2*f),c},s.pick=function(c,a){const u={};for(let f=0;f<a.length;f++){const g=a[f];g in c&&(u[g]=c[g])}return u},s.plugin=lt,s.pointGeometry=j,s.polesInViewport=function(c){const a=cu(new Float64Array(16));fm(a,c.pixelMatrix,c.globeMatrix);const u=[0,oc,0],f=[0,ac,0];return $r(u,u,a),$r(f,f,a),[u[0]>0&&u[0]<=c.width&&u[1]>0&&u[1]<=c.height&&!QT(c,new pt(c.center.lat,90)),f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!QT(c,new pt(c.center.lat,-90))]},s.polygonContainsPoint=dm,s.polygonIntersectsBox=ck,s.polygonIntersectsPolygon=sk,s.polygonizeBounds=function(c,a,u=0,f=!0){const g=new j(u,u),v=c.sub(g),T=a.add(g),C=[v,new j(T.x,v.y),T,new j(v.x,T.y)];return f&&C.push(v.clone()),C},s.posAttributes=F0,s.postMapLoadEvent=ee,s.postPerformanceEvent=Ae,s.postTurnstileEvent=de,s.potpack=VT,s.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},s.radToDeg=he,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(c){return c({pluginStatus:Le,pluginURL:Ce}),Ze.on("pluginStateChange",c),c},s.removeAuthState=function(c){Ke.delete(c)},s.renderColorRamp=LT,s.resample=Hn,s.rotateX=ST,s.rotateX$1=Sk,s.rotateY=Q1,s.rotateY$1=Mk,s.rotateZ=function(c,a,u){var f=Math.sin(u),g=Math.cos(u),v=a[0],T=a[1],C=a[2],k=a[3],O=a[4],W=a[5],q=a[6],$=a[7];return a!==c&&(c[8]=a[8],c[9]=a[9],c[10]=a[10],c[11]=a[11],c[12]=a[12],c[13]=a[13],c[14]=a[14],c[15]=a[15]),c[0]=v*g+O*f,c[1]=T*g+W*f,c[2]=C*g+q*f,c[3]=k*g+$*f,c[4]=O*g-v*f,c[5]=W*g-T*f,c[6]=q*g-C*f,c[7]=$*g-k*f,c},s.rotateZ$1=function(c,a,u){u*=.5;var f=a[0],g=a[1],v=a[2],T=a[3],C=Math.sin(u),k=Math.cos(u);return c[0]=f*k+g*C,c[1]=g*k-f*C,c[2]=v*k+T*C,c[3]=T*k-v*C,c},s.scale=pm,s.scale$1=xk,s.scale$2=Tl,s.scaleAndAdd=w0,s.set=function(c,a,u,f){return c[0]=a,c[1]=u,c[2]=f,c},s.setCacheLimits=function(c,a){St=c,tn=a},s.setColumn=function(c,a,u){c[4*a+0]=u[0],c[4*a+1]=u[1],c[4*a+2]=u[2],c[4*a+3]=u[3]},s.setRTLTextPlugin=function(c,a,u=!1){if(Le===we||Le===Me||Le===_e)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ce=Sn.resolveURL(c),Le=we,xe=a,Xe(),u||ft()},s.smoothstep=Oe,s.spec=wt,s.squaredLength=function(c){var a=c[0],u=c[1],f=c[2];return a*a+u*u+f*f},s.storeAuthState=function(c,a){a?Ke.add(c):Ke.delete(c)},s.sub=uu,s.subtract=TT,s.symbolSize=Y8,s.tileAABB=function(c,a,u,f,g,v,T,C,k){if(k.name==="globe")return IW(c,a,new lw(u,f,g));const O=ym({z:u,x:f,y:g},k);return new Qo([(v+O.x/O.scale)*a,a*(O.y/O.scale),T],[(v+O.x2/O.scale)*a,a*(O.y2/O.scale),C])},s.tileCornersToBounds=_w,s.tileTransform=ym,s.transformMat3=function(c,a,u){var f=a[0],g=a[1],v=a[2];return c[0]=f*u[0]+g*u[3]+v*u[6],c[1]=f*u[1]+g*u[4]+v*u[7],c[2]=f*u[2]+g*u[5]+v*u[8],c},s.transformMat4=$r,s.transformMat4$1=mm,s.transformQuat=yk,s.transitionTileAABBinECEF=ID,s.translate=_0,s.transpose=function(c,a){if(c===a){var u=a[1],f=a[2],g=a[5];c[1]=a[3],c[2]=a[6],c[3]=u,c[5]=a[7],c[6]=f,c[7]=g}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c},s.triggerPluginCompletionEvent=Ue,s.uniqueId=Ne,s.updateGlobeVertexNormal=function(c,a,u,f,g){const v=5*a+2;c.float32[v+0]=u,c.float32[v+1]=f,c.float32[v+2]=g},s.validateCustomStyleLayer=function(c){const a=[],u=c.id;return u===void 0&&a.push({message:`layers.${u}: missing required property "id"`}),c.render===void 0&&a.push({message:`layers.${u}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&a.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),a},s.validateFilter=c=>Na(td(c)),s.validateFog=c=>Na(sm(c)),s.validateLayer=c=>Na(nd(c)),s.validateLight=c=>Na(id(c)),s.validateSource=c=>Na(Ju(c)),s.validateStyle=om,s.validateTerrain=c=>Na(iu(c)),s.values=Te,s.vectorTile=sw,s.version=p,s.warnOnce=At,s.window=d,s.wrap=We}),o(["./shared"],function(s){function d(Ee){if(typeof Ee=="number"||typeof Ee=="boolean"||typeof Ee=="string"||Ee==null)return JSON.stringify(Ee);if(Array.isArray(Ee)){let de="[";for(const Ie of Ee)de+=`${d(Ie)},`;return`${de}]`}let se="{";for(const de of Object.keys(Ee).sort())se+=`${de}:${d(Ee[de])},`;return`${se}}`}function p(Ee){let se="";for(const de of s.refProperties)se+=`/${d(Ee[de])}`;return se}class _{constructor(se){this.keyCache={},se&&this.replace(se)}replace(se){this._layerConfigs={},this._layers={},this.update(se,[])}update(se,de){for(const ee of se)this._layerConfigs[ee.id]=ee,(this._layers[ee.id]=s.createStyleLayer(ee)).compileFilter(),this.keyCache[ee.id]&&delete this.keyCache[ee.id];for(const ee of de)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const Ie=function(ee,pe){const Ae={};for(let ve=0;ve<ee.length;ve++){const Ke=pe&&pe[ee[ve].id]||p(ee[ve]);pe&&(pe[ee[ve].id]=Ke);let ht=Ae[Ke];ht||(ht=Ae[Ke]=[]),ht.push(ee[ve])}const ye=[];for(const ve in Ae)ye.push(Ae[ve]);return ye}(s.values(this._layerConfigs),this.keyCache);for(const ee of Ie){const pe=ee.map(zt=>this._layers[zt.id]),Ae=pe[0];if(Ae.visibility==="none")continue;const ye=Ae.source||"";let ve=this.familiesBySource[ye];ve||(ve=this.familiesBySource[ye]={});const Ke=Ae.sourceLayer||"_geojsonTileLayer";let ht=ve[Ke];ht||(ht=ve[Ke]=[]),ht.push(pe)}}}class w{loadTile(se,de){const{uid:Ie,encoding:ee,rawImageData:pe,padding:Ae,buildQuadTree:ye}=se,ve=s.window.ImageBitmap&&pe instanceof s.window.ImageBitmap?this.getImageData(pe,Ae):pe;de(null,new s.DEMData(Ie,ve,ee,Ae<1,ye))}getImageData(se,de){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(se.width,se.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=se.width,this.offscreenCanvas.height=se.height,this.offscreenCanvasContext.drawImage(se,0,0,se.width,se.height);const Ie=this.offscreenCanvasContext.getImageData(-de,-de,se.width+2*de,se.height+2*de);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Ie}}var M=function Ee(se,de){var Ie,ee=se&&se.type;if(ee==="FeatureCollection")for(Ie=0;Ie<se.features.length;Ie++)Ee(se.features[Ie],de);else if(ee==="GeometryCollection")for(Ie=0;Ie<se.geometries.length;Ie++)Ee(se.geometries[Ie],de);else if(ee==="Feature")Ee(se.geometry,de);else if(ee==="Polygon")A(se.coordinates,de);else if(ee==="MultiPolygon")for(Ie=0;Ie<se.coordinates.length;Ie++)A(se.coordinates[Ie],de);return se};function A(Ee,se){if(Ee.length!==0){P(Ee[0],se);for(var de=1;de<Ee.length;de++)P(Ee[de],!se)}}function P(Ee,se){for(var de=0,Ie=0,ee=0,pe=Ee.length,Ae=pe-1;ee<pe;Ae=ee++){var ye=(Ee[ee][0]-Ee[Ae][0])*(Ee[Ae][1]+Ee[ee][1]),ve=de+ye;Ie+=Math.abs(de)>=Math.abs(ye)?de-ve+ye:ye-ve+de,de=ve}de+Ie>=0!=!!se&&Ee.reverse()}const L=s.VectorTileFeature.prototype.toGeoJSON;class D{constructor(se){this._feature=se,this.extent=s.EXTENT,this.type=se.type,this.properties=se.tags,"id"in se&&!isNaN(se.id)&&(this.id=parseInt(se.id,10))}loadGeometry(){if(this._feature.type===1){const se=[];for(const de of this._feature.geometry)se.push([new s.pointGeometry(de[0],de[1])]);return se}{const se=[];for(const de of this._feature.geometry){const Ie=[];for(const ee of de)Ie.push(new s.pointGeometry(ee[0],ee[1]));se.push(Ie)}return se}}toGeoJSON(se,de,Ie){return L.call(this,se,de,Ie)}}class z{constructor(se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=se.length,this._features=se}feature(se){return new D(this._features[se])}}var F={exports:{}},N=s.pointGeometry,V=s.vectorTile.VectorTileFeature,j=Q;function Q(Ee,se){this.options=se||{},this.features=Ee,this.length=Ee.length}function re(Ee,se){this.id=typeof Ee.id=="number"?Ee.id:void 0,this.type=Ee.type,this.rawGeometry=Ee.type===1?[Ee.geometry]:Ee.geometry,this.properties=Ee.tags,this.extent=se||4096}Q.prototype.feature=function(Ee){return new re(this.features[Ee],this.options.extent)},re.prototype.loadGeometry=function(){var Ee=this.rawGeometry;this.geometry=[];for(var se=0;se<Ee.length;se++){for(var de=Ee[se],Ie=[],ee=0;ee<de.length;ee++)Ie.push(new N(de[ee][0],de[ee][1]));this.geometry.push(Ie)}return this.geometry},re.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ee=this.geometry,se=1/0,de=-1/0,Ie=1/0,ee=-1/0,pe=0;pe<Ee.length;pe++)for(var Ae=Ee[pe],ye=0;ye<Ae.length;ye++){var ve=Ae[ye];se=Math.min(se,ve.x),de=Math.max(de,ve.x),Ie=Math.min(Ie,ve.y),ee=Math.max(ee,ve.y)}return[se,Ie,de,ee]},re.prototype.toGeoJSON=V.prototype.toGeoJSON;var Z=s.pbf,ne=j;function he(Ee){var se=new Z;return function(de,Ie){for(var ee in de.layers)Ie.writeMessage(3,De,de.layers[ee])}(Ee,se),se.finish()}function De(Ee,se){var de;se.writeVarintField(15,Ee.version||1),se.writeStringField(1,Ee.name||""),se.writeVarintField(5,Ee.extent||4096);var Ie={keys:[],values:[],keycache:{},valuecache:{}};for(de=0;de<Ee.length;de++)Ie.feature=Ee.feature(de),se.writeMessage(2,He,Ie);var ee=Ie.keys;for(de=0;de<ee.length;de++)se.writeStringField(3,ee[de]);var pe=Ie.values;for(de=0;de<pe.length;de++)se.writeMessage(4,We,pe[de])}function He(Ee,se){var de=Ee.feature;de.id!==void 0&&se.writeVarintField(1,de.id),se.writeMessage(2,ae,Ee),se.writeVarintField(3,de.type),se.writeMessage(4,Oe,de)}function ae(Ee,se){var de=Ee.feature,Ie=Ee.keys,ee=Ee.values,pe=Ee.keycache,Ae=Ee.valuecache;for(var ye in de.properties){var ve=de.properties[ye],Ke=pe[ye];if(ve!==null){Ke===void 0&&(Ie.push(ye),pe[ye]=Ke=Ie.length-1),se.writeVarint(Ke);var ht=typeof ve;ht!=="string"&&ht!=="boolean"&&ht!=="number"&&(ve=JSON.stringify(ve));var zt=ht+":"+ve,vt=Ae[zt];vt===void 0&&(ee.push(ve),Ae[zt]=vt=ee.length-1),se.writeVarint(vt)}}}function le(Ee,se){return(se<<3)+(7&Ee)}function fe(Ee){return Ee<<1^Ee>>31}function Oe(Ee,se){for(var de=Ee.loadGeometry(),Ie=Ee.type,ee=0,pe=0,Ae=de.length,ye=0;ye<Ae;ye++){var ve=de[ye],Ke=1;Ie===1&&(Ke=ve.length),se.writeVarint(le(1,Ke));for(var ht=Ie===3?ve.length-1:ve.length,zt=0;zt<ht;zt++){zt===1&&Ie!==1&&se.writeVarint(le(2,ht-1));var vt=ve[zt].x-ee,Jt=ve[zt].y-pe;se.writeVarint(fe(vt)),se.writeVarint(fe(Jt)),ee+=vt,pe+=Jt}Ie===3&&se.writeVarint(le(7,1))}}function We(Ee,se){var de=typeof Ee;de==="string"?se.writeStringField(1,Ee):de==="boolean"?se.writeBooleanField(7,Ee):de==="number"&&(Ee%1!=0?se.writeDoubleField(3,Ee):Ee<0?se.writeSVarintField(6,Ee):se.writeVarintField(5,Ee))}function ce(Ee,se,de,Ie,ee,pe){if(ee-Ie<=de)return;const Ae=Ie+ee>>1;Te(Ee,se,Ae,Ie,ee,pe%2),ce(Ee,se,de,Ie,Ae-1,pe+1),ce(Ee,se,de,Ae+1,ee,pe+1)}function Te(Ee,se,de,Ie,ee,pe){for(;ee>Ie;){if(ee-Ie>600){const Ke=ee-Ie+1,ht=de-Ie+1,zt=Math.log(Ke),vt=.5*Math.exp(2*zt/3),Jt=.5*Math.sqrt(zt*vt*(Ke-vt)/Ke)*(ht-Ke/2<0?-1:1);Te(Ee,se,de,Math.max(Ie,Math.floor(de-ht*vt/Ke+Jt)),Math.min(ee,Math.floor(de+(Ke-ht)*vt/Ke+Jt)),pe)}const Ae=se[2*de+pe];let ye=Ie,ve=ee;for(Pe(Ee,se,Ie,de),se[2*ee+pe]>Ae&&Pe(Ee,se,Ie,ee);ye<ve;){for(Pe(Ee,se,ye,ve),ye++,ve--;se[2*ye+pe]<Ae;)ye++;for(;se[2*ve+pe]>Ae;)ve--}se[2*Ie+pe]===Ae?Pe(Ee,se,Ie,ve):(ve++,Pe(Ee,se,ve,ee)),ve<=de&&(Ie=ve+1),de<=ve&&(ee=ve-1)}}function Pe(Ee,se,de,Ie){Qe(Ee,de,Ie),Qe(se,2*de,2*Ie),Qe(se,2*de+1,2*Ie+1)}function Qe(Ee,se,de){const Ie=Ee[se];Ee[se]=Ee[de],Ee[de]=Ie}function Ne(Ee,se,de,Ie){const ee=Ee-de,pe=se-Ie;return ee*ee+pe*pe}F.exports=he,F.exports.fromVectorTileJs=he,F.exports.fromGeojsonVt=function(Ee,se){se=se||{};var de={};for(var Ie in Ee)de[Ie]=new ne(Ee[Ie].features,se),de[Ie].name=Ie,de[Ie].version=se.version,de[Ie].extent=se.extent;return he({layers:de})},F.exports.GeoJSONWrapper=ne;const nt=Ee=>Ee[0],ze=Ee=>Ee[1];class et{constructor(se,de=nt,Ie=ze,ee=64,pe=Float64Array){this.nodeSize=ee,this.points=se;const Ae=se.length<65536?Uint16Array:Uint32Array,ye=this.ids=new Ae(se.length),ve=this.coords=new pe(2*se.length);for(let Ke=0;Ke<se.length;Ke++)ye[Ke]=Ke,ve[2*Ke]=de(se[Ke]),ve[2*Ke+1]=Ie(se[Ke]);ce(ye,ve,ee,0,ye.length-1,0)}range(se,de,Ie,ee){return function(pe,Ae,ye,ve,Ke,ht,zt){const vt=[0,pe.length-1,0],Jt=[];let Yt,Xt;for(;vt.length;){const gn=vt.pop(),Xn=vt.pop(),ii=vt.pop();if(Xn-ii<=zt){for(let kn=ii;kn<=Xn;kn++)Yt=Ae[2*kn],Xt=Ae[2*kn+1],Yt>=ye&&Yt<=Ke&&Xt>=ve&&Xt<=ht&&Jt.push(pe[kn]);continue}const Sn=Math.floor((ii+Xn)/2);Yt=Ae[2*Sn],Xt=Ae[2*Sn+1],Yt>=ye&&Yt<=Ke&&Xt>=ve&&Xt<=ht&&Jt.push(pe[Sn]);const Jn=(gn+1)%2;(gn===0?ye<=Yt:ve<=Xt)&&(vt.push(ii),vt.push(Sn-1),vt.push(Jn)),(gn===0?Ke>=Yt:ht>=Xt)&&(vt.push(Sn+1),vt.push(Xn),vt.push(Jn))}return Jt}(this.ids,this.coords,se,de,Ie,ee,this.nodeSize)}within(se,de,Ie){return function(ee,pe,Ae,ye,ve,Ke){const ht=[0,ee.length-1,0],zt=[],vt=ve*ve;for(;ht.length;){const Jt=ht.pop(),Yt=ht.pop(),Xt=ht.pop();if(Yt-Xt<=Ke){for(let Jn=Xt;Jn<=Yt;Jn++)Ne(pe[2*Jn],pe[2*Jn+1],Ae,ye)<=vt&&zt.push(ee[Jn]);continue}const gn=Math.floor((Xt+Yt)/2),Xn=pe[2*gn],ii=pe[2*gn+1];Ne(Xn,ii,Ae,ye)<=vt&&zt.push(ee[gn]);const Sn=(Jt+1)%2;(Jt===0?Ae-ve<=Xn:ye-ve<=ii)&&(ht.push(Xt),ht.push(gn-1),ht.push(Sn)),(Jt===0?Ae+ve>=Xn:ye+ve>=ii)&&(ht.push(gn+1),ht.push(Yt),ht.push(Sn))}return zt}(this.ids,this.coords,se,de,Ie,this.nodeSize)}}const Et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ee=>Ee},Nt=Math.fround||(qt=new Float32Array(1),Ee=>(qt[0]=+Ee,qt[0]));var qt;class wn{constructor(se){this.options=Vn(Object.create(Et),se),this.trees=new Array(this.options.maxZoom+1)}load(se){const{log:de,minZoom:Ie,maxZoom:ee,nodeSize:pe}=this.options;de&&console.time("total time");const Ae=`prepare ${se.length} points`;de&&console.time(Ae),this.points=se;let ye=[];for(let ve=0;ve<se.length;ve++)se[ve].geometry&&ye.push(Rn(se[ve],ve));this.trees[ee+1]=new et(ye,On,Zn,pe,Float32Array),de&&console.timeEnd(Ae);for(let ve=ee;ve>=Ie;ve--){const Ke=+Date.now();ye=this._cluster(ye,ve),this.trees[ve]=new et(ye,On,Zn,pe,Float32Array),de&&console.log("z%d: %d clusters in %dms",ve,ye.length,+Date.now()-Ke)}return de&&console.timeEnd("total time"),this}getClusters(se,de){let Ie=((se[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,se[1]));let pe=se[2]===180?180:((se[2]+180)%360+360)%360-180;const Ae=Math.max(-90,Math.min(90,se[3]));if(se[2]-se[0]>=360)Ie=-180,pe=180;else if(Ie>pe){const ht=this.getClusters([Ie,ee,180,Ae],de),zt=this.getClusters([-180,ee,pe,Ae],de);return ht.concat(zt)}const ye=this.trees[this._limitZoom(de)],ve=ye.range(Ft(Ie),Cn(Ae),Ft(pe),Cn(ee)),Ke=[];for(const ht of ve){const zt=ye.points[ht];Ke.push(zt.numPoints?At(zt):this.points[zt.index])}return Ke}getChildren(se){const de=this._getOriginId(se),Ie=this._getOriginZoom(se),ee="No cluster with the specified id.",pe=this.trees[Ie];if(!pe)throw new Error(ee);const Ae=pe.points[de];if(!Ae)throw new Error(ee);const ye=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),ve=pe.within(Ae.x,Ae.y,ye),Ke=[];for(const ht of ve){const zt=pe.points[ht];zt.parentId===se&&Ke.push(zt.numPoints?At(zt):this.points[zt.index])}if(Ke.length===0)throw new Error(ee);return Ke}getLeaves(se,de,Ie){const ee=[];return this._appendLeaves(ee,se,de=de||10,Ie=Ie||0,0),ee}getTile(se,de,Ie){const ee=this.trees[this._limitZoom(se)],pe=Math.pow(2,se),{extent:Ae,radius:ye}=this.options,ve=ye/Ae,Ke=(Ie-ve)/pe,ht=(Ie+1+ve)/pe,zt={features:[]};return this._addTileFeatures(ee.range((de-ve)/pe,Ke,(de+1+ve)/pe,ht),ee.points,de,Ie,pe,zt),de===0&&this._addTileFeatures(ee.range(1-ve/pe,Ke,1,ht),ee.points,pe,Ie,pe,zt),de===pe-1&&this._addTileFeatures(ee.range(0,Ke,ve/pe,ht),ee.points,-1,Ie,pe,zt),zt.features.length?zt:null}getClusterExpansionZoom(se){let de=this._getOriginZoom(se)-1;for(;de<=this.options.maxZoom;){const Ie=this.getChildren(se);if(de++,Ie.length!==1)break;se=Ie[0].properties.cluster_id}return de}_appendLeaves(se,de,Ie,ee,pe){const Ae=this.getChildren(de);for(const ye of Ae){const ve=ye.properties;if(ve&&ve.cluster?pe+ve.point_count<=ee?pe+=ve.point_count:pe=this._appendLeaves(se,ve.cluster_id,Ie,ee,pe):pe<ee?pe++:se.push(ye),se.length===Ie)break}return pe}_addTileFeatures(se,de,Ie,ee,pe,Ae){for(const ye of se){const ve=de[ye],Ke=ve.numPoints;let ht,zt,vt;if(Ke)ht=Ot(ve),zt=ve.x,vt=ve.y;else{const Xt=this.points[ve.index];ht=Xt.properties,zt=Ft(Xt.geometry.coordinates[0]),vt=Cn(Xt.geometry.coordinates[1])}const Jt={type:1,geometry:[[Math.round(this.options.extent*(zt*pe-Ie)),Math.round(this.options.extent*(vt*pe-ee))]],tags:ht};let Yt;Ke?Yt=ve.id:this.options.generateId?Yt=ve.index:this.points[ve.index].id&&(Yt=this.points[ve.index].id),Yt!==void 0&&(Jt.id=Yt),Ae.features.push(Jt)}}_limitZoom(se){return Math.max(this.options.minZoom,Math.min(Math.floor(+se),this.options.maxZoom+1))}_cluster(se,de){const Ie=[],{radius:ee,extent:pe,reduce:Ae,minPoints:ye}=this.options,ve=ee/(pe*Math.pow(2,de));for(let Ke=0;Ke<se.length;Ke++){const ht=se[Ke];if(ht.zoom<=de)continue;ht.zoom=de;const zt=this.trees[de+1],vt=zt.within(ht.x,ht.y,ve),Jt=ht.numPoints||1;let Yt=Jt;for(const Xt of vt){const gn=zt.points[Xt];gn.zoom>de&&(Yt+=gn.numPoints||1)}if(Yt>Jt&&Yt>=ye){let Xt=ht.x*Jt,gn=ht.y*Jt,Xn=Ae&&Jt>1?this._map(ht,!0):null;const ii=(Ke<<5)+(de+1)+this.points.length;for(const Sn of vt){const Jn=zt.points[Sn];if(Jn.zoom<=de)continue;Jn.zoom=de;const kn=Jn.numPoints||1;Xt+=Jn.x*kn,gn+=Jn.y*kn,Jn.parentId=ii,Ae&&(Xn||(Xn=this._map(ht,!0)),Ae(Xn,this._map(Jn)))}ht.parentId=ii,Ie.push(_n(Xt/Yt,gn/Yt,ii,Yt,Xn))}else if(Ie.push(ht),Yt>1)for(const Xt of vt){const gn=zt.points[Xt];gn.zoom<=de||(gn.zoom=de,Ie.push(gn))}}return Ie}_getOriginId(se){return se-this.points.length>>5}_getOriginZoom(se){return(se-this.points.length)%32}_map(se,de){if(se.numPoints)return de?Vn({},se.properties):se.properties;const Ie=this.points[se.index].properties,ee=this.options.map(Ie);return de&&ee===Ie?Vn({},ee):ee}}function _n(Ee,se,de,Ie,ee){return{x:Nt(Ee),y:Nt(se),zoom:1/0,id:de,parentId:-1,numPoints:Ie,properties:ee}}function Rn(Ee,se){const[de,Ie]=Ee.geometry.coordinates;return{x:Nt(Ft(de)),y:Nt(Cn(Ie)),zoom:1/0,index:se,parentId:-1}}function At(Ee){return{type:"Feature",id:Ee.id,properties:Ot(Ee),geometry:{type:"Point",coordinates:[(se=Ee.x,360*(se-.5)),pn(Ee.y)]}};var se}function Ot(Ee){const se=Ee.numPoints,de=se>=1e4?`${Math.round(se/1e3)}k`:se>=1e3?Math.round(se/100)/10+"k":se;return Vn(Vn({},Ee.properties),{cluster:!0,cluster_id:Ee.id,point_count:se,point_count_abbreviated:de})}function Ft(Ee){return Ee/360+.5}function Cn(Ee){const se=Math.sin(Ee*Math.PI/180),de=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return de<0?0:de>1?1:de}function pn(Ee){const se=(180-360*Ee)*Math.PI/180;return 360*Math.atan(Math.exp(se))/Math.PI-90}function Vn(Ee,se){for(const de in se)Ee[de]=se[de];return Ee}function On(Ee){return Ee.x}function Zn(Ee){return Ee.y}function ai(Ee,se,de,Ie){for(var ee,pe=Ie,Ae=de-se>>1,ye=de-se,ve=Ee[se],Ke=Ee[se+1],ht=Ee[de],zt=Ee[de+1],vt=se+3;vt<de;vt+=3){var Jt=Ei(Ee[vt],Ee[vt+1],ve,Ke,ht,zt);if(Jt>pe)ee=vt,pe=Jt;else if(Jt===pe){var Yt=Math.abs(vt-Ae);Yt<ye&&(ee=vt,ye=Yt)}}pe>Ie&&(ee-se>3&&ai(Ee,se,ee,Ie),Ee[ee+2]=pe,de-ee>3&&ai(Ee,ee,de,Ie))}function Ei(Ee,se,de,Ie,ee,pe){var Ae=ee-de,ye=pe-Ie;if(Ae!==0||ye!==0){var ve=((Ee-de)*Ae+(se-Ie)*ye)/(Ae*Ae+ye*ye);ve>1?(de=ee,Ie=pe):ve>0&&(de+=Ae*ve,Ie+=ye*ve)}return(Ae=Ee-de)*Ae+(ye=se-Ie)*ye}function Be(Ee,se,de,Ie){var ee={id:Ee===void 0?null:Ee,type:se,geometry:de,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(pe){var Ae=pe.geometry,ye=pe.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")Se(pe,Ae);else if(ye==="Polygon"||ye==="MultiLineString")for(var ve=0;ve<Ae.length;ve++)Se(pe,Ae[ve]);else if(ye==="MultiPolygon")for(ve=0;ve<Ae.length;ve++)for(var Ke=0;Ke<Ae[ve].length;Ke++)Se(pe,Ae[ve][Ke])}(ee),ee}function Se(Ee,se){for(var de=0;de<se.length;de+=3)Ee.minX=Math.min(Ee.minX,se[de]),Ee.minY=Math.min(Ee.minY,se[de+1]),Ee.maxX=Math.max(Ee.maxX,se[de]),Ee.maxY=Math.max(Ee.maxY,se[de+1])}function St(Ee,se,de,Ie){if(se.geometry){var ee=se.geometry.coordinates,pe=se.geometry.type,Ae=Math.pow(de.tolerance/((1<<de.maxZoom)*de.extent),2),ye=[],ve=se.id;if(de.promoteId?ve=se.properties[de.promoteId]:de.generateId&&(ve=Ie||0),pe==="Point")tn(ee,ye);else if(pe==="MultiPoint")for(var Ke=0;Ke<ee.length;Ke++)tn(ee[Ke],ye);else if(pe==="LineString")nn(ee,ye,Ae,!1);else if(pe==="MultiLineString"){if(de.lineMetrics){for(Ke=0;Ke<ee.length;Ke++)nn(ee[Ke],ye=[],Ae,!1),Ee.push(Be(ve,"LineString",ye,se.properties));return}fn(ee,ye,Ae,!1)}else if(pe==="Polygon")fn(ee,ye,Ae,!0);else{if(pe!=="MultiPolygon"){if(pe==="GeometryCollection"){for(Ke=0;Ke<se.geometry.geometries.length;Ke++)St(Ee,{id:ve,geometry:se.geometry.geometries[Ke],properties:se.properties},de,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ke=0;Ke<ee.length;Ke++){var ht=[];fn(ee[Ke],ht,Ae,!0),ye.push(ht)}}Ee.push(Be(ve,pe,ye,se.properties))}}function tn(Ee,se){se.push(Nn(Ee[0])),se.push(yn(Ee[1])),se.push(0)}function nn(Ee,se,de,Ie){for(var ee,pe,Ae=0,ye=0;ye<Ee.length;ye++){var ve=Nn(Ee[ye][0]),Ke=yn(Ee[ye][1]);se.push(ve),se.push(Ke),se.push(0),ye>0&&(Ae+=Ie?(ee*Ke-ve*pe)/2:Math.sqrt(Math.pow(ve-ee,2)+Math.pow(Ke-pe,2))),ee=ve,pe=Ke}var ht=se.length-3;se[2]=1,ai(se,0,ht,de),se[ht+2]=1,se.size=Math.abs(Ae),se.start=0,se.end=se.size}function fn(Ee,se,de,Ie){for(var ee=0;ee<Ee.length;ee++){var pe=[];nn(Ee[ee],pe,de,Ie),se.push(pe)}}function Nn(Ee){return Ee/360+.5}function yn(Ee){var se=Math.sin(Ee*Math.PI/180),de=.5-.25*Math.log((1+se)/(1-se))/Math.PI;return de<0?0:de>1?1:de}function Dt(Ee,se,de,Ie,ee,pe,Ae,ye){if(Ie/=se,pe>=(de/=se)&&Ae<Ie)return Ee;if(Ae<de||pe>=Ie)return null;for(var ve=[],Ke=0;Ke<Ee.length;Ke++){var ht=Ee[Ke],zt=ht.geometry,vt=ht.type,Jt=ee===0?ht.minX:ht.minY,Yt=ee===0?ht.maxX:ht.maxY;if(Jt>=de&&Yt<Ie)ve.push(ht);else if(!(Yt<de||Jt>=Ie)){var Xt=[];if(vt==="Point"||vt==="MultiPoint")Un(zt,Xt,de,Ie,ee);else if(vt==="LineString")Je(zt,Xt,de,Ie,ee,!1,ye.lineMetrics);else if(vt==="MultiLineString")Zt(zt,Xt,de,Ie,ee,!1);else if(vt==="Polygon")Zt(zt,Xt,de,Ie,ee,!0);else if(vt==="MultiPolygon")for(var gn=0;gn<zt.length;gn++){var Xn=[];Zt(zt[gn],Xn,de,Ie,ee,!0),Xn.length&&Xt.push(Xn)}if(Xt.length){if(ye.lineMetrics&&vt==="LineString"){for(gn=0;gn<Xt.length;gn++)ve.push(Be(ht.id,vt,Xt[gn],ht.tags));continue}vt!=="LineString"&&vt!=="MultiLineString"||(Xt.length===1?(vt="LineString",Xt=Xt[0]):vt="MultiLineString"),vt!=="Point"&&vt!=="MultiPoint"||(vt=Xt.length===3?"Point":"MultiPoint"),ve.push(Be(ht.id,vt,Xt,ht.tags))}}}return ve.length?ve:null}function Un(Ee,se,de,Ie,ee){for(var pe=0;pe<Ee.length;pe+=3){var Ae=Ee[pe+ee];Ae>=de&&Ae<=Ie&&(se.push(Ee[pe]),se.push(Ee[pe+1]),se.push(Ee[pe+2]))}}function Je(Ee,se,de,Ie,ee,pe,Ae){for(var ye,ve,Ke=It(Ee),ht=ee===0?Yn:li,zt=Ee.start,vt=0;vt<Ee.length-3;vt+=3){var Jt=Ee[vt],Yt=Ee[vt+1],Xt=Ee[vt+2],gn=Ee[vt+3],Xn=Ee[vt+4],ii=ee===0?Jt:Yt,Sn=ee===0?gn:Xn,Jn=!1;Ae&&(ye=Math.sqrt(Math.pow(Jt-gn,2)+Math.pow(Yt-Xn,2))),ii<de?Sn>de&&(ve=ht(Ke,Jt,Yt,gn,Xn,de),Ae&&(Ke.start=zt+ye*ve)):ii>Ie?Sn<Ie&&(ve=ht(Ke,Jt,Yt,gn,Xn,Ie),Ae&&(Ke.start=zt+ye*ve)):sn(Ke,Jt,Yt,Xt),Sn<de&&ii>=de&&(ve=ht(Ke,Jt,Yt,gn,Xn,de),Jn=!0),Sn>Ie&&ii<=Ie&&(ve=ht(Ke,Jt,Yt,gn,Xn,Ie),Jn=!0),!pe&&Jn&&(Ae&&(Ke.end=zt+ye*ve),se.push(Ke),Ke=It(Ee)),Ae&&(zt+=ye)}var kn=Ee.length-3;Jt=Ee[kn],Yt=Ee[kn+1],Xt=Ee[kn+2],(ii=ee===0?Jt:Yt)>=de&&ii<=Ie&&sn(Ke,Jt,Yt,Xt),kn=Ke.length-3,pe&&kn>=3&&(Ke[kn]!==Ke[0]||Ke[kn+1]!==Ke[1])&&sn(Ke,Ke[0],Ke[1],Ke[2]),Ke.length&&se.push(Ke)}function It(Ee){var se=[];return se.size=Ee.size,se.start=Ee.start,se.end=Ee.end,se}function Zt(Ee,se,de,Ie,ee,pe){for(var Ae=0;Ae<Ee.length;Ae++)Je(Ee[Ae],se,de,Ie,ee,pe,!1)}function sn(Ee,se,de,Ie){Ee.push(se),Ee.push(de),Ee.push(Ie)}function Yn(Ee,se,de,Ie,ee,pe){var Ae=(pe-se)/(Ie-se);return Ee.push(pe),Ee.push(de+(ee-de)*Ae),Ee.push(1),Ae}function li(Ee,se,de,Ie,ee,pe){var Ae=(pe-de)/(ee-de);return Ee.push(se+(Ie-se)*Ae),Ee.push(pe),Ee.push(1),Ae}function Bi(Ee,se){for(var de=[],Ie=0;Ie<Ee.length;Ie++){var ee,pe=Ee[Ie],Ae=pe.type;if(Ae==="Point"||Ae==="MultiPoint"||Ae==="LineString")ee=rt(pe.geometry,se);else if(Ae==="MultiLineString"||Ae==="Polygon"){ee=[];for(var ye=0;ye<pe.geometry.length;ye++)ee.push(rt(pe.geometry[ye],se))}else if(Ae==="MultiPolygon")for(ee=[],ye=0;ye<pe.geometry.length;ye++){for(var ve=[],Ke=0;Ke<pe.geometry[ye].length;Ke++)ve.push(rt(pe.geometry[ye][Ke],se));ee.push(ve)}de.push(Be(pe.id,Ae,ee,pe.tags))}return de}function rt(Ee,se){var de=[];de.size=Ee.size,Ee.start!==void 0&&(de.start=Ee.start,de.end=Ee.end);for(var Ie=0;Ie<Ee.length;Ie+=3)de.push(Ee[Ie]+se,Ee[Ie+1],Ee[Ie+2]);return de}function Ct(Ee,se){if(Ee.transformed)return Ee;var de,Ie,ee,pe=1<<Ee.z,Ae=Ee.x,ye=Ee.y;for(de=0;de<Ee.features.length;de++){var ve=Ee.features[de],Ke=ve.geometry,ht=ve.type;if(ve.geometry=[],ht===1)for(Ie=0;Ie<Ke.length;Ie+=2)ve.geometry.push(Vt(Ke[Ie],Ke[Ie+1],se,pe,Ae,ye));else for(Ie=0;Ie<Ke.length;Ie++){var zt=[];for(ee=0;ee<Ke[Ie].length;ee+=2)zt.push(Vt(Ke[Ie][ee],Ke[Ie][ee+1],se,pe,Ae,ye));ve.geometry.push(zt)}}return Ee.transformed=!0,Ee}function Vt(Ee,se,de,Ie,ee,pe){return[Math.round(de*(Ee*Ie-ee)),Math.round(de*(se*Ie-pe))]}function bn(Ee,se,de,Ie,ee){for(var pe=se===ee.maxZoom?0:ee.tolerance/((1<<se)*ee.extent),Ae={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:de,y:Ie,z:se,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<Ee.length;ye++){Ae.numFeatures++,Ln(Ae,Ee[ye],pe,ee);var ve=Ee[ye].minX,Ke=Ee[ye].minY,ht=Ee[ye].maxX,zt=Ee[ye].maxY;ve<Ae.minX&&(Ae.minX=ve),Ke<Ae.minY&&(Ae.minY=Ke),ht>Ae.maxX&&(Ae.maxX=ht),zt>Ae.maxY&&(Ae.maxY=zt)}return Ae}function Ln(Ee,se,de,Ie){var ee=se.geometry,pe=se.type,Ae=[];if(pe==="Point"||pe==="MultiPoint")for(var ye=0;ye<ee.length;ye+=3)Ae.push(ee[ye]),Ae.push(ee[ye+1]),Ee.numPoints++,Ee.numSimplified++;else if(pe==="LineString")Ri(Ae,ee,Ee,de,!1,!1);else if(pe==="MultiLineString"||pe==="Polygon")for(ye=0;ye<ee.length;ye++)Ri(Ae,ee[ye],Ee,de,pe==="Polygon",ye===0);else if(pe==="MultiPolygon")for(var ve=0;ve<ee.length;ve++){var Ke=ee[ve];for(ye=0;ye<Ke.length;ye++)Ri(Ae,Ke[ye],Ee,de,!0,ye===0)}if(Ae.length){var ht=se.tags||null;if(pe==="LineString"&&Ie.lineMetrics){for(var zt in ht={},se.tags)ht[zt]=se.tags[zt];ht.mapbox_clip_start=ee.start/ee.size,ht.mapbox_clip_end=ee.end/ee.size}var vt={geometry:Ae,type:pe==="Polygon"||pe==="MultiPolygon"?3:pe==="LineString"||pe==="MultiLineString"?2:1,tags:ht};se.id!==null&&(vt.id=se.id),Ee.features.push(vt)}}function Ri(Ee,se,de,Ie,ee,pe){var Ae=Ie*Ie;if(Ie>0&&se.size<(ee?Ae:Ie))de.numPoints+=se.length/3;else{for(var ye=[],ve=0;ve<se.length;ve+=3)(Ie===0||se[ve+2]>Ae)&&(de.numSimplified++,ye.push(se[ve]),ye.push(se[ve+1])),de.numPoints++;ee&&function(Ke,ht){for(var zt=0,vt=0,Jt=Ke.length,Yt=Jt-2;vt<Jt;Yt=vt,vt+=2)zt+=(Ke[vt]-Ke[Yt])*(Ke[vt+1]+Ke[Yt+1]);if(zt>0===ht)for(vt=0,Jt=Ke.length;vt<Jt/2;vt+=2){var Xt=Ke[vt],gn=Ke[vt+1];Ke[vt]=Ke[Jt-2-vt],Ke[vt+1]=Ke[Jt-1-vt],Ke[Jt-2-vt]=Xt,Ke[Jt-1-vt]=gn}}(ye,pe),Ee.push(ye)}}function hr(Ee,se){var de=(se=this.options=function(ee,pe){for(var Ae in pe)ee[Ae]=pe[Ae];return ee}(Object.create(this.options),se)).debug;if(de&&console.time("preprocess data"),se.maxZoom<0||se.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(se.promoteId&&se.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ie=function(ee,pe){var Ae=[];if(ee.type==="FeatureCollection")for(var ye=0;ye<ee.features.length;ye++)St(Ae,ee.features[ye],pe,ye);else St(Ae,ee.type==="Feature"?ee:{geometry:ee},pe);return Ae}(Ee,se);this.tiles={},this.tileCoords=[],de&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",se.indexMaxZoom,se.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ie=function(ee,pe){var Ae=pe.buffer/pe.extent,ye=ee,ve=Dt(ee,1,-1-Ae,Ae,0,-1,2,pe),Ke=Dt(ee,1,1-Ae,2+Ae,0,-1,2,pe);return(ve||Ke)&&(ye=Dt(ee,1,-Ae,1+Ae,0,-1,2,pe)||[],ve&&(ye=Bi(ve,1).concat(ye)),Ke&&(ye=ye.concat(Bi(Ke,-1)))),ye}(Ie,se),Ie.length&&this.splitTile(Ie,0,0,0),de&&(Ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Fr(Ee,se,de){return 32*((1<<Ee)*de+se)+Ee}function Pr(Ee,se){const de=Ee.tileID.canonical;if(!this._geoJSONIndex)return se(null,null);const Ie=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!Ie)return se(null,null);const ee=new z(Ie.features);let pe=F.exports(ee);pe.byteOffset===0&&pe.byteLength===pe.buffer.byteLength||(pe=new Uint8Array(pe)),se(null,{vectorTile:ee,rawData:pe.buffer})}hr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},hr.prototype.splitTile=function(Ee,se,de,Ie,ee,pe,Ae){for(var ye=[Ee,se,de,Ie],ve=this.options,Ke=ve.debug;ye.length;){Ie=ye.pop(),de=ye.pop(),se=ye.pop(),Ee=ye.pop();var ht=1<<se,zt=Fr(se,de,Ie),vt=this.tiles[zt];if(!vt&&(Ke>1&&console.time("creation"),vt=this.tiles[zt]=bn(Ee,se,de,Ie,ve),this.tileCoords.push({z:se,x:de,y:Ie}),Ke)){Ke>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",se,de,Ie,vt.numFeatures,vt.numPoints,vt.numSimplified),console.timeEnd("creation"));var Jt="z"+se;this.stats[Jt]=(this.stats[Jt]||0)+1,this.total++}if(vt.source=Ee,ee){if(se===ve.maxZoom||se===ee)continue;var Yt=1<<ee-se;if(de!==Math.floor(pe/Yt)||Ie!==Math.floor(Ae/Yt))continue}else if(se===ve.indexMaxZoom||vt.numPoints<=ve.indexMaxPoints)continue;if(vt.source=null,Ee.length!==0){Ke>1&&console.time("clipping");var Xt,gn,Xn,ii,Sn,Jn,kn=.5*ve.buffer/ve.extent,ps=.5-kn,nr=.5+kn,Br=1+kn;Xt=gn=Xn=ii=null,Sn=Dt(Ee,ht,de-kn,de+nr,0,vt.minX,vt.maxX,ve),Jn=Dt(Ee,ht,de+ps,de+Br,0,vt.minX,vt.maxX,ve),Ee=null,Sn&&(Xt=Dt(Sn,ht,Ie-kn,Ie+nr,1,vt.minY,vt.maxY,ve),gn=Dt(Sn,ht,Ie+ps,Ie+Br,1,vt.minY,vt.maxY,ve),Sn=null),Jn&&(Xn=Dt(Jn,ht,Ie-kn,Ie+nr,1,vt.minY,vt.maxY,ve),ii=Dt(Jn,ht,Ie+ps,Ie+Br,1,vt.minY,vt.maxY,ve),Jn=null),Ke>1&&console.timeEnd("clipping"),ye.push(Xt||[],se+1,2*de,2*Ie),ye.push(gn||[],se+1,2*de,2*Ie+1),ye.push(Xn||[],se+1,2*de+1,2*Ie),ye.push(ii||[],se+1,2*de+1,2*Ie+1)}}},hr.prototype.getTile=function(Ee,se,de){var Ie=this.options,ee=Ie.extent,pe=Ie.debug;if(Ee<0||Ee>24)return null;var Ae=1<<Ee,ye=Fr(Ee,se=(se%Ae+Ae)%Ae,de);if(this.tiles[ye])return Ct(this.tiles[ye],ee);pe>1&&console.log("drilling down to z%d-%d-%d",Ee,se,de);for(var ve,Ke=Ee,ht=se,zt=de;!ve&&Ke>0;)Ke--,ht=Math.floor(ht/2),zt=Math.floor(zt/2),ve=this.tiles[Fr(Ke,ht,zt)];return ve&&ve.source?(pe>1&&console.log("found parent tile z%d-%d-%d",Ke,ht,zt),pe>1&&console.time("drilling down"),this.splitTile(ve.source,Ke,ht,zt,Ee,se,de),pe>1&&console.timeEnd("drilling down"),this.tiles[ye]?Ct(this.tiles[ye],ee):null):null};class Gi extends s.VectorTileWorkerSource{constructor(se,de,Ie,ee,pe){super(se,de,Ie,ee,Pr),pe&&(this.loadGeoJSON=pe)}loadData(se,de){const Ie=se&&se.request,ee=Ie&&Ie.collectResourceTiming;this.loadGeoJSON(se,(pe,Ae)=>{if(pe||!Ae)return de(pe);if(typeof Ae!="object")return de(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));{M(Ae,!0);try{if(se.filter){const ve=s.createExpression(se.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ve.result==="error")throw new Error(ve.value.map(ht=>`${ht.key}: ${ht.message}`).join(", "));Ae={type:"FeatureCollection",features:Ae.features.filter(ht=>ve.value.evaluate({zoom:0},ht))}}this._geoJSONIndex=se.cluster?new wn(function({superclusterOptions:ve,clusterProperties:Ke}){if(!Ke||!ve)return ve;const ht={},zt={},vt={accumulated:null,zoom:0},Jt={properties:null},Yt=Object.keys(Ke);for(const Xt of Yt){const[gn,Xn]=Ke[Xt],ii=s.createExpression(Xn),Sn=s.createExpression(typeof gn=="string"?[gn,["accumulated"],["get",Xt]]:gn);ht[Xt]=ii.value,zt[Xt]=Sn.value}return ve.map=Xt=>{Jt.properties=Xt;const gn={};for(const Xn of Yt)gn[Xn]=ht[Xn].evaluate(vt,Jt);return gn},ve.reduce=(Xt,gn)=>{Jt.properties=gn;for(const Xn of Yt)vt.accumulated=Xt[Xn],Xt[Xn]=zt[Xn].evaluate(vt,Jt)},ve}(se)).load(Ae.features):function(ve,Ke){return new hr(ve,Ke)}(Ae,se.geojsonVtOptions)}catch(ve){return de(ve)}this.loaded={};const ye={};if(ee){const ve=s.getPerformanceMeasurement(Ie);ve&&(ye.resourceTiming={},ye.resourceTiming[se.source]=JSON.parse(JSON.stringify(ve)))}de(null,ye)}})}reloadTile(se,de){const Ie=this.loaded;return Ie&&Ie[se.uid]?super.reloadTile(se,de):this.loadTile(se,de)}loadGeoJSON(se,de){if(se.request)s.getJSON(se.request,de);else{if(typeof se.data!="string")return de(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`));try{return de(null,JSON.parse(se.data))}catch{return de(new Error(`Input data given to '${se.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(se,de){try{de(null,this._geoJSONIndex.getClusterExpansionZoom(se.clusterId))}catch(Ie){de(Ie)}}getClusterChildren(se,de){try{de(null,this._geoJSONIndex.getChildren(se.clusterId))}catch(Ie){de(Ie)}}getClusterLeaves(se,de){try{de(null,this._geoJSONIndex.getLeaves(se.clusterId,se.limit,se.offset))}catch(Ie){de(Ie)}}}class es{constructor(se){this.self=se,this.actor=new s.Actor(se,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Gi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(de,Ie)=>{if(this.workerSourceTypes[de])throw new Error(`Worker source with name "${de}" already registered.`);this.workerSourceTypes[de]=Ie},this.self.registerRTLTextPlugin=de=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=de.applyArabicShaping,s.plugin.processBidirectionalText=de.processBidirectionalText,s.plugin.processStyledBidirectionalText=de.processStyledBidirectionalText}}clearCaches(se,de,Ie){delete this.layerIndexes[se],delete this.availableImages[se],delete this.workerSources[se],delete this.demWorkerSources[se],Ie()}checkIfReady(se,de,Ie){Ie()}setReferrer(se,de){this.referrer=de}spriteLoaded(se,de){this.isSpriteLoaded[se]=de;for(const Ie in this.workerSources[se]){const ee=this.workerSources[se][Ie];for(const pe in ee)ee[pe]instanceof s.VectorTileWorkerSource&&(ee[pe].isSpriteLoaded=de,ee[pe].fire(new s.Event("isSpriteLoaded")))}}setImages(se,de,Ie){this.availableImages[se]=de;for(const ee in this.workerSources[se]){const pe=this.workerSources[se][ee];for(const Ae in pe)pe[Ae].availableImages=de}Ie()}enableTerrain(se,de,Ie){this.terrain=de,Ie()}setProjection(se,de){this.projections[se]=s.getProjection(de)}setLayers(se,de,Ie){this.getLayerIndex(se).replace(de),Ie()}updateLayers(se,de,Ie){this.getLayerIndex(se).update(de.layers,de.removedIds),Ie()}loadTile(se,de,Ie){const ee=this.enableTerrain?s.extend({enableTerrain:this.terrain},de):de;ee.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,de.type,de.source).loadTile(ee,Ie)}loadDEMTile(se,de,Ie){const ee=this.enableTerrain?s.extend({buildQuadTree:this.terrain},de):de;this.getDEMWorkerSource(se,de.source).loadTile(ee,Ie)}reloadTile(se,de,Ie){const ee=this.enableTerrain?s.extend({enableTerrain:this.terrain},de):de;ee.projection=this.projections[se]||this.defaultProjection,this.getWorkerSource(se,de.type,de.source).reloadTile(ee,Ie)}abortTile(se,de,Ie){this.getWorkerSource(se,de.type,de.source).abortTile(de,Ie)}removeTile(se,de,Ie){this.getWorkerSource(se,de.type,de.source).removeTile(de,Ie)}removeSource(se,de,Ie){if(!this.workerSources[se]||!this.workerSources[se][de.type]||!this.workerSources[se][de.type][de.source])return;const ee=this.workerSources[se][de.type][de.source];delete this.workerSources[se][de.type][de.source],ee.removeSource!==void 0?ee.removeSource(de,Ie):Ie()}loadWorkerSource(se,de,Ie){try{this.self.importScripts(de.url),Ie()}catch(ee){Ie(ee.toString())}}syncRTLPluginState(se,de,Ie){try{s.plugin.setState(de);const ee=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&ee!=null){this.self.importScripts(ee);const pe=s.plugin.isParsed();Ie(pe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ee}`),pe)}}catch(ee){Ie(ee.toString())}}getAvailableImages(se){let de=this.availableImages[se];return de||(de=[]),de}getLayerIndex(se){let de=this.layerIndexes[se];return de||(de=this.layerIndexes[se]=new _),de}getWorkerSource(se,de,Ie){if(this.workerSources[se]||(this.workerSources[se]={}),this.workerSources[se][de]||(this.workerSources[se][de]={}),!this.workerSources[se][de][Ie]){const ee={send:(pe,Ae,ye,ve,Ke,ht)=>{this.actor.send(pe,Ae,ye,se,Ke,ht)},scheduler:this.actor.scheduler};this.workerSources[se][de][Ie]=new this.workerSourceTypes[de](ee,this.getLayerIndex(se),this.getAvailableImages(se),this.isSpriteLoaded[se])}return this.workerSources[se][de][Ie]}getDEMWorkerSource(se,de){return this.demWorkerSources[se]||(this.demWorkerSources[se]={}),this.demWorkerSources[se][de]||(this.demWorkerSources[se][de]=new w),this.demWorkerSources[se][de]}enforceCacheSizeLimit(se,de){s.enforceCacheSizeLimit(de)}getWorkerPerformanceMetrics(se,de,Ie){Ie(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new es(self)),es}),o(["./shared"],function(s){function d(y,h){if(Array.isArray(y)){if(!Array.isArray(h)||y.length!==h.length)return!1;for(let m=0;m<y.length;m++)if(!d(y[m],h[m]))return!1;return!0}if(typeof y=="object"&&y!==null&&h!==null){if(typeof h!="object"||Object.keys(y).length!==Object.keys(h).length)return!1;for(const m in y)if(!d(y[m],h[m]))return!1;return!0}return y===h}var p=_;function _(y){return!function(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var b,E,I=new Blob([""],{type:"text/javascript"}),B=URL.createObjectURL(I);try{E=new Worker(B),b=!0}catch{b=!1}return E&&E.terminate(),URL.revokeObjectURL(B),b}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var b=document.createElement("canvas");b.width=b.height=1;var E=b.getContext("2d");if(!E)return!1;var I=E.getImageData(0,0,1,1);return I&&I.width===b.width}()?(w[m=h&&h.failIfMajorPerformanceCaveat]===void 0&&(w[m]=function(b){var E,I=function(B){var U=document.createElement("canvas"),H=Object.create(_.webGLContextAttributes);return H.failIfMajorPerformanceCaveat=B,U.getContext("webgl",H)||U.getContext("experimental-webgl",H)}(b);if(!I)return!1;try{E=I.createShader(I.VERTEX_SHADER)}catch{return!1}return!(!E||I.isContextLost())&&(I.shaderSource(E,"void main() {}"),I.compileShader(E),I.getShaderParameter(E,I.COMPILE_STATUS)===!0)}(m)),w[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(y)}var w={};function M(y,h,m){const b=s.window.document.createElement(y);return h!==void 0&&(b.className=h),m&&m.appendChild(b),b}function A(y,h,m){const b=s.window.document.createElementNS("http://www.w3.org/2000/svg",y);for(const E of Object.keys(h))b.setAttributeNS(null,E,h[E]);return m&&m.appendChild(b),b}_.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const P=s.window.document&&s.window.document.documentElement.style,L=P&&P.userSelect!==void 0?"userSelect":"WebkitUserSelect";let D;function z(){P&&L&&(D=P[L],P[L]="none")}function F(){P&&L&&(P[L]=D)}function N(y){y.preventDefault(),y.stopPropagation(),s.window.removeEventListener("click",N,!0)}function V(){s.window.addEventListener("click",N,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",N,!0)},0)}function j(y,h){const m=y.getBoundingClientRect();return Z(y,m,h)}function Q(y,h){const m=y.getBoundingClientRect(),b=[];for(let E=0;E<h.length;E++)b.push(Z(y,m,h[E]));return b}function re(y){return s.window.InstallTrigger!==void 0&&y.button===2&&y.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:y.button}function Z(y,h,m){const b=y.offsetWidth===h.width?1:y.offsetWidth/h.width;return new s.pointGeometry((m.clientX-h.left)*b,(m.clientY-h.top)*b)}function ne(y,h){var m=h[0],b=h[1],E=h[2],I=h[3],B=m*I-E*b;return B?(y[0]=I*(B=1/B),y[1]=-b*B,y[2]=-E*B,y[3]=m*B,y):null}function he(y){const{userImage:h}=y;return!!(h&&h.render&&h.render())&&(y.data.replace(new Uint8Array(h.data.buffer)),!0)}class De extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:m,callback:b}of this.requestors)this._notify(m,b);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,m){this._validate(h,m)&&(this.images[h]=m)}_validate(h,m){let b=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),b=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),b=!1),this._validateContent(m.content,m)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),b=!1),b}_validateStretch(h,m){if(!h)return!0;let b=0;for(const E of h){if(E[0]<b||E[1]<E[0]||m<E[1])return!1;b=E[1]}return!0}_validateContent(h,m){return!(h&&(h.length!==4||h[0]<0||m.data.width<h[0]||h[1]<0||m.data.height<h[1]||h[2]<0||m.data.width<h[2]||h[3]<0||m.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,m){m.version=this.images[h].version+1,this.images[h]=m,this.updatedImages[h]=!0}removeImage(h){const m=this.images[h];delete this.images[h],delete this.patterns[h],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,m){let b=!0;if(!this.isLoaded())for(const E of h)this.images[E]||(b=!1);this.isLoaded()||b?this._notify(h,m):this.requestors.push({ids:h,callback:m})}_notify(h,m){const b={};for(const E of h){this.images[E]||this.fire(new s.Event("styleimagemissing",{id:E}));const I=this.images[E];I?b[E]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:Boolean(I.userImage&&I.userImage.render)}:s.warnOnce(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,b)}getPixelSize(){const{width:h,height:m}=this.atlasImage;return{width:h,height:m}}getPattern(h){const m=this.patterns[h],b=this.getImage(h);if(!b)return null;if(m&&m.position.version===b.version)return m.position;if(m)m.position.version=b.version;else{const E={w:b.data.width+2,h:b.data.height+2,x:0,y:0},I=new s.ImagePosition(E,b);this.patterns[h]={bin:E,position:I}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const m=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(h,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const I in this.patterns)h.push(this.patterns[I].bin);const{w:m,h:b}=s.potpack(h),E=this.atlasImage;E.resize({width:m||1,height:b||1});for(const I in this.patterns){const{bin:B}=this.patterns[I],U=B.x+1,H=B.y+1,K=this.images[I].data,Y=K.width,oe=K.height;s.RGBAImage.copy(K,E,{x:0,y:0},{x:U,y:H},{width:Y,height:oe}),s.RGBAImage.copy(K,E,{x:0,y:oe-1},{x:U,y:H-1},{width:Y,height:1}),s.RGBAImage.copy(K,E,{x:0,y:0},{x:U,y:H+oe},{width:Y,height:1}),s.RGBAImage.copy(K,E,{x:Y-1,y:0},{x:U-1,y:H},{width:1,height:oe}),s.RGBAImage.copy(K,E,{x:0,y:0},{x:U+Y,y:H},{width:1,height:oe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const m of h){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const b=this.images[m];he(b)&&this.updateImage(m,b)}}}const He=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(y,h){return function([m,b,E]){const I=s.degToRad(b+90),B=s.degToRad(E);return{x:m*Math.cos(I)*Math.sin(B),y:m*Math.sin(I)*Math.sin(B),z:m*Math.cos(B),azimuthal:b,polar:E}}(y.expression.evaluate(h))}interpolate(y,h,m){return{x:s.number(y.x,h.x,m),y:s.number(y.y,h.y,m),z:s.number(y.z,h.z,m),azimuthal:s.number(y.azimuthal,h.azimuthal,m),polar:s.number(y.polar,h.polar,m)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)}),ae="-transition";class le extends s.Evented{constructor(h){super(),this._transitionable=new s.Transitionable(He),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,m={}){if(!this._validate(s.validateLight,h,m))for(const b in h){const E=h[b];s.endsWith(b,ae)?this._transitionable.setTransition(b.slice(0,-ae.length),E):this._transitionable.setValue(b,E)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,b){return(!b||b.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const fe=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)}),Oe="-transition";class We extends s.Evented{constructor(h,m){super(),this._transitionable=new s.Transitionable(fe),this.set(h),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=m}get(){return this._transitionable.serialize()}set(h){for(const m in h){const b=h[m];s.endsWith(m,Oe)?this._transitionable.setTransition(m.slice(0,-Oe.length),b):this._transitionable.setValue(m,b)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}}function ce(y,h,m,b){const E=s.smoothstep(45,65,m),[I,B]=Te(y,b),U=s.length(h);let H=1-Math.min(1,Math.exp((U-I)/(B-I)*-6));return H*=H*H,H=Math.min(1,1.00747*H),H*E*y.alpha}function Te(y,h){const m=.5/Math.tan(.5*h);return[y.range[0]+m,y.range[1]+m]}const Pe=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])}),Qe="-transition";class Ne extends s.Evented{constructor(h,m){super(),this._transitionable=new s.Transitionable(Pe),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const h=this._transform,m=h.projection.name==="globe",b=s.globeToMercatorTransition(h.zoom),E=this.properties.get("range"),I=[.5,3];return{range:m?[s.number(I[0],E[0],b),s.number(I[1],E[1],b)]:E,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,m={}){if(!this._validate(s.validateFog,h,m)){for(const b of Object.keys(s.spec.fog))h&&h[b]===void 0&&(h[b]=s.spec.fog[b].default);for(const b in h){const E=h[b];s.endsWith(b,Qe)?this._transitionable.setTransition(b.slice(0,-Qe.length),E):this._transitionable.setValue(b,E)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,h))*m.a}getOpacityAtLatLng(h,m){return this._transform.projection.supportsFog?function(b,E,I){const B=s.MercatorCoordinate.fromLngLat(E),U=I.elevation?I.elevation.getAtPointOrZero(B):0,H=[B.x,B.y,U];return s.transformMat4(H,H,I.mercatorFogMatrix),ce(b,H,I.pitch,I._fov)}(this.state,h,m):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?Te(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,b){return(!b||b.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class nt{constructor(h,m){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const b=this.workerPool.acquire(this.id);for(let E=0;E<b.length;E++){const I=new nt.Actor(b[E],m,this.id);I.name=`Worker ${E}`,this.actors.push(I)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,m,b){s.asyncAll(this.actors,(E,I)=>{E.send(h,m,I)},b=b||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ze(y,h,m){return h*(s.EXTENT/(y.tileSize*Math.pow(2,m-y.tileID.overscaledZ)))}nt.Actor=s.Actor;class et{constructor(h,m,b,E){this.screenBounds=h,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=b,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,E)}static createFromScreenPoints(h,m){let b,E;if(h instanceof s.pointGeometry||typeof h[0]=="number"){const I=s.pointGeometry.convert(h);b=[I],E=m.isPointAboveHorizon(I)}else{const I=s.pointGeometry.convert(h[0]),B=s.pointGeometry.convert(h[1]);b=[I,B],E=s.polygonizeBounds(I,B).every(U=>m.isPointAboveHorizon(U))}return new et(b,m.getCameraPoint(),E,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],E=s.polygonizeBounds(m,b,0,!1);return this.cameraPoint.y>b.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<b.x?E.splice(3,0,this.cameraPoint):this.cameraPoint.x>=b.x?E[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(E[3]=this.cameraPoint)),s.bufferConvexPolygon(E,h)}bufferedCameraGeometryGlobe(h){const m=this.screenBounds[0],b=this.screenBounds.length===1?this.screenBounds[0].add(new s.pointGeometry(1,1)):this.screenBounds[1],E=s.polygonizeBounds(m,b,h),I=this.cameraPoint.clone();switch(3*((I.y>m.y)+(I.y>b.y))+((I.x>m.x)+(I.x>b.x))){case 0:E[0]=I,E[4]=I.clone();break;case 1:E.splice(1,0,I);break;case 2:E[1]=I;break;case 3:E.splice(4,0,I);break;case 5:E.splice(2,0,I);break;case 6:E[3]=I;break;case 7:E.splice(3,0,I);break;case 8:E[2]=I}return E}containsTile(h,m,b,E=0){const I=h.queryPadding/m._pixelsPerMercatorPixel+1,B=b?this._bufferedCameraMercator(I,m):this._bufferedScreenMercator(I,m);let U=h.tileID.wrap+(B.unwrapped?E:0);const H=B.polygon.map(_e=>s.getTilePoint(h.tileTransform,_e,U));if(!s.polygonIntersectsBox(H,0,0,s.EXTENT,s.EXTENT))return;U=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?E:0);const K=this.screenGeometryMercator.polygon.map(_e=>s.getTileVec3(h.tileTransform,_e,U)),Y=K.map(_e=>new s.pointGeometry(_e[0],_e[1])),oe=m.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),me=s.getTileVec3(h.tileTransform,oe,U),be=K.map(_e=>{const xe=s.sub(_e,_e,me);return s.normalize(xe,xe),new s.Ray(me,xe)}),we=ze(h,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:Y,tilespaceRays:be,bufferedTilespaceGeometry:H,bufferedTilespaceBounds:(Me=s.getBounds(H),Me.min.x=s.clamp(Me.min.x,0,s.EXTENT),Me.min.y=s.clamp(Me.min.y,0,s.EXTENT),Me.max.x=s.clamp(Me.max.x,0,s.EXTENT),Me.max.y=s.clamp(Me.max.y,0,s.EXTENT),Me),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:we};var Me}_bufferedScreenMercator(h,m){const b=qt(h);if(this._screenRaycastCache[b])return this._screenRaycastCache[b];{let E;return E=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),m):{polygon:this.bufferedScreenGeometry(h).map(I=>m.pointCoordinate3D(I)),unwrapped:!0},this._screenRaycastCache[b]=E,E}}_bufferedCameraMercator(h,m){const b=qt(h);if(this._cameraRaycastCache[b])return this._cameraRaycastCache[b];{let E;return E=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),m):{polygon:this.bufferedCameraGeometry(h).map(I=>m.pointCoordinate3D(I)),unwrapped:!0},this._cameraRaycastCache[b]=E,E}}_projectAndResample(h,m){const b=function(I,B){const U=s.multiply([],B.pixelMatrix,B.globeMatrix),H=[0,-s.GLOBE_RADIUS,0,1],K=[0,s.GLOBE_RADIUS,0,1],Y=[0,0,0,1];s.transformMat4$1(H,H,U),s.transformMat4$1(K,K,U),s.transformMat4$1(Y,Y,U);const oe=new s.pointGeometry(H[0]/H[3],H[1]/H[3]),me=new s.pointGeometry(K[0]/K[3],K[1]/K[3]),be=s.polygonContainsPoint(I,oe)&&H[3]<Y[3],we=s.polygonContainsPoint(I,me)&&K[3]<Y[3];if(!be&&!we)return null;const Me=function(tt,ft,lt){for(let it=1;it<tt.length;it++){const Wt=Nt(ft.pointCoordinate3D(tt[it-1]).x),ot=Nt(ft.pointCoordinate3D(tt[it]).x);if(lt<0){if(Wt<ot)return{idx:it,t:-Wt/(ot-1-Wt)}}else if(ot<Wt)return{idx:it,t:(1-Wt)/(ot+1-Wt)}}return null}(I,B,be?-1:1);if(!Me)return null;const{idx:_e,t:xe}=Me;let Le=_e>1?Et(I.slice(0,_e),B):[],Ce=_e<I.length?Et(I.slice(_e),B):[];Le=Le.map(tt=>new s.pointGeometry(Nt(tt.x),tt.y)),Ce=Ce.map(tt=>new s.pointGeometry(Nt(tt.x),tt.y));const Ue=[...Le];Ue.length===0&&Ue.push(Ce[Ce.length-1]);const Xe=s.number(Ue[Ue.length-1].y,(Ce.length===0?Le[0]:Ce[0]).y,xe);let Ze;return Ze=be?[new s.pointGeometry(0,Xe),new s.pointGeometry(0,0),new s.pointGeometry(1,0),new s.pointGeometry(1,Xe)]:[new s.pointGeometry(1,Xe),new s.pointGeometry(1,1),new s.pointGeometry(0,1),new s.pointGeometry(0,Xe)],Ue.push(...Ze),Ce.length===0?Ue.push(Le[0]):Ue.push(...Ce),{polygon:Ue.map(tt=>new s.MercatorCoordinate(tt.x,tt.y)),unwrapped:!1}}(h,m);if(b)return b;const E=function(I,B){let U=!1,H=-1/0,K=0;for(let oe=0;oe<I.length-1;oe++)I[oe].x>H&&(H=I[oe].x,K=oe);for(let oe=0;oe<I.length-1;oe++){const me=(K+oe)%(I.length-1),be=I[me],we=I[me+1];Math.abs(be.x-we.x)>.5&&(be.x<we.x?(be.x+=1,me===0&&(I[I.length-1].x+=1)):(we.x+=1,me+1===I.length-1&&(I[0].x+=1)),U=!0)}const Y=s.mercatorXfromLng(B.center.lng);return U&&Y<Math.abs(Y-1)&&I.forEach(oe=>{oe.x-=1}),{polygon:I,unwrapped:U}}(Et(h,m).map(I=>new s.pointGeometry(Nt(I.x),I.y)),m);return{polygon:E.polygon.map(I=>new s.MercatorCoordinate(I.x,I.y)),unwrapped:E.unwrapped}}}function Et(y,h){return s.resample(y,m=>{const b=h.pointCoordinate3D(m);m.x=b.x,m.y=b.y},1/256)}function Nt(y){return y<0?1+y%1:y%1}function qt(y){return 100*y|0}function wn(y,h,m,b,E){const I=function(B,U){if(B)return E(B);if(U){y.url&&U.tiles&&y.tiles&&delete y.tiles;const H=s.pick(s.extend(U,y),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);U.vector_layers&&(H.vectorLayers=U.vector_layers,H.vectorLayerIds=H.vectorLayers.map(K=>K.id)),H.tiles=h.canonicalizeTileset(H,y.url),E(null,H)}};return y.url?s.getJSON(h.transformRequest(h.normalizeSourceURL(y.url,null,m,b),s.ResourceType.Source),I):s.exported.frame(()=>I(null,y))}class _n{constructor(h,m,b){this.bounds=s.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=m||0,this.maxzoom=b||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const m=Math.pow(2,h.z),b=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*m),E=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*m),I=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*m),B=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*m);return h.x>=b&&h.x<I&&h.y>=E&&h.y<B}}class Rn{constructor(h,m,b){this.context=h;const E=h.gl;this.buffer=E.createBuffer(),this.dynamicDraw=Boolean(b),this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const At={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ot{constructor(h,m,b,E){this.length=m.length,this.attributes=b,this.itemSize=m.bytesPerElement,this.dynamicDraw=E,this.context=h;const I=h.gl;this.buffer=I.createBuffer(),h.bindVertexBuffer.set(this.buffer),I.bufferData(I.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,m){for(let b=0;b<this.attributes.length;b++){const E=m.attributes[this.attributes[b].name];E!==void 0&&h.enableVertexAttribArray(E)}}setVertexAttribPointers(h,m,b){for(let E=0;E<this.attributes.length;E++){const I=this.attributes[E],B=m.attributes[I.name];B!==void 0&&h.vertexAttribPointer(B,I.components,h[At[I.type]],!1,this.itemSize,I.offset+this.itemSize*(b||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ft{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cn extends Ft{getDefault(){return s.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class pn extends Ft{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class Vn extends Ft{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class On extends Ft{getDefault(){return[!0,!0,!0,!0]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Zn extends Ft{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class ai extends Ft{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Ei extends Ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const m=this.current;(h.func!==m.func||h.ref!==m.ref||h.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class Be extends Ft{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class Se extends Ft{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=h,this.dirty=!1}}class St extends Ft{getDefault(){return[0,1]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class tn extends Ft{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=h,this.dirty=!1}}class nn extends Ft{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class fn extends Ft{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.BLEND):m.disable(m.BLEND),this.current=h,this.dirty=!1}}class Nn extends Ft{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class yn extends Ft{getDefault(){return s.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class Dt extends Ft{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class Un extends Ft{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=h,this.dirty=!1}}class Je extends Ft{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class It extends Ft{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}class Zt extends Ft{getDefault(){return null}set(h){(h!==this.current||this.dirty)&&(this.gl.useProgram(h),this.current=h,this.dirty=!1)}}class sn extends Ft{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class Yn extends Ft{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class li extends Ft{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class Bi extends Ft{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class rt extends Ft{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class Ct extends Ft{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Vt extends Ft{getDefault(){return null}set(h){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class bn extends Ft{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class Ln extends Ft{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class Ri extends Ft{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class hr extends Ft{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class Fr extends Ft{constructor(h,m){super(h),this.context=h,this.parent=m}getDefault(){return null}}class Pr extends Fr{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class Gi extends Fr{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class es extends Gi{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ee{constructor(h,m,b,E){this.context=h,this.width=m,this.height=b;const I=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new Pr(h,I),E&&(this.depthAttachment=new Gi(h,I))}destroy(){const h=this.context.gl,m=this.colorAttachment.get();if(m&&h.deleteTexture(m),this.depthAttachment){const b=this.depthAttachment.get();b&&h.deleteRenderbuffer(b)}h.deleteFramebuffer(this.framebuffer)}}class se{constructor(h){this.gl=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Cn(this),this.clearDepth=new pn(this),this.clearStencil=new Vn(this),this.colorMask=new On(this),this.depthMask=new Zn(this),this.stencilMask=new ai(this),this.stencilFunc=new Ei(this),this.stencilOp=new Be(this),this.stencilTest=new Se(this),this.depthRange=new St(this),this.depthTest=new tn(this),this.depthFunc=new nn(this),this.blend=new fn(this),this.blendFunc=new Nn(this),this.blendColor=new yn(this),this.blendEquation=new Dt(this),this.cullFace=new Un(this),this.cullFaceSide=new Je(this),this.frontFace=new It(this),this.program=new Zt(this),this.activeTexture=new sn(this),this.viewport=new Yn(this),this.bindFramebuffer=new li(this),this.bindRenderbuffer=new Bi(this),this.bindTexture=new rt(this),this.bindVertexBuffer=new Ct(this),this.bindElementBuffer=new Vt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new bn(this),this.pixelStoreUnpack=new Ln(this),this.pixelStoreUnpackPremultiplyAlpha=new Ri(this),this.pixelStoreUnpackFlipY=new hr(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureHalfFloat=h.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(h.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,m){return new Rn(this,h,m)}createVertexBuffer(h,m,b){return new Ot(this,h,m,b)}createRenderbuffer(h,m,b){const E=this.gl,I=E.createRenderbuffer();return this.bindRenderbuffer.set(I),E.renderbufferStorage(E.RENDERBUFFER,h,m,b),this.bindRenderbuffer.set(null),I}createFramebuffer(h,m,b){return new Ee(this,h,m,b)}clear({color:h,depth:m,stencil:b}){const E=this.gl;let I=0;h&&(I|=E.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(I|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),b!==void 0&&(I|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(b),this.stencilMask.set(255)),E.clear(I)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){d(h.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class de extends s.Evented{constructor(h,m,b,E){super(),this.id=h,this.dispatcher=b,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},m),s.extend(this,s.pick(m,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=wn(this._options,this.map._requestManager,null,null,(h,m)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new s.ErrorEvent(h)):m&&(s.extend(this,m),m.bounds&&(this.tileBounds=new _n(m.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(m.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return s.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,m){const b=s.exported.devicePixelRatio>=2,E=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),b,this.tileSize);h.request=s.getImage(this.map._requestManager.transformRequest(E,s.ResourceType.Tile),(I,B,U,H)=>(delete h.request,h.aborted?(h.state="unloaded",m(null)):I?(h.state="errored",m(I)):B?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:U,expires:H}),h.setTexture(B,this.map.painter),h.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(h,m,b){h.setTexture(m,b)}static unloadTileData(h,m){h.texture&&m.saveTileTexture(h.texture)}abortTile(h,m){h.request&&(h.request.cancel(),delete h.request),m()}unloadTile(h,m){h.texture&&this.map.painter.saveTileTexture(h.texture),m()}hasTransition(){return!1}}let Ie;function ee(y,h,m,b,E,I,B,U){const H=[y,m,E,h,b,I,1,1,1],K=[B,U,1],Y=s.adjoint([],H),[oe,me,be]=s.transformMat3(K,K,s.transpose(Y,Y));return s.multiply$1(H,[oe,0,0,0,me,0,0,0,be],H)}class pe extends s.Evented{constructor(h,m,b,E){super(),this.id=h,this.dispatcher=b,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=m,this._dirty=!1}load(h,m){this._loaded=m||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(b,E)=>{if(this._imageRequest=null,this._loaded=!0,b)this.fire(new s.ErrorEvent(b));else if(E){const{HTMLImageElement:I}=s.window;this.image=E instanceof I?s.exported.getImageData(E):E,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const m=h.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(b){let E=1/0,I=1/0,B=-1/0,U=-1/0;for(const oe of b)E=Math.min(E,oe.x),I=Math.min(I,oe.y),B=Math.max(B,oe.x),U=Math.max(U,oe.y);const H=Math.max(B-E,U-I),K=Math.max(0,Math.floor(-Math.log(H)/Math.LN2)),Y=Math.pow(2,K);return new s.CanonicalTileID(K,Math.floor((E+B)/2*Y),Math.floor((I+U)/2*Y))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const H in this.tiles){const K=this.tiles[H];K.state!=="loaded"&&(K.state="loaded",K.texture=this.texture)}if(this._boundsArray)return;const m=s.tileTransform(this.tileID,this.map.transform.projection),[b,E,I,B]=this.coordinates.map(H=>{const K=m.projection.project(H[0],H[1]);return s.getTilePoint(m,K)._round()});this.perspectiveTransform=function(H,K,Y,oe,me,be,we,Me,_e,xe){const Le=ee(0,0,H,0,0,K,H,K),Ce=ee(Y,oe,me,be,we,Me,_e,xe);return s.multiply$1(Ce,s.adjoint(Le,Le),Ce),[Ce[6]/Ce[8]*H/s.EXTENT,Ce[7]/Ce[8]*K/s.EXTENT]}(this.width,this.height,b.x,b.y,E.x,E.y,B.x,B.y,I.x,I.y);const U=this._boundsArray=new s.StructArrayLayout4i8;U.emplaceBack(b.x,b.y,0,0),U.emplaceBack(E.x,E.y,s.EXTENT,0),U.emplaceBack(B.x,B.y,0,s.EXTENT),U.emplaceBack(I.x,I.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(U,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const h=this.map.painter.context,m=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(h,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,m){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},m(null)):(h.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ae={vector:class extends s.Evented{constructor(y,h,m,b){if(super(),this.id=y,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(h,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(y){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=wn(this._options,this.map._requestManager,h,m,(b,E)=>{this._tileJSONRequest=null,this._loaded=!0,b?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),m&&m.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new s.ErrorEvent(b))):E&&(s.extend(this,E),E.bounds&&(this.tileBounds=new _n(E.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(E.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),y&&y(b)})}loaded(){return this._loaded}hasTile(y){return!this.tileBounds||this.tileBounds.contains(y.canonical)}onAdd(y){this.map=y,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>{const y=this.map.style._getSourceCaches(this.id);for(const h of y)h.clearTiles()})}setSourceProperty(y){y(),this.reload()}setTiles(y){return this._options.tiles=y,this.reload(),this}setUrl(y){return this.url=y,this._options.url=y,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(y,h){const m=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme)),b={request:this.map._requestManager.transformRequest(m,s.ResourceType.Tile),data:void 0,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,tileSize:this.tileSize*y.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:y.isSymbolTile};if(b.request.collectResourceTiming=this._collectResourceTiming,y.actor&&y.state!=="expired")y.state==="loading"?y.reloadCallback=h:y.request=y.actor.send("reloadTile",b,E.bind(this));else if(y.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)y.request=y.actor.send("loadTile",b,E.bind(this),void 0,!0);else{const I=s.loadVectorTile.call({deduped:this._deduped},b,(B,U)=>{B||!U?E.call(this,B):(b.data={cacheControl:U.cacheControl,expires:U.expires,rawData:U.rawData.slice(0)},y.actor&&y.actor.send("loadTile",b,E.bind(this),void 0,!0))},!0);y.request={cancel:I}}function E(I,B){return delete y.request,y.aborted?h(null):I&&I.status!==404?h(I):(B&&B.resourceTiming&&(y.resourceTiming=B.resourceTiming),this.map._refreshExpiredTiles&&B&&y.setExpiryData(B),y.loadVectorData(B,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(y.reloadCallback&&(this.loadTile(y,y.reloadCallback),y.reloadCallback=null)))}}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.actor&&y.actor.send("abortTile",{uid:y.uid,type:this.type,source:this.id})}unloadTile(y){y.unloadVectorData(),y.actor&&y.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},raster:de,"raster-dem":class extends de{constructor(y,h,m,b){super(y,h,m,b),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(y,h){const m=this.map._requestManager.normalizeTileURL(y.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function b(E,I){E&&(y.state="errored",h(E)),I&&(y.dem=I,y.dem.onDeserialize(),y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0,y.state="loaded",h(null))}y.request=s.getImage(this.map._requestManager.transformRequest(m,s.ResourceType.Tile),function(E,I,B,U){if(delete y.request,y.aborted)y.state="unloaded",h(null);else if(E)y.state="errored",h(E);else if(I){this.map._refreshExpiredTiles&&y.setExpiryData({cacheControl:B,expires:U});const H=s.window.ImageBitmap&&I instanceof s.window.ImageBitmap&&(Ie==null&&(Ie=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),Ie),K=1-(I.width-s.prevPowerOfTwo(I.width))/2;K<1||y.neighboringTiles||(y.neighboringTiles=this._getNeighboringTiles(y.tileID));const Y=H?I:s.exported.getImageData(I,K),oe={uid:y.uid,coord:y.tileID,source:this.id,rawImageData:Y,encoding:this.encoding,padding:K};y.actor&&y.state!=="expired"||(y.actor=this.dispatcher.getActor(),y.actor.send("loadDEMTile",oe,b.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(y){const h=y.canonical,m=Math.pow(2,h.z),b=(h.x-1+m)%m,E=h.x===0?y.wrap-1:y.wrap,I=(h.x+1+m)%m,B=h.x+1===m?y.wrap+1:y.wrap,U={};return U[new s.OverscaledTileID(y.overscaledZ,E,h.z,b,h.y).key]={backfilled:!1},U[new s.OverscaledTileID(y.overscaledZ,B,h.z,I,h.y).key]={backfilled:!1},h.y>0&&(U[new s.OverscaledTileID(y.overscaledZ,E,h.z,b,h.y-1).key]={backfilled:!1},U[new s.OverscaledTileID(y.overscaledZ,y.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},U[new s.OverscaledTileID(y.overscaledZ,B,h.z,I,h.y-1).key]={backfilled:!1}),h.y+1<m&&(U[new s.OverscaledTileID(y.overscaledZ,E,h.z,b,h.y+1).key]={backfilled:!1},U[new s.OverscaledTileID(y.overscaledZ,y.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},U[new s.OverscaledTileID(y.overscaledZ,B,h.z,I,h.y+1).key]={backfilled:!1}),U}unloadTile(y){y.demTexture&&this.map.painter.saveTileTexture(y.demTexture),y.fbo&&(y.fbo.destroy(),delete y.fbo),y.dem&&delete y.dem,delete y.neighboringTiles,y.state="unloaded"}},geojson:class extends s.Evented{constructor(y,h,m,b){super(),this.id=y,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(b),this._data=h.data,this._options=s.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const E=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*E,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*E,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:s.EXTENT,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*E,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(y){this.map=y,this.setData(this._data)}setData(y){return this._data=y,this._updateWorkerData(),this}getClusterExpansionZoom(y,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:y,source:this.id},h),this}getClusterChildren(y,h){return this.actor.send("geojson.getClusterChildren",{clusterId:y,source:this.id},h),this}getClusterLeaves(y,h,m,b){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:y,limit:h,offset:m},b),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const y=s.extend({},this.workerOptions),h=this._data;typeof h=="string"?(y.request=this.map._requestManager.transformRequest(s.exported.resolveURL(h),s.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,y,(m,b)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new s.ErrorEvent(m));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(E.resourceTiming=b.resourceTiming[this.id]),this.fire(new s.Event("data",E)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(y,h){const m=y.actor?"reloadTile":"loadTile";y.actor=this.actor,y.request=this.actor.send(m,{type:this.type,uid:y.uid,tileID:y.tileID,tileZoom:y.tileZoom,zoom:y.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(b,E)=>(delete y.request,y.unloadVectorData(),y.aborted?h(null):b?h(b):(y.loadVectorData(E,this.map.painter,m==="reloadTile"),h(null))),void 0,m==="loadTile")}abortTile(y){y.request&&(y.request.cancel(),delete y.request),y.aborted=!0}unloadTile(y){y.unloadVectorData(),this.actor.send("removeTile",{uid:y.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends pe{constructor(y,h,m,b){super(y,h,m,b),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const y=this.options;this.urls=[];for(const h of y.urls)this.urls.push(this.map._requestManager.transformRequest(h,s.ResourceType.Source).url);s.getVideo(this.urls,(h,m)=>{this._loaded=!0,h?this.fire(new s.ErrorEvent(h)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(y){if(this.video){const h=this.video.seekable;y<h.start(0)||y>h.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=y}}getVideo(){return this.video}onAdd(y){this.map||(this.map=y,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const y=this.map.painter.context,h=y.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(y,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(y)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:pe,canvas:class extends pe{constructor(y,h,m,b){super(y,h,m,b),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(I=>typeof I!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${y}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(y){this.map=y,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let y=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,y=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,y=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?(y||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const y of[this.canvas.width,this.canvas.height])if(isNaN(y)||y<=0)return!0;return!1}},custom:class extends s.Evented{constructor(y,h,m,b){super(),this.id=y,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=h,this.setEventedParent(b),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new _n(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(y){this._map=y,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(y),this.load()}onRemove(y){this._implementation.onRemove&&this._implementation.onRemove(y)}hasTile(y){if(this._implementation.hasTile){const{x:h,y:m,z:b}=y.canonical;return this._implementation.hasTile({x:h,y:m,z:b})}return!this.tileBounds||this.tileBounds.contains(y.canonical)}loadTile(y,h){const{x:m,y:b,z:E}=y.tileID.canonical,I=new s.window.AbortController;y.request=Promise.resolve(this._implementation.loadTile({x:m,y:b,z:E},{signal:I.signal})).then(function(B){return delete y.request,y.aborted?(y.state="unloaded",h(null)):B===void 0?(y.state="errored",h(null)):B===null?(this.loadTileData(y,{width:this.tileSize,height:this.tileSize,data:null}),y.state="loaded",h(null)):function(U){return U instanceof s.window.ImageData||U instanceof s.window.HTMLCanvasElement||U instanceof s.window.ImageBitmap||U instanceof s.window.HTMLImageElement}(B)?(this.loadTileData(y,B),y.state="loaded",void h(null)):(y.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(B=>{B.code!==20&&(y.state="errored",h(B))}),y.request.cancel=()=>I.abort()}loadTileData(y,h){de.loadTileData(y,h,this._map.painter)}unloadTileData(y){de.unloadTileData(y,this._map.painter)}unloadTile(y,h){if(this.unloadTileData(y),this._implementation.unloadTile){const{x:m,y:b,z:E}=y.tileID.canonical;this._implementation.unloadTile({x:m,y:b,z:E})}h()}abortTile(y,h){y.request&&y.request.cancel&&(y.request.cancel(),delete y.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(y=>({x:y.canonical.x,y:y.canonical.y,z:y.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ye=function(y,h,m,b){const E=new Ae[h.type](y,h,m,b);if(E.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${E.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],E),E};function ve(y,h){const m=s.identity([]);return s.scale(m,m,[.5*y.width,.5*-y.height,1]),s.translate(m,m,[1,-1,0]),s.multiply(m,m,y.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(m)}function Ke(y,h,m,b,E,I,B,U=!1){const H=y.tilesIn(b,B,U);H.sort(zt);const K=[];for(const oe of H)K.push({wrappedTileID:oe.tile.tileID.wrapped().key,queryResults:oe.tile.queryRenderedFeatures(h,m,y._state,oe,E,I,ve(y.transform,oe.tile.tileID),U)});const Y=function(oe){const me={},be={};for(const we of oe){const Me=we.queryResults,_e=we.wrappedTileID,xe=be[_e]=be[_e]||{};for(const Le in Me){const Ce=Me[Le],Ue=xe[Le]=xe[Le]||{},Xe=me[Le]=me[Le]||[];for(const Ze of Ce)Ue[Ze.featureIndex]||(Ue[Ze.featureIndex]=!0,Xe.push(Ze))}}return me}(K);for(const oe in Y)Y[oe].forEach(me=>{const be=me.feature,we=be.layer;we&&we.type!=="background"&&we.type!=="sky"&&(be.source=we.source,we["source-layer"]&&(be.sourceLayer=we["source-layer"]),be.state=be.id!==void 0?y.getFeatureState(we["source-layer"],be.id):{})});return Y}function ht(y,h){const m=y.getRenderableIds().map(I=>y.getTileByID(I)),b=[],E={};for(let I=0;I<m.length;I++){const B=m[I],U=B.tileID.canonical.key;E[U]||(E[U]=!0,B.querySourceFeatures(b,h))}return b}function zt(y,h){const m=y.tileID,b=h.tileID;return m.overscaledZ-b.overscaledZ||m.canonical.y-b.canonical.y||m.wrap-b.wrap||m.canonical.x-b.canonical.x}function vt(){return cd.workerClass!=null?new cd.workerClass:new s.window.Worker(cd.workerUrl)}const Jt="mapboxgl_preloaded_worker_pool";class Yt{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<Yt.workerCount;)this.workers.push(new vt);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Jt]}numActive(){return Object.keys(this.active).length}}let Xt;function gn(){return Xt||(Xt=new Yt),Xt}function Xn(y,h){const m={};for(const b in y)b!=="ref"&&(m[b]=y[b]);return s.refProperties.forEach(b=>{b in h&&(m[b]=h[b])}),m}function ii(y){y=y.slice();const h=Object.create(null);for(let m=0;m<y.length;m++)h[y[m].id]=y[m];for(let m=0;m<y.length;m++)"ref"in y[m]&&(y[m]=Xn(y[m],h[y[m].ref]));return y}Yt.workerCount=2;const Sn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Jn(y,h,m){m.push({command:Sn.addSource,args:[y,h[y]]})}function kn(y,h,m){h.push({command:Sn.removeSource,args:[y]}),m[y]=!0}function ps(y,h,m,b){kn(y,m,b),Jn(y,h,m)}function nr(y,h,m){let b;for(b in y[m])if(y[m].hasOwnProperty(b)&&b!=="data"&&!d(y[m][b],h[m][b]))return!1;for(b in h[m])if(h[m].hasOwnProperty(b)&&b!=="data"&&!d(y[m][b],h[m][b]))return!1;return!0}function Br(y,h,m,b,E,I){let B;for(B in h=h||{},y=y||{})y.hasOwnProperty(B)&&(d(y[B],h[B])||m.push({command:I,args:[b,B,h[B],E]}));for(B in h)h.hasOwnProperty(B)&&!y.hasOwnProperty(B)&&(d(y[B],h[B])||m.push({command:I,args:[b,B,h[B],E]}))}function wt(y){return y.id}function Es(y,h){return y[h.id]=h,y}class ir{constructor(h,m){this.reset(h,m)}reset(h,m){this.points=h||[],this._distances=[0];for(let b=1;b<this.points.length;b++)this._distances[b]=this._distances[b-1]+this.points[b].dist(this.points[b-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=s.clamp(h,0,1);let m=1,b=this._distances[m];const E=h*this.paddedLength+this.padding;for(;b<E&&m<this._distances.length;)b=this._distances[++m];const I=m-1,B=this._distances[I],U=b-B,H=U>0?(E-B)/U:0;return this.points[I].mult(1-H).add(this.points[m].mult(H))}}class Ni{constructor(h,m,b){const E=this.boxCells=[],I=this.circleCells=[];this.xCellCount=Math.ceil(h/b),this.yCellCount=Math.ceil(m/b);for(let B=0;B<this.xCellCount*this.yCellCount;B++)E.push([]),I.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=m,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,m,b,E,I){this._forEachCell(m,b,E,I,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(E),this.bboxes.push(I)}insertCircle(h,m,b,E){this._forEachCell(m-E,b-E,m+E,b+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(m),this.circles.push(b),this.circles.push(E)}_insertBoxCell(h,m,b,E,I,B){this.boxCells[I].push(B)}_insertCircleCell(h,m,b,E,I,B){this.circleCells[I].push(B)}_query(h,m,b,E,I,B){if(b<0||h>this.width||E<0||m>this.height)return!I&&[];const U=[];if(h<=0&&m<=0&&this.width<=b&&this.height<=E){if(I)return!0;for(let H=0;H<this.boxKeys.length;H++)U.push({key:this.boxKeys[H],x1:this.bboxes[4*H],y1:this.bboxes[4*H+1],x2:this.bboxes[4*H+2],y2:this.bboxes[4*H+3]});for(let H=0;H<this.circleKeys.length;H++){const K=this.circles[3*H],Y=this.circles[3*H+1],oe=this.circles[3*H+2];U.push({key:this.circleKeys[H],x1:K-oe,y1:Y-oe,x2:K+oe,y2:Y+oe})}return B?U.filter(B):U}return this._forEachCell(h,m,b,E,this._queryCell,U,{hitTest:I,seenUids:{box:{},circle:{}}},B),I?U.length>0:U}_queryCircle(h,m,b,E,I){const B=h-b,U=h+b,H=m-b,K=m+b;if(U<0||B>this.width||K<0||H>this.height)return!E&&[];const Y=[];return this._forEachCell(B,H,U,K,this._queryCellCircle,Y,{hitTest:E,circle:{x:h,y:m,radius:b},seenUids:{box:{},circle:{}}},I),E?Y.length>0:Y}query(h,m,b,E,I){return this._query(h,m,b,E,!1,I)}hitTest(h,m,b,E,I){return this._query(h,m,b,E,!0,I)}hitTestCircle(h,m,b,E){return this._queryCircle(h,m,b,!0,E)}_queryCell(h,m,b,E,I,B,U,H){const K=U.seenUids,Y=this.boxCells[I];if(Y!==null){const me=this.bboxes;for(const be of Y)if(!K.box[be]){K.box[be]=!0;const we=4*be;if(h<=me[we+2]&&m<=me[we+3]&&b>=me[we+0]&&E>=me[we+1]&&(!H||H(this.boxKeys[be]))){if(U.hitTest)return B.push(!0),!0;B.push({key:this.boxKeys[be],x1:me[we],y1:me[we+1],x2:me[we+2],y2:me[we+3]})}}}const oe=this.circleCells[I];if(oe!==null){const me=this.circles;for(const be of oe)if(!K.circle[be]){K.circle[be]=!0;const we=3*be;if(this._circleAndRectCollide(me[we],me[we+1],me[we+2],h,m,b,E)&&(!H||H(this.circleKeys[be]))){if(U.hitTest)return B.push(!0),!0;{const Me=me[we],_e=me[we+1],xe=me[we+2];B.push({key:this.circleKeys[be],x1:Me-xe,y1:_e-xe,x2:Me+xe,y2:_e+xe})}}}}}_queryCellCircle(h,m,b,E,I,B,U,H){const K=U.circle,Y=U.seenUids,oe=this.boxCells[I];if(oe!==null){const be=this.bboxes;for(const we of oe)if(!Y.box[we]){Y.box[we]=!0;const Me=4*we;if(this._circleAndRectCollide(K.x,K.y,K.radius,be[Me+0],be[Me+1],be[Me+2],be[Me+3])&&(!H||H(this.boxKeys[we])))return B.push(!0),!0}}const me=this.circleCells[I];if(me!==null){const be=this.circles;for(const we of me)if(!Y.circle[we]){Y.circle[we]=!0;const Me=3*we;if(this._circlesCollide(be[Me],be[Me+1],be[Me+2],K.x,K.y,K.radius)&&(!H||H(this.circleKeys[we])))return B.push(!0),!0}}}_forEachCell(h,m,b,E,I,B,U,H){const K=this._convertToXCellCoord(h),Y=this._convertToYCellCoord(m),oe=this._convertToXCellCoord(b),me=this._convertToYCellCoord(E);for(let be=K;be<=oe;be++)for(let we=Y;we<=me;we++)if(I.call(this,h,m,b,E,this.xCellCount*we+be,B,U,H))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,m,b,E,I,B){const U=E-h,H=I-m,K=b+B;return K*K>U*U+H*H}_circleAndRectCollide(h,m,b,E,I,B,U){const H=(B-E)/2,K=Math.abs(h-(E+H));if(K>H+b)return!1;const Y=(U-I)/2,oe=Math.abs(m-(I+Y));if(oe>Y+b)return!1;if(K<=H||oe<=Y)return!0;const me=K-H,be=oe-Y;return me*me+be*be<=b*b}}const zi=Math.tan(85*Math.PI/180);function ci(y,h,m,b,E,I,B){const U=s.create();if(m)if(I.name==="globe"){const H=s.calculateGlobeLabelMatrix(E,h);s.multiply(U,U,H)}else{const H=ne([],B);U[0]=H[0],U[1]=H[1],U[4]=H[2],U[5]=H[3],b||s.rotateZ(U,U,E.angle)}else s.multiply(U,E.labelPlaneMatrix,y);return U}function wr(y,h,m,b,E,I,B){const U=ci(y,h,m,b,E,I,B);return I.name==="globe"&&m||(U[2]=U[6]=U[10]=U[14]=0),U}function Ur(y,h,m,b,E,I,B){if(m){if(I.name==="globe"){const U=ci(y,h,m,b,E,I,B);return s.invert(U,U),s.multiply(U,y,U),U}{const U=s.clone(y),H=s.identity([]);return H[0]=B[0],H[1]=B[1],H[4]=B[2],H[5]=B[3],s.multiply(U,U,H),b||s.rotateZ(U,U,-E.angle),U}}return E.glCoordMatrix}function qi(y,h,m,b){const E=[y,h,m,1];m?s.transformMat4$1(E,E,b):br(E,E,b);const I=E[3];return E[0]/=I,E[1]/=I,E[2]/=I,E}function Kt(y,h){return Math.min(.5+y/h*.5,1.5)}function ni(y,h){const m=y[0]/y[3],b=y[1]/y[3];return m>=-h[0]&&m<=h[0]&&b>=-h[1]&&b<=h[1]}function Kn(y,h,m,b,E,I,B,U,H,K){const Y=m.transform,oe=b?y.textSizeData:y.iconSizeData,me=s.evaluateSizeForZoom(oe,m.transform.zoom),be=Y.projection.name==="globe",we=[256/m.width*2+1,256/m.height*2+1],Me=b?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;Me.clear();let _e=null;be&&(_e=b?y.text.globeExtVertexArray:y.icon.globeExtVertexArray);const xe=y.lineVertexArray,Le=b?y.text.placedSymbolArray:y.icon.placedSymbolArray,Ce=m.transform.width/m.transform.height;let Ue,Xe=!1;for(let Ze=0;Ze<Le.length;Ze++){const tt=Le.get(Ze),{numGlyphs:ft,writingMode:lt}=tt;if(lt!==s.WritingMode.vertical||Xe||Ue===s.WritingMode.horizontal||(Xe=!0),Ue=lt,(tt.hidden||lt===s.WritingMode.vertical)&&!Xe){As(ft,Me);continue}Xe=!1;const it=new s.pointGeometry(tt.tileAnchorX,tt.tileAnchorY);let{x:Wt,y:ot,z:bt}=Y.projection.projectTilePoint(it.x,it.y,K.canonical);if(H){const[mn,cn,Fn]=H(it);Wt+=mn,ot+=cn,bt+=Fn}const mt=[Wt,ot,bt,1];if(s.transformMat4$1(mt,mt,h),!ni(mt,we)){As(ft,Me);continue}const Ut=Kt(m.transform.cameraToCenterDistance,mt[3]),gt=s.evaluateSizeForFeature(oe,me,tt),Lt=B?gt/Ut:gt*Ut,kt=qi(Wt,ot,bt,E);if(kt[3]<=0){As(ft,Me);continue}let Ye={};const at=B?null:H,Qt=ri(tt,Lt,!1,U,h,E,I,y.glyphOffsetArray,xe,Me,_e,kt,it,Ye,Ce,at,Y.projection,K,B);Xe=Qt.useVertical,at&&Qt.needsFlipping&&(Ye={}),(Qt.notEnoughRoom||Xe||Qt.needsFlipping&&ri(tt,Lt,!0,U,h,E,I,y.glyphOffsetArray,xe,Me,_e,kt,it,Ye,Ce,at,Y.projection,K,B).notEnoughRoom)&&As(ft,Me)}b?(y.text.dynamicLayoutVertexBuffer.updateData(Me),_e&&y.text.globeExtVertexBuffer.updateData(_e)):(y.icon.dynamicLayoutVertexBuffer.updateData(Me),_e&&y.icon.globeExtVertexBuffer.updateData(_e))}function uo(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me){const{lineStartIndex:_e,glyphStartIndex:xe,segment:Le}=U,Ce=xe+U.numGlyphs,Ue=_e+U.lineLength,Xe=h.getoffsetX(xe),Ze=h.getoffsetX(Ce-1),tt=ms(y*Xe,m,b,E,I,B,Le,_e,Ue,H,K,Y,oe,me,!0,be,we,Me);if(!tt)return null;const ft=ms(y*Ze,m,b,E,I,B,Le,_e,Ue,H,K,Y,oe,me,!0,be,we,Me);return ft?{first:tt,last:ft}:null}function Wl(y,h,m,b){return y===s.WritingMode.horizontal&&Math.abs(b)>Math.abs(m)?{useVertical:!0}:y===s.WritingMode.vertical?b>0?{needsFlipping:!0}:null:h!==0&&function(E,I){return E===0||Math.abs(I/E)>zi}(m,b)?h===1?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function ri(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me,_e,xe,Le){const Ce=h/24,Ue=y.lineOffsetX*Ce,Xe=y.lineOffsetY*Ce,{lineStartIndex:Ze,glyphStartIndex:tt,numGlyphs:ft,segment:lt,writingMode:it,flipState:Wt}=y,ot=Ze+y.lineLength,bt=mt=>{if(Y){const[kt,Ye,at]=mt.up,Qt=K.length;s.updateGlobeVertexNormal(Y,Qt+0,kt,Ye,at),s.updateGlobeVertexNormal(Y,Qt+1,kt,Ye,at),s.updateGlobeVertexNormal(Y,Qt+2,kt,Ye,at),s.updateGlobeVertexNormal(Y,Qt+3,kt,Ye,at)}const[Ut,gt,Lt]=mt.point;s.addDynamicAttributes(K,Ut,gt,Lt,mt.angle)};if(ft>1){const mt=uo(Ce,U,Ue,Xe,m,oe,me,y,H,I,be,Me,!1,_e,xe,Le);if(!mt)return{notEnoughRoom:!0};if(b&&!m){let[Ut,gt,Lt]=mt.first.point,[kt,Ye,at]=mt.last.point;[Ut,gt]=qi(Ut,gt,Lt,B),[kt,Ye]=qi(kt,Ye,at,B);const Qt=Wl(it,Wt,(kt-Ut)*we,Ye-gt);if(y.flipState=Qt&&Qt.needsFlipping?1:2,Qt)return Qt}bt(mt.first);for(let Ut=tt+1;Ut<tt+ft-1;Ut++){const gt=ms(Ce*U.getoffsetX(Ut),Ue,Xe,m,oe,me,lt,Ze,ot,H,I,be,Me,!1,!1,_e,xe,Le);if(!gt)return K.length-=4*(Ut-tt),{notEnoughRoom:!0};bt(gt)}bt(mt.last)}else{if(b&&!m){const Ut=qi(me.x,me.y,0,E),gt=Ze+lt+1,Lt=new s.pointGeometry(H.getx(gt),H.gety(gt)),kt=qi(Lt.x,Lt.y,0,E),Ye=kt[3]>0?kt:Rc(me,Lt,Ut,1,E,void 0,_e,xe.canonical),at=Wl(it,Wt,(Ye[0]-Ut[0])*we,Ye[1]-Ut[1]);if(y.flipState=at&&at.needsFlipping?1:2,at)return at}const mt=ms(Ce*U.getoffsetX(tt),Ue,Xe,m,oe,me,lt,Ze,ot,H,I,be,Me,!1,!1,_e,xe,Le);if(!mt)return{notEnoughRoom:!0};bt(mt)}return{}}function Hl(y,h,m,b,E){const{x:I,y:B,z:U}=b.projectTilePoint(y.x,y.y,h);if(!E)return qi(I,B,U,m);const[H,K,Y]=E(y);return qi(I+H,B+K,U+Y,m)}function Rc(y,h,m,b,E,I,B,U){const H=Hl(y.sub(h)._unit()._add(y),U,E,B,I);return s.sub(H,m,H),s.normalize(H,H),s.scaleAndAdd(H,m,H,b)}function ms(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me,_e,xe){const Le=b?y-h:y+h;let Ce=Le>0?1:-1,Ue=0;b&&(Ce*=-1,Ue=Math.PI),Ce<0&&(Ue+=Math.PI);let Xe=U+B+(Ce>0?0:1)|0,Ze=E,tt=E,ft=0,lt=0;const it=Math.abs(Le),Wt=[],ot=[];let bt=I,mt=bt;const Ut=()=>Rc(mt,bt,tt,it-ft+1,Y,me,Me,_e.canonical);for(;ft+lt<=it;){if(Xe+=Ce,Xe<U||Xe>=H)return null;if(tt=Ze,mt=bt,Wt.push(tt),be&&ot.push(mt),bt=new s.pointGeometry(K.getx(Xe),K.gety(Xe)),Ze=oe[Xe],!Ze){const Fn=Hl(bt,_e.canonical,Y,Me,me);Ze=Fn[3]>0?oe[Xe]=Fn:Ut()}ft+=lt,lt=s.distance(tt,Ze)}we&&me&&(oe[Xe]&&(Ze=Ut(),lt=s.distance(tt,Ze)),oe[Xe]=Ze);const gt=(it-ft)/lt,Lt=bt.sub(mt)._mult(gt)._add(mt),kt=s.sub([],Ze,tt),Ye=s.scaleAndAdd([],tt,kt,gt);let at=[0,0,1],Qt=kt[0],mn=kt[1];if(xe&&(at=Me.upVector(_e.canonical,Lt.x,Lt.y),at[0]!==0||at[1]!==0||at[2]!==1)){const Fn=[at[2],0,-at[0]],zn=s.cross([],at,Fn);s.normalize(Fn,Fn),s.normalize(zn,zn),Qt=s.dot(kt,Fn),mn=s.dot(kt,zn)}if(m){const Fn=s.cross([],at,kt);s.normalize(Fn,Fn),s.scaleAndAdd(Ye,Ye,Fn,m*Ce)}const cn=Ue+Math.atan2(mn,Qt);return Wt.push(Ye),be&&ot.push(Lt),{point:Ye,angle:cn,path:Wt,tilePath:ot,up:at}}function As(y,h){const m=h.length,b=m+4*y;h.resize(b),h.float32.fill(-1/0,4*m,4*b)}function br(y,h,m){const b=h[0],E=h[1];return y[0]=m[0]*b+m[4]*E+m[12],y[1]=m[1]*b+m[5]*E+m[13],y[3]=m[3]*b+m[7]*E+m[15],y}const Da=100;class jl{constructor(h,m,b=new Ni(h.width+200,h.height+200,25),E=new Ni(h.width+200,h.height+200,25)){this.transform=h,this.grid=b,this.ignoredGrid=E,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+Da,this.screenBottomBoundary=h.height+Da,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=m}placeCollisionBox(h,m,b,E,I,B,U,H){let K=b.projectedAnchorX,Y=b.projectedAnchorY,oe=b.projectedAnchorZ;const me=b.elevation,be=b.tileID,we=h.getProjection();if(me&&be){const[Ze,tt,ft]=we.upVector(be.canonical,b.tileAnchorX,b.tileAnchorY),lt=we.upVectorScale(be.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;K+=Ze*me*lt,Y+=tt*me*lt,oe+=ft*me*lt}const Me=this.projectAndGetPerspectiveRatio(U,K,Y,oe,b.tileID,we.name==="globe"||!!me||this.transform.pitch>0,we),_e=B*Me.perspectiveRatio,xe=(b.x1*m+E.x-b.padding)*_e+Me.point.x,Le=(b.y1*m+E.y-b.padding)*_e+Me.point.y,Ce=(b.x2*m+E.x+b.padding)*_e+Me.point.x,Ue=(b.y2*m+E.y+b.padding)*_e+Me.point.y,Xe=Me.perspectiveRatio<=.55||Me.occluded;return!this.isInsideGrid(xe,Le,Ce,Ue)||!I&&this.grid.hitTest(xe,Le,Ce,Ue,H)||Xe?{box:[],offscreen:!1,occluded:Me.occluded}:{box:[xe,Le,Ce,Ue],offscreen:this.isOffscreen(xe,Le,Ce,Ue),occluded:!1}}placeCollisionCircles(h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me){const _e=[],xe=this.transform.elevation,Le=h.getProjection(),Ce=xe?xe.getAtTileOffsetFunc(Me,this.transform.center.lat,this.transform.worldSize,Le):null,Ue=new s.pointGeometry(b.tileAnchorX,b.tileAnchorY);let{x:Xe,y:Ze,z:tt}=Le.projectTilePoint(Ue.x,Ue.y,Me.canonical);if(Ce){const[Lt,kt,Ye]=Ce(Ue);Xe+=Lt,Ze+=kt,tt+=Ye}const ft=Le.name==="globe",lt=this.projectAndGetPerspectiveRatio(U,Xe,Ze,tt,Me,ft||!!xe||this.transform.pitch>0,Le),{perspectiveRatio:it}=lt,Wt=(oe?B/it:B*it)/s.ONE_EM,ot=qi(Xe,Ze,tt,H),bt=lt.signedDistanceFromCamera>0?uo(Wt,I,b.lineOffsetX*Wt,b.lineOffsetY*Wt,!1,ot,Ue,b,E,H,{},xe&&!oe?Ce:null,oe&&!!xe,Le,Me,oe):null;let mt=!1,Ut=!1,gt=!0;if(bt&&!lt.occluded){const Lt=.5*be*it+we,kt=new s.pointGeometry(-100,-100),Ye=new s.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),at=new ir,{first:Qt,last:mn}=bt,cn=Qt.path.length;let Fn=[];for(let an=cn-1;an>=1;an--)Fn.push(Qt.path[an]);for(let an=1;an<mn.path.length;an++)Fn.push(mn.path[an]);const zn=2.5*Lt;K&&(Fn=Fn.map(([an,Li,bi],ki)=>(Ce&&!ft&&(bi=Ce(ki<cn-1?Qt.tilePath[cn-1-ki]:mn.tilePath[ki-cn+2])[2]),qi(an,Li,bi,K))),Fn.some(an=>an[3]<=0)&&(Fn=[]));let In=[];if(Fn.length>0){let an=1/0,Li=-1/0,bi=1/0,ki=-1/0;for(const si of Fn)an=Math.min(an,si[0]),bi=Math.min(bi,si[1]),Li=Math.max(Li,si[0]),ki=Math.max(ki,si[1]);Li>=kt.x&&an<=Ye.x&&ki>=kt.y&&bi<=Ye.y&&(In=[Fn.map(si=>new s.pointGeometry(si[0],si[1]))],(an<kt.x||Li>Ye.x||bi<kt.y||ki>Ye.y)&&(In=s.clipLine(In,kt.x,kt.y,Ye.x,Ye.y)))}for(const an of In){at.reset(an,.25*Lt);let Li=0;Li=at.length<=.5*Lt?1:Math.ceil(at.paddedLength/zn)+1;for(let bi=0;bi<Li;bi++){const ki=bi/Math.max(Li-1,1),si=at.lerp(ki),Us=si.x+Da,Js=si.y+Da;_e.push(Us,Js,Lt,0);const Xr=Us-Lt,Ro=Js-Lt,Zi=Us+Lt,Si=Js+Lt;if(gt=gt&&this.isOffscreen(Xr,Ro,Zi,Si),Ut=Ut||this.isInsideGrid(Xr,Ro,Zi,Si),!m&&this.grid.hitTestCircle(Us,Js,Lt,me)&&(mt=!0,!Y))return{circles:[],offscreen:!1,collisionDetected:mt,occluded:!1}}}}return{circles:!Y&&mt||!Ut?[]:_e,offscreen:gt,collisionDetected:mt,occluded:lt.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let b=1/0,E=1/0,I=-1/0,B=-1/0;for(const Y of h){const oe=new s.pointGeometry(Y.x+Da,Y.y+Da);b=Math.min(b,oe.x),E=Math.min(E,oe.y),I=Math.max(I,oe.x),B=Math.max(B,oe.y),m.push(oe)}const U=this.grid.query(b,E,I,B).concat(this.ignoredGrid.query(b,E,I,B)),H={},K={};for(const Y of U){const oe=Y.key;if(H[oe.bucketInstanceId]===void 0&&(H[oe.bucketInstanceId]={}),H[oe.bucketInstanceId][oe.featureIndex])continue;const me=[new s.pointGeometry(Y.x1,Y.y1),new s.pointGeometry(Y.x2,Y.y1),new s.pointGeometry(Y.x2,Y.y2),new s.pointGeometry(Y.x1,Y.y2)];s.polygonIntersectsPolygon(m,me)&&(H[oe.bucketInstanceId][oe.featureIndex]=!0,K[oe.bucketInstanceId]===void 0&&(K[oe.bucketInstanceId]=[]),K[oe.bucketInstanceId].push(oe.featureIndex))}return K}insertCollisionBox(h,m,b,E,I){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:b,featureIndex:E,collisionGroupID:I},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,m,b,E,I){const B=m?this.ignoredGrid:this.grid,U={bucketInstanceId:b,featureIndex:E,collisionGroupID:I};for(let H=0;H<h.length;H+=4)B.insertCircle(U,h[H],h[H+1],h[H+2])}projectAndGetPerspectiveRatio(h,m,b,E,I,B,U){const H=[m,b,E,1];let K=!1;if(E||this.transform.pitch>0){s.transformMat4$1(H,H,h);const oe=U.name==="globe";this.fogState&&I&&!oe&&(K=function(be,we,Me,_e,xe,Le){const Ce=Le.calculateFogTileMatrix(xe),Ue=[we,Me,_e];return s.transformMat4(Ue,Ue,Ce),ce(be,Ue,Le.pitch,Le._fov)}(this.fogState,m,b,E,I.toUnwrapped(),this.transform)>.9)}else br(H,H,h);const Y=H[3];return{point:new s.pointGeometry((H[0]/Y+1)/2*this.transform.width+Da,(-H[1]/Y+1)/2*this.transform.height+Da),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(U)/Y*.5,1.5),signedDistanceFromCamera:Y,occluded:B&&H[2]>Y||K}}isOffscreen(h,m,b,E){return b<Da||h>=this.screenRightBoundary||E<Da||m>this.screenBottomBoundary}isInsideGrid(h,m,b,E){return b>=0&&h<this.gridRightBoundary&&E>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const h=s.identity([]);return s.translate(h,h,[-100,-100,0]),h}}function ql(y,h,m){const b=h.createTileMatrix(y,y.worldSize,m.toUnwrapped());return s.multiply(new Float32Array(16),y.projMatrix,b)}function sl(y,h,m){if(h.projection.name===m.projection.name)return y.projMatrix;const b=m.clone();return b.setProjection(h.projection),ql(b,h.getProjection(),y)}function Zl(y,h,m){return h.name===m.projection.name?y.projMatrix:ql(m,h,y)}class jp{constructor(h,m,b,E){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?m:-m))):E&&b?1:0,this.placed=b}isHidden(){return this.opacity===0&&!this.placed}}class Xl{constructor(h,m,b,E,I,B=!1){this.text=new jp(h?h.text:null,m,b,I),this.icon=new jp(h?h.icon:null,m,E,I),this.clipped=B}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zc{constructor(h,m,b,E=!1){this.text=h,this.icon=m,this.skipFade=b,this.clipped=E}}class Nu{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Oc{constructor(h,m,b,E,I){this.bucketInstanceId=h,this.featureIndex=m,this.sourceLayerIndex=b,this.bucketIndex=E,this.tileID=I}}class ho{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const m=++this.maxGroupID;this.collisionGroups[h]={ID:m,predicate:b=>b.collisionGroupID===m}}return this.collisionGroups[h]}}function Sr(y,h,m,b,E){const{horizontalAlign:I,verticalAlign:B}=s.getAnchorAlignment(y),U=-(I-.5)*h,H=-(B-.5)*m,K=s.evaluateVariableOffset(y,b);return new s.pointGeometry(U+K[0]*E,H+K[1]*E)}function Ai(y,h,m,b,E){const I=new s.pointGeometry(y,h);return m&&I._rotate(b?E:-E),I}class rf{constructor(h,m,b,E,I){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new jl(this.transform,I),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new ho(b),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,m,b,E){const I=b.getBucket(m),B=b.latestFeatureIndex;if(!I||!B||m.id!==I.layerIds[0])return;const U=I.layers[0].layout,H=b.collisionBoxArray,K=Math.pow(2,this.transform.zoom-b.tileID.overscaledZ),Y=b.tileSize/s.EXTENT,oe=b.tileID.toUnwrapped();this.transform.setProjection(I.projection);const me=(be=b.tileID,we=I.getProjection(),Me=this.transform,we.name===this.projection?Me.calculateProjMatrix(be.toUnwrapped()):ql(Me,we,be));var be,we,Me;const _e=U.get("text-pitch-alignment")==="map",xe=U.get("text-rotation-alignment")==="map";m.compileFilter();const Le=m.dynamicFilter(),Ce=m.dynamicFilterNeedsFeature(),Ue=this.transform.calculatePixelsToTileUnitsMatrix(b),Xe=wr(me,b.tileID.canonical,_e,xe,this.transform,I.getProjection(),Ue);let Ze=null;if(_e){const lt=Ur(me,b.tileID.canonical,_e,xe,this.transform,I.getProjection(),Ue);Ze=s.multiply([],this.transform.labelPlaneMatrix,lt)}let tt=null;Le&&b.latestFeatureIndex&&(tt={unwrappedTileID:oe,dynamicFilter:Le,dynamicFilterNeedsFeature:Ce,featureIndex:b.latestFeatureIndex}),this.retainedQueryData[I.bucketInstanceId]=new Oc(I.bucketInstanceId,B,I.sourceLayerIndex,I.index,b.tileID);const ft={bucket:I,layout:U,posMatrix:me,textLabelPlaneMatrix:Xe,labelToScreenMatrix:Ze,clippingData:tt,scale:K,textPixelRatio:Y,holdingForFade:b.holdingForFade(),collisionBoxArray:H,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(I.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(I.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(I.sourceID)};if(E)for(const lt of I.sortKeyRanges){const{sortKey:it,symbolInstanceStart:Wt,symbolInstanceEnd:ot}=lt;h.push({sortKey:it,symbolInstanceStart:Wt,symbolInstanceEnd:ot,parameters:ft})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:ft})}attemptAnchorPlacement(h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me,_e,xe,Le){const{textOffset0:Ce,textOffset1:Ue,crossTileID:Xe}=me,Ze=[Ce,Ue],tt=Sr(h,b,E,Ze,I),ft=this.collisionIndex.placeCollisionBox(we,I,m,Ai(tt.x,tt.y,B,U,this.transform.angle),oe,H,K,Y.predicate);if(_e){const lt=we.getSymbolInstanceIconSize(Le,this.transform.zoom,me.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(we,lt,_e,Ai(tt.x,tt.y,B,U,this.transform.angle),oe,H,K,Y.predicate).box.length===0)return}if(ft.box.length>0){let lt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Xe]&&this.prevPlacement.placements[Xe]&&this.prevPlacement.placements[Xe].text&&(lt=this.prevPlacement.variableOffsets[Xe].anchor),this.variableOffsets[Xe]={textOffset:Ze,width:b,height:E,anchor:h,textScale:I,prevAnchor:lt},this.markUsedJustification(we,h,me,Me),we.allowVerticalPlacement&&(this.markUsedOrientation(we,Me,me),this.placedOrientations[Xe]=Me),{shift:tt,placedGlyphBoxes:ft}}}placeLayerBucketPart(h,m,b,E){const{bucket:I,layout:B,posMatrix:U,textLabelPlaneMatrix:H,labelToScreenMatrix:K,clippingData:Y,textPixelRatio:oe,holdingForFade:me,collisionBoxArray:be,partiallyEvaluatedTextSize:we,partiallyEvaluatedIconSize:Me,collisionGroup:_e}=h.parameters,xe=B.get("text-optional"),Le=B.get("icon-optional"),Ce=B.get("text-allow-overlap"),Ue=B.get("icon-allow-overlap"),Xe=B.get("text-rotation-alignment")==="map",Ze=B.get("text-pitch-alignment")==="map",tt=B.get("icon-text-fit")!=="none",ft=B.get("symbol-z-order")==="viewport-y";this.transform.setProjection(I.projection);let lt=Ce&&(Ue||!I.hasIconData()||Le),it=Ue&&(Ce||!I.hasTextData()||xe);!I.collisionArrays&&be&&I.deserializeCollisionBoxes(be),b&&E&&I.updateCollisionDebugBuffers(this.transform.zoom,be);const Wt=(ot,bt,mt)=>{const{crossTileID:Ut,numVerticalGlyphVertices:gt}=ot;if(Y){const Zi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Si=null;if(Y.dynamicFilterNeedsFeature){const xi=this.retainedQueryData[I.bucketInstanceId];Si=Y.featureIndex.loadFeature({featureIndex:ot.featureIndex,bucketIndex:xi.bucketIndex,sourceLayerIndex:xi.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,Y.dynamicFilter)(Zi,Si,this.retainedQueryData[I.bucketInstanceId].tileID.canonical,new s.pointGeometry(ot.tileAnchorX,ot.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[Ut]=new zc(!1,!1,!1,!0),void(m[Ut]=!0)}if(m[Ut])return;if(me)return void(this.placements[Ut]=new zc(!1,!1,!1));let Lt=!1,kt=!1,Ye=!0,at=!1,Qt=!1,mn=null,cn={box:null,offscreen:null,occluded:null},Fn={box:null,offscreen:null,occluded:null},zn=null,In=null,an=null,Li=0,bi=0,ki=0;mt.textFeatureIndex?Li=mt.textFeatureIndex:ot.useRuntimeCollisionCircles&&(Li=ot.featureIndex),mt.verticalTextFeatureIndex&&(bi=mt.verticalTextFeatureIndex);const si=Zi=>{Zi.tileID=this.retainedQueryData[I.bucketInstanceId].tileID;const Si=this.transform.elevation;(Si||Zi.elevation)&&(Zi.elevation=Si?Si.getAtTileOffset(Zi.tileID,Zi.tileAnchorX,Zi.tileAnchorY):0)},Us=mt.textBox;if(Us){si(Us);const Zi=xi=>{let rr=s.WritingMode.horizontal;if(I.allowVerticalPlacement&&!xi&&this.prevPlacement){const is=this.prevPlacement.placedOrientations[Ut];is&&(this.placedOrientations[Ut]=is,rr=is,this.markUsedOrientation(I,rr,ot))}return rr},Si=(xi,rr)=>{if(I.allowVerticalPlacement&&gt>0&&mt.verticalTextBox){for(const is of I.writingModes)if(is===s.WritingMode.vertical?(cn=rr(),Fn=cn):cn=xi(),cn&&cn.box&&cn.box.length)break}else cn=xi()};if(B.get("text-variable-anchor")){let xi=B.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ut]){const Oi=this.prevPlacement.variableOffsets[Ut];xi.indexOf(Oi.anchor)>0&&(xi=xi.filter(Ls=>Ls!==Oi.anchor),xi.unshift(Oi.anchor))}const rr=(Oi,Ls,ic)=>{const $o=I.getSymbolInstanceTextSize(we,ot,this.transform.zoom,bt),Xi=(Oi.x2-Oi.x1)*$o+2*Oi.padding,rs=(Oi.y2-Oi.y1)*$o+2*Oi.padding,Vr=tt&&!Ue?Ls:null;Vr&&si(Vr);let zo={box:[],offscreen:!1,occluded:!1};const ys=Ce?2*xi.length:xi.length;for(let su=0;su<ys;++su){const Yo=this.attemptAnchorPlacement(xi[su%xi.length],Oi,Xi,rs,$o,Xe,Ze,oe,U,_e,su>=xi.length,ot,bt,I,ic,Vr,we,Me);if(Yo&&(zo=Yo.placedGlyphBoxes,zo&&zo.box&&zo.box.length)){Lt=!0,mn=Yo.shift;break}}return zo};Si(()=>rr(Us,mt.iconBox,s.WritingMode.horizontal),()=>{const Oi=mt.verticalTextBox;return Oi&&si(Oi),I.allowVerticalPlacement&&!(cn&&cn.box&&cn.box.length)&&gt>0&&Oi?rr(Oi,mt.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),cn&&(Lt=cn.box,Ye=cn.offscreen,at=cn.occluded);const is=Zi(cn&&cn.box);if(!Lt&&this.prevPlacement){const Oi=this.prevPlacement.variableOffsets[Ut];Oi&&(this.variableOffsets[Ut]=Oi,this.markUsedJustification(I,Oi.anchor,ot,is))}}else{const xi=(rr,is)=>{const Oi=I.getSymbolInstanceTextSize(we,ot,this.transform.zoom,bt),Ls=this.collisionIndex.placeCollisionBox(I,Oi,rr,new s.pointGeometry(0,0),Ce,oe,U,_e.predicate);return Ls&&Ls.box&&Ls.box.length&&(this.markUsedOrientation(I,is,ot),this.placedOrientations[Ut]=is),Ls};Si(()=>xi(Us,s.WritingMode.horizontal),()=>{const rr=mt.verticalTextBox;return I.allowVerticalPlacement&&gt>0&&rr?(si(rr),xi(rr,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Zi(cn&&cn.box&&cn.box.length)}}if(zn=cn,Lt=zn&&zn.box&&zn.box.length>0,Ye=zn&&zn.offscreen,at=zn&&zn.occluded,ot.useRuntimeCollisionCircles){const Zi=I.text.placedSymbolArray.get(ot.centerJustifiedTextSymbolIndex>=0?ot.centerJustifiedTextSymbolIndex:ot.verticalPlacedTextSymbolIndex),Si=s.evaluateSizeForFeature(I.textSizeData,we,Zi),xi=B.get("text-padding");In=this.collisionIndex.placeCollisionCircles(I,Ce,Zi,I.lineVertexArray,I.glyphOffsetArray,Si,U,H,K,b,Ze,_e.predicate,ot.collisionCircleDiameter*Si/s.ONE_EM,xi,this.retainedQueryData[I.bucketInstanceId].tileID),Lt=Ce||In.circles.length>0&&!In.collisionDetected,Ye=Ye&&In.offscreen,at=In.occluded}if(mt.iconFeatureIndex&&(ki=mt.iconFeatureIndex),mt.iconBox){const Zi=Si=>{si(Si);const xi=tt&&mn?Ai(mn.x,mn.y,Xe,Ze,this.transform.angle):new s.pointGeometry(0,0),rr=I.getSymbolInstanceIconSize(Me,this.transform.zoom,ot.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(I,rr,Si,xi,Ue,oe,U,_e.predicate)};Fn&&Fn.box&&Fn.box.length&&mt.verticalIconBox?(an=Zi(mt.verticalIconBox),kt=an.box.length>0):(an=Zi(mt.iconBox),kt=an.box.length>0),Ye=Ye&&an.offscreen,Qt=an.occluded}const Js=xe||ot.numHorizontalGlyphVertices===0&&gt===0,Xr=Le||ot.numIconVertices===0;if(Js||Xr?Xr?Js||(kt=kt&&Lt):Lt=kt&&Lt:kt=Lt=kt&&Lt,Lt&&zn&&zn.box&&this.collisionIndex.insertCollisionBox(zn.box,B.get("text-ignore-placement"),I.bucketInstanceId,Fn&&Fn.box&&bi?bi:Li,_e.ID),kt&&an&&this.collisionIndex.insertCollisionBox(an.box,B.get("icon-ignore-placement"),I.bucketInstanceId,ki,_e.ID),In&&(Lt&&this.collisionIndex.insertCollisionCircles(In.circles,B.get("text-ignore-placement"),I.bucketInstanceId,Li,_e.ID),b)){const Zi=I.bucketInstanceId;let Si=this.collisionCircleArrays[Zi];Si===void 0&&(Si=this.collisionCircleArrays[Zi]=new Nu);for(let xi=0;xi<In.circles.length;xi+=4)Si.circles.push(In.circles[xi+0]),Si.circles.push(In.circles[xi+1]),Si.circles.push(In.circles[xi+2]),Si.circles.push(In.collisionDetected?1:0)}const Ro=I.projection.name!=="globe";lt=lt&&(Ro||!at),it=it&&(Ro||!Qt),this.placements[Ut]=new zc(Lt||lt,kt||it,Ye||I.justReloaded),m[Ut]=!0};if(ft){const ot=I.getSortedSymbolIndexes(this.transform.angle);for(let bt=ot.length-1;bt>=0;--bt){const mt=ot[bt];Wt(I.symbolInstances.get(mt),mt,I.collisionArrays[mt])}}else for(let ot=h.symbolInstanceStart;ot<h.symbolInstanceEnd;ot++)Wt(I.symbolInstances.get(ot),ot,I.collisionArrays[ot]);if(b&&I.bucketInstanceId in this.collisionCircleArrays){const ot=this.collisionCircleArrays[I.bucketInstanceId];s.invert(ot.invProjMatrix,U),ot.viewportMatrix=this.collisionIndex.getViewportMatrix()}I.justReloaded=!1}markUsedJustification(h,m,b,E){const{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:B,rightJustifiedTextSymbolIndex:U,verticalPlacedTextSymbolIndex:H,crossTileID:K}=b,Y=s.getAnchorJustification(m),oe=E===s.WritingMode.vertical?H:Y==="left"?I:Y==="center"?B:Y==="right"?U:-1;I>=0&&(h.text.placedSymbolArray.get(I).crossTileID=oe>=0&&I!==oe?0:K),B>=0&&(h.text.placedSymbolArray.get(B).crossTileID=oe>=0&&B!==oe?0:K),U>=0&&(h.text.placedSymbolArray.get(U).crossTileID=oe>=0&&U!==oe?0:K),H>=0&&(h.text.placedSymbolArray.get(H).crossTileID=oe>=0&&H!==oe?0:K)}markUsedOrientation(h,m,b){const E=m===s.WritingMode.horizontal||m===s.WritingMode.horizontalOnly?m:0,I=m===s.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:B,centerJustifiedTextSymbolIndex:U,rightJustifiedTextSymbolIndex:H,verticalPlacedTextSymbolIndex:K}=b,Y=h.text.placedSymbolArray;B>=0&&(Y.get(B).placedOrientation=E),U>=0&&(Y.get(U).placedOrientation=E),H>=0&&(Y.get(H).placedOrientation=E),K>=0&&(Y.get(K).placedOrientation=I)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let b=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const E=m?m.symbolFadeChange(h):1,I=m?m.opacities:{},B=m?m.variableOffsets:{},U=m?m.placedOrientations:{};for(const H in this.placements){const K=this.placements[H],Y=I[H];Y?(this.opacities[H]=new Xl(Y,E,K.text,K.icon,null,K.clipped),b=b||K.text!==Y.text.placed||K.icon!==Y.icon.placed):(this.opacities[H]=new Xl(null,E,K.text,K.icon,K.skipFade,K.clipped),b=b||K.text||K.icon)}for(const H in I){const K=I[H];if(!this.opacities[H]){const Y=new Xl(K,E,!1,!1);Y.isHidden()||(this.opacities[H]=Y,b=b||K.text.placed||K.icon.placed)}}for(const H in B)this.variableOffsets[H]||!this.opacities[H]||this.opacities[H].isHidden()||(this.variableOffsets[H]=B[H]);for(const H in U)this.placedOrientations[H]||!this.opacities[H]||this.opacities[H].isHidden()||(this.placedOrientations[H]=U[H]);b?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:h)}updateLayerOpacities(h,m){const b={};for(const E of m){const I=E.getBucket(h);I&&E.latestFeatureIndex&&h.id===I.layerIds[0]&&this.updateBucketOpacities(I,b,E.collisionBoxArray)}}updateBucketOpacities(h,m,b){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const E=h.layers[0].layout,I=!!h.layers[0].dynamicFilter(),B=new Xl(null,0,!1,!1,!0),U=E.get("text-allow-overlap"),H=E.get("icon-allow-overlap"),K=E.get("text-variable-anchor"),Y=E.get("text-rotation-alignment")==="map",oe=E.get("text-pitch-alignment")==="map",me=E.get("icon-text-fit")!=="none",be=new Xl(null,0,U&&(H||!h.hasIconData()||E.get("icon-optional")),H&&(U||!h.hasTextData()||E.get("text-optional")),!0);!h.collisionArrays&&b&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(b);const we=(_e,xe,Le)=>{for(let Ce=0;Ce<xe/4;Ce++)_e.opacityVertexArray.emplaceBack(Le)};let Me=0;for(let _e=0;_e<h.symbolInstances.length;_e++){const xe=h.symbolInstances.get(_e),{numHorizontalGlyphVertices:Le,numVerticalGlyphVertices:Ce,crossTileID:Ue,numIconVertices:Xe}=xe;let Ze=this.opacities[Ue];m[Ue]?Ze=B:Ze||(Ze=be,this.opacities[Ue]=Ze),m[Ue]=!0;const tt=Le>0||Ce>0,ft=Xe>0,lt=this.placedOrientations[Ue],it=lt===s.WritingMode.vertical,Wt=lt===s.WritingMode.horizontal||lt===s.WritingMode.horizontalOnly;if(!tt&&!ft||Ze.isHidden()||Me++,tt){const ot=gs(Ze.text);we(h.text,Le,it?ol:ot),we(h.text,Ce,Wt?ol:ot);const bt=Ze.text.isHidden(),{leftJustifiedTextSymbolIndex:mt,centerJustifiedTextSymbolIndex:Ut,rightJustifiedTextSymbolIndex:gt,verticalPlacedTextSymbolIndex:Lt}=xe,kt=h.text.placedSymbolArray,Ye=bt||it?1:0;mt>=0&&(kt.get(mt).hidden=Ye),Ut>=0&&(kt.get(Ut).hidden=Ye),gt>=0&&(kt.get(gt).hidden=Ye),Lt>=0&&(kt.get(Lt).hidden=bt||Wt?1:0);const at=this.variableOffsets[Ue];at&&this.markUsedJustification(h,at.anchor,xe,lt);const Qt=this.placedOrientations[Ue];Qt&&(this.markUsedJustification(h,"left",xe,Qt),this.markUsedOrientation(h,Qt,xe))}if(ft){const ot=gs(Ze.icon),{placedIconSymbolIndex:bt,verticalPlacedIconSymbolIndex:mt}=xe,Ut=h.icon.placedSymbolArray,gt=Ze.icon.isHidden()?1:0;bt>=0&&(we(h.icon,Xe,it?ol:ot),Ut.get(bt).hidden=gt),mt>=0&&(we(h.icon,xe.numVerticalIconVertices,Wt?ol:ot),Ut.get(mt).hidden=gt)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const ot=h.collisionArrays[_e];if(ot){let bt=new s.pointGeometry(0,0),mt=!0;if(ot.textBox||ot.verticalTextBox){if(K){const gt=this.variableOffsets[Ue];gt?(bt=Sr(gt.anchor,gt.width,gt.height,gt.textOffset,gt.textScale),Y&&bt._rotate(oe?this.transform.angle:-this.transform.angle)):mt=!1}I&&(mt=!Ze.clipped),ot.textBox&&ts(h.textCollisionBox.collisionVertexArray,Ze.text.placed,!mt||it,bt.x,bt.y),ot.verticalTextBox&&ts(h.textCollisionBox.collisionVertexArray,Ze.text.placed,!mt||Wt,bt.x,bt.y)}const Ut=mt&&Boolean(!Wt&&ot.verticalIconBox);ot.iconBox&&ts(h.iconCollisionBox.collisionVertexArray,Ze.icon.placed,Ut,me?bt.x:0,me?bt.y:0),ot.verticalIconBox&&ts(h.iconCollisionBox.collisionVertexArray,Ze.icon.placed,!Ut,me?bt.x:0,me?bt.y:0)}}}if(h.fullyClipped=Me===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const _e=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=_e.invProjMatrix,h.placementViewportMatrix=_e.viewportMatrix,h.collisionCircleArray=_e.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,m){const b=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*b>h}setStale(){this.stale=!0}}function ts(y,h,m,b,E){y.emplaceBack(h?1:0,m?1:0,b||0,E||0),y.emplaceBack(h?1:0,m?1:0,b||0,E||0),y.emplaceBack(h?1:0,m?1:0,b||0,E||0),y.emplaceBack(h?1:0,m?1:0,b||0,E||0)}const Io=Math.pow(2,25),Og=Math.pow(2,24),sf=Math.pow(2,17),wi=Math.pow(2,16),Fc=Math.pow(2,9),qp=Math.pow(2,8),Bc=Math.pow(2,1);function gs(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const h=y.placed?1:0,m=Math.floor(127*y.opacity);return m*Io+h*Og+m*sf+h*wi+m*Fc+h*qp+m*Bc+h}const ol=0;class Wo{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(h,m,b,E,I){const B=this._bucketParts;for(;this._currentTileIndex<h.length;)if(m.getBucketParts(B,E,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,I())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,B.sort((U,H)=>U.sortKey-H.sortKey));this._currentPartIndex<B.length;){const U=B[this._currentPartIndex];if(m.placeLayerBucketPart(U,this._seenCrossTileIDs,b,U.symbolInstanceStart===0),this._currentPartIndex++,I())return!0}return!1}}class al{constructor(h,m,b,E,I,B,U,H){this.placement=new rf(h,I,B,U,H),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=b,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(h,m,b){const E=s.exported.now(),I=()=>{const B=s.exported.now()-E;return!this._forceFullPlacement&&B>2};for(;this._currentPlacementIndex>=0;){const B=m[h[this._currentPlacementIndex]],U=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=U)&&(!B.maxzoom||B.maxzoom>U)){if(this._inProgressLayer||(this._inProgressLayer=new Wo(B)),this._inProgressLayer.continuePlacement(b[B.source],this.placement,this._showCollisionBoxes,B,I))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Dh=512/s.EXTENT/2;class Po{constructor(h,m,b){this.tileID=h,this.indexedSymbolInstances={},this.bucketInstanceId=b;for(let E=0;E<m.length;E++){const I=m.get(E),B=I.key;this.indexedSymbolInstances[B]||(this.indexedSymbolInstances[B]=[]),this.indexedSymbolInstances[B].push({crossTileID:I.crossTileID,coord:this.getScaledCoordinates(I,h)})}}getScaledCoordinates(h,m){const b=Dh/Math.pow(2,m.canonical.z-this.tileID.canonical.z);return{x:Math.floor((m.canonical.x*s.EXTENT+h.tileAnchorX)*b),y:Math.floor((m.canonical.y*s.EXTENT+h.tileAnchorY)*b)}}findMatches(h,m,b){const E=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let I=0;I<h.length;I++){const B=h.get(I);if(B.crossTileID)continue;const U=this.indexedSymbolInstances[B.key];if(!U)continue;const H=this.getScaledCoordinates(B,m);for(const K of U)if(Math.abs(K.coord.x-H.x)<=E&&Math.abs(K.coord.y-H.y)<=E&&!b[K.crossTileID]){b[K.crossTileID]=!0,B.crossTileID=K.crossTileID;break}}}}class ll{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Uu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const m=Math.round((h-this.lng)/360);if(m!==0)for(const b in this.indexes){const E=this.indexes[b],I={};for(const B in E){const U=E[B];U.tileID=U.tileID.unwrapTo(U.tileID.wrap+m),I[U.tileID.key]=U}this.indexes[b]=I}this.lng=h}addBucket(h,m,b){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let I=0;I<m.symbolInstances.length;I++)m.symbolInstances.get(I).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]={});const E=this.usedCrossTileIDs[h.overscaledZ];for(const I in this.indexes){const B=this.indexes[I];if(Number(I)>h.overscaledZ)for(const U in B){const H=B[U];H.tileID.isChildOf(h)&&H.findMatches(m.symbolInstances,h,E)}else{const U=B[h.scaledTo(Number(I)).key];U&&U.findMatches(m.symbolInstances,h,E)}}for(let I=0;I<m.symbolInstances.length;I++){const B=m.symbolInstances.get(I);B.crossTileID||(B.crossTileID=b.generate(),E[B.crossTileID]=!0)}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new Po(h,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(h,m){for(const b in m.indexedSymbolInstances)for(const E of m.indexedSymbolInstances[b])delete this.usedCrossTileIDs[h][E.crossTileID]}removeStaleBuckets(h){let m=!1;for(const b in this.indexes){const E=this.indexes[b];for(const I in E)h[E[I].bucketInstanceId]||(this.removeBucketCrossTileIDs(b,E[I]),delete E[I],m=!0)}return m}}class cl{constructor(){this.layerIndexes={},this.crossTileIDs=new ll,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,m,b,E){let I=this.layerIndexes[h.id];I===void 0&&(I=this.layerIndexes[h.id]=new Uu);let B=!1;const U={};E.name!=="globe"&&I.handleWrapJump(b);for(const H of m){const K=H.getBucket(h);K&&h.id===K.layerIds[0]&&(K.bucketInstanceId||(K.bucketInstanceId=++this.maxBucketInstanceId),I.addBucket(H.tileID,K,this.crossTileIDs)&&(B=!0),U[K.bucketInstanceId]=!0)}return I.removeStaleBuckets(U)&&(B=!0),B}pruneUnusedLayers(h){const m={};h.forEach(b=>{m[b]=!0});for(const b in this.layerIndexes)m[b]||delete this.layerIndexes[b]}}const Rh=(y,h)=>s.emitValidationErrors(y,h&&h.filter(m=>m.identifier!=="source.canvas")),Fg=s.pick(Sn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Xs=s.pick(Sn,["setCenter","setZoom","setBearing","setPitch"]),$l={version:8,layers:[],sources:{}},Nc={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Cs extends s.Evented{constructor(h,m={}){super(),this.map=h,this.dispatcher=new nt(gn(),this),this.imageManager=new De,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(h._requestManager,m.localFontFamily?s.LocalGlyphMode.all:m.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new cl,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const b=this;this._rtlTextPluginCallback=Cs.registerForPluginStateChange(E=>{b.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(I,B)=>{if(s.triggerPluginCompletionEvent(I),B&&B.every(U=>U))for(const U in b._sourceCaches){const H=b._sourceCaches[U],K=H.getSource().type;K!=="vector"&&K!=="geojson"||H.reload()}})}),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const I=this.getSource(E.sourceId);if(I&&I.vectorLayerIds)for(const B in this._layers){const U=this._layers[B];U.source===I.id&&this._validateLayer(U)}})}loadURL(h,m={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const b=typeof m.validate=="boolean"?m.validate:!s.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,m.accessToken);const E=this.map._requestManager.transformRequest(h,s.ResourceType.Style);this._request=s.getJSON(E,(I,B)=>{this._request=null,I?this.fire(new s.ErrorEvent(I)):B&&this._load(B,b)})}loadJSON(h,m={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(h,m.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load($l,!1)}_updateLayerCount(h,m){const b=m?1:-1;h.is3D()&&(this._num3DLayers+=b),h.type==="circle"&&(this._numCircleLayers+=b),h.type==="symbol"&&(this._numSymbolLayers+=b)}_load(h,m){if(m&&Rh(this,s.validateStyle(h)))return;this._loaded=!0,this.stylesheet=s.clone$1(h),this._updateMapProjection();for(const E in h.sources)this.addSource(E,h.sources[E],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const b=ii(this.stylesheet.layers);this._order=b.map(E=>E.id),this._layers={},this._serializedLayers={};for(let E of b)E=s.createStyleLayer(E),E.setEventedParent(this,{layer:{id:E.id}}),this._layers[E.id]=E,this._serializedLayers[E.id]=E.serialize(),this._updateLayerCount(E,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new le(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(m,b,E){let I,B,U;const H=s.exported.devicePixelRatio>1?"@2x":"";let K=s.getJSON(b.transformRequest(b.normalizeSpriteURL(m,H,".json"),s.ResourceType.SpriteJSON),(me,be)=>{K=null,U||(U=me,I=be,oe())}),Y=s.getImage(b.transformRequest(b.normalizeSpriteURL(m,H,".png"),s.ResourceType.SpriteImage),(me,be)=>{Y=null,U||(U=me,B=be,oe())});function oe(){if(U)E(U);else if(I&&B){const me=s.exported.getImageData(B),be={};for(const we in I){const{width:Me,height:_e,x:xe,y:Le,sdf:Ce,pixelRatio:Ue,stretchX:Xe,stretchY:Ze,content:tt}=I[we],ft=new s.RGBAImage({width:Me,height:_e});s.RGBAImage.copy(me,ft,{x:xe,y:Le},{x:0,y:0},{width:Me,height:_e}),be[we]={data:ft,pixelRatio:Ue,sdf:Ce,stretchX:Xe,stretchY:Ze,content:tt}}E(null,be)}}return{cancel(){K&&(K.cancel(),K=null),Y&&(Y.cancel(),Y=null)}}}(h,this.map._requestManager,(m,b)=>{if(this._spriteRequest=null,m)this.fire(new s.ErrorEvent(m));else if(b)for(const E in b)this.imageManager.addImage(E,b[E]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(h){const m=this.getSource(h.source);if(!m)return;const b=h.sourceLayer;b&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(b)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${b}" does not exist on source "${m.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const m=[];for(const b of h){const E=this._layers[b];E.type!=="custom"&&m.push(E.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&Nc[h.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const m=this._changed;if(this._changed){const E=Object.keys(this._updatedLayers),I=Object.keys(this._removedLayers);(E.length||I.length)&&this._updateWorkerLayers(E,I);for(const B in this._updatedSources){const U=this._updatedSources[B];U==="reload"?this._reloadSource(B):U==="clear"&&this._clearSource(B)}this._updateTilesForChangedImages();for(const B in this._updatedPaintProps)this._layers[B].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const b={};for(const E in this._sourceCaches){const I=this._sourceCaches[E];b[E]=I.used,I.used=!1}for(const E of this._order){const I=this._layers[E];if(I.recalculate(h,this._availableImages),!I.isHidden(h.zoom)){const U=this._getLayerSourceCache(I);U&&(U.used=!0)}const B=this.map.painter;if(B){const U=I.getProgramIds();if(!U)continue;const H=I.getProgramConfiguration(h.zoom);for(const K of U)B.useProgram(K,H)}}for(const E in b){const I=this._sourceCaches[E];b[E]!==I.used&&I.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),Rh(this,s.validateStyle(h)))return!1;(h=s.clone$1(h)).layers=ii(h.layers);const m=function(E,I){if(!E)return[{command:Sn.setStyle,args:[I]}];let B=[];try{if(!d(E.version,I.version))return[{command:Sn.setStyle,args:[I]}];d(E.center,I.center)||B.push({command:Sn.setCenter,args:[I.center]}),d(E.zoom,I.zoom)||B.push({command:Sn.setZoom,args:[I.zoom]}),d(E.bearing,I.bearing)||B.push({command:Sn.setBearing,args:[I.bearing]}),d(E.pitch,I.pitch)||B.push({command:Sn.setPitch,args:[I.pitch]}),d(E.sprite,I.sprite)||B.push({command:Sn.setSprite,args:[I.sprite]}),d(E.glyphs,I.glyphs)||B.push({command:Sn.setGlyphs,args:[I.glyphs]}),d(E.transition,I.transition)||B.push({command:Sn.setTransition,args:[I.transition]}),d(E.light,I.light)||B.push({command:Sn.setLight,args:[I.light]}),d(E.fog,I.fog)||B.push({command:Sn.setFog,args:[I.fog]}),d(E.projection,I.projection)||B.push({command:Sn.setProjection,args:[I.projection]});const U={},H=[];(function(oe,me,be,we){let Me;for(Me in me=me||{},oe=oe||{})oe.hasOwnProperty(Me)&&(me.hasOwnProperty(Me)||kn(Me,be,we));for(Me in me)me.hasOwnProperty(Me)&&(oe.hasOwnProperty(Me)?d(oe[Me],me[Me])||(oe[Me].type==="geojson"&&me[Me].type==="geojson"&&nr(oe,me,Me)?be.push({command:Sn.setGeoJSONSourceData,args:[Me,me[Me].data]}):ps(Me,me,be,we)):Jn(Me,me,be))})(E.sources,I.sources,H,U);const K=[];E.layers&&E.layers.forEach(oe=>{oe.source&&U[oe.source]?B.push({command:Sn.removeLayer,args:[oe.id]}):K.push(oe)});let Y=E.terrain;Y&&U[Y.source]&&(B.push({command:Sn.setTerrain,args:[void 0]}),Y=void 0),B=B.concat(H),d(Y,I.terrain)||B.push({command:Sn.setTerrain,args:[I.terrain]}),function(oe,me,be){me=me||[];const we=(oe=oe||[]).map(wt),Me=me.map(wt),_e=oe.reduce(Es,{}),xe=me.reduce(Es,{}),Le=we.slice(),Ce=Object.create(null);let Ue,Xe,Ze,tt,ft,lt,it;for(Ue=0,Xe=0;Ue<we.length;Ue++)Ze=we[Ue],xe.hasOwnProperty(Ze)?Xe++:(be.push({command:Sn.removeLayer,args:[Ze]}),Le.splice(Le.indexOf(Ze,Xe),1));for(Ue=0,Xe=0;Ue<Me.length;Ue++)Ze=Me[Me.length-1-Ue],Le[Le.length-1-Ue]!==Ze&&(_e.hasOwnProperty(Ze)?(be.push({command:Sn.removeLayer,args:[Ze]}),Le.splice(Le.lastIndexOf(Ze,Le.length-Xe),1)):Xe++,lt=Le[Le.length-Ue],be.push({command:Sn.addLayer,args:[xe[Ze],lt]}),Le.splice(Le.length-Ue,0,Ze),Ce[Ze]=!0);for(Ue=0;Ue<Me.length;Ue++)if(Ze=Me[Ue],tt=_e[Ze],ft=xe[Ze],!Ce[Ze]&&!d(tt,ft))if(d(tt.source,ft.source)&&d(tt["source-layer"],ft["source-layer"])&&d(tt.type,ft.type)){for(it in Br(tt.layout,ft.layout,be,Ze,null,Sn.setLayoutProperty),Br(tt.paint,ft.paint,be,Ze,null,Sn.setPaintProperty),d(tt.filter,ft.filter)||be.push({command:Sn.setFilter,args:[Ze,ft.filter]}),d(tt.minzoom,ft.minzoom)&&d(tt.maxzoom,ft.maxzoom)||be.push({command:Sn.setLayerZoomRange,args:[Ze,ft.minzoom,ft.maxzoom]}),tt)tt.hasOwnProperty(it)&&it!=="layout"&&it!=="paint"&&it!=="filter"&&it!=="metadata"&&it!=="minzoom"&&it!=="maxzoom"&&(it.indexOf("paint.")===0?Br(tt[it],ft[it],be,Ze,it.slice(6),Sn.setPaintProperty):d(tt[it],ft[it])||be.push({command:Sn.setLayerProperty,args:[Ze,it,ft[it]]}));for(it in ft)ft.hasOwnProperty(it)&&!tt.hasOwnProperty(it)&&it!=="layout"&&it!=="paint"&&it!=="filter"&&it!=="metadata"&&it!=="minzoom"&&it!=="maxzoom"&&(it.indexOf("paint.")===0?Br(tt[it],ft[it],be,Ze,it.slice(6),Sn.setPaintProperty):d(tt[it],ft[it])||be.push({command:Sn.setLayerProperty,args:[Ze,it,ft[it]]}))}else be.push({command:Sn.removeLayer,args:[Ze]}),lt=Le[Le.lastIndexOf(Ze)+1],be.push({command:Sn.addLayer,args:[ft,lt]})}(K,I.layers,B)}catch(U){console.warn("Unable to compute style diff:",U),B=[{command:Sn.setStyle,args:[I]}]}return B}(this.serialize(),h).filter(E=>!(E.command in Xs));if(m.length===0)return!1;const b=m.filter(E=>!(E.command in Fg));if(b.length>0)throw new Error(`Unimplemented: ${b.map(E=>E.command).join(", ")}.`);return m.forEach(E=>{E.command!=="setTransition"&&E.command!=="setProjection"&&this[E.command].apply(this,E.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,m){return this.getImage(h)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,m),this._afterImageUpdated(h),this)}updateImage(h,m){this.imageManager.updateImage(h,m)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,m,b={}){if(this._checkLoaded(),this.getSource(h)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(s.validateSource,`sources.${h}`,m,null,b))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const E=ye(h,m,this.dispatcher,this);E.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:E.serialize(),sourceId:h}));const I=B=>{const U=(B?"symbol:":"other:")+h,H=this._sourceCaches[U]=new s.SourceCache(U,E,B);(B?this._symbolSourceCaches:this._otherSourceCaches)[h]=H,H.style=this,H.onAdd(this.map)};I(!1),m.type!=="vector"&&m.type!=="geojson"||I(!0),E.onAdd&&E.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const m=this.getSource(h);if(!m)throw new Error("There is no source with this ID");for(const E in this._layers)if(this._layers[E].source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${E}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const b=this._getSourceCaches(h);for(const E of b)delete this._sourceCaches[E.id],delete this._updatedSources[E.id],E.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:E.getSource().id})),E.setEventedParent(null),E.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,m){this._checkLoaded(),this.getSource(h).setData(m),this._changed=!0}getSource(h){const m=this._getSourceCache(h);return m&&m.getSource()}_getSources(){const h=[];for(const m in this._otherSourceCaches){const b=this._getSourceCache(m);b&&h.push(b.getSource())}return h}addLayer(h,m,b={}){this._checkLoaded();const E=h.id;if(this.getLayer(E))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${E}" already exists on this map`)));let I;if(h.type==="custom"){if(Rh(this,s.validateCustomStyleLayer(h)))return;I=s.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(E,h.source),h=s.clone$1(h),h=s.extend(h,{source:E})),this._validate(s.validateLayer,`layers.${E}`,h,{arrayIndex:-1},b))return;I=s.createStyleLayer(h),this._validateLayer(I),I.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[I.id]=I.serialize(),this._updateLayerCount(I,!0)}const B=m?this._order.indexOf(m):this._order.length;if(m&&B===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice(B,0,E),this._layerOrderChanged=!0,this._layers[E]=I;const U=this._getLayerSourceCache(I);if(this._removedLayers[E]&&I.source&&U&&I.type!=="custom"){const H=this._removedLayers[E];delete this._removedLayers[E],H.type!==I.type?this._updatedSources[I.source]="clear":(this._updatedSources[I.source]="reload",U.pause())}this._updateLayer(I),I.onAdd&&I.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,m){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===m)return;const b=this._order.indexOf(h);this._order.splice(b,1);const E=m?this._order.indexOf(m):this._order.length;m&&E===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(E,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const m=this._layers[h];if(!m)return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const b=this._order.indexOf(h);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=m,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const m in this._layers)if(this._layers[m].type===h)return!0;return!1}setLayerZoomRange(h,m,b){this._checkLoaded();const E=this.getLayer(h);E?E.minzoom===m&&E.maxzoom===b||(m!=null&&(E.minzoom=m),b!=null&&(E.maxzoom=b),this._updateLayer(E)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,m,b={}){this._checkLoaded();const E=this.getLayer(h);if(E){if(!d(E.filter,m))return m==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(s.validateFilter,`layers.${E.id}.filter`,m,{layerType:E.type},b)||(E.filter=s.clone$1(m),this._updateLayer(E)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const m=this.getLayer(h);return m&&s.clone$1(m.filter)}setLayoutProperty(h,m,b,E={}){this._checkLoaded();const I=this.getLayer(h);I?d(I.getLayoutProperty(m),b)||(I.setLayoutProperty(m,b,E),this._updateLayer(I)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,m){const b=this.getLayer(h);if(b)return b.getLayoutProperty(m);this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,m,b,E={}){this._checkLoaded();const I=this.getLayer(h);I?d(I.getPaintProperty(m),b)||(I.setPaintProperty(m,b,E)&&this._updateLayer(I),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,m){const b=this.getLayer(h);return b&&b.getPaintProperty(m)}setFeatureState(h,m){this._checkLoaded();const b=h.source,E=h.sourceLayer,I=this.getSource(b);if(!I)return void this.fire(new s.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const B=I.type;if(B==="geojson"&&E)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(B==="vector"&&!E)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const U=this._getSourceCaches(b);for(const H of U)H.setFeatureState(E,h.id,m)}removeFeatureState(h,m){this._checkLoaded();const b=h.source,E=this.getSource(b);if(!E)return void this.fire(new s.ErrorEvent(new Error(`The source '${b}' does not exist in the map's style.`)));const I=E.type,B=I==="vector"?h.sourceLayer:void 0;if(I==="vector"&&!B)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const U=this._getSourceCaches(b);for(const H of U)H.removeFeatureState(B,h.id,m)}getFeatureState(h){this._checkLoaded();const m=h.source,b=h.sourceLayer,E=this.getSource(m);if(E){if(E.type!=="vector"||b)return h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(b,h.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const m in this._sourceCaches){const b=this._sourceCaches[m].getSource();h[b.id]||(h[b.id]=b.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(h){this._updatedLayers[h.id]=!0;const m=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",m.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const m=B=>this._layers[B].type==="fill-extrusion",b={},E=[];for(let B=this._order.length-1;B>=0;B--){const U=this._order[B];if(m(U)){b[U]=B;for(const H of h){const K=H[U];if(K)for(const Y of K)E.push(Y)}}}E.sort((B,U)=>U.intersectionZ-B.intersectionZ);const I=[];for(let B=this._order.length-1;B>=0;B--){const U=this._order[B];if(m(U))for(let H=E.length-1;H>=0;H--){const K=E[H].feature;if(b[K.layer.id]<B)break;I.push(K),E.pop()}else for(const H of h){const K=H[U];if(K)for(const Y of K)I.push(Y.feature)}}return I}queryRenderedFeatures(h,m,b){m&&m.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const E={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const H of m.layers){const K=this._layers[H];if(!K)return this.fire(new s.ErrorEvent(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];E[K.source]=!0}}const I=[];m.availableImages=this._availableImages;const B=m&&m.layers?m.layers.some(H=>{const K=this.getLayer(H);return K&&K.is3D()}):this.has3DLayers(),U=et.createFromScreenPoints(h,b);for(const H in this._sourceCaches){const K=this._sourceCaches[H].getSource().id;m.layers&&!E[K]||I.push(Ke(this._sourceCaches[H],this._layers,this._serializedLayers,U,m,b,B,!!this.map._showQueryGeometry))}return this.placement&&I.push(function(H,K,Y,oe,me,be,we){const Me={},_e=be.queryRenderedSymbols(oe),xe=[];for(const Le of Object.keys(_e).map(Number))xe.push(we[Le]);xe.sort(zt);for(const Le of xe){const Ce=Le.featureIndex.lookupSymbolFeatures(_e[Le.bucketInstanceId],K,Le.bucketIndex,Le.sourceLayerIndex,me.filter,me.layers,me.availableImages,H);for(const Ue in Ce){const Xe=Me[Ue]=Me[Ue]||[],Ze=Ce[Ue];Ze.sort((tt,ft)=>{const lt=Le.featureSortOrder;if(lt){const it=lt.indexOf(tt.featureIndex);return lt.indexOf(ft.featureIndex)-it}return ft.featureIndex-tt.featureIndex});for(const tt of Ze)Xe.push(tt)}}for(const Le in Me)Me[Le].forEach(Ce=>{const Ue=Ce.feature,Xe=Y(H[Le]).getFeatureState(Ue.layer["source-layer"],Ue.id);Ue.source=Ue.layer.source,Ue.layer["source-layer"]&&(Ue.sourceLayer=Ue.layer["source-layer"]),Ue.state=Xe});return Me}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),U.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(I)}querySourceFeatures(h,m){m&&m.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const b=this._getSourceCaches(h);let E=[];for(const I of b)E=E.concat(ht(I,m));return E}addSourceType(h,m,b){return Cs.getSourceType(h)?b(new Error(`A source type called "${h}" already exists.`)):(Cs.setSourceType(h,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:m.workerSourceURL},b):b(null,null))}getLight(){return this.light.getLight()}setLight(h,m={}){this._checkLoaded();const b=this.light.getLight();let E=!1;for(const B in h)if(!d(h[B],b[B])){E=!0;break}if(!E)return;const I=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,m),this.light.updateTransitions(I)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,m=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(m===1){if(typeof h.source=="object"){const b="terrain-dem-src";this.addSource(b,h.source),h=s.clone$1(h),h=s.extend(h,{source:b})}if(this._validate(s.validateTerrain,"terrain",h))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode)this._createTerrain(h,m);else{const b=this.terrain,E=b.get();for(const I of Object.keys(s.spec.terrain))!h.hasOwnProperty(I)&&s.spec.terrain[I].default&&(h[I]=s.spec.terrain[I].default);for(const I in h)if(!d(h[I],E[I])){b.set(h),this.stylesheet.terrain=h;const B=this._setTransitionParameters({duration:0});b.updateTransitions(B);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const m=this.fog=new Ne(h,this.map.transform);this.stylesheet.fog=h;const b=this._setTransitionParameters({duration:0});m.updateTransitions(b)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,b=m.get();Object.keys(h).length===0&&m.set(h);for(const E in h)if(!d(h[E],b[E])){m.set(h),this.stylesheet.fog=h;const I=this._setTransitionParameters({duration:0});m.updateTransitions(I);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:s.exported.now(),transition:s.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(b=>this.isLayerDraped(this._layers[b])),m=this._order.filter(b=>!this.isLayerDraped(this._layers[b]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...m)}_createTerrain(h,m){const b=this.terrain=new We(h,m);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const E=this._setTransitionParameters({duration:0});b.updateTransitions(E)}_force3DLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="symbol"&&this._updateLayer(m)}}_validate(h,m,b,E,I={}){return(!I||I.validate!==!1)&&Rh(this,h.call(s.validateStyle,s.extend({key:m,style:this.serialize(),value:b,styleSpec:s.spec},E)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const m=this._getSourceCaches(h);for(const b of m)b.clearTiles()}_reloadSource(h){const m=this._getSourceCaches(h);for(const b of m)b.resume(),b.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const m in this._sourceCaches)this._sourceCaches[m].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const m=this._sourceCaches[h];m.resume(),m.reload()}}_updatePlacement(h,m,b,E,I=!1){let B=!1,U=!1;const H={};for(const K of this._order){const Y=this._layers[K];if(Y.type!=="symbol")continue;if(!H[Y.source]){const me=this._getLayerSourceCache(Y);if(!me)continue;H[Y.source]=me.getRenderableIds(!0).map(be=>me.getTileByID(be)).sort((be,we)=>we.tileID.overscaledZ-be.tileID.overscaledZ||(be.tileID.isLessThan(we.tileID)?-1:1))}const oe=this.crossTileSymbolIndex.addLayer(Y,H[Y.source],h.center.lng,h.projection);B=B||oe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),I=I||this._layerOrderChanged||b===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(I||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),h.zoom))&&(this.pauseablePlacement=new al(h,this._order,I,m,b,E,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,H),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),U=!0),B&&this.pauseablePlacement.placement.setStale()),U||B)for(const K of this._order){const Y=this._layers[K];Y.type==="symbol"&&this.placement.updateLayerOpacities(Y,H[Y.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,m,b){this.imageManager.getImages(m.icons,b),this._updateTilesForChangedImages();const E=I=>{I&&I.setDependencies(m.tileID.key,m.type,m.icons)};E(this._otherSourceCaches[m.source]),E(this._symbolSourceCaches[m.source])}getGlyphs(h,m,b){this.glyphManager.getGlyphs(m.stacks,b)}getResource(h,m,b){return s.makeRequest(m,b)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const m=[];return this._otherSourceCaches[h]&&m.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&m.push(this._symbolSourceCaches[h]),m}_isSourceCacheLoaded(h){const m=this._getSourceCaches(h);return m.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):m.every(b=>b.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Cs.getSourceType=function(y){return Ae[y]},Cs.setSourceType=function(y,h){Ae[y]=h},Cs.registerForPluginStateChange=s.registerForPluginStateChange;var fo=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Yl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",zh=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Uc=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Vu=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let of={},Oh={};const Vc=[];po(fo,Vc),po(zh,Vc),po(Uc,Vc),po(Vu,Vc),of=Ci("",zh),Oh=Ci(Vu,Uc);const Fh=Ci(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Gc=fo,Bs=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Ho={background:Ci(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ci(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ci(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ci("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ci(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ci(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ci("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ci("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ci("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ci(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ci(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ci(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ci(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ci(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Ci(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Ci(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ci(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ci(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ci(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ci(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Ci(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Ci(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Ci(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Ci(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Ci(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ci(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Yl),skyboxGradient:Ci(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Yl),skyboxCapture:Ci(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ci(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;
#ifdef GLOBE_POLES
vec3 up_vector=normalize(globe_pos)*u_tile_up_scale;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ci(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function po(y,h){const m=y.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let b of m)if(b=b.trim(),b[0]==="#"&&b.includes("if")&&!b.includes("endif")){b=b.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const E=b.split(" ");for(const I of E)h.includes(I)||h.push(I)}}function Ci(y,h){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),E={},I=[...Vc];return po(y,I),po(h,I),{fragmentSource:y=y.replace(m,(B,U,H,K,Y)=>(E[Y]=!0,U==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
varying ${H} ${K} ${Y};
#else
uniform ${H} ${K} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${H} ${K} ${Y} = u_${Y};
#endif
`)),vertexSource:h=h.replace(m,(B,U,H,K,Y)=>{const oe=K==="float"?"vec2":"vec4",me=Y.match(/color/)?"color":oe;return E[Y]?U==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${H} ${oe} a_${Y};
varying ${H} ${K} ${Y};
#else
uniform ${H} ${K} u_${Y};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${H} ${K} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${me}(a_${Y}, u_${Y}_t);
#else
    ${H} ${K} ${Y} = u_${Y};
#endif
`:U==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${H} ${oe} a_${Y};
#else
uniform ${H} ${K} u_${Y};
#endif
`:me==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${H} ${K} ${Y} = a_${Y};
#else
    ${H} ${K} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${H} ${K} ${Y} = unpack_mix_${me}(a_${Y}, u_${Y}_t);
#else
    ${H} ${K} ${Y} = u_${Y};
#endif
`}),staticAttributes:b,usedDefines:I}}class Zp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,m,b,E,I,B,U){this.context=h;let H=this.boundPaintVertexBuffers.length!==E.length;for(let Y=0;!H&&Y<E.length;Y++)this.boundPaintVertexBuffers[Y]!==E[Y]&&(H=!0);let K=this.boundDynamicVertexBuffers.length!==U.length;for(let Y=0;!K&&Y<U.length;Y++)this.boundDynamicVertexBuffers[Y]!==U[Y]&&(K=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==b||H||K||this.boundIndexBuffer!==I||this.boundVertexOffset!==B)this.freshBind(m,b,E,I,B,U);else{h.bindVertexArrayOES.set(this.vao);for(const Y of U)Y&&Y.bind();I&&I.dynamicDraw&&I.bind()}}freshBind(h,m,b,E,I,B){let U;const H=h.numAttributes,K=this.context,Y=K.gl;if(K.extVertexArrayObject)this.vao&&this.destroy(),this.vao=K.extVertexArrayObject.createVertexArrayOES(),K.bindVertexArrayOES.set(this.vao),U=0,this.boundProgram=h,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=b,this.boundIndexBuffer=E,this.boundVertexOffset=I,this.boundDynamicVertexBuffers=B;else{U=K.currentNumAttributes||0;for(let oe=H;oe<U;oe++)Y.disableVertexAttribArray(oe)}m.enableAttributes(Y,h),m.bind(),m.setVertexAttribPointers(Y,h,I);for(const oe of b)oe.enableAttributes(Y,h),oe.bind(),oe.setVertexAttribPointers(Y,h,I);for(const oe of B)oe&&(oe.enableAttributes(Y,h),oe.bind(),oe.setVertexAttribPointers(Y,h,I));E&&E.bind(),K.currentNumAttributes=H}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Lo(y,h){const m=Math.pow(2,h.canonical.z),b=h.canonical.y;return[new s.MercatorCoordinate(0,b/m).toLngLat().lat,new s.MercatorCoordinate(0,(b+1)/m).toLngLat().lat]}function Ra(y,h,m,b,E,I,B){const U=y.context,H=U.gl,K=m.fbo;if(!K)return;y.prepareDrawTile();const Y=y.useProgram("hillshade");U.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,K.colorAttachment.get());const oe=((Me,_e,xe,Le)=>{const Ce=xe.paint.get("hillshade-shadow-color"),Ue=xe.paint.get("hillshade-highlight-color"),Xe=xe.paint.get("hillshade-accent-color");let Ze=xe.paint.get("hillshade-illumination-direction")*(Math.PI/180);xe.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ze-=Me.transform.angle);const tt=!Me.options.moving;return{u_matrix:Le||Me.transform.calculateProjMatrix(_e.tileID.toUnwrapped(),tt),u_image:0,u_latrange:Lo(0,_e.tileID),u_light:[xe.paint.get("hillshade-exaggeration"),Ze],u_shadow:Ce,u_highlight:Ue,u_accent:Xe}})(y,m,b,y.terrain?h.projMatrix:null);y.prepareDrawProgram(U,Y,h.toUnwrapped());const{tileBoundsBuffer:me,tileBoundsIndexBuffer:be,tileBoundsSegments:we}=y.getTileBoundsBuffers(m);Y.draw(U,H.TRIANGLES,E,I,B,s.CullFaceMode.disabled,oe,b.id,me,be,we)}function ul(y,h,m){if(!h.needsDEMTextureUpload)return;const b=y.context,E=b.gl;b.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||y.getTileTexture(m.stride);const I=m.getPixels();h.demTexture?h.demTexture.update(I,{premultiply:!1}):h.demTexture=new s.Texture(b,I,E.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function Bh(y,h,m,b,E,I){const B=y.context,U=B.gl;if(!h.dem)return;const H=h.dem;if(B.activeTexture.set(U.TEXTURE1),ul(y,h,H),!h.demTexture)return;h.demTexture.bind(U.NEAREST,U.CLAMP_TO_EDGE);const K=H.dim;B.activeTexture.set(U.TEXTURE0);let Y=h.fbo;if(!Y){const we=new s.Texture(B,{width:K,height:K,data:null},U.RGBA);we.bind(U.LINEAR,U.CLAMP_TO_EDGE),Y=h.fbo=B.createFramebuffer(K,K,!0),Y.colorAttachment.set(we.texture)}B.bindFramebuffer.set(Y.framebuffer),B.viewport.set([0,0,K,K]);const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:me,tileBoundsSegments:be}=y.getMercatorTileBoundsBuffers();y.useProgram("hillshadePrepare").draw(B,U.TRIANGLES,b,E,I,s.CullFaceMode.disabled,((we,Me)=>{const _e=Me.stride,xe=s.create();return s.ortho(xe,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(xe,xe,[0,-s.EXTENT,0]),{u_matrix:xe,u_image:1,u_dimension:[_e,_e],u_zoom:we.overscaledZ,u_unpack:Me.unpackVector}})(h.tileID,H),m.id,oe,me,be),h.needsHillshadePrepare=!1}const Kl=y=>({u_matrix:new s.UniformMatrix4f(y),u_image0:new s.Uniform1i(y),u_skirt_height:new s.Uniform1f(y)}),Nh=(y,h)=>({u_matrix:y,u_image0:0,u_skirt_height:h}),af=(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be)=>({u_proj_matrix:Float32Array.from(y),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(b),u_merc_matrix:m,u_zoom_transition:E,u_merc_center:I,u_image0:0,u_frustum_tl:B,u_frustum_tr:U,u_frustum_br:H,u_frustum_bl:K,u_globe_pos:Y,u_globe_radius:oe,u_viewport:me,u_grid_matrix:be?Float32Array.from(be):new Float32Array(9)});function Gu(y,h){return y!=null&&h!=null&&!(!y.hasData()||!h.hasData())&&y.demTexture!=null&&h.demTexture!=null&&y.tileID.key!==h.tileID.key}const za=new class{constructor(){this.operations={}}newMorphing(y,h,m,b,E){if(y in this.operations){const I=this.operations[y];I.to.tileID.key!==m.tileID.key&&(I.queued=m)}else this.operations[y]={startTime:b,phase:0,duration:E,from:h,to:m,queued:null}}getMorphValuesForProxy(y){if(!(y in this.operations))return null;const h=this.operations[y];return{from:h.from,to:h.to,phase:h.phase}}update(y){for(const h in this.operations){const m=this.operations[h];for(m.phase=(y-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,y)){delete this.operations[h];break}}}_nextOp(y,h){return!!y.queued&&(y.from=y.to,y.to=y.queued,y.queued=null,y.phase=0,y.startTime=h,!0)}_validOp(y){return y.from.hasData()&&y.to.hasData()}},Wc={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Uh(y,h){const m=1<<y.z;return!h&&(y.x===0||y.x===m-1)||y.y===0||y.y===m-1}const Wu=y=>({u_matrix:y});function Hu(y,h,m,b,E){if(E>0){const I=s.exported.now(),B=(I-y.timeAdded)/E,U=h?(I-h.timeAdded)/E:-1,H=m.getSource(),K=b.coveringZoomLevel({tileSize:H.tileSize,roundZoom:H.roundZoom}),Y=!h||Math.abs(h.tileID.overscaledZ-K)>Math.abs(y.tileID.overscaledZ-K),oe=Y&&y.refreshedUponExpiration?1:s.clamp(Y?B:1-U,0,1);return y.refreshedUponExpiration&&B>=1&&(y.refreshedUponExpiration=!1),h?{opacity:1,mix:1-oe}:{opacity:oe,mix:0}}return{opacity:1,mix:0}}class di extends s.SourceCache{constructor(h){const m={type:"raster-dem",maxzoom:h.transform.maxZoom},b=new nt(gn(),null),E=ye("mock-dem",m,b,h.style);super("mock-dem",E,!1),E.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,m){h.state="loaded",m(null)}}class hl extends s.SourceCache{constructor(h){const m=ye("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new nt(gn(),null),h.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,m,b){if(h.freezeTileCoverage)return;this.transform=h;const E=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((I,B)=>{if(I[B.key]="",!this._tiles[B.key]){const U=new s.Tile(B,this._source.tileSize*B.overscaleFactor(),h.tileZoom);U.state="loaded",this._tiles[B.key]=U}return I},{});for(const I in this._tiles)I in E||(this.freeFBO(I),this._tiles[I].unloadVectorData(),delete this._tiles[I])}freeFBO(h){const m=this.proxyCachedFBO[h];if(m!==void 0){const b=Object.values(m);this.renderCachePool.push(...b),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ju extends s.OverscaledTileID{constructor(h,m,b){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=m,this.projMatrix=b}}class Vh extends s.Elevation{constructor(h,m){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[b,E,I]=function(H){const K=new s.StructArrayLayout4i8,Y=new s.StructArrayLayout3ui6,oe=131;K.reserve(17161),Y.reserve(33800);const me=s.EXTENT/128,be=s.EXTENT+me/2,we=be+me;for(let _e=-me;_e<we;_e+=me)for(let xe=-me;xe<we;xe+=me){const Le=xe<0||xe>be||_e<0||_e>be?24575:0,Ce=s.clamp(Math.round(xe),0,s.EXTENT),Ue=s.clamp(Math.round(_e),0,s.EXTENT);K.emplaceBack(Ce+Le,Ue,Ce,Ue)}const Me=(_e,xe)=>{const Le=xe*oe+_e;Y.emplaceBack(Le+1,Le,Le+oe),Y.emplaceBack(Le+oe,Le+oe+1,Le+1)};for(let _e=1;_e<129;_e++)for(let xe=1;xe<129;xe++)Me(xe,_e);return[0,129].forEach(_e=>{for(let xe=0;xe<130;xe++)Me(xe,_e),Me(_e,xe)}),[K,Y,32768]}(),B=h.context;this.gridBuffer=B.createVertexBuffer(b,s.boundsAttributes.members),this.gridIndexBuffer=B.createIndexBuffer(E),this.gridSegments=s.SegmentVector.simpleSegment(0,0,b.length,E.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,b.length,I),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new hl(m.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const U=B.gl;this._overlapStencilMode=new s.StencilMode({func:U.GEQUAL,mask:255},0,255,U.KEEP,U.KEEP,U.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new di(m.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency()}update(h,m,b){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const E=h.terrain.properties;this.sourceCache=h.terrain.drapeRenderMode===0?this._mockSourceCache:h._getSourceCache(E.get("source")),this._exaggeration=E.get("exaggeration");const I=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const B=this.getScaledDemTileSize();this.sourceCache.update(m,B,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,I(),this._initializing=!0),I(),m.updateElevation(!0,b),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||h.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,b=this.painter.transform;this._initializing&&(this._initializing=b._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(b.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const E=this.proxyCoords=m.getIds().map(H=>{const K=m.getTileByID(H).tileID;return K.projMatrix=b.calculateProjMatrix(K.toUnwrapped()),K});(function(H,K){const Y=K.transform.pointCoordinate(K.transform.getCameraPoint()),oe=new s.pointGeometry(Y.x,Y.y);H.sort((me,be)=>{if(be.overscaledZ-me.overscaledZ)return be.overscaledZ-me.overscaledZ;const we=new s.pointGeometry(me.canonical.x+(1<<me.canonical.z)*me.wrap,me.canonical.y),Me=new s.pointGeometry(be.canonical.x+(1<<be.canonical.z)*be.wrap,be.canonical.y),_e=oe.mult(1<<me.canonical.z);return _e.x-=.5,_e.y-=.5,_e.distSqr(we)-_e.distSqr(Me)})})(E,this.painter),this._previousZoom=b.zoom;const I=this.proxyToSource||{};this.proxyToSource={},E.forEach(H=>{this.proxyToSource[H.key]={}}),this.terrainTileForTile={};const B=this._style._sourceCaches;for(const H in B){const K=B[H];if(!K.used||(K!==this.sourceCache&&this.resetTileLookupCache(K.id),this._setupProxiedCoordsForOrtho(K,h[H],I),K.usedForTerrain))continue;const Y=h[H];K.getSource().reparseOverscaled&&this._assignTerrainTiles(Y)}this.proxiedCoords[m.id]=E.map(H=>new ju(H,H.key,this.orthoMatrix)),this._assignTerrainTiles(E),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(I),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const U={};this._visibleDemTiles=[];for(const H of this.proxyCoords){const K=this.terrainTileForTile[H.key];if(!K)continue;const Y=K.tileID.key;Y in U||(this._visibleDemTiles.push(K),U[Y]=Y)}}_assignTerrainTiles(h){this._initializing||h.forEach(m=>{if(this.terrainTileForTile[m.key])return;const b=this._findTileCoveringTileID(m,this.sourceCache);b&&(this.terrainTileForTile[m.key]=b)})}_prepareDEMTextures(){const h=this.painter.context,m=h.gl;for(const b in this.terrainTileForTile){const E=this.terrainTileForTile[b],I=E.dem;!I||E.demTexture&&!E.needsDEMTextureUpload||(h.activeTexture.set(m.TEXTURE1),ul(this.painter,E,I))}}_prepareDemTileUniforms(h,m,b,E){if(!m||m.demTexture==null)return!1;const I=h.tileID.canonical,B=Math.pow(2,m.tileID.canonical.z-I.z),U=E||"";return b[`u_dem_tl${U}`]=[I.x*B%1,I.y*B%1],b[`u_dem_scale${U}`]=B,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,m=h.gl;if(!this._emptyDepthBufferTexture){const b=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(h,b,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const m=this._visibleDemTiles.reduce((b,E)=>{if(!E.dem)return b;const I=E.dem.tree.minimums[0];return I>0&&h++,b+I},0);return h?m/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,m=h.gl;h.activeTexture.set(m.TEXTURE2);const b=this._getLoadedAreaMinimum(),E=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(b,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let I=this._emptyDEMTexture;return I?I.update(E,{premultiply:!1}):I=this._emptyDEMTexture=new s.Texture(h,E,m.RGBA,{premultiply:!1}),I}setupElevationDraw(h,m,b){const E=this.painter.context,I=E.gl,B=(U=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(U),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var U;B.u_dem_size=this.sourceCache.getSource().tileSize,B.u_exaggeration=this.exaggeration();let H=null,K=null,Y=1;if(b&&b.morphing&&this._useVertexMorphing){const oe=b.morphing.srcDemTile,me=b.morphing.dstDemTile;Y=b.morphing.phase,oe&&me&&(this._prepareDemTileUniforms(h,oe,B,"_prev")&&(K=oe),this._prepareDemTileUniforms(h,me,B)&&(H=me))}if(K&&H?(E.activeTexture.set(I.TEXTURE2),H.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE,I.NEAREST),E.activeTexture.set(I.TEXTURE4),K.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE,I.NEAREST),B.u_dem_lerp=Y):(H=this.terrainTileForTile[h.tileID.key],E.activeTexture.set(I.TEXTURE2),(this._prepareDemTileUniforms(h,H,B)?H.demTexture:this.emptyDEMTexture).bind(I.NEAREST,I.CLAMP_TO_EDGE)),E.activeTexture.set(I.TEXTURE3),b&&b.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE),this._depthFBO&&(B.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE),B.u_depth_size_inv=[1,1]),b&&b.useMeterToDem&&H){const oe=(1<<H.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;B.u_meter_to_dem=oe}if(b&&b.labelPlaneMatrixInv&&(B.u_label_plane_matrix_inv=b.labelPlaneMatrixInv),m.setTerrainUniformValues(E,B),this.painter.transform.projection.name==="globe"){const oe=this.globeUniformValues(this.painter.transform,h.tileID.canonical,b&&b.useDenormalizedUpVectorScale);m.setGlobeUniformValues(E,oe)}}globeUniformValues(h,m,b){const E=h.projection;return{u_tile_tl_up:E.upVector(m,0,0),u_tile_tr_up:E.upVector(m,s.EXTENT,0),u_tile_br_up:E.upVector(m,s.EXTENT,s.EXTENT),u_tile_bl_up:E.upVector(m,0,s.EXTENT),u_tile_up_scale:b?s.GLOBE_METERS_TO_ECEF:E.upVectorScale(m,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const m=this.painter,b=this.painter.context;h.length!==0&&(b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(E,I,B,U,H){if(E.transform.projection.name==="globe")(function(K,Y,oe,me,be){const we=K.context,Me=we.gl;let _e,xe;const Le=K.options.showTerrainWireframe?2:0,Ce=K.transform,Ue=s.globeUseCustomAntiAliasing(K,we,Ce),Xe=(Ut,gt)=>{if(xe===Ut)return;const Lt=[Wc[Ut],"PROJECTION_GLOBE_VIEW"];Ue&&Lt.push("CUSTOM_ANTIALIASING"),gt&&Lt.push(Wc[Le]),_e=K.useProgram("globeRaster",null,Lt),xe=Ut},Ze=K.colorModeForRenderPass(),tt=new s.DepthMode(Me.LEQUAL,s.DepthMode.ReadWrite,K.depthRangeFor3D);za.update(be);const ft=s.calculateGlobeMercatorMatrix(Ce),lt=[s.mercatorXfromLng(Ce.center.lng),s.mercatorYfromLat(Ce.center.lat)],it=Le?[!1,!0]:[!1],Wt=K.globeSharedBuffers,ot=[Ce.width*s.exported.devicePixelRatio,Ce.height*s.exported.devicePixelRatio],bt=Float32Array.from(Ce.globeMatrix),mt={useDenormalizedUpVectorScale:!0};if(it.forEach(Ut=>{xe=-1;const gt=Ut?Me.LINES:Me.TRIANGLES;for(const Lt of me){const kt=oe.getTile(Lt),Ye=s.StencilMode.disabled,at=Y.prevTerrainTileForTile[Lt.key],Qt=Y.terrainTileForTile[Lt.key];Gu(at,Qt)&&za.newMorphing(Lt.key,at,Qt,be,250),we.activeTexture.set(Me.TEXTURE0),kt.texture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE);const mn=za.getMorphValuesForProxy(Lt.key),cn=mn?1:0;mn&&s.extend$1(mt,{morphing:{srcDemTile:mn.from,dstDemTile:mn.to,phase:s.easeCubicInOut(mn.phase)}});const Fn=s.tileCornersToBounds(Lt.canonical),zn=s.getLatitudinalLod(Fn.getCenter().lat),In=s.getGridMatrix(Lt.canonical,Fn,zn,Ce.worldSize/Ce._pixelsPerMercatorPixel),an=s.globeNormalizeECEF(s.globeTileBounds(Lt.canonical)),Li=af(Ce.projMatrix,bt,ft,an,s.globeToMercatorTransition(Ce.zoom),lt,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,ot,In);if(Xe(cn,Ut),Y.setupElevationDraw(kt,_e,mt),K.prepareDrawProgram(we,_e,Lt.toUnwrapped()),Wt){const[bi,ki,si]=Ut?Wt.getWirefameBuffers(K.context,zn):Wt.getGridBuffers(zn);_e.draw(we,gt,tt,Ye,Ze,s.CullFaceMode.backCCW,Li,"globe_raster",bi,ki,si)}}}),Wt){const Ut=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ue&&Ut.push("CUSTOM_ANTIALIASING"),_e=K.useProgram("globeRaster",null,Ut);for(const gt of me){const{x:Lt,y:kt,z:Ye}=gt.canonical,at=kt===0,Qt=kt===(1<<Ye)-1,[mn,cn,Fn,zn]=Wt.getPoleBuffers(Ye);if(zn&&(at||Qt)){const In=oe.getTile(gt);we.activeTexture.set(Me.TEXTURE0),In.texture.bind(Me.LINEAR,Me.CLAMP_TO_EDGE);let an=s.globePoleMatrixForTile(Ye,Lt,Ce);const Li=s.globeNormalizeECEF(s.globeTileBounds(gt.canonical)),bi=(ki,si)=>ki.draw(we,Me.TRIANGLES,tt,s.StencilMode.disabled,Ze,s.CullFaceMode.disabled,af(Ce.projMatrix,an,an,Li,0,lt,Ce.frustumCorners.TL,Ce.frustumCorners.TR,Ce.frustumCorners.BR,Ce.frustumCorners.BL,Ce.globeCenterInViewSpace,Ce.globeRadius,ot),"globe_pole_raster",si,Fn,zn);Y.setupElevationDraw(In,_e,mt),K.prepareDrawProgram(we,_e,gt.toUnwrapped()),at&&bi(_e,mn),Qt&&(an=s.scale(s.create(),an,[1,-1,1]),bi(_e,cn))}}}})(E,I,B,U,H);else{const K=E.context,Y=K.gl;let oe,me;const be=E.options.showTerrainWireframe?2:0,we=(Ce,Ue)=>{if(me===Ce)return;const Xe=[Wc[Ce]];Ue&&Xe.push(Wc[be]),oe=E.useProgram("terrainRaster",null,Xe),me=Ce},Me=E.colorModeForRenderPass(),_e=new s.DepthMode(Y.LEQUAL,s.DepthMode.ReadWrite,E.depthRangeFor3D);za.update(H);const xe=E.transform,Le=6*Math.pow(1.5,22-xe.zoom)*I.exaggeration();(be?[!1,!0]:[!1]).forEach(Ce=>{me=-1;const Ue=Ce?Y.LINES:Y.TRIANGLES,[Xe,Ze]=Ce?I.getWirefameBuffer():[I.gridIndexBuffer,I.gridSegments];for(const tt of U){const ft=B.getTile(tt),lt=s.StencilMode.disabled,it=I.prevTerrainTileForTile[tt.key],Wt=I.terrainTileForTile[tt.key];Gu(it,Wt)&&za.newMorphing(tt.key,it,Wt,H,250),K.activeTexture.set(Y.TEXTURE0),ft.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST);const ot=za.getMorphValuesForProxy(tt.key),bt=ot?1:0;let mt;ot&&(mt={morphing:{srcDemTile:ot.from,dstDemTile:ot.to,phase:s.easeCubicInOut(ot.phase)}});const Ut=Nh(tt.projMatrix,Uh(tt.canonical,xe.renderWorldCopies)?Le/10:Le);we(bt,Ce),I.setupElevationDraw(ft,oe,mt),E.prepareDrawProgram(K,oe,tt.toUnwrapped()),oe.draw(K,Ue,_e,lt,Me,s.CullFaceMode.backCCW,Ut,"terrain_raster",I.gridBuffer,Xe,Ze)}})}}(m,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const m=this.painter,b=this.painter.context,E=this.proxySourceCache,I=this.proxiedCoords[E.id],B=this._drapedRenderBatches.shift(),U=[],H=m.style.order;let K=0;for(const Y of I){const oe=E.getTileByID(Y.proxyTileKey),me=E.proxyCachedFBO[Y.key]?E.proxyCachedFBO[Y.key][h]:void 0,be=me!==void 0?E.renderCache[me]:this.pool[K++],we=me!==void 0;if(oe.texture=be.tex,we&&!be.dirty){U.push(oe.tileID);continue}let Me;b.bindFramebuffer.set(be.fb.framebuffer),this.renderedToTile=!1,be.dirty&&(b.clear({color:s.Color.transparent,stencil:0}),be.dirty=!1);for(let _e=B.start;_e<=B.end;++_e){const xe=m.style._layers[H[_e]];if(xe.isHidden(m.transform.zoom))continue;const Le=m.style._getLayerSourceCache(xe),Ce=Le?this.proxyToSource[Y.key][Le.id]:[Y];if(!Ce)continue;const Ue=Ce;b.viewport.set([0,0,be.fb.width,be.fb.height]),Me!==(Le?Le.id:null)&&(this._setupStencil(be,Ce,xe,Le),Me=Le?Le.id:null),m.renderLayer(m,Le,xe,Ue)}this.renderedToTile?(be.dirty=!0,U.push(oe.tileID)):we||--K,K===5&&(K=0,this.renderToBackBuffer(U))}return this.renderToBackBuffer(U),this.renderingToTexture=!1,b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height]),B.end+1}postRender(){}renderCacheEfficiency(h){const m=h.order.length;if(m===0)return{efficiency:100};let b,E=0,I=0,B=!1;for(let U=0;U<m;++U){const H=h._layers[h.order[U]];this._style.isLayerDraped(H)?(B&&++E,++I):B||(B=!0,b=H.id)}return I===0?{efficiency:100}:{efficiency:100*(1-E/I),firstUndrapedLayer:b}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{h=Math.min(h,m.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,m,b){if(!this._visibleDemTiles)return null;const E=this._visibleDemTiles.filter(I=>I.dem).map(I=>{const B=I.tileID,U=1<<B.overscaledZ,{x:H,y:K}=B.canonical,Y=H/U,oe=(H+1)/U,me=K/U,be=(K+1)/U;return{minx:Y,miny:me,maxx:oe,maxy:be,t:I.dem.tree.raycastRoot(Y,me,oe,be,h,m,b),tile:I}});E.sort((I,B)=>(I.t!==null?I.t:Number.MAX_VALUE)-(B.t!==null?B.t:Number.MAX_VALUE));for(const I of E){if(I.t==null)return null;const B=I.tile.dem.tree.raycast(I.minx,I.miny,I.maxx,I.maxy,h,m,b);if(B!=null)return B}return null}_createFBO(){const h=this.painter.context,m=h.gl,b=this.drapeBufferSize;h.activeTexture.set(m.TEXTURE0);const E=new s.Texture(h,{width:b[0],height:b[1],data:null},m.RGBA);E.bind(m.LINEAR,m.CLAMP_TO_EDGE);const I=h.createFramebuffer(b[0],b[1],!1);return I.colorAttachment.set(E.texture),I.depthAttachment=new es(h,I.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,b[0],b[1]),this._stencilRef=0,I.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):I.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:I,tex:E,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const m=this._style._layers[h],b=m.isHidden(this.painter.transform.zoom);return m.type!=="custom"&&!b&&m.hasTransition()})}_clearRasterFadeFromRenderCache(){let h=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof de){h=!0;break}if(h)for(let m=0;m<this._style.order.length;++m){const b=this._style._layers[this._style.order[m]],E=b.isHidden(this.painter.transform.zoom),I=this._style._getLayerSourceCache(b);if(b.type!=="raster"||E||!I)continue;const B=b.paint.get("raster-fade-duration");for(const U of this.proxyCoords){const H=this.proxyToSource[U.key][I.id];if(H)for(const K of H){const Y=Hu(I.getTile(K),I.findLoadedParent(K,0),I,this.painter.transform,B);(Y.opacity!==1||Y.mix!==0)&&this._clearRenderCacheForTile(I.id,K)}}}}_setupDrapedRenderBatches(){const h=this._style.order,m=h.length;if(m===0)return;const b=[];let E,I=0,B=this._style._layers[h[I]];for(;!this._style.isLayerDraped(B)&&B.isHidden(this.painter.transform.zoom)&&++I<m;)B=this._style._layers[h[I]];for(;I<m;++I){const U=this._style._layers[h[I]];U.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(U)?E===void 0&&(E=I):E!==void 0&&(b.push({start:E,end:I-1}),E=void 0))}E!==void 0&&b.push({start:E,end:I-1}),this._drapedRenderBatches=b}_setupRenderCache(h){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const B=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let U=0;U<B.length;++U){const H=Object.values(B[U]);m.renderCachePool.push(...H)}}return}this._clearRasterFadeFromRenderCache();const b=this.proxyCoords,E=this._tilesDirty;for(let B=b.length-1;B>=0;B--){const U=b[B];if(m.getTileByID(U.key),m.proxyCachedFBO[U.key]!==void 0){const H=h[U.key],K=this.proxyToSource[U.key];let Y=0;for(const oe in K){const me=K[oe],be=H[oe];if(!be||be.length!==me.length||me.some((we,Me)=>we!==be[Me]||E[oe]&&E[oe].hasOwnProperty(we.key))){Y=-1;break}++Y}for(const oe in m.proxyCachedFBO[U.key])m.renderCache[m.proxyCachedFBO[U.key][oe]].dirty=Y<0||Y!==Object.values(H).length}}const I=[...this._drapedRenderBatches];I.sort((B,U)=>U.end-U.start-(B.end-B.start));for(const B of I)for(const U of b){if(m.proxyCachedFBO[U.key])continue;let H=m.renderCachePool.pop();H===void 0&&m.renderCache.length<50&&(H=m.renderCache.length,m.renderCache.push(this._createFBO())),H!==void 0&&(m.proxyCachedFBO[U.key]={},m.proxyCachedFBO[U.key][B.start]=H,m.renderCache[H].dirty=!0)}this._tilesDirty={}}_setupStencil(h,m,b,E){if(!E||!this._sourceTilesOverlap[E.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const I=this.painter.context,B=I.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let U;if(b.isTileClipped())U=m.length,this._overlapStencilMode.test={func:B.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);U=1,this._overlapStencilMode.test={func:B.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+U>255&&(I.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=U,this._overlapStencilMode.ref=this._stencilRef,b.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(h,m){const b=this.painter,E=this.painter.context,I=E.gl;b._tileClippingMaskIDs={},E.setColorMode(s.ColorMode.disabled),E.setDepthMode(s.DepthMode.disabled);const B=b.useProgram("clippingMask");for(const U of h){const H=b._tileClippingMaskIDs[U.key]=--m;B.draw(E,I.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:I.ALWAYS,mask:0},H,255,I.KEEP,I.KEEP,I.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Wu(U.projMatrix),"$clipping",b.tileExtentBuffer,b.quadTriangleIndexBuffer,b.tileExtentSegments)}}pointCoordinate(h){const m=this.painter.transform;if(h.x<0||h.x>m.width||h.y<0||h.y>m.height)return null;const b=[h.x,h.y,1,1];s.transformMat4$1(b,b,m.pixelMatrixInverse),s.scale$1(b,b,1/b[3]),b[0]/=m.worldSize,b[1]/=m.worldSize;const E=m._camera.position,I=s.mercatorZfromAltitude(1,m.center.lat),B=[E[0],E[1],E[2]/I,0],U=s.subtract([],b.slice(0,3),B);s.normalize(U,U);const H=this.raycast(B,U,this._exaggeration);return H!==null&&H?(s.scaleAndAdd(B,B,U,H),B[3]=B[2],B[2]*=I,B):null}drawDepth(){const h=this.painter,m=h.context,b=this.proxySourceCache,E=Math.ceil(h.width),I=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===E&&this._depthFBO.height===I||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const B=m.gl,U=m.createFramebuffer(E,I,!0);m.activeTexture.set(B.TEXTURE0);const H=new s.Texture(m,{width:E,height:I,data:null},B.RGBA);H.bind(B.NEAREST,B.CLAMP_TO_EDGE),U.colorAttachment.set(H.texture);const K=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,E,I);U.depthAttachment.set(K),this._depthFBO=U,this._depthTexture=H}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,E,I]),function(B,U,H,K){if(B.transform.projection.name==="globe")return;const Y=B.context,oe=Y.gl;Y.clear({depth:1});const me=B.useProgram("terrainDepth"),be=new s.DepthMode(oe.LESS,s.DepthMode.ReadWrite,B.depthRangeFor3D);for(const we of K){const Me=H.getTile(we),_e=Nh(we.projMatrix,0);U.setupElevationDraw(Me,me),me.draw(Y,oe.TRIANGLES,be,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,_e,"terrain_depth",U.gridBuffer,U.gridIndexBuffer,U.gridNoSkirtSegments)}}(h,this,b,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,m,b){if(h.getSource()instanceof pe)return this._setupProxiedCoordsForImageSource(h,m,b);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const E=this.proxiedCoords[h.id]=[],I=this.proxyCoords;for(let U=0;U<I.length;U++){const H=I[U],K=this._findTileCoveringTileID(H,h);if(K){const Y=this._createProxiedId(H,K,b[H.key]&&b[H.key][h.id]);E.push(Y),this.proxyToSource[H.key][h.id]=[Y]}}let B=!1;for(let U=0;U<m.length;U++){const H=h.getTile(m[U]);if(!H||!H.hasData())continue;const K=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(K&&K.tileID.canonical.z!==H.tileID.canonical.z){const Y=this.proxyToSource[K.tileID.key][h.id],oe=this._createProxiedId(K.tileID,H,b[K.tileID.key]&&b[K.tileID.key][h.id]);Y?Y.splice(Y.length-1,0,oe):this.proxyToSource[K.tileID.key][h.id]=[oe],E.push(oe),B=!0}}this._sourceTilesOverlap[h.id]=B}_setupProxiedCoordsForImageSource(h,m,b){if(!h.getSource().loaded())return;const E=this.proxiedCoords[h.id]=[],I=this.proxyCoords,B=h.getSource(),U=new s.pointGeometry(B.tileID.x,B.tileID.y)._div(1<<B.tileID.z),H=B.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((Y,oe)=>(Y.min.x=Math.min(Y.min.x,oe.x-U.x),Y.min.y=Math.min(Y.min.y,oe.y-U.y),Y.max.x=Math.max(Y.max.x,oe.x-U.x),Y.max.y=Math.max(Y.max.y,oe.y-U.y),Y),{min:new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),K=(Y,oe)=>{const me=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),be=Y.canonical.y/(1<<Y.canonical.z),we=s.EXTENT/(1<<Y.canonical.z),Me=oe.wrap+oe.canonical.x/(1<<oe.canonical.z),_e=oe.canonical.y/(1<<oe.canonical.z);return me+we<Me+H.min.x||me>Me+H.max.x||be+we<_e+H.min.y||be>_e+H.max.y};for(let Y=0;Y<I.length;Y++){const oe=I[Y];for(let me=0;me<m.length;me++){const be=h.getTile(m[me]);if(!be||!be.hasData()||K(oe,be.tileID))continue;const we=this._createProxiedId(oe,be,b[oe.key]&&b[oe.key][h.id]),Me=this.proxyToSource[oe.key][h.id];Me?Me.push(we):this.proxyToSource[oe.key][h.id]=[we],E.push(we)}}}_createProxiedId(h,m,b){let E=this.orthoMatrix;if(b){const I=b.find(B=>B.key===m.tileID.key);if(I)return I}if(m.tileID.key!==h.key){const I=h.canonical.z-m.tileID.canonical.z;let B,U,H;E=s.create();const K=m.tileID.wrap-h.wrap<<h.overscaledZ;I>0?(B=s.EXTENT>>I,U=B*((m.tileID.canonical.x<<I)-h.canonical.x+K),H=B*((m.tileID.canonical.y<<I)-h.canonical.y)):(B=s.EXTENT<<-I,U=s.EXTENT*(m.tileID.canonical.x-(h.canonical.x+K<<-I)),H=s.EXTENT*(m.tileID.canonical.y-(h.canonical.y<<-I))),s.ortho(E,0,B,0,B,0,1),s.translate(E,E,[U,H,0])}return new ju(m.tileID,h.key,E)}_findTileCoveringTileID(h,m){let b=m.getTile(h);if(b&&b.hasData())return b;const E=this._findCoveringTileCache[m.id],I=E[h.key];if(b=I?m.getTileByID(I):null,b&&b.hasData()||I===null)return b;let B=b?b.tileID:h,U=B.overscaledZ;const H=m.getSource().minzoom,K=[];if(!I){const oe=m.getSource().maxzoom;if(h.canonical.z>=oe){const me=h.canonical.z-oe;m.getSource().reparseOverscaled?(U=Math.max(h.canonical.z+2,m.transform.tileZoom),B=new s.OverscaledTileID(U,h.wrap,oe,h.canonical.x>>me,h.canonical.y>>me)):me!==0&&(U=oe,B=new s.OverscaledTileID(U,h.wrap,oe,h.canonical.x>>me,h.canonical.y>>me))}B.key!==h.key&&(K.push(B.key),b=m.getTile(B))}const Y=oe=>{K.forEach(me=>{E[me]=oe}),K.length=0};for(U-=1;U>=H&&(!b||!b.hasData());U--){b&&Y(b.tileID.key);const oe=B.calculateScaledKey(U);if(b=m.getTileByID(oe),b&&b.hasData())break;const me=E[oe];if(me===null)break;me===void 0?K.push(oe):b=m.getTileByID(me)}return Y(b?b.tileID.key:null),b&&b.hasData()?b:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,m){let b=this._tilesDirty[h];b||(b=this._tilesDirty[h]={}),b[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(m){let b=0;const E=new s.StructArrayLayout2ui4,I=131;for(let B=1;B<129;B++){for(let U=1;U<129;U++)b=B*I+U,E.emplaceBack(b,b+1),E.emplaceBack(b,b+I),E.emplaceBack(b+1,b+I),B===128&&E.emplaceBack(b+I,b+I+1);E.emplaceBack(b+1,b+1+I)}return E}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class mo{static cacheKey(h,m,b,E){let I=`${m}${E?E.cacheKey:""}`;for(const B of b)h.usedDefines.includes(B)&&(I+=`/${B}`);return I}constructor(h,m,b,E,I,B){const U=h.gl;this.program=U.createProgram();const H=function(_e){const xe=[];for(let Le=0;Le<_e.length;Le++){if(_e[Le]===null)continue;const Ce=_e[Le].split(" ");xe.push(Ce.pop())}return xe}(b.staticAttributes),K=E?E.getBinderAttributes():[],Y=H.concat(K);let oe=E?E.defines():[];oe=oe.concat(B.map(_e=>`#define ${_e}`));const me=oe.concat(h.extStandardDerivatives?`#extension GL_OES_standard_derivatives : enable
`.concat(Bs):Bs,Bs,Gc,Fh.fragmentSource,Oh.fragmentSource,b.fragmentSource).join(`
`),be=oe.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Gc,Fh.vertexSource,Oh.vertexSource,of.vertexSource,b.vertexSource).join(`
`),we=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);U.shaderSource(we,me),U.compileShader(we),U.attachShader(this.program,we);const Me=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())this.failedToCreate=!0;else{U.shaderSource(Me,be),U.compileShader(Me),U.attachShader(this.program,Me),this.attributes={},this.numAttributes=Y.length;for(let _e=0;_e<this.numAttributes;_e++)Y[_e]&&(U.bindAttribLocation(this.program,_e,Y[_e]),this.attributes[Y[_e]]=_e);U.linkProgram(this.program),U.deleteShader(Me),U.deleteShader(we),this.fixedUniforms=I(h),this.binderUniforms=E?E.getUniforms(h):[],B.includes("TERRAIN")&&(this.terrainUniforms=(_e=>({u_dem:new s.Uniform1i(_e),u_dem_prev:new s.Uniform1i(_e),u_dem_unpack:new s.Uniform4f(_e),u_dem_tl:new s.Uniform2f(_e),u_dem_scale:new s.Uniform1f(_e),u_dem_tl_prev:new s.Uniform2f(_e),u_dem_scale_prev:new s.Uniform1f(_e),u_dem_size:new s.Uniform1f(_e),u_dem_lerp:new s.Uniform1f(_e),u_exaggeration:new s.Uniform1f(_e),u_depth:new s.Uniform1i(_e),u_depth_size_inv:new s.Uniform2f(_e),u_meter_to_dem:new s.Uniform1f(_e),u_label_plane_matrix_inv:new s.UniformMatrix4f(_e)}))(h)),B.includes("GLOBE")&&(this.globeUniforms=(_e=>({u_tile_tl_up:new s.Uniform3f(_e),u_tile_tr_up:new s.Uniform3f(_e),u_tile_br_up:new s.Uniform3f(_e),u_tile_bl_up:new s.Uniform3f(_e),u_tile_up_scale:new s.Uniform1f(_e)}))(h)),B.includes("FOG")&&(this.fogUniforms=(_e=>({u_fog_matrix:new s.UniformMatrix4f(_e),u_fog_range:new s.Uniform2f(_e),u_fog_color:new s.Uniform4f(_e),u_fog_horizon_blend:new s.Uniform1f(_e),u_fog_temporal_offset:new s.Uniform1f(_e),u_frustum_tl:new s.Uniform3f(_e),u_frustum_tr:new s.Uniform3f(_e),u_frustum_br:new s.Uniform3f(_e),u_frustum_bl:new s.Uniform3f(_e),u_globe_pos:new s.Uniform3f(_e),u_globe_radius:new s.Uniform1f(_e),u_globe_transition:new s.Uniform1f(_e),u_is_globe:new s.Uniform1i(_e),u_viewport:new s.Uniform2f(_e)}))(h))}}setTerrainUniformValues(h,m){if(!this.terrainUniforms)return;const b=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const E in m)b[E]&&b[E].set(this.program,E,m[E])}}setGlobeUniformValues(h,m){if(!this.globeUniforms)return;const b=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const E in m)b[E]&&b[E].set(this.program,E,m[E])}}setFogUniformValues(h,m){if(!this.fogUniforms)return;const b=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const E in m)b[E].set(this.program,E,m[E])}}draw(h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me){const _e=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(b),h.setStencilMode(E),h.setColorMode(I),h.setCullFace(B);for(const Le of Object.keys(this.fixedUniforms))this.fixedUniforms[Le].set(this.program,Le,U[Le]);we&&we.setUniforms(this.program,h,this.binderUniforms,me,{zoom:be});const xe={[_e.LINES]:2,[_e.TRIANGLES]:3,[_e.LINE_STRIP]:1}[m];for(const Le of oe.get()){const Ce=Le.vaos||(Le.vaos={});(Ce[H]||(Ce[H]=new Zp)).bind(h,this,K,we?we.getPaintVertexBuffers():[],Y,Le.vertexOffset,Me||[]),_e.drawElements(m,Le.primitiveLength*xe,_e.UNSIGNED_SHORT,Le.primitiveOffset*xe*2)}}}function $s(y,h){const m=Math.pow(2,h.tileID.overscaledZ),b=h.tileSize*Math.pow(2,y.transform.tileZoom)/m,E=b*(h.tileID.canonical.x+h.tileID.wrap*m),I=b*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/ze(h,1,y.transform.tileZoom),u_pixel_coord_upper:[E>>16,I>>16],u_pixel_coord_lower:[65535&E,65535&I]}}const Jl=s.create(),Oa=(y,h,m,b,E,I,B,U,H,K,Y)=>{const oe=h.style.light,me=oe.properties.get("position"),be=[me.x,me.y,me.z],we=s.create$1();oe.properties.get("anchor")==="viewport"&&(s.fromRotation(we,-h.transform.angle),s.transformMat3(be,be,we));const Me=oe.properties.get("color"),_e=h.transform,xe={u_matrix:y,u_lightpos:be,u_lightintensity:oe.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_vertical_gradient:+m,u_opacity:b,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Jl,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:E,u_edge_radius:I};return _e.projection.name==="globe"&&(xe.u_tile_id=[B.canonical.x,B.canonical.y,1<<B.canonical.z],xe.u_zoom_transition=H,xe.u_inv_rot_matrix=Y,xe.u_merc_center=K,xe.u_up_dir=_e.projection.upVector(new s.CanonicalTileID(0,0,0),K[0]*s.EXTENT,K[1]*s.EXTENT),xe.u_height_lift=U),xe},dl=(y,h,m,b,E,I,B,U,H,K,Y,oe)=>{const me=Oa(y,h,m,b,E,I,B,H,K,Y,oe),be={u_height_factor:-Math.pow(2,B.overscaledZ)/U.tileSize/8};return s.extend(me,$s(h,U),be)},Fa=y=>({u_matrix:y}),Gh=(y,h,m)=>s.extend(Fa(y),$s(h,m)),Wh=(y,h)=>({u_matrix:y,u_world:h}),Hh=(y,h,m,b)=>s.extend(Gh(y,h,m),{u_world:b}),go=s.create(),_o=(y,h,m,b,E,I)=>{const B=y.transform,U=B.projection.name==="globe";let H;if(I.paint.get("circle-pitch-alignment")==="map")if(U){const Y=s.globePixelsToTileUnits(B.zoom,h.canonical)*B._pixelsPerMercatorPixel;H=Float32Array.from([Y,0,0,Y])}else H=B.calculatePixelsToTileUnitsMatrix(m);else H=new Float32Array([B.pixelsToGLUnits[0],0,0,B.pixelsToGLUnits[1]]);const K={u_camera_to_center_distance:B.cameraToCenterDistance,u_matrix:y.translatePosMatrix(h.projMatrix,m,I.paint.get("circle-translate"),I.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:H,u_inv_rot_matrix:go,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(U){K.u_inv_rot_matrix=b,K.u_merc_center=E,K.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],K.u_zoom_transition=s.globeToMercatorTransition(B.zoom);const Y=E[0]*s.EXTENT,oe=E[1]*s.EXTENT;K.u_up_dir=B.projection.upVector(new s.CanonicalTileID(0,0,0),Y,oe)}return K},Ar=y=>{const h=[];return y.paint.get("circle-pitch-alignment")==="map"&&h.push("PITCH_WITH_MAP"),y.paint.get("circle-pitch-scale")==="map"&&h.push("SCALE_WITH_MAP"),h},fl=(y,h,m,b)=>{const E=s.EXTENT/m.tileSize;return{u_matrix:y,u_camera_to_center_distance:h.getCameraToCenterDistance(b),u_extrude_scale:[h.pixelsToGLUnits[0]/E,h.pixelsToGLUnits[1]/E]}},Ns=(y,h,m=1)=>({u_matrix:y,u_color:h,u_overlay:0,u_overlay_scale:m}),Xp=s.create(),jh=(y,h,m,b,E,I,B)=>{const U=y.transform,H=U.projection.name==="globe",K=H?s.globePixelsToTileUnits(U.zoom,h.canonical)*U._pixelsPerMercatorPixel:ze(m,1,I),Y={u_matrix:h.projMatrix,u_extrude_scale:K,u_intensity:B,u_inv_rot_matrix:Xp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(H){Y.u_inv_rot_matrix=b,Y.u_merc_center=E,Y.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],Y.u_zoom_transition=s.globeToMercatorTransition(U.zoom);const oe=E[0]*s.EXTENT,me=E[1]*s.EXTENT;Y.u_up_dir=U.projection.upVector(new s.CanonicalTileID(0,0,0),oe,me)}return Y},qh=(y,h,m,b,E,I,B)=>{const U=y.transform,H=U.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:Hc(y,h,m,b),u_pixels_to_tile_units:H,u_device_pixel_ratio:I,u_units_to_pixels:[1/U.pixelsToGLUnits[0],1/U.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:E,u_texsize:pl(m)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Zh(h,y.transform),u_alpha_discard_threshold:0,u_trim_offset:B}},jo=(y,h,m,b,E)=>{const I=y.transform;return{u_matrix:Hc(y,h,m,b),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:I.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:E,u_image:0,u_tile_units_to_pixels:Zh(h,I),u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Zh(y,h){return 1/ze(y,1,h.tileZoom)}function Hc(y,h,m,b){return y.translatePosMatrix(b||h.tileID.projMatrix,h,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function pl(y){const h=y.paint.get("line-dasharray").value;return h.value||h.kind!=="constant"}const lf=(y,h,m,b,E,I)=>{return{u_matrix:y,u_tl_parent:h,u_scale_parent:m,u_fade_t:b.mix,u_opacity:b.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(U=E.paint.get("raster-saturation"),U>0?1-1/(1.001-U):-U),u_contrast_factor:(B=E.paint.get("raster-contrast"),B>0?1/(1-B):1+B),u_spin_weights:jc(E.paint.get("raster-hue-rotate")),u_perspective_transform:I};var B,U};function jc(y){y*=Math.PI/180;const h=Math.sin(y),m=Math.cos(y);return[(2*m+1)/3,(-Math.sqrt(3)*h-m+1)/3,(Math.sqrt(3)*h-m+1)/3]}const Xh=s.create(),$h=(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me)=>{const _e=E.transform,xe={u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:_e.width/_e.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:I,u_label_plane_matrix:B,u_coord_matrix:U,u_is_text:+H,u_pitch_with_map:+b,u_texsize:K,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xh,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Xh,u_up_vector:[0,-1,0]};return Me.name==="globe"&&(xe.u_tile_id=[Y.canonical.x,Y.canonical.y,1<<Y.canonical.z],xe.u_zoom_transition=oe,xe.u_inv_rot_matrix=be,xe.u_merc_center=me,xe.u_camera_forward=_e._camera.forward(),xe.u_ecef_origin=s.globeECEFOrigin(_e.globeMatrix,Y.toUnwrapped()),xe.u_tile_matrix=Float32Array.from(_e.globeMatrix),xe.u_up_vector=we),xe},$p=(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me,_e)=>s.extend($h(y,h,m,b,E,I,B,U,H,K,oe,me,be,we,Me,_e),{u_gamma_scale:b?E.transform.cameraToCenterDistance*Math.cos(E.terrain?0:E.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+Y}),ml=(y,h,m,b,E,I,B,U,H,K,Y,oe,me,be,we,Me)=>s.extend($p(y,h,m,b,E,I,B,U,!0,H,!0,Y,oe,me,be,we,Me),{u_texsize_icon:K,u_texture_icon:1}),Bg=(y,h,m)=>({u_matrix:y,u_opacity:h,u_color:m}),qc=(y,h,m,b,E)=>s.extend(function(I,B,U){const H=B.imageManager.getPattern(I.toString()),{width:K,height:Y}=B.imageManager.getPixelSize(),oe=Math.pow(2,U.tileID.overscaledZ),me=U.tileSize*Math.pow(2,B.transform.tileZoom)/oe,be=me*(U.tileID.canonical.x+U.tileID.wrap*oe),we=me*U.tileID.canonical.y;return{u_image:0,u_pattern_tl:H.tl,u_pattern_br:H.br,u_texsize:[K,Y],u_pattern_size:H.displaySize,u_tile_units_to_pixels:1/ze(U,1,B.transform.tileZoom),u_pixel_coord_upper:[be>>16,we>>16],u_pixel_coord_lower:[65535&be,65535&we]}}(b,m,E),{u_matrix:y,u_opacity:h}),qo={fillExtrusion:y=>({u_matrix:new s.UniformMatrix4f(y),u_lightpos:new s.Uniform3f(y),u_lightintensity:new s.Uniform1f(y),u_lightcolor:new s.Uniform3f(y),u_vertical_gradient:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_edge_radius:new s.Uniform1f(y),u_ao:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_up_dir:new s.Uniform3f(y),u_height_lift:new s.Uniform1f(y)}),fillExtrusionPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_lightpos:new s.Uniform3f(y),u_lightintensity:new s.Uniform1f(y),u_lightcolor:new s.Uniform3f(y),u_vertical_gradient:new s.Uniform1f(y),u_height_factor:new s.Uniform1f(y),u_edge_radius:new s.Uniform1f(y),u_ao:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_up_dir:new s.Uniform3f(y),u_height_lift:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y)}),fill:y=>({u_matrix:new s.UniformMatrix4f(y)}),fillPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),fillOutline:y=>({u_matrix:new s.UniformMatrix4f(y),u_world:new s.Uniform2f(y)}),fillOutlinePattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_world:new s.Uniform2f(y),u_image:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),circle:y=>({u_camera_to_center_distance:new s.Uniform1f(y),u_extrude_scale:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_up_dir:new s.Uniform3f(y)}),collisionBox:y=>({u_matrix:new s.UniformMatrix4f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_extrude_scale:new s.Uniform2f(y)}),collisionCircle:y=>({u_matrix:new s.UniformMatrix4f(y),u_inv_matrix:new s.UniformMatrix4f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_viewport_size:new s.Uniform2f(y)}),debug:y=>({u_color:new s.UniformColor(y),u_matrix:new s.UniformMatrix4f(y),u_overlay:new s.Uniform1i(y),u_overlay_scale:new s.Uniform1f(y)}),clippingMask:y=>({u_matrix:new s.UniformMatrix4f(y)}),heatmap:y=>({u_extrude_scale:new s.Uniform1f(y),u_intensity:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_up_dir:new s.Uniform3f(y)}),heatmapTexture:y=>({u_image:new s.Uniform1i(y),u_color_ramp:new s.Uniform1i(y),u_opacity:new s.Uniform1f(y)}),hillshade:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_latrange:new s.Uniform2f(y),u_light:new s.Uniform2f(y),u_shadow:new s.UniformColor(y),u_highlight:new s.UniformColor(y),u_accent:new s.UniformColor(y)}),hillshadePrepare:y=>({u_matrix:new s.UniformMatrix4f(y),u_image:new s.Uniform1i(y),u_dimension:new s.Uniform2f(y),u_zoom:new s.Uniform1f(y),u_unpack:new s.Uniform4f(y)}),line:y=>({u_matrix:new s.UniformMatrix4f(y),u_pixels_to_tile_units:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_units_to_pixels:new s.Uniform2f(y),u_dash_image:new s.Uniform1i(y),u_gradient_image:new s.Uniform1i(y),u_image_height:new s.Uniform1f(y),u_texsize:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_alpha_discard_threshold:new s.Uniform1f(y),u_trim_offset:new s.Uniform2f(y)}),linePattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_texsize:new s.Uniform2f(y),u_pixels_to_tile_units:new s.UniformMatrix2f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_units_to_pixels:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y),u_alpha_discard_threshold:new s.Uniform1f(y)}),raster:y=>({u_matrix:new s.UniformMatrix4f(y),u_tl_parent:new s.Uniform2f(y),u_scale_parent:new s.Uniform1f(y),u_fade_t:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_image0:new s.Uniform1i(y),u_image1:new s.Uniform1i(y),u_brightness_low:new s.Uniform1f(y),u_brightness_high:new s.Uniform1f(y),u_saturation_factor:new s.Uniform1f(y),u_contrast_factor:new s.Uniform1f(y),u_spin_weights:new s.Uniform3f(y),u_perspective_transform:new s.Uniform2f(y)}),symbolIcon:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_camera_forward:new s.Uniform3f(y),u_tile_matrix:new s.UniformMatrix4f(y),u_up_vector:new s.Uniform3f(y),u_ecef_origin:new s.Uniform3f(y),u_texture:new s.Uniform1i(y)}),symbolSDF:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_texture:new s.Uniform1i(y),u_gamma_scale:new s.Uniform1f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_tile_id:new s.Uniform3f(y),u_zoom_transition:new s.Uniform1f(y),u_inv_rot_matrix:new s.UniformMatrix4f(y),u_merc_center:new s.Uniform2f(y),u_camera_forward:new s.Uniform3f(y),u_tile_matrix:new s.UniformMatrix4f(y),u_up_vector:new s.Uniform3f(y),u_ecef_origin:new s.Uniform3f(y),u_is_halo:new s.Uniform1i(y)}),symbolTextAndIcon:y=>({u_is_size_zoom_constant:new s.Uniform1i(y),u_is_size_feature_constant:new s.Uniform1i(y),u_size_t:new s.Uniform1f(y),u_size:new s.Uniform1f(y),u_camera_to_center_distance:new s.Uniform1f(y),u_rotate_symbol:new s.Uniform1i(y),u_aspect_ratio:new s.Uniform1f(y),u_fade_change:new s.Uniform1f(y),u_matrix:new s.UniformMatrix4f(y),u_label_plane_matrix:new s.UniformMatrix4f(y),u_coord_matrix:new s.UniformMatrix4f(y),u_is_text:new s.Uniform1i(y),u_pitch_with_map:new s.Uniform1i(y),u_texsize:new s.Uniform2f(y),u_texsize_icon:new s.Uniform2f(y),u_texture:new s.Uniform1i(y),u_texture_icon:new s.Uniform1i(y),u_gamma_scale:new s.Uniform1f(y),u_device_pixel_ratio:new s.Uniform1f(y),u_is_halo:new s.Uniform1i(y)}),background:y=>({u_matrix:new s.UniformMatrix4f(y),u_opacity:new s.Uniform1f(y),u_color:new s.UniformColor(y)}),backgroundPattern:y=>({u_matrix:new s.UniformMatrix4f(y),u_opacity:new s.Uniform1f(y),u_image:new s.Uniform1i(y),u_pattern_tl:new s.Uniform2f(y),u_pattern_br:new s.Uniform2f(y),u_texsize:new s.Uniform2f(y),u_pattern_size:new s.Uniform2f(y),u_pixel_coord_upper:new s.Uniform2f(y),u_pixel_coord_lower:new s.Uniform2f(y),u_tile_units_to_pixels:new s.Uniform1f(y)}),terrainRaster:Kl,terrainDepth:Kl,skybox:y=>({u_matrix:new s.UniformMatrix4f(y),u_sun_direction:new s.Uniform3f(y),u_cubemap:new s.Uniform1i(y),u_opacity:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y)}),skyboxGradient:y=>({u_matrix:new s.UniformMatrix4f(y),u_color_ramp:new s.Uniform1i(y),u_center_direction:new s.Uniform3f(y),u_radius:new s.Uniform1f(y),u_opacity:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y)}),skyboxCapture:y=>({u_matrix_3f:new s.UniformMatrix3f(y),u_sun_direction:new s.Uniform3f(y),u_sun_intensity:new s.Uniform1f(y),u_color_tint_r:new s.Uniform4f(y),u_color_tint_m:new s.Uniform4f(y),u_luminance:new s.Uniform1f(y)}),globeRaster:y=>({u_proj_matrix:new s.UniformMatrix4f(y),u_globe_matrix:new s.UniformMatrix4f(y),u_normalize_matrix:new s.UniformMatrix4f(y),u_merc_matrix:new s.UniformMatrix4f(y),u_zoom_transition:new s.Uniform1f(y),u_merc_center:new s.Uniform2f(y),u_image0:new s.Uniform1i(y),u_grid_matrix:new s.UniformMatrix3f(y),u_frustum_tl:new s.Uniform3f(y),u_frustum_tr:new s.Uniform3f(y),u_frustum_br:new s.Uniform3f(y),u_frustum_bl:new s.Uniform3f(y),u_globe_pos:new s.Uniform3f(y),u_globe_radius:new s.Uniform1f(y),u_viewport:new s.Uniform2f(y)}),globeAtmosphere:y=>({u_frustum_tl:new s.Uniform3f(y),u_frustum_tr:new s.Uniform3f(y),u_frustum_br:new s.Uniform3f(y),u_frustum_bl:new s.Uniform3f(y),u_horizon:new s.Uniform1f(y),u_transition:new s.Uniform1f(y),u_fadeout_range:new s.Uniform1f(y),u_color:new s.Uniform4f(y),u_high_color:new s.Uniform4f(y),u_space_color:new s.Uniform4f(y),u_star_intensity:new s.Uniform1f(y),u_star_density:new s.Uniform1f(y),u_star_size:new s.Uniform1f(y),u_temporal_offset:new s.Uniform1f(y),u_horizon_angle:new s.Uniform1f(y),u_rotation_matrix:new s.UniformMatrix4f(y)})};let Ba;function Zc(y,h,m,b,E,I,B){const U=y.context,H=U.gl,K=y.transform,Y=y.useProgram("collisionBox"),oe=[];let me=0,be=0;for(let Ue=0;Ue<b.length;Ue++){const Xe=b[Ue],Ze=h.getTile(Xe),tt=Ze.getBucket(m);if(!tt)continue;const ft=sl(Xe,tt,K);let lt=ft;E[0]===0&&E[1]===0||(lt=y.translatePosMatrix(ft,Ze,E,I));const it=B?tt.textCollisionBox:tt.iconCollisionBox,Wt=tt.collisionCircleArray;if(Wt.length>0){const ot=s.create(),bt=lt;s.mul(ot,tt.placementInvProjMatrix,K.glCoordMatrix),s.mul(ot,ot,tt.placementViewportMatrix),oe.push({circleArray:Wt,circleOffset:be,transform:bt,invTransform:ot,projection:tt.getProjection()}),me+=Wt.length/4,be=me}it&&(y.terrain&&y.terrain.setupElevationDraw(Ze,Y),Y.draw(U,H.LINES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,fl(lt,K,Ze,tt.getProjection()),m.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,null,K.zoom,null,[it.collisionVertexBuffer,it.collisionVertexBufferExt]))}if(!B||!oe.length)return;const we=y.useProgram("collisionCircle"),Me=new s.StructArrayLayout2f1f2i16;Me.resize(4*me),Me._trim();let _e=0;for(const Ue of oe)for(let Xe=0;Xe<Ue.circleArray.length/4;Xe++){const Ze=4*Xe,tt=Ue.circleArray[Ze+0],ft=Ue.circleArray[Ze+1],lt=Ue.circleArray[Ze+2],it=Ue.circleArray[Ze+3];Me.emplace(_e++,tt,ft,lt,it,0),Me.emplace(_e++,tt,ft,lt,it,1),Me.emplace(_e++,tt,ft,lt,it,2),Me.emplace(_e++,tt,ft,lt,it,3)}(!Ba||Ba.length<2*me)&&(Ba=function(Ue){const Xe=2*Ue,Ze=new s.StructArrayLayout3ui6;Ze.resize(Xe),Ze._trim();for(let tt=0;tt<Xe;tt++){const ft=6*tt;Ze.uint16[ft+0]=4*tt+0,Ze.uint16[ft+1]=4*tt+1,Ze.uint16[ft+2]=4*tt+2,Ze.uint16[ft+3]=4*tt+2,Ze.uint16[ft+4]=4*tt+3,Ze.uint16[ft+5]=4*tt+0}return Ze}(me));const xe=U.createIndexBuffer(Ba,!0),Le=U.createVertexBuffer(Me,s.collisionCircleLayout.members,!0);for(const Ue of oe){const Xe={u_matrix:Ue.transform,u_inv_matrix:Ue.invTransform,u_camera_to_center_distance:(Ce=K).getCameraToCenterDistance(Ue.projection),u_viewport_size:[Ce.width,Ce.height]};we.draw(U,H.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,y.colorModeForRenderPass(),s.CullFaceMode.disabled,Xe,m.id,Le,xe,s.SegmentVector.simpleSegment(0,2*Ue.circleOffset,Ue.circleArray.length,Ue.circleArray.length/2),null,K.zoom)}var Ce;Le.destroy(),xe.destroy()}const yo=s.create();function Yp({width:y,height:h,anchor:m,textOffset:b,textScale:E},I){const{horizontalAlign:B,verticalAlign:U}=s.getAnchorAlignment(m),H=-(B-.5)*y,K=-(U-.5)*h,Y=s.evaluateVariableOffset(m,b);return new s.pointGeometry((H/E+Y[0])*I,(K/E+Y[1])*I)}function Xc(y,h,m,b,E,I,B,U,H,K,Y){const oe=y.text.placedSymbolArray,me=y.text.dynamicLayoutVertexArray,be=y.icon.dynamicLayoutVertexArray,we={},Me=y.getProjection(),_e=Zl(U,Me,I),xe=I.elevation,Le=Me.upVectorScale(U.canonical,I.center.lat,I.worldSize).metersToTile;me.clear();for(let Ce=0;Ce<oe.length;Ce++){const Ue=oe.get(Ce),{tileAnchorX:Xe,tileAnchorY:Ze,numGlyphs:tt}=Ue,ft=y.allowVerticalPlacement&&!Ue.placedOrientation,lt=Ue.hidden||!Ue.crossTileID||ft?null:b[Ue.crossTileID];if(lt){let it=0,Wt=0,ot=0;if(xe){const Qt=xe?xe.getAtTileOffset(U,Xe,Ze):0,[mn,cn,Fn]=Me.upVector(U.canonical,Xe,Ze);it=Qt*mn*Le,Wt=Qt*cn*Le,ot=Qt*Fn*Le}let[bt,mt,Ut,gt]=qi(Ue.projectedAnchorX+it,Ue.projectedAnchorY+Wt,Ue.projectedAnchorZ+ot,m?_e:B);const Lt=Kt(I.getCameraToCenterDistance(Me),gt);let kt=E.evaluateSizeForFeature(y.textSizeData,K,Ue)*Lt/s.ONE_EM;m&&(kt*=y.tilePixelRatio/H);const Ye=Yp(lt,kt);m?({x:bt,y:mt,z:Ut}=Me.projectTilePoint(Xe+Ye.x,Ze+Ye.y,U.canonical),[bt,mt,Ut]=qi(bt+it,mt+Wt,Ut+ot,B)):(h&&Ye._rotate(-I.angle),bt+=Ye.x,mt+=Ye.y,Ut=0);const at=y.allowVerticalPlacement&&Ue.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Qt=0;Qt<tt;Qt++)s.addDynamicAttributes(me,bt,mt,Ut,at);Y&&Ue.associatedIconIndex>=0&&(we[Ue.associatedIconIndex]={x:bt,y:mt,z:Ut,angle:at})}else As(tt,me)}if(Y){be.clear();const Ce=y.icon.placedSymbolArray;for(let Ue=0;Ue<Ce.length;Ue++){const Xe=Ce.get(Ue),{numGlyphs:Ze}=Xe,tt=we[Ue];if(Xe.hidden||!tt)As(Ze,be);else{const{x:ft,y:lt,z:it,angle:Wt}=tt;for(let ot=0;ot<Ze;ot++)s.addDynamicAttributes(be,ft,lt,it,Wt)}}y.icon.dynamicLayoutVertexBuffer.updateData(be)}y.text.dynamicLayoutVertexBuffer.updateData(me)}function Kp(y,h,m){return m.iconsInText&&h?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function gl(y,h,m,b,E,I,B,U,H,K,Y,oe){const me=y.context,be=me.gl,we=y.transform,Me=U==="map",_e=H==="map",xe=Me&&m.layout.get("symbol-placement")!=="point",Le=Me&&!_e&&!xe,Ce=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Ue=!1;const Xe=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),Ze=[s.mercatorXfromLng(we.center.lng),s.mercatorYfromLat(we.center.lat)],tt=m.layout.get("text-variable-anchor"),ft=we.projection.name==="globe",lt=[],it=[0,-1,0];let Wt=it;!ft&&!we.mercatorFromTransition||Me||(Wt=function(ot){const bt=ot._camera.getWorldToCamera(ot.worldSize,1),mt=s.multiply([],bt,ot.globeMatrix);s.invert(mt,mt);const Ut=[0,0,0],gt=[0,1,0,0];return s.transformMat4$1(gt,gt,mt),Ut[0]=gt[0],Ut[1]=gt[1],Ut[2]=gt[2],s.normalize(Ut,Ut),Ut}(we));for(const ot of b){const bt=h.getTile(ot),mt=bt.getBucket(m);if(!mt||mt.projection.name==="mercator"&&ft)continue;const Ut=E?mt.text:mt.icon;if(!Ut||mt.fullyClipped||!Ut.segments.get().length)continue;const gt=Ut.programConfigurations.get(m.id),Lt=E||mt.sdfIcons,kt=E?mt.textSizeData:mt.iconSizeData,Ye=_e||we.pitch!==0,at=s.evaluateSizeForZoom(kt,we.zoom);let Qt,mn,cn,Fn,zn=[0,0],In=null;if(E){if(mn=bt.glyphAtlasTexture,cn=be.LINEAR,Qt=bt.glyphAtlasTexture.size,mt.iconsInText){zn=bt.imageAtlasTexture.size,In=bt.imageAtlasTexture;const rs=kt.kind==="composite"||kt.kind==="camera";Fn=Ye||y.options.rotating||y.options.zooming||rs?be.LINEAR:be.NEAREST}}else{const rs=m.layout.get("icon-size").constantOr(0)!==1||mt.iconsNeedLinear;mn=bt.imageAtlasTexture,cn=Lt||y.options.rotating||y.options.zooming||rs||Ye?be.LINEAR:be.NEAREST,Qt=bt.imageAtlasTexture.size}const an=mt.projection.name==="globe",Li=an?Wt:it,bi=an?s.globeToMercatorTransition(we.zoom):0,ki=Zl(ot,mt.getProjection(),we),si=we.calculatePixelsToTileUnitsMatrix(bt),Us=ci(ki,bt.tileID.canonical,_e,Me,we,mt.getProjection(),si),Js=y.terrain&&_e&&xe?s.invert(s.create(),Us):yo,Xr=Ur(ki,bt.tileID.canonical,_e,Me,we,mt.getProjection(),si),Ro=tt&&mt.hasTextData(),Zi=m.layout.get("icon-text-fit")!=="none"&&Ro&&mt.hasIconData();if(xe){const rs=we.elevation,Vr=rs?rs.getAtTileOffsetFunc(ot,we.center.lat,we.worldSize,mt.getProjection()):null,zo=wr(ki,bt.tileID.canonical,_e,Me,we,mt.getProjection(),si);Kn(mt,ki,y,E,zo,Xr,_e,K,Vr,ot)}const Si=xe||E&&tt||Zi,xi=y.translatePosMatrix(ki,bt,I,B),rr=Si?yo:Us,is=y.translatePosMatrix(Xr,bt,I,B,!0),Oi=mt.getProjection().createInversionMatrix(we,ot.canonical),Ls=[];y.terrainRenderModeElevated()&&_e&&Ls.push("PITCH_WITH_MAP_TERRAIN"),an&&Ls.push("PROJECTION_GLOBE_VIEW"),Si&&Ls.push("PROJECTED_POS_ON_VIEWPORT");const ic=Lt&&m.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let $o;$o=Lt?mt.iconsInText?ml(kt.kind,at,Le,_e,y,xi,rr,is,Qt,zn,ot,bi,Ze,Oi,Li,mt.getProjection()):$p(kt.kind,at,Le,_e,y,xi,rr,is,E,Qt,!0,ot,bi,Ze,Oi,Li,mt.getProjection()):$h(kt.kind,at,Le,_e,y,xi,rr,is,E,Qt,ot,bi,Ze,Oi,Li,mt.getProjection());const Xi={program:y.useProgram(Kp(Lt,E,mt),gt,Ls),buffers:Ut,uniformValues:$o,atlasTexture:mn,atlasTextureIcon:In,atlasInterpolation:cn,atlasInterpolationIcon:Fn,isSDF:Lt,hasHalo:ic,tile:bt,labelPlaneMatrixInv:Js};if(Ce&&mt.canOverlap){Ue=!0;const rs=Ut.segments.get();for(const Vr of rs)lt.push({segments:new s.SegmentVector([Vr]),sortKey:Vr.sortKey,state:Xi})}else lt.push({segments:Ut.segments,sortKey:0,state:Xi})}Ue&&lt.sort((ot,bt)=>ot.sortKey-bt.sortKey);for(const ot of lt){const bt=ot.state;if(y.terrain&&y.terrain.setupElevationDraw(bt.tile,bt.program,{useDepthForOcclusion:!ft,labelPlaneMatrixInv:bt.labelPlaneMatrixInv}),me.activeTexture.set(be.TEXTURE0),bt.atlasTexture.bind(bt.atlasInterpolation,be.CLAMP_TO_EDGE),bt.atlasTextureIcon&&(me.activeTexture.set(be.TEXTURE1),bt.atlasTextureIcon&&bt.atlasTextureIcon.bind(bt.atlasInterpolationIcon,be.CLAMP_TO_EDGE)),bt.isSDF){const mt=bt.uniformValues;bt.hasHalo&&(mt.u_is_halo=1,Cr(bt.buffers,ot.segments,m,y,bt.program,Xe,Y,oe,mt)),mt.u_is_halo=0}Cr(bt.buffers,ot.segments,m,y,bt.program,Xe,Y,oe,bt.uniformValues)}}function Cr(y,h,m,b,E,I,B,U,H){const K=b.context,Y=[y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer,y.globeExtVertexBuffer];E.draw(K,K.gl.TRIANGLES,I,B,U,s.CullFaceMode.disabled,H,m.id,y.layoutVertexBuffer,y.indexBuffer,h,m.paint,b.transform.zoom,y.programConfigurations.get(m.id),Y)}function Yh(y,h,m,b,E,I,B){const U=y.context.gl,H=m.paint.get("fill-pattern"),K=H&&H.constantOr(1);let Y,oe,me,be,we;B?(oe=K&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Y=U.LINES):(oe=K?"fillPattern":"fill",Y=U.TRIANGLES);for(const Me of b){const _e=h.getTile(Me);if(K&&!_e.patternsLoaded())continue;const xe=_e.getBucket(m);if(!xe)continue;y.prepareDrawTile();const Le=xe.programConfigurations.get(m.id),Ce=y.useProgram(oe,Le);K&&(y.context.activeTexture.set(U.TEXTURE0),_e.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Le.updatePaintBuffers());const Ue=H.constantOr(null);if(Ue&&_e.imageAtlas){const Ze=_e.imageAtlas.patternPositions[Ue.toString()];Ze&&Le.setConstantPatternPositions(Ze)}const Xe=y.translatePosMatrix(Me.projMatrix,_e,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(B){be=xe.indexBuffer2,we=xe.segments2;const Ze=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[U.drawingBufferWidth,U.drawingBufferHeight];me=oe==="fillOutlinePattern"&&K?Hh(Xe,y,_e,Ze):Wh(Xe,Ze)}else be=xe.indexBuffer,we=xe.segments,me=K?Gh(Xe,y,_e):Fa(Xe);y.prepareDrawProgram(y.context,Ce,Me.toUnwrapped()),Ce.draw(y.context,Y,E,y.stencilModeForClipping(Me),I,s.CullFaceMode.disabled,me,m.id,xe.layoutVertexBuffer,be,we,m.paint,y.transform.zoom,Le)}}function Kh(y,h,m,b,E,I,B){const U=y.context,H=U.gl,K=y.transform,Y=m.paint.get("fill-extrusion-pattern"),oe=Y.constantOr(1),me=m.paint.get("fill-extrusion-opacity"),be=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],we=m.layout.get("fill-extrusion-edge-radius"),Me=K.projection.name==="globe"?s.fillExtrusionHeightLift():0,_e=K.projection.name==="globe",xe=_e?s.globeToMercatorTransition(K.zoom):0,Le=[s.mercatorXfromLng(K.center.lng),s.mercatorYfromLat(K.center.lat)],Ce=[];_e&&(Ce.push("PROJECTION_GLOBE_VIEW"),y.style.terrainSetForDrapingOnly()&&Ce.push("TERRAIN")),be[0]>0&&Ce.push("FAUX_AO");for(const Ue of b){const Xe=h.getTile(Ue),Ze=Xe.getBucket(m);if(!Ze||Ze.projection.name!==K.projection.name)continue;const tt=Ze.programConfigurations.get(m.id),ft=y.useProgram(oe?"fillExtrusionPattern":"fillExtrusion",tt,Ce);if(y.terrain){const Ut=y.terrain;if(y.style.terrainSetForDrapingOnly())Ut.setupElevationDraw(Xe,ft,{useMeterToDem:!0});else{if(!Ze.enableTerrain)continue;if(Ut.setupElevationDraw(Xe,ft,{useMeterToDem:!0}),Jp(U,h,Ue,Ze,m,Ut),!Ze.centroidVertexBuffer){const gt=ft.attributes.a_centroid_pos;gt!==void 0&&H.vertexAttrib2f(gt,0,0)}}}oe&&(y.context.activeTexture.set(H.TEXTURE0),Xe.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),tt.updatePaintBuffers());const lt=Y.constantOr(null);if(lt&&Xe.imageAtlas){const Ut=Xe.imageAtlas.patternPositions[lt.toString()];Ut&&tt.setConstantPatternPositions(Ut)}const it=y.translatePosMatrix(Ue.projMatrix,Xe,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Wt=K.projection.createInversionMatrix(K,Ue.canonical),ot=m.paint.get("fill-extrusion-vertical-gradient"),bt=oe?dl(it,y,ot,me,be,we,Ue,Xe,Me,xe,Le,Wt):Oa(it,y,ot,me,be,we,Ue,Me,xe,Le,Wt);y.prepareDrawProgram(U,ft,Ue.toUnwrapped());const mt=[];y.terrain&&mt.push(Ze.centroidVertexBuffer),_e&&mt.push(Ze.layoutVertexExtBuffer),ft.draw(U,U.gl.TRIANGLES,E,I,B,s.CullFaceMode.backCCW,bt,m.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,m.paint,y.transform.zoom,tt,mt)}}function Jp(y,h,m,b,E,I){const B=[xe=>{let Le=xe.canonical.x-1,Ce=xe.wrap;return Le<0&&(Le=(1<<xe.canonical.z)-1,Ce--),new s.OverscaledTileID(xe.overscaledZ,Ce,xe.canonical.z,Le,xe.canonical.y)},xe=>{let Le=xe.canonical.x+1,Ce=xe.wrap;return Le===1<<xe.canonical.z&&(Le=0,Ce++),new s.OverscaledTileID(xe.overscaledZ,Ce,xe.canonical.z,Le,xe.canonical.y)},xe=>new s.OverscaledTileID(xe.overscaledZ,xe.wrap,xe.canonical.z,xe.canonical.x,(xe.canonical.y===0?1<<xe.canonical.z:xe.canonical.y)-1),xe=>new s.OverscaledTileID(xe.overscaledZ,xe.wrap,xe.canonical.z,xe.canonical.x,xe.canonical.y===(1<<xe.canonical.z)-1?0:xe.canonical.y+1)],U=xe=>{const Le=h.getSource().minzoom,Ce=Xe=>{const Ze=h.getTileByID(Xe);if(Ze&&Ze.hasData())return Ze.getBucket(E)},Ue=[0,-1,1];for(const Xe of Ue){if(xe.overscaledZ+Xe<Le)continue;const Ze=Ce(xe.calculateScaledKey(xe.overscaledZ+Xe));if(Ze)return Ze}},H=[0,0,0],K=(xe,Le)=>(H[0]=Math.min(xe.min.y,Le.min.y),H[1]=Math.max(xe.max.y,Le.max.y),H[2]=s.EXTENT-Le.min.x>xe.max.x?Le.min.x-s.EXTENT:xe.max.x,H),Y=(xe,Le)=>(H[0]=Math.min(xe.min.x,Le.min.x),H[1]=Math.max(xe.max.x,Le.max.x),H[2]=s.EXTENT-Le.min.y>xe.max.y?Le.min.y-s.EXTENT:xe.max.y,H),oe=[(xe,Le)=>K(xe,Le),(xe,Le)=>K(Le,xe),(xe,Le)=>Y(xe,Le),(xe,Le)=>Y(Le,xe)],me=new s.pointGeometry(0,0);let be,we,Me;const _e=(xe,Le,Ce,Ue,Xe)=>{const Ze=[[Ue?Ce:xe,Ue?xe:Ce,0],[Ue?Ce:Le,Ue?Le:Ce,0]],tt=Xe<0?s.EXTENT+Xe:Xe,ft=[Ue?tt:(xe+Le)/2,Ue?(xe+Le)/2:tt,0];return Ce===0&&Xe<0||Ce!==0&&Xe>0?I.getForTilePoints(Me,[ft],!0,we):Ze.push(ft),I.getForTilePoints(m,Ze,!0,be),Math.max(Ze[0][2],Ze[1][2],ft[2])/I.exaggeration()};for(let xe=0;xe<4;xe++){const Le=(xe<2?1:5)-xe,Ce=b.borders[xe];if(Ce.length===0)continue;const Ue=Me=B[xe](m),Xe=U(Ue);if(!(Xe&&Xe instanceof s.FillExtrusionBucket&&Xe.enableTerrain)||b.borderDoneWithNeighborZ[xe]===Xe.canonical.z&&Xe.borderDoneWithNeighborZ[Le]===b.canonical.z||(we=I.findDEMTileFor(Ue),!we||!we.dem))continue;if(!be){const lt=I.findDEMTileFor(m);if(!lt||!lt.dem)return;be=lt}const Ze=Xe.borders[Le];let tt=0;const ft=Xe.borderDoneWithNeighborZ[Le]!==b.canonical.z;if(b.canonical.z===Xe.canonical.z){for(let lt=0;lt<Ce.length;lt++){const it=b.featuresOnBorder[Ce[lt]],Wt=it.borders[xe];let ot;for(;tt<Ze.length&&(ot=Xe.featuresOnBorder[Ze[tt]],!(ot.borders[Le][1]>Wt[0]+3));)ft&&Xe.encodeCentroid(void 0,ot,!1),tt++;if(ot&&tt<Ze.length){const bt=tt;let mt=0;for(;!(ot.borders[Le][0]>Wt[1]-3)&&(mt++,++tt!==Ze.length);)ot=Xe.featuresOnBorder[Ze[tt]];if(ot=Xe.featuresOnBorder[Ze[bt]],it.intersectsCount()>1||ot.intersectsCount()>1||mt!==1){mt!==1&&(tt=bt),b.encodeCentroid(void 0,it,!1),ft&&Xe.encodeCentroid(void 0,ot,!1);continue}const Ut=oe[xe](it,ot),gt=xe%2?s.EXTENT-1:0;me.x=_e(Ut[0],Math.min(s.EXTENT-1,Ut[1]),gt,xe<2,Ut[2]),me.y=0,b.encodeCentroid(me,it,!1),ft&&Xe.encodeCentroid(me,ot,!1)}else b.encodeCentroid(void 0,it,!1)}b.borderDoneWithNeighborZ[xe]=Xe.canonical.z,b.needsCentroidUpdate=!0,ft&&(Xe.borderDoneWithNeighborZ[Le]=b.canonical.z,Xe.needsCentroidUpdate=!0)}else{for(const lt of Ce)b.encodeCentroid(void 0,b.featuresOnBorder[lt],!1);if(ft){for(const lt of Ze)Xe.encodeCentroid(void 0,Xe.featuresOnBorder[lt],!1);Xe.borderDoneWithNeighborZ[Le]=b.canonical.z,Xe.needsCentroidUpdate=!0}b.borderDoneWithNeighborZ[xe]=Xe.canonical.z,b.needsCentroidUpdate=!0}}(b.needsCentroidUpdate||!b.centroidVertexBuffer&&b.centroidVertexArray.length!==0)&&b.uploadCentroid(y)}const cf=new s.Color(1,0,0,1),Zo=new s.Color(0,1,0,1),Ql=new s.Color(0,0,1,1),Ir=new s.Color(1,0,1,1),Is=new s.Color(0,1,1,1);function ns(y,h,m){const b=y.context,E=y.transform,I=b.gl,B=E.projection.name==="globe",U=B?["PROJECTION_GLOBE_VIEW"]:null;let H=m.projMatrix;if(B&&s.globeToMercatorTransition(E.zoom)>0){const it=s.transitionTileAABBinECEF(m.canonical,E),Wt=s.globeDenormalizeECEF(it);H=s.multiply(new Float32Array(16),E.globeMatrix,Wt),s.multiply(H,E.projMatrix,H)}const K=y.useProgram("debug",null,U),Y=h.getTileByID(m.key);y.terrain&&y.terrain.setupElevationDraw(Y,K);const oe=s.DepthMode.disabled,me=s.StencilMode.disabled,be=y.colorModeForRenderPass(),we="$debug";b.activeTexture.set(I.TEXTURE0),y.emptyTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),B?Y._makeGlobeTileDebugBuffers(y.context,E):Y._makeDebugTileBoundsBuffers(y.context,E.projection);const Me=Y._tileDebugBuffer||y.debugBuffer,_e=Y._tileDebugIndexBuffer||y.debugIndexBuffer,xe=Y._tileDebugSegments||y.debugSegments;K.draw(b,I.LINE_STRIP,oe,me,be,s.CullFaceMode.disabled,Ns(H,s.Color.red),we,Me,_e,xe,null,null,null,[Y._globeTileDebugBorderBuffer]);const Le=Y.latestRawTileData,Ce=Math.floor((Le&&Le.byteLength||0)/1024),Ue=h.getTile(m).tileSize,Xe=512/Math.min(Ue,512)*(m.overscaledZ/E.zoom)*.5;let Ze=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Ze+=` => ${m.overscaledZ}`),Ze+=` ${Ce}kb`,function(it,Wt){it.initDebugOverlayCanvas();const ot=it.debugOverlayCanvas,bt=it.context.gl,mt=it.debugOverlayCanvas.getContext("2d");mt.clearRect(0,0,ot.width,ot.height),mt.shadowColor="white",mt.shadowBlur=2,mt.lineWidth=1.5,mt.strokeStyle="white",mt.textBaseline="top",mt.font="bold 36px Open Sans, sans-serif",mt.fillText(Wt,5,5),mt.strokeText(Wt,5,5),it.debugOverlayTexture.update(ot),it.debugOverlayTexture.bind(bt.LINEAR,bt.CLAMP_TO_EDGE)}(y,Ze);const tt=Y._tileDebugTextBuffer||y.debugBuffer,ft=Y._tileDebugTextIndexBuffer||y.quadTriangleIndexBuffer,lt=Y._tileDebugTextSegments||y.debugSegments;K.draw(b,I.TRIANGLES,oe,me,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Ns(H,s.Color.transparent,Xe),we,tt,ft,lt,null,null,null,[Y._globeTileDebugTextBuffer])}function qu(y,h,m,b){xo(y,0,h+m/2,y.transform.width,m,b)}function ec(y,h,m,b){xo(y,h-m/2,0,m,y.transform.height,b)}function xo(y,h,m,b,E,I){const B=y.context,U=B.gl;U.enable(U.SCISSOR_TEST),U.scissor(h*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,b*s.exported.devicePixelRatio,E*s.exported.devicePixelRatio),B.clear({color:I}),U.disable(U.SCISSOR_TEST)}const Jh=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ps}=Jh;function Ys(y,h,m,b){y.emplaceBack(h,m,b)}class _l{constructor(h){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Ys(this.vertexArray,-1,-1,1),Ys(this.vertexArray,1,-1,1),Ys(this.vertexArray,-1,1,1),Ys(this.vertexArray,1,1,1),Ys(this.vertexArray,-1,-1,-1),Ys(this.vertexArray,1,-1,-1),Ys(this.vertexArray,-1,1,-1),Ys(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,Ps),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function yl(y,h,m,b,E,I){const B=y.gl,U=h.paint.get("sky-atmosphere-color"),H=h.paint.get("sky-atmosphere-halo-color"),K=h.paint.get("sky-atmosphere-sun-intensity"),Y=((oe,me,be,we,Me)=>({u_matrix_3f:oe,u_sun_direction:me,u_sun_intensity:be,u_color_tint_r:[we.r,we.g,we.b,we.a],u_color_tint_m:[Me.r,Me.g,Me.b,Me.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),b),E,K,U,H);B.framebufferTexture2D(B.FRAMEBUFFER,B.COLOR_ATTACHMENT0,B.TEXTURE_CUBE_MAP_POSITIVE_X+I,h.skyboxTexture,0),m.draw(y,B.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,Y,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const _a=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class oi{constructor(h){const m=new s.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const b=new s.StructArrayLayout3ui6;b.emplaceBack(0,1,2),b.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(m,_a.members),this.indexBuffer=h.createIndexBuffer(b),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ya={symbol:function(y,h,m,b,E){if(y.renderPass!=="translucent")return;const I=s.StencilMode.disabled,B=y.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(U,H,K,Y,oe,me,be){const we=H.transform,Me=oe==="map",_e=me==="map";for(const xe of U){const Le=Y.getTile(xe),Ce=Le.getBucket(K);if(!Ce||!Ce.text||!Ce.text.segments.get().length)continue;const Ue=s.evaluateSizeForZoom(Ce.textSizeData,we.zoom),Xe=Zl(xe,Ce.getProjection(),we),Ze=we.calculatePixelsToTileUnitsMatrix(Le),tt=ci(Xe,Le.tileID.canonical,_e,Me,we,Ce.getProjection(),Ze),ft=K.layout.get("icon-text-fit")!=="none"&&Ce.hasIconData();if(Ue){const lt=Math.pow(2,we.zoom-Le.tileID.overscaledZ);Xc(Ce,Me,_e,be,s.symbolSize,we,tt,xe,lt,Ue,ft)}}}(b,y,m,h,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),E),m.paint.get("icon-opacity").constantOr(1)!==0&&gl(y,h,m,b,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),I,B),m.paint.get("text-opacity").constantOr(1)!==0&&gl(y,h,m,b,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),I,B),h.map.showCollisionBoxes&&(Zc(y,h,m,b,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),Zc(y,h,m,b,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(y,h,m,b){if(y.renderPass!=="translucent")return;const E=m.paint.get("circle-opacity"),I=m.paint.get("circle-stroke-width"),B=m.paint.get("circle-stroke-opacity"),U=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(E.constantOr(1)===0&&(I.constantOr(1)===0||B.constantOr(1)===0))return;const H=y.context,K=H.gl,Y=y.transform,oe=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),me=s.StencilMode.disabled,be=y.colorModeForRenderPass(),we=Y.projection.name==="globe",Me=[s.mercatorXfromLng(Y.center.lng),s.mercatorYfromLat(Y.center.lat)],_e=[];for(let Le=0;Le<b.length;Le++){const Ce=b[Le],Ue=h.getTile(Ce),Xe=Ue.getBucket(m);if(!Xe||Xe.projection.name!==Y.projection.name)continue;const Ze=Xe.programConfigurations.get(m.id),tt=Ar(m);we&&tt.push("PROJECTION_GLOBE_VIEW");const ft=y.useProgram("circle",Ze,tt),lt=Xe.layoutVertexBuffer,it=Xe.globeExtVertexBuffer,Wt=Xe.indexBuffer,ot=Y.projection.createInversionMatrix(Y,Ce.canonical),bt={programConfiguration:Ze,program:ft,layoutVertexBuffer:lt,globeExtVertexBuffer:it,indexBuffer:Wt,uniformValues:_o(y,Ce,Ue,ot,Me,m),tile:Ue};if(U){const mt=Xe.segments.get();for(const Ut of mt)_e.push({segments:new s.SegmentVector([Ut]),sortKey:Ut.sortKey,state:bt})}else _e.push({segments:Xe.segments,sortKey:0,state:bt})}U&&_e.sort((Le,Ce)=>Le.sortKey-Ce.sortKey);const xe={useDepthForOcclusion:!we};for(const Le of _e){const{programConfiguration:Ce,program:Ue,layoutVertexBuffer:Xe,globeExtVertexBuffer:Ze,indexBuffer:tt,uniformValues:ft,tile:lt}=Le.state,it=Le.segments;y.terrain&&y.terrain.setupElevationDraw(lt,Ue,xe),y.prepareDrawProgram(H,Ue,lt.tileID.toUnwrapped()),Ue.draw(H,K.TRIANGLES,oe,me,be,s.CullFaceMode.disabled,ft,m.id,Xe,tt,it,m.paint,Y.zoom,Ce,[Ze])}},heatmap:function(y,h,m,b){if(m.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const E=y.context,I=E.gl,B=s.StencilMode.disabled,U=new s.ColorMode([I.ONE,I.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(be,we,Me,_e){const xe=be.gl,Le=we.width*_e,Ce=we.height*_e;be.activeTexture.set(xe.TEXTURE1),be.viewport.set([0,0,Le,Ce]);let Ue=Me.heatmapFbo;if(!Ue||Ue&&(Ue.width!==Le||Ue.height!==Ce)){Ue&&Ue.destroy();const Xe=xe.createTexture();xe.bindTexture(xe.TEXTURE_2D,Xe),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_S,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_WRAP_T,xe.CLAMP_TO_EDGE),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MIN_FILTER,xe.LINEAR),xe.texParameteri(xe.TEXTURE_2D,xe.TEXTURE_MAG_FILTER,xe.LINEAR),Ue=Me.heatmapFbo=be.createFramebuffer(Le,Ce,!1),function(Ze,tt,ft,lt,it,Wt){const ot=Ze.gl;ot.texImage2D(ot.TEXTURE_2D,0,ot.RGBA,it,Wt,0,ot.RGBA,Ze.extRenderToTextureHalfFloat?Ze.extTextureHalfFloat.HALF_FLOAT_OES:ot.UNSIGNED_BYTE,null),lt.colorAttachment.set(ft)}(be,0,Xe,Ue,Le,Ce)}else xe.bindTexture(xe.TEXTURE_2D,Ue.colorAttachment.get()),be.bindFramebuffer.set(Ue.framebuffer)})(E,y,m,y.transform.projection.name==="globe"?.5:.25),E.clear({color:s.Color.transparent});const H=y.transform,K=H.projection.name==="globe",Y=K?["PROJECTION_GLOBE_VIEW"]:null,oe=K?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,me=[s.mercatorXfromLng(H.center.lng),s.mercatorYfromLat(H.center.lat)];for(let be=0;be<b.length;be++){const we=b[be];if(h.hasRenderableParent(we))continue;const Me=h.getTile(we),_e=Me.getBucket(m);if(!_e||_e.projection.name!==H.projection.name)continue;const xe=_e.programConfigurations.get(m.id),Le=y.useProgram("heatmap",xe,Y),{zoom:Ce}=y.transform;y.terrain&&y.terrain.setupElevationDraw(Me,Le),y.prepareDrawProgram(E,Le,we.toUnwrapped());const Ue=H.projection.createInversionMatrix(H,we.canonical);Le.draw(E,I.TRIANGLES,s.DepthMode.disabled,B,U,oe,jh(y,we,Me,Ue,me,Ce,m.paint.get("heatmap-intensity")),m.id,_e.layoutVertexBuffer,_e.indexBuffer,_e.segments,m.paint,y.transform.zoom,xe,K?[_e.globeExtVertexBuffer]:null)}E.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(E,I){const B=E.context,U=B.gl,H=I.heatmapFbo;if(!H)return;B.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,H.colorAttachment.get()),B.activeTexture.set(U.TEXTURE1);let K=I.colorRampTexture;K||(K=I.colorRampTexture=new s.Texture(B,I.colorRamp,U.RGBA)),K.bind(U.LINEAR,U.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(B,U.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,E.colorModeForRenderPass(),s.CullFaceMode.disabled,((Y,oe,me,be)=>({u_image:0,u_color_ramp:1,u_opacity:oe.paint.get("heatmap-opacity")}))(0,I),I.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,I.paint,E.transform.zoom)}(y,m))},line:function(y,h,m,b){if(y.renderPass!=="translucent")return;const E=m.paint.get("line-opacity"),I=m.paint.get("line-width");if(E.constantOr(1)===0||I.constantOr(1)===0)return;const B=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),U=y.colorModeForRenderPass(),H=y.terrain&&y.terrain.renderingToTexture?1:s.exported.devicePixelRatio,K=m.paint.get("line-dasharray"),Y=K.constantOr(1),oe=m.layout.get("line-cap"),me=m.paint.get("line-pattern"),be=me.constantOr(1),we=m.paint.get("line-gradient"),Me=be?"linePattern":"line",_e=y.context,xe=_e.gl,Le=(Ue=>{const Xe=[];pl(Ue)&&Xe.push("RENDER_LINE_DASH"),Ue.paint.get("line-gradient")&&Xe.push("RENDER_LINE_GRADIENT");const Ze=Ue.paint.get("line-trim-offset");Ze[0]===0&&Ze[1]===0||Xe.push("RENDER_LINE_TRIM_OFFSET");const tt=Ue.paint.get("line-pattern").constantOr(1),ft=Ue.paint.get("line-opacity").constantOr(1)!==1;return!tt&&ft&&Xe.push("RENDER_LINE_ALPHA_DISCARD"),Xe})(m);let Ce=Le.includes("RENDER_LINE_ALPHA_DISCARD");y.terrain&&y.terrain.clipOrMaskOverlapStencilType()&&(Ce=!1);for(const Ue of b){const Xe=h.getTile(Ue);if(be&&!Xe.patternsLoaded())continue;const Ze=Xe.getBucket(m);if(!Ze)continue;y.prepareDrawTile();const tt=Ze.programConfigurations.get(m.id),ft=y.useProgram(Me,tt,Le),lt=me.constantOr(null);if(lt&&Xe.imageAtlas){const Lt=Xe.imageAtlas.patternPositions[lt.toString()];Lt&&tt.setConstantPatternPositions(Lt)}const it=K.constantOr(null),Wt=oe.constantOr(null);if(!be&&it&&Wt&&Xe.lineAtlas){const Lt=Xe.lineAtlas.getDash(it,Wt);Lt&&tt.setConstantPatternPositions(Lt)}let[ot,bt]=m.paint.get("line-trim-offset");(Wt==="round"||Wt==="square")&&ot!==bt&&(ot===0&&(ot-=1),bt===1&&(bt+=1));const mt=y.terrain?Ue.projMatrix:null,Ut=be?jo(y,Xe,m,mt,H):qh(y,Xe,m,mt,Ze.lineClipsArray.length,H,[ot,bt]);if(we){const Lt=Ze.gradients[m.id];let kt=Lt.texture;if(m.gradientVersion!==Lt.version){let Ye=256;if(m.stepInterpolant){const at=h.getSource().maxzoom,Qt=Ue.canonical.z===at?Math.ceil(1<<y.transform.maxZoom-Ue.canonical.z):1;Ye=s.clamp(s.nextPowerOfTwo(Ze.maxLineLength/s.EXTENT*1024*Qt),256,_e.maxTextureSize)}Lt.gradient=s.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Ye,image:Lt.gradient||void 0,clips:Ze.lineClipsArray}),Lt.texture?Lt.texture.update(Lt.gradient):Lt.texture=new s.Texture(_e,Lt.gradient,xe.RGBA),Lt.version=m.gradientVersion,kt=Lt.texture}_e.activeTexture.set(xe.TEXTURE1),kt.bind(m.stepInterpolant?xe.NEAREST:xe.LINEAR,xe.CLAMP_TO_EDGE)}Y&&(_e.activeTexture.set(xe.TEXTURE0),Xe.lineAtlasTexture.bind(xe.LINEAR,xe.REPEAT),tt.updatePaintBuffers()),be&&(_e.activeTexture.set(xe.TEXTURE0),Xe.imageAtlasTexture.bind(xe.LINEAR,xe.CLAMP_TO_EDGE),tt.updatePaintBuffers()),y.prepareDrawProgram(_e,ft,Ue.toUnwrapped());const gt=Lt=>{ft.draw(_e,xe.TRIANGLES,B,Lt,U,s.CullFaceMode.disabled,Ut,m.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segments,m.paint,y.transform.zoom,tt,[Ze.layoutVertexBuffer2])};if(Ce){const Lt=y.stencilModeForClipping(Ue).ref;Lt===0&&y.terrain&&_e.clear({stencil:0});const kt={func:xe.EQUAL,mask:255};Ut.u_alpha_discard_threshold=.8,gt(new s.StencilMode(kt,Lt,255,xe.KEEP,xe.KEEP,xe.INVERT)),Ut.u_alpha_discard_threshold=0,gt(new s.StencilMode(kt,Lt,255,xe.KEEP,xe.KEEP,xe.KEEP))}else gt(y.stencilModeForClipping(Ue))}Ce&&(y.resetStencilClippingMasks(),y.terrain&&_e.clear({stencil:0}))},fill:function(y,h,m,b){const E=m.paint.get("fill-color"),I=m.paint.get("fill-opacity");if(I.constantOr(1)===0)return;const B=y.colorModeForRenderPass(),U=m.paint.get("fill-pattern"),H=y.opaquePassEnabledForLayer()&&!U.constantOr(1)&&E.constantOr(s.Color.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===H){const K=y.depthModeForSublayer(1,y.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Yh(y,h,m,b,K,B,!1)}if(y.renderPass==="translucent"&&m.paint.get("fill-antialias")){const K=y.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Yh(y,h,m,b,K,B,!0)}},"fill-extrusion":function(y,h,m,b){const E=m.paint.get("fill-extrusion-opacity");if(E!==0&&y.renderPass==="translucent"){const I=new s.DepthMode(y.context.gl.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D);if(E!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Kh(y,h,m,b,I,s.StencilMode.disabled,s.ColorMode.disabled),Kh(y,h,m,b,I,y.stencilModeFor3D(),y.colorModeForRenderPass()),y.resetStencilClippingMasks();else{const B=y.colorModeForRenderPass();Kh(y,h,m,b,I,s.StencilMode.disabled,B)}}},hillshade:function(y,h,m,b){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const E=y.context,I=y.depthModeForSublayer(0,s.DepthMode.ReadOnly),B=y.colorModeForRenderPass(),U=y.terrain&&y.terrain.renderingToTexture,[H,K]=y.renderPass!=="translucent"||U?[{},b]:y.stencilConfigForOverlap(b);for(const Y of K){const oe=h.getTile(Y);if(oe.needsHillshadePrepare&&y.renderPass==="offscreen")Bh(y,oe,m,I,s.StencilMode.disabled,B);else if(y.renderPass==="translucent"){const me=U&&y.terrain?y.terrain.stencilModeForRTTOverlap(Y):H[Y.overscaledZ];Ra(y,Y,oe,m,I,me,B)}}E.viewport.set([0,0,y.width,y.height]),y.resetStencilClippingMasks()},raster:function(y,h,m,b,E,I){if(y.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!b.length)return;const B=y.context,U=B.gl,H=h.getSource(),K=y.useProgram("raster"),Y=y.colorModeForRenderPass(),oe=y.terrain&&y.terrain.renderingToTexture,[me,be]=H instanceof pe||oe?[{},b]:y.stencilConfigForOverlap(b),we=be[be.length-1].overscaledZ,Me=!y.options.moving;for(const _e of be){const xe=oe?s.DepthMode.disabled:y.depthModeForSublayer(_e.overscaledZ-we,m.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,U.LESS),Le=_e.toUnwrapped(),Ce=h.getTile(_e);if(oe&&(!Ce||!Ce.hasData()))continue;const Ue=oe?_e.projMatrix:y.transform.calculateProjMatrix(Le,Me),Xe=y.terrain&&oe?y.terrain.stencilModeForRTTOverlap(_e):me[_e.overscaledZ],Ze=I?0:m.paint.get("raster-fade-duration");Ce.registerFadeDuration(Ze);const tt=h.findLoadedParent(_e,0),ft=Hu(Ce,tt,h,y.transform,Ze);let lt,it;y.terrain&&y.terrain.prepareDrawTile();const Wt=m.paint.get("raster-resampling")==="nearest"?U.NEAREST:U.LINEAR;B.activeTexture.set(U.TEXTURE0),Ce.texture.bind(Wt,U.CLAMP_TO_EDGE),B.activeTexture.set(U.TEXTURE1),tt?(tt.texture.bind(Wt,U.CLAMP_TO_EDGE),lt=Math.pow(2,tt.tileID.overscaledZ-Ce.tileID.overscaledZ),it=[Ce.tileID.canonical.x*lt%1,Ce.tileID.canonical.y*lt%1]):Ce.texture.bind(Wt,U.CLAMP_TO_EDGE);const ot=lf(Ue,it||[0,0],lt||1,ft,m,H instanceof pe?H.perspectiveTransform:[0,0]);if(y.prepareDrawProgram(B,K,Le),H instanceof pe)H.boundsBuffer&&H.boundsSegments&&K.draw(B,U.TRIANGLES,xe,s.StencilMode.disabled,Y,s.CullFaceMode.disabled,ot,m.id,H.boundsBuffer,y.quadTriangleIndexBuffer,H.boundsSegments);else{const{tileBoundsBuffer:bt,tileBoundsIndexBuffer:mt,tileBoundsSegments:Ut}=y.getTileBoundsBuffers(Ce);K.draw(B,U.TRIANGLES,xe,Xe,Y,s.CullFaceMode.disabled,ot,m.id,bt,mt,Ut)}}y.resetStencilClippingMasks()},background:function(y,h,m,b){const E=m.paint.get("background-color"),I=m.paint.get("background-opacity");if(I===0)return;const B=y.context,U=B.gl,H=y.transform,K=H.tileSize,Y=m.paint.get("background-pattern");if(y.isPatternMissing(Y))return;const oe=!Y&&E.a===1&&I===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==oe)return;const me=s.StencilMode.disabled,be=y.depthModeForSublayer(0,oe==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),we=y.colorModeForRenderPass(),Me=y.useProgram(Y?"backgroundPattern":"background");let _e,xe=b;xe||(_e=y.getBackgroundTiles(),xe=Object.values(_e).map(Le=>Le.tileID)),Y&&(B.activeTexture.set(U.TEXTURE0),y.imageManager.bind(y.context));for(const Le of xe){const Ce=Le.toUnwrapped(),Ue=b?Le.projMatrix:y.transform.calculateProjMatrix(Ce);y.prepareDrawTile();const Xe=h?h.getTile(Le):_e?_e[Le.key]:new s.Tile(Le,K,H.zoom,y),Ze=Y?qc(Ue,I,y,Y,{tileID:Le,tileSize:K}):Bg(Ue,I,E);y.prepareDrawProgram(B,Me,Ce);const{tileBoundsBuffer:tt,tileBoundsIndexBuffer:ft,tileBoundsSegments:lt}=y.getTileBoundsBuffers(Xe);Me.draw(B,U.TRIANGLES,be,me,we,s.CullFaceMode.disabled,Ze,m.id,tt,ft,lt)}},sky:function(y,h,m){const b=y.transform,E=b.projection.name==="mercator"||b.projection.name==="globe"?1:s.smoothstep(7,8,b.zoom),I=m.paint.get("sky-opacity")*E;if(I===0)return;const B=y.context,U=m.paint.get("sky-type"),H=new s.DepthMode(B.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),K=y.frameCounter/1e3%1;U==="atmosphere"?y.renderPass==="offscreen"?m.needsSkyboxCapture(y)&&(function(Y,oe,me,be){const we=Y.context,Me=we.gl;let _e=oe.skyboxFbo;if(!_e){_e=oe.skyboxFbo=we.createFramebuffer(32,32,!1),oe.skyboxGeometry=new _l(we),oe.skyboxTexture=we.gl.createTexture(),Me.bindTexture(Me.TEXTURE_CUBE_MAP,oe.skyboxTexture),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_WRAP_S,Me.CLAMP_TO_EDGE),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_WRAP_T,Me.CLAMP_TO_EDGE),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_MIN_FILTER,Me.LINEAR),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_MAG_FILTER,Me.LINEAR);for(let Ue=0;Ue<6;++Ue)Me.texImage2D(Me.TEXTURE_CUBE_MAP_POSITIVE_X+Ue,0,Me.RGBA,32,32,0,Me.RGBA,Me.UNSIGNED_BYTE,null)}we.bindFramebuffer.set(_e.framebuffer),we.viewport.set([0,0,32,32]);const xe=oe.getCenter(Y,!0),Le=Y.useProgram("skyboxCapture"),Ce=new Float64Array(16);s.identity(Ce),s.rotateY(Ce,Ce,.5*-Math.PI),yl(we,oe,Le,Ce,xe,0),s.identity(Ce),s.rotateY(Ce,Ce,.5*Math.PI),yl(we,oe,Le,Ce,xe,1),s.identity(Ce),s.rotateX(Ce,Ce,.5*-Math.PI),yl(we,oe,Le,Ce,xe,2),s.identity(Ce),s.rotateX(Ce,Ce,.5*Math.PI),yl(we,oe,Le,Ce,xe,3),s.identity(Ce),yl(we,oe,Le,Ce,xe,4),s.identity(Ce),s.rotateY(Ce,Ce,Math.PI),yl(we,oe,Le,Ce,xe,5),we.viewport.set([0,0,Y.width,Y.height])}(y,m),m.markSkyboxValid(y)):y.renderPass==="sky"&&function(Y,oe,me,be,we){const Me=Y.context,_e=Me.gl,xe=Y.transform,Le=Y.useProgram("skybox");Me.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_CUBE_MAP,oe.skyboxTexture);const Ce=((Ue,Xe,Ze,tt,ft)=>({u_matrix:Ue,u_sun_direction:Xe,u_cubemap:0,u_opacity:tt,u_temporal_offset:ft}))(xe.skyboxMatrix,oe.getCenter(Y,!1),0,be,we);Y.prepareDrawProgram(Me,Le),Le.draw(Me,_e.TRIANGLES,me,s.StencilMode.disabled,Y.colorModeForRenderPass(),s.CullFaceMode.backCW,Ce,"skybox",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(y,m,H,I,K):U==="gradient"&&y.renderPass==="sky"&&function(Y,oe,me,be,we){const Me=Y.context,_e=Me.gl,xe=Y.transform,Le=Y.useProgram("skyboxGradient");oe.skyboxGeometry||(oe.skyboxGeometry=new _l(Me)),Me.activeTexture.set(_e.TEXTURE0);let Ce=oe.colorRampTexture;Ce||(Ce=oe.colorRampTexture=new s.Texture(Me,oe.colorRamp,_e.RGBA)),Ce.bind(_e.LINEAR,_e.CLAMP_TO_EDGE);const Ue=((Xe,Ze,tt,ft,lt)=>({u_matrix:Xe,u_color_ramp:0,u_center_direction:Ze,u_radius:s.degToRad(tt),u_opacity:ft,u_temporal_offset:lt}))(xe.skyboxMatrix,oe.getCenter(Y,!1),oe.paint.get("sky-gradient-radius"),be,we);Y.prepareDrawProgram(Me,Le),Le.draw(Me,_e.TRIANGLES,me,s.StencilMode.disabled,Y.colorModeForRenderPass(),s.CullFaceMode.backCW,Ue,"skyboxGradient",oe.skyboxGeometry.vertexBuffer,oe.skyboxGeometry.indexBuffer,oe.skyboxGeometry.segment)}(y,m,H,I,K)},debug:function(y,h,m){for(let b=0;b<m.length;b++)ns(y,h,m[b])},custom:function(y,h,m){const b=y.context,E=m.implementation;if(y.transform.projection.unsupportedLayers&&y.transform.projection.unsupportedLayers.includes("custom"))s.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(y.renderPass==="offscreen"){const I=E.prerender;I&&(y.setCustomLayerDefaults(),b.setColorMode(y.colorModeForRenderPass()),I.call(E,b.gl,y.transform.customLayerMatrix()),b.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),b.setColorMode(y.colorModeForRenderPass()),b.setStencilMode(s.StencilMode.disabled);const I=E.renderingMode==="3d"?new s.DepthMode(y.context.gl.LEQUAL,s.DepthMode.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,s.DepthMode.ReadOnly);b.setDepthMode(I),E.render(b.gl,y.transform.customLayerMatrix()),b.setDirty(),y.setBaseState(),b.bindFramebuffer.set(null)}}};class uf{constructor(h,m){this.context=new se(h),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new cl,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,m){const b=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(b||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Vh(this,h));const E=this._terrain;this.transform.elevation=b?E:null,E.update(h,this.transform,m)}_updateFog(h){const m=h.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[b,E]=m.getFovAdjustedRange(this.transform._fov);if(b>E)return void(this.transform.fogCullDistSq=null);const I=b+.78*(E-b);this.transform.fogCullDistSq=I*I}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,m){if(this.width=h*s.exported.devicePixelRatio,this.height=m*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const b of this.style.order)this.style._layers[b].resize()}setup(){const h=this.context,m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(m,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const b=new s.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(s.EXTENT,0),b.emplaceBack(0,s.EXTENT),b.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=h.createVertexBuffer(b,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const E=new s.StructArrayLayout2i4;E.emplaceBack(-1,-1),E.emplaceBack(1,-1),E.emplaceBack(-1,1),E.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(E,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const I=new s.StructArrayLayout4i8;I.emplaceBack(0,0,0,0),I.emplaceBack(s.EXTENT,0,s.EXTENT,0),I.emplaceBack(0,s.EXTENT,0,s.EXTENT),I.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(I,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const B=new s.StructArrayLayout3ui6;B.emplaceBack(0,1,2),B.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer(B);const U=new s.StructArrayLayout1ui2;for(const K of[0,1,3,2,0])U.emplaceBack(K);this.debugIndexBuffer=h.createIndexBuffer(U),this.emptyTexture=new s.Texture(h,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=s.create();const H=this.context.gl;this.stencilClearMode=new s.StencilMode({func:H.ALWAYS,mask:0},0,255,H.ZERO,H.ZERO,H.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new oi(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,m=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,m.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,Wu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,m,b){if(!m||this.currentStencilSource===m.id||!h.isTileClipped()||!b||b.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let U=!1;for(const H of b)if(this._tileClippingMaskIDs[H.key]===void 0){U=!0;break}if(!U)return}this.currentStencilSource=m.id;const E=this.context,I=E.gl;this.nextStencilID+b.length>256&&this.clearStencil(),E.setColorMode(s.ColorMode.disabled),E.setDepthMode(s.DepthMode.disabled);const B=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const U of b){const H=m.getTile(U),K=this._tileClippingMaskIDs[U.key]=this.nextStencilID++,{tileBoundsBuffer:Y,tileBoundsIndexBuffer:oe,tileBoundsSegments:me}=this.getTileBoundsBuffers(H);B.draw(E,I.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:I.ALWAYS,mask:0},K,255,I.KEEP,I.KEEP,I.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,Wu(U.projMatrix),"$clipping",Y,oe,me)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,m=this.context.gl;return new s.StencilMode({func:m.NOTEQUAL,mask:255},h,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const m=this.context.gl;return new s.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(h){const m=this.context.gl,b=h.sort((B,U)=>U.overscaledZ-B.overscaledZ),E=b[b.length-1].overscaledZ,I=b[0].overscaledZ-E+1;if(I>1){this.currentStencilSource=void 0,this.nextStencilID+I>256&&this.clearStencil();const B={};for(let U=0;U<I;U++)B[U+E]=new s.StencilMode({func:m.GEQUAL,mask:255},U+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=I,[B,b]}return[{[E]:s.StencilMode.disabled},b]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([h.CONSTANT_COLOR,h.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(h,m,b){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new s.DepthMode(b||this.context.gl.LEQUAL,m,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,m){this.style=h,this.options=m,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const b=this.style.order,E=this.style._sourceCaches;for(const H in E){const K=E[H];K.used&&K.prepare(this.context)}const I={},B={},U={};for(const H in E){const K=E[H];I[H]=K.getVisibleCoordinates(),B[H]=I[H].slice().reverse(),U[H]=K.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<b.length;H++)if(this.style._layers[b[H]].is3D()){this.opaquePassCutoff=H;break}if(this.terrain&&(this.terrain.updateTileBinding(U),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),s.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const H of b){const K=this.style._layers[H],Y=h._getLayerSourceCache(K);if(!K.hasOffscreenPass()||K.isHidden(this.transform.zoom))continue;const oe=Y?B[Y.id]:void 0;(K.type==="custom"||K.isSky()||oe&&oe.length)&&this.renderLayer(this,Y,K,oe)}if(this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=b.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[b[this.currentLayer]],K=h._getLayerSourceCache(H);if(H.isSky())continue;const Y=K?B[K.id]:void 0;this._renderTileClippingMasks(H,K,Y),this.renderLayer(this,K,H,Y)}if(this.style.fog&&this.transform.projection.supportsFog&&function(H,K){const Y=H.context,oe=Y.gl,me=H.transform,be=new s.DepthMode(oe.LEQUAL,s.DepthMode.ReadOnly,[0,1]),we=H.useProgram("globeAtmosphere",null,me.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Me=s.globeToMercatorTransition(me.zoom),_e=K.properties.get("color").toArray01(),xe=K.properties.get("high-color").toArray01(),Le=K.properties.get("space-color").toArray01PremultipliedAlpha(),Ce=s.identity$1([]);s.rotateY$1(Ce,Ce,-s.degToRad(me._center.lng)),s.rotateX$1(Ce,Ce,s.degToRad(me._center.lat)),s.rotateZ$1(Ce,Ce,me.angle),s.rotateX$1(Ce,Ce,-me._pitch);const Ue=s.fromQuat(new Float32Array(16),Ce),Xe=s.mapValue(K.properties.get("star-intensity"),0,1,0,.25),Ze=5e-4,tt=s.mapValue(K.properties.get("horizon-blend"),0,1,Ze,.25),ft=s.globeUseCustomAntiAliasing(H,Y,me)&&tt===Ze?me.worldSize/(2*Math.PI*1.025)-1:me.globeRadius,lt=H.frameCounter/1e3%1,it=s.length(me.globeCenterInViewSpace),Wt=Math.sqrt(Math.pow(it,2)-Math.pow(ft,2)),ot=Math.acos(Wt/it),bt=((Ut,gt,Lt,kt,Ye,at,Qt,mn,cn,Fn,zn,In,an,Li)=>({u_frustum_tl:Ut,u_frustum_tr:gt,u_frustum_br:Lt,u_frustum_bl:kt,u_horizon:Ye,u_transition:at,u_fadeout_range:Qt,u_color:mn,u_high_color:cn,u_space_color:Fn,u_star_intensity:zn,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:In,u_horizon_angle:an,u_rotation_matrix:Li}))(me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.frustumCorners.horizon,Me,tt,_e,xe,Le,Xe,lt,ot,Ue);H.prepareDrawProgram(Y,we);const mt=H.atmosphereBuffer;mt&&we.draw(Y,oe.TRIANGLES,be,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,bt,"skybox",mt.vertexBuffer,mt.indexBuffer,mt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<b.length;this.currentLayer++){const H=this.style._layers[b[this.currentLayer]],K=h._getLayerSourceCache(H);H.isSky()&&this.renderLayer(this,K,H,K?B[K.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<b.length;){const H=this.style._layers[b[this.currentLayer]],K=h._getLayerSourceCache(H);if(H.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(H)){if(H.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Y=K?(H.type==="symbol"?U:B)[K.id]:void 0;this._renderTileClippingMasks(H,K,K?I[K.id]:void 0),this.renderLayer(this,K,H,Y),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let H=null;s.values(this.style._layers).forEach(K=>{const Y=h._getLayerSourceCache(K);Y&&!K.isHidden(this.transform.zoom)&&(!H||H.getSource().maxzoom<Y.getSource().maxzoom)&&(H=Y)}),H&&this.options.showTileBoundaries&&ya.debug(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const K=H.transform.padding;qu(H,H.transform.height-(K.top||0),3,cf),qu(H,K.bottom||0,3,Zo),ec(H,K.left||0,3,Ql),ec(H,H.transform.width-(K.right||0),3,Ir);const Y=H.transform.centerPoint;(function(oe,me,be,we){xo(oe,me-1,be-10,2,20,we),xo(oe,me-10,be-1,20,2,we)})(H,Y.x,H.transform.height-Y.y,Is)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}}renderLayer(h,m,b,E){b.isHidden(this.transform.zoom)||(b.type==="background"||b.type==="sky"||b.type==="custom"||E&&E.length)&&(this.id=b.id,this.gpuTimingStart(b),h.transform.projection.unsupportedLayers&&h.transform.projection.unsupportedLayers.includes(b.type)||ya[b.type](h,m,b,E,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let b=this.gpuTimers[h.id];b||(b=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),b.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,m=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),h.beginQueryEXT(h.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const m={};for(const b in h){const E=h[b],I=this.context.extTimerQuery,B=I.getQueryObjectEXT(E.query,I.QUERY_RESULT_EXT)/1e6;I.deleteQueryEXT(E.query),m[b]=B}return m}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let b=0;for(const E of h)b+=m.getQueryObjectEXT(E,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(E);return b}translatePosMatrix(h,m,b,E,I){if(!b[0]&&!b[1])return h;const B=I?E==="map"?this.transform.angle:0:E==="viewport"?-this.transform.angle:0;if(B){const K=Math.sin(B),Y=Math.cos(B);b=[b[0]*Y-b[1]*K,b[0]*K+b[1]*Y]}const U=[I?b[0]:ze(m,b[0],this.transform.zoom),I?b[1]:ze(m,b[1],this.transform.zoom),0],H=new Float32Array(16);return s.translate(H,h,U),H}saveTileTexture(h){const m=this._tileTextures[h.size[0]];m?m.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const m=this._tileTextures[h];return m&&m.length>0?m.pop():null}isPatternMissing(h){return h===null||h!==void 0&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,b=this.style&&this.style.fog,E=[];return this.terrainRenderModeElevated()&&E.push("TERRAIN"),this.transform.projection.name==="globe"&&E.push("GLOBE"),m&&E.push("ZERO_EXAGGERATION"),b&&!h&&b.getOpacity(this.transform.pitch)!==0&&E.push("FOG"),h&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}useProgram(h,m,b){this.cache=this.cache||{};const E=b||[],I=this.currentGlobalDefines().concat(E),B=mo.cacheKey(Ho[h],h,I,m);return this.cache[B]||(this.cache[B]=new mo(this.context,h,Ho[h],m,qo[h],I)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,m,b){if(this.terrain&&this.terrain.renderingToTexture)return;const E=this.style.fog;if(E){const I=E.getOpacity(this.transform.pitch),B=((U,H,K,Y,oe,me,be,we,Me,_e,xe)=>{const Le=U.transform,Ce=H.properties.get("color").toArray01();Ce[3]=Y;const Ue=U.frameCounter/1e3%1;return{u_fog_matrix:K?Le.calculateFogTileMatrix(K):U.identityMat,u_fog_range:H.getFovAdjustedRange(Le._fov),u_fog_color:Ce,u_fog_horizon_blend:H.properties.get("horizon-blend"),u_fog_temporal_offset:Ue,u_frustum_tl:oe,u_frustum_tr:me,u_frustum_br:be,u_frustum_bl:we,u_globe_pos:Me,u_globe_radius:_e,u_viewport:xe,u_globe_transition:s.globeToMercatorTransition(Le.zoom),u_is_globe:+(Le.projection.name==="globe")}})(this,E,b,I,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);m.setFogUniformValues(h,B)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const h=this.context.gl,m=h.createTexture();return h.bindTexture(h.TEXTURE_2D,m),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,m=this._backgroundTiles={},b=this.transform.coveringTiles({tileSize:512});for(const E of b)m[E.key]=h[E.key]||new s.Tile(E,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class $c{constructor(h=0,m=0,b=0,E=0){if(isNaN(h)||h<0||isNaN(m)||m<0||isNaN(b)||b<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=m,this.left=b,this.right=E}interpolate(h,m,b){return m.top!=null&&h.top!=null&&(this.top=s.number(h.top,m.top,b)),m.bottom!=null&&h.bottom!=null&&(this.bottom=s.number(h.bottom,m.bottom,b)),m.left!=null&&h.left!=null&&(this.left=s.number(h.left,m.left,b)),m.right!=null&&h.right!=null&&(this.right=s.number(h.right,m.right,b)),this}getCenter(h,m){const b=s.clamp((this.left+h-this.right)/2,0,h),E=s.clamp((this.top+m-this.bottom)/2,0,m);return new s.pointGeometry(b,E)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new $c(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Yc(y,h){const m=s.getColumn(y,3);s.fromQuat(y,h),s.setColumn(y,3,m)}function hf(y,h){const m=s.identity$1([]);return s.rotateZ$1(m,m,-h),s.rotateX$1(m,m,-y),m}function Qp(y,h){const m=[y[0],y[1],0],b=[h[0],h[1],0];if(s.length(m)>=1e-15){const B=s.normalize([],m);s.scale$2(b,B,s.dot(b,B)),h[0]=b[0],h[1]=b[1]}const E=s.cross([],h,y);if(s.len(E)<1e-15)return null;const I=Math.atan2(-E[1],E[0]);return hf(Math.atan2(Math.sqrt(y[0]*y[0]+y[1]*y[1]),-y[2]),I)}class df{constructor(h,m){this.position=h,this.orientation=m}get position(){return this._position}set position(h){if(h){const m=h instanceof s.MercatorCoordinate?h:new s.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(m.x=s.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(h,m){if(this.orientation=null,!this.position)return;const b=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(h)):0,E=this.position,I=s.MercatorCoordinate.fromLngLat(h,b),B=[I.x-E.x,I.y-E.y,I.z-E.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=Qp(B,m)}setPitchBearing(h,m){this.orientation=hf(s.degToRad(h),s.degToRad(-m))}}class ff{constructor(h,m){this._transform=s.identity([]),this.orientation=m,this.position=h}get mercatorPosition(){const h=this.position;return new s.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=s.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var m;h&&s.setColumn(this._transform,3,[(m=h)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||s.identity$1([]),h&&Yc(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,m){this._orientation=hf(h,m),Yc(this._transform,this._orientation)}forward(){const h=s.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=s.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=s.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,m){const b=new Float64Array(16);return s.invert(b,this.getWorldToCamera(h,m)),b}getWorldToCameraPosition(h,m,b){const E=this.position;s.scale$2(E,E,-h);const I=new Float64Array(16);return s.fromScaling(I,[b,b,b]),s.translate(I,I,E),I[10]*=m,I}getWorldToCamera(h,m){const b=new Float64Array(16),E=new Float64Array(4),I=this.position;return s.conjugate(E,this._orientation),s.scale$2(I,I,-h),s.fromQuat(b,E),s.translate(b,b,I),b[1]*=-1,b[5]*=-1,b[9]*=-1,b[13]*=-1,b[8]*=m,b[9]*=m,b[10]*=m,b[11]*=m,b}getCameraToClipPerspective(h,m,b,E){const I=new Float64Array(16);return s.perspective(I,h,m,b,E),I}getDistanceToElevation(h,m=!1){const b=h===0?0:s.mercatorZfromAltitude(h,m?s.latFromMercatorY(this.position[1]):this.position[1]),E=this.forward();return(b-this.position[2])/E[2]}clone(){return new ff([...this.position],[...this.orientation])}}function Qh(y,h){const m=Xo(y.projection,y.zoom,y.width,y.height),b=function(I,B,U,H,K){const Y=new s.LngLat(U.lng-180*xl,U.lat),oe=new s.LngLat(U.lng+180*xl,U.lat),me=I.project(Y.lng,Y.lat),be=I.project(oe.lng,oe.lat),we=-Math.atan2(be.y-me.y,be.x-me.x),Me=s.MercatorCoordinate.fromLngLat(U);Me.y=s.clamp(Me.y,-.999975,.999975);const _e=Me.toLngLat(),xe=I.project(_e.lng,_e.lat),Le=s.MercatorCoordinate.fromLngLat(_e);Le.x+=xl;const Ce=Le.toLngLat(),Ue=I.project(Ce.lng,Ce.lat),Xe=Zu(Ue.x-xe.x,Ue.y-xe.y,we),Ze=s.MercatorCoordinate.fromLngLat(_e);Ze.y+=xl;const tt=Ze.toLngLat(),ft=I.project(tt.lng,tt.lat),lt=Zu(ft.x-xe.x,ft.y-xe.y,we),it=Math.abs(Xe.x)/Math.abs(lt.y),Wt=s.identity([]);s.rotateZ(Wt,Wt,-we*(1-(K?0:H)));const ot=s.identity([]);return s.scale(ot,ot,[1,1-(1-it)*H,1]),ot[4]=-lt.x/lt.y*H,s.rotateZ(ot,ot,we),s.multiply(ot,Wt,ot),ot}(y.projection,0,y.center,m,h),E=Kc(y);return s.scale(b,b,[E,E,1]),b}function Kc(y){const h=y.projection,m=Xo(y.projection,y.zoom,y.width,y.height),b=Jc(h,y.center),E=Jc(h,s.LngLat.convert(h.center));return Math.pow(2,b*m+(1-m)*E)}function Xo(y,h,m,b,E=1/0){const I=y.range;if(!I)return 0;const B=Math.min(E,Math.max(m,b)),U=Math.log(B/1024)/Math.LN2;return s.smoothstep(I[0]+U,I[1]+U,h)}const xl=1/4e4;function Jc(y,h){const m=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),b=new s.LngLat(h.lng-180*xl,m),E=new s.LngLat(h.lng+180*xl,m),I=y.project(b.lng,m),B=y.project(E.lng,m),U=s.MercatorCoordinate.fromLngLat(b),H=s.MercatorCoordinate.fromLngLat(E),K=B.x-I.x,Y=B.y-I.y,oe=H.x-U.x,me=H.y-U.y,be=Math.sqrt((oe*oe+me*me)/(K*K+Y*Y));return Math.log(be)/Math.LN2}function Zu(y,h,m){const b=Math.cos(m),E=Math.sin(m);return{x:y*b-h*E,y:y*E+h*b}}class tc{constructor(h,m,b,E,I,B,U){this.tileSize=512,this._renderWorldCopies=I===void 0||I,this._minZoom=h||0,this._maxZoom=m||22,this._minPitch=b??0,this._maxPitch=E??60,this.setProjection(B),this.setMaxBounds(U),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new $c,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ff,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new tc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,m=!1){const b=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||b)&&this._updateCameraOnTerrain(),(h||b)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const b=!d(m,this.getProjection());return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const m=h!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.pointGeometry(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const m=-h*Math.PI/180;var b;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(b=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b),function(E,I,B){var U=I[0],H=I[1],K=I[2],Y=I[3],oe=Math.sin(B),me=Math.cos(B);E[0]=U*me+K*oe,E[1]=H*me+Y*oe,E[2]=U*-oe+K*me,E[3]=H*-oe+Y*me}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const m=s.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=s.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const m=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],b=this.horizonLineFromTop();let E=0,I=0;for(let B=0;B<m.length;B++){const U=new s.pointGeometry(m[B][0]*this.width,b+m[B][1]*(this.height-b)),H=h.pointCoordinate(U);if(!H)continue;const K=1/Math.hypot(H[0]-this._camera.position[0],H[1]-this._camera.position[1]);E+=H[3]*K,I+=K}return I===0?NaN:E/I}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),b=this.pixelsPerMeter/this.worldSize*m,E=this._mercatorZfromZoom(h),I=this._mercatorZfromZoom(this._maxZoom),B=Math.max(E-b,I);this._setZoom(this._zoomFromMercatorZ(B))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let b;b=h.z<this._camera.position[2]?[m.x,m.y,m.z]:[h.x,h.y,h.z];const E=s.length(s.sub([],this._camera.position,b));return s.clamp(this._zoomFromMercatorZ(E),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let m=!1;if(h.orientation&&!s.exactEquals(h.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(h.orientation)),h.position){const b=[h.position.x,h.position.y,h.position.z];s.exactEquals$1(b,this._camera.position)||(this._setCameraPosition(b),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,m=new df;return m.position=new s.MercatorCoordinate(h[0],h[1],h[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(h){if(!s.length$1(h))return!1;s.normalize$1(h,h);const m=s.transformQuat([],[0,0,-1],h),b=s.transformQuat([],[0,-1,0],h);if(b[2]<0)return!1;const E=Qp(m,b);return!!E&&(this._camera.orientation=E,!0)}_setCameraPosition(h){const m=this.zoomScale(this.minZoom)*this.tileSize,b=this.zoomScale(this.maxZoom)*this.tileSize,E=this.cameraToCenterDistance;h[2]=s.clamp(h[2],E/b,E/m),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,m,b){this._unmodified=!1,this._edgeInsets.interpolate(h,m,b),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const m=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(h){const m=[new s.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const b=this.pointCoordinate(new s.pointGeometry(0,0)),E=this.pointCoordinate(new s.pointGeometry(this.width,0)),I=this.pointCoordinate(new s.pointGeometry(this.width,this.height)),B=this.pointCoordinate(new s.pointGeometry(0,this.height)),U=Math.floor(Math.min(b.x,E.x,I.x,B.x)),H=Math.floor(Math.max(b.x,E.x,I.x,B.x)),K=1;for(let Y=U-K;Y<=H+K;Y++)Y!==0&&m.push(new s.UnwrappedTileID(Y,h))}return m}coveringTiles(h){let m=this.coveringZoomLevel(h);const b=m,E=this.elevation&&!h.isTerrainDEM,I=this.projection.name==="mercator";if(h.minzoom!==void 0&&m<h.minzoom)return[];h.maxzoom!==void 0&&m>h.maxzoom&&(m=h.maxzoom);const B=this.locationCoordinate(this.center),U=this.center.lat,H=1<<m,K=[H*B.x,H*B.y,0],Y=this.projection.name==="globe",oe=!Y,me=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,oe),be=Y?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),we=H*s.mercatorZfromAltitude(1,this.center.lat),Me=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),_e=[H*be.x,H*be.y,Me*(oe?1:we)],xe=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),Le=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,Ce=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ue=h.isTerrainDEM?-Ce:this._elevation?this._elevation.getMinElevationBelowMSL():0,Xe=this.projection.isReprojectedInTileSpace?Kc(this):1,Ze=gt=>{const kt=new s.MercatorCoordinate(gt.x+25e-6,gt.y,gt.z),Ye=new s.MercatorCoordinate(gt.x,gt.y+25e-6,gt.z),at=gt.toLngLat(),Qt=kt.toLngLat(),mn=Ye.toLngLat(),cn=this.locationCoordinate(at),Fn=this.locationCoordinate(Qt),zn=this.locationCoordinate(mn),In=Math.hypot(Fn.x-cn.x,Fn.y-cn.y),an=Math.hypot(zn.x-cn.x,zn.y-cn.y);return Math.sqrt(In*an)*Xe/25e-6},tt=gt=>{const Lt=Ce,kt=Ue;return{aabb:s.tileAABB(this,H,0,0,0,gt,kt,Lt,this.projection),zoom:0,x:0,y:0,minZ:kt,maxZ:Lt,wrap:gt,fullyVisible:!1}},ft=[];let lt=[];const it=m,Wt=h.reparseOverscaled?b:m,ot=gt=>gt*gt,bt=ot((Me-this._centerAltitude)*we),mt=gt=>{if(!this._elevation||!gt.tileID||!I)return;const Lt=this._elevation.getMinMaxForTile(gt.tileID),kt=gt.aabb;Lt?(kt.min[2]=Lt.min,kt.max[2]=Lt.max,kt.center[2]=(kt.min[2]+kt.max[2])/2):(gt.shouldSplit=Ut(gt),gt.shouldSplit||(kt.min[2]=kt.max[2]=kt.center[2]=this._centerAltitude))},Ut=gt=>{if(gt.zoom<Le)return!0;if(gt.zoom===it)return!1;if(gt.shouldSplit!=null)return gt.shouldSplit;const Lt=gt.aabb.distanceX(_e),kt=gt.aabb.distanceY(_e);let Ye=bt,at=1;if(Y){Ye=ot(gt.aabb.distanceZ(_e));const cn=Math.pow(2,gt.zoom),Fn=s.latFromMercatorY((gt.y+1)/cn),zn=s.latFromMercatorY(gt.y/cn),In=Math.min(Math.max(U,Fn),zn),an=s.circumferenceAtLatitude(In)/s.circumferenceAtLatitude(U);if(at=In===U?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,an/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&gt.zoom===it-1&&an>=.9)return!0}else if(E&&(Ye=ot(gt.aabb.distanceZ(_e)*we)),this.projection.isReprojectedInTileSpace&&b<=5){const cn=Math.pow(2,gt.zoom),Fn=Ze(new s.MercatorCoordinate((gt.x+.5)/cn,(gt.y+.5)/cn));at=Fn>.85?1:Fn}const Qt=Lt*Lt+kt*kt+Ye,mn=ot((1<<it-gt.zoom)*xe*at*((cn,Fn)=>{if(Fn*ot(.707)<cn)return 1;const zn=Math.sqrt(Fn/cn);return zn/(1.4144271570014144+(Math.pow(1.1,zn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ye,bt),Qt));return Qt<mn};if(this.renderWorldCopies)for(let gt=1;gt<=3;gt++)ft.push(tt(-gt)),ft.push(tt(gt));for(ft.push(tt(0));ft.length>0;){const gt=ft.pop(),Lt=gt.x,kt=gt.y;let Ye=gt.fullyVisible;if(!Ye){const at=gt.aabb.intersects(me);if(at===0)continue;Ye=at===2}if(gt.zoom!==it&&Ut(gt))for(let at=0;at<4;at++){const Qt=(Lt<<1)+at%2,mn=(kt<<1)+(at>>1),cn={aabb:I?gt.aabb.quadrant(at):s.tileAABB(this,H,gt.zoom+1,Qt,mn,gt.wrap,gt.minZ,gt.maxZ,this.projection),zoom:gt.zoom+1,x:Qt,y:mn,wrap:gt.wrap,fullyVisible:Ye,tileID:void 0,shouldSplit:void 0,minZ:gt.minZ,maxZ:gt.maxZ};E&&!Y&&(cn.tileID=new s.OverscaledTileID(gt.zoom+1===it?Wt:gt.zoom+1,gt.wrap,gt.zoom+1,Qt,mn),mt(cn)),ft.push(cn)}else{const at=gt.zoom===it?Wt:gt.zoom;if(h.minzoom&&h.minzoom>at)continue;const Qt=K[0]-(.5+Lt+(gt.wrap<<gt.zoom))*(1<<m-gt.zoom),mn=K[1]-.5-kt,cn=gt.tileID?gt.tileID:new s.OverscaledTileID(at,gt.wrap,gt.zoom,Lt,kt);lt.push({tileID:cn,distanceSq:Qt*Qt+mn*mn})}}if(this.fogCullDistSq){const gt=this.fogCullDistSq,Lt=this.horizonLineFromTop();lt=lt.filter(kt=>{const Ye=[0,0,0,1],at=[s.EXTENT,s.EXTENT,0,1],Qt=this.calculateFogTileMatrix(kt.tileID.toUnwrapped());s.transformMat4$1(Ye,Ye,Qt),s.transformMat4$1(at,at,Qt);const mn=s.getAABBPointSquareDist(Ye,at);if(mn===0)return!0;let cn=!1;const Fn=this._elevation;if(Fn&&mn>gt&&Lt!==0){const zn=this.calculateProjMatrix(kt.tileID.toUnwrapped());let In;h.isTerrainDEM||(In=Fn.getMinMaxForTile(kt.tileID)),In||(In={min:Ue,max:Ce});const an=s.furthestTileCorner(this.rotation),Li=[an[0]*s.EXTENT,an[1]*s.EXTENT,In.max];s.transformMat4(Li,Li,zn),cn=(1-Li[1])*this.height*.5<Lt}return mn<gt||cn})}return lt.sort((gt,Lt)=>gt.distanceSq-Lt.distanceSq).map(gt=>gt.tileID)}resize(h,m){this.width=h,this.height=m,this.pixelsToGLUnits=[2/h,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const m=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),b=this.projection.project(h.lng,m);return new s.pointGeometry(b.x*this.worldSize,b.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(h,m){let b,E;const I=this.centerPoint;if(this.projection.name==="globe"){const U=this.worldSize;b=(m.x-I.x)/U,E=(m.y-I.y)/U}else{const U=this.pointCoordinate(m),H=this.pointCoordinate(I);b=U.x-H.x,E=U.y-H.y}const B=this.locationCoordinate(h);this.setLocation(new s.MercatorCoordinate(B.x-b,B.y-E))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,m){const b=m?s.mercatorZfromAltitude(m,h.lat):void 0,E=this.projection.project(h.lng,h.lat);return new s.MercatorCoordinate(E.x,E.y,b)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,m){const b=m??this._centerAltitude,E=[h.x,h.y,0,1],I=[h.x,h.y,1,1];s.transformMat4$1(E,E,this.pixelMatrixInverse),s.transformMat4$1(I,I,this.pixelMatrixInverse);const B=I[3];s.scale$1(E,E,1/E[3]),s.scale$1(I,I,1/B);const U=E[2],H=I[2];return{p0:E,p1:I,t:U===H?0:(b-U)/(H-U)}}screenPointToMercatorRay(h){const m=[h.x,h.y,0,1],b=[h.x,h.y,1,1];return s.transformMat4$1(m,m,this.pixelMatrixInverse),s.transformMat4$1(b,b,this.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),s.scale$1(b,b,1/b[3]),m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,b[2]=s.mercatorZfromAltitude(b[2],this._center.lat)*this.worldSize,s.scale$1(m,m,1/this.worldSize),s.scale$1(b,b,1/this.worldSize),new s.Ray([m[0],m[1],m[2]],s.normalize([],s.sub([],b,m)))}rayIntersectionCoordinate(h){const{p0:m,p1:b,t:E}=h,I=s.mercatorZfromAltitude(m[2],this._center.lat),B=s.mercatorZfromAltitude(b[2],this._center.lat);return new s.MercatorCoordinate(s.number(m[0],b[0],E)/this.worldSize,s.number(m[1],b[1],E)/this.worldSize,s.number(I,B,E))}pointCoordinate(h,m=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,m)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let m=this.projection.pointCoordinate3D(this,h.x,h.y);if(m)return new s.MercatorCoordinate(m[0],m[1],m[2]);let b=0,E=this.horizonLineFromTop();if(h.y>E)return this.pointCoordinate(h);const I=.02*E,B=h.clone();for(let U=0;U<10&&E-b>I;U++){B.y=s.number(b,E,.66);const H=this.projection.pointCoordinate3D(this,B.x,B.y);H?(E=B.y,m=H):b=B.y}return m?new s.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}_coordinatePoint(h,m){const b=m&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,E=[h.x*this.worldSize,h.y*this.worldSize,b+h.toAltitude(),1];return s.transformMat4$1(E,E,this.pixelMatrix),E[3]>0?new s.pointGeometry(E[0]/E[3],E[1]/E[3]):new s.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getGlobeBounds(){const{top:h,left:m}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,E=this.width-this._edgeInsets.right,I=this.pointCoordinate3D(new s.pointGeometry(m,h)),B=this.pointCoordinate3D(new s.pointGeometry(E,h)),U=this.pointCoordinate3D(new s.pointGeometry(E,b)),H=this.pointCoordinate3D(new s.pointGeometry(m,b));let K=Math.min(I.x,H.x),Y=Math.max(B.x,U.x),oe=Math.min(I.y,B.y),me=Math.max(H.y,U.y);const be=Math.pow(2,-this.zoom)/16,we=(Ze,tt,ft,lt)=>{const it=(Ze+ft)/2,Wt=(tt+lt)/2,ot=new s.pointGeometry(it,Wt),bt=this.pointCoordinate3D(ot),mt=Math.max(0,K-bt.x,oe-bt.y,bt.x-Y,bt.y-me);K=Math.min(K,bt.x),Y=Math.max(Y,bt.x),oe=Math.min(oe,bt.y),me=Math.max(me,bt.y),mt>be&&(we(Ze,tt,it,Wt),we(it,Wt,ft,lt))};we(m,h,E,h),we(E,h,E,b),we(E,b,m,b),we(m,b,m,h);const[Me,_e]=s.polesInViewport(this),xe=Me||_e,Le=Me?90:s.latFromMercatorY(oe),Ce=xe?180:s.lngFromMercatorX(Y),Ue=_e?-90:s.latFromMercatorY(me),Xe=xe?-180:s.lngFromMercatorX(K);return new s.LngLatBounds(new s.LngLat(Xe,Ue),new s.LngLat(Ce,Le))}_getBounds(h,m){if(this.projection.name==="globe")return this._getGlobeBounds();const b=new s.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),E=new s.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),I=new s.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),B=new s.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let U=this.pointCoordinate(b,h),H=this.pointCoordinate(E,h);const K=this.pointCoordinate(I,m),Y=this.pointCoordinate(B,m),oe=(me,be)=>(be.y-me.y)/(be.x-me.x);return U.y>1&&H.y>=0?U=new s.MercatorCoordinate((1-Y.y)/oe(Y,U)+Y.x,1):U.y<0&&H.y<=1&&(U=new s.MercatorCoordinate(-Y.y/oe(Y,U)+Y.x,0)),H.y>1&&U.y>=0?H=new s.MercatorCoordinate((1-K.y)/oe(K,H)+K.x,1):H.y<0&&U.y<=1&&(H=new s.MercatorCoordinate(-K.y/oe(K,H)+K.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(U)).extend(this.coordinateLocation(H)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(K))}_getBounds3D(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBounds(0,0);const m=h.visibleDemTiles.reduce((b,E)=>{if(E.dem){const I=E.dem.tree;b.min=Math.min(b.min,I.minimums[0]),b.max=Math.max(b.max,I.maximums[0])}return b},{min:Number.MAX_VALUE,max:0});return this._getBounds(m.min*h.exaggeration(),m.max*h.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(h=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,b=this.height/2-m*(1-this._horizonShift);return h?Math.max(0,b):b}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,m){return this.projection.createTileMatrix(this,m,h)}calculateDistanceTileData(h){const m=h.key,b=this._distanceTileDataCache;if(b[m])return b[m];const E=h.canonical,I=1/this.height,B=this.cameraWorldSize,U=B/this.zoomScale(E.z),H=(E.x+Math.pow(2,E.z)*h.wrap)*U,K=E.y*U,Y=this.point;Y.x*=B/this.worldSize,Y.y*=B/this.worldSize;const oe=this.angle,me=Math.sin(-oe),be=-Math.cos(-oe);return b[m]={bearing:[me,be],center:[(Y.x-H)*I,(Y.y-K)*I],scale:U/s.EXTENT*I},b[m]}calculateFogTileMatrix(h){const m=h.key,b=this._fogTileMatrixCache;if(b[m])return b[m];const E=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return s.multiply(E,this.worldToFogMatrix,E),b[m]=new Float32Array(E),b[m]}calculateProjMatrix(h,m=!1){const b=h.key,E=m?this._alignedProjMatrixCache:this._projMatrixCache;if(E[b])return E[b];const I=this.calculatePosMatrix(h,this.worldSize);return s.multiply(I,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,I),E[b]=new Float32Array(I),E[b]}calculatePixelsToTileUnitsMatrix(h){const m=h.tileID.key,b=this._pixelsToTileUnitsCache;if(b[m])return b[m];const E=function(I,B){const{scale:U}=I.tileTransform,H=U*s.EXTENT/(I.tileSize*Math.pow(2,B.zoom-I.tileID.overscaledZ+I.tileID.canonical.z));return K=new Float32Array(4),me=(Y=B.inverseAdjustmentMatrix)[1],be=Y[2],we=Y[3],_e=(oe=[H,H])[1],K[0]=Y[0]*(Me=oe[0]),K[1]=me*Me,K[2]=be*_e,K[3]=we*_e,K;var K,Y,oe,me,be,we,Me,_e}(h,this);return b[m]=E,b[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(m),E=this._camera.forward(),I=s.mercatorZfromAltitude(1,this._center.lat);b[2]/=I,E[2]/=I,s.normalize(E,E);const B=h.raycast(b,E,h.exaggeration());if(B){const U=s.scaleAndAdd([],b,E,B),H=new s.MercatorCoordinate(U[0],U[1],s.mercatorZfromAltitude(U[2],s.latFromMercatorY(U[1]))),K=(H.z+s.length([H.x-b[0],H.y-b[1],H.z-b[2]*I]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(K),this._centerAltitude=H.toAltitude(),this._center=this.coordinateLocation(H),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const m=this._elevation,b=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,E=this._computeCameraPosition(b),I=m.getAtPointOrZero(new s.MercatorCoordinate(...E)),B=this.pixelsPerMeter/this.worldSize*I,U=this._minimumHeightOverTerrain(),H=E[2]-B;if(H<=U)if(H<0||h){const K=this.locationCoordinate(this._center,this._centerAltitude),Y=[E[0],E[1],K.z-E[2]],oe=s.length(Y);Y[2]-=(U-H)/this._pixelsPerMercatorPixel;const me=s.length(Y);if(me===0)return;s.scale$2(Y,Y,oe/me*this._pixelsPerMercatorPixel),this._camera.position=[E[0],E[1],K.z*this._pixelsPerMercatorPixel-Y[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const me=this.center;return me.lat=s.clamp(me.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(me.lng=s.clamp(me.lng,this.minLng,this.maxLng)),this.center=me,void(this._constraining=!1)}const m=this._unmodified,{x:b,y:E}=this.point;let I=0,B=b,U=E;const H=this.width/2,K=this.height/2,Y=this.worldMinY*this.scale,oe=this.worldMaxY*this.scale;if(E-K<Y&&(U=Y+K),E+K>oe&&(U=oe-K),oe-Y<this.height&&(I=Math.max(I,this.height/(oe-Y)),U=(oe+Y)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const me=this.worldMinX*this.scale,be=this.worldMaxX*this.scale,we=this.worldSize/2-(me+be)/2;B=(b+we+this.worldSize)%this.worldSize-we,B-H<me&&(B=me+H),B+H>be&&(B=be-H),be-me<this.width&&(I=Math.max(I,this.width/(be-me)),B=(be+me)/2)}B===b&&U===E||(this.center=this.unproject(new s.pointGeometry(B,U))),I&&(this.zoom+=this.scaleZoom(I)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const b=Xo(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?m:1),I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);I[8]=2*-h.x/this.width,I[9]=2*h.y/this.height;let B=s.mul([],I,E);if(this.projection.isReprojectedInTileSpace){const Xe=this.locationCoordinate(this.center),Ze=s.identity([]);s.translate(Ze,Ze,[Xe.x*this.worldSize,Xe.y*this.worldSize,0]),s.multiply(Ze,Ze,Qh(this)),s.translate(Ze,Ze,[-Xe.x*this.worldSize,-Xe.y*this.worldSize,0]),s.multiply(B,B,Ze),this.inverseAdjustmentMatrix=function(tt){const ft=Qh(tt,!0);return ne([],[ft[0],ft[1],ft[4],ft[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],B,[this.worldSize,this.worldSize,this.worldSize/m,1]),this.projMatrix=B,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const U=s.invert([],I);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(U,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);s.identity(H),s.scale(H,H,[1,-1,1]),s.rotateX(H,H,this._pitch),s.rotateZ(H,H,this.angle);const K=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Y=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;K[8]=2*-h.x/this.width,K[9]=2*(h.y+Y)/this.height,this.skyboxMatrix=s.multiply(H,K,H);const oe=this.point,me=oe.x,be=oe.y,we=this.width%2/2,Me=this.height%2/2,_e=Math.cos(this.angle),xe=Math.sin(this.angle),Le=me-Math.round(me)+_e*we+xe*Me,Ce=be-Math.round(be)+_e*Me+xe*we,Ue=new Float64Array(B);if(s.translate(Ue,Ue,[Le>.5?Le-1:Le,Ce>.5?Ce-1:Ce,0]),this.alignedProjMatrix=Ue,B=s.create(),s.scale(B,B,[this.width/2,-this.height/2,1]),s.translate(B,B,[1,-1,0]),this.labelPlaneMatrix=B,B=s.create(),s.scale(B,B,[1,-1,1]),s.translate(B,B,[-1,-1,0]),s.scale(B,B,[2/this.width,2/this.height,1]),this.glCoordMatrix=B,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},B=s.invert(new Float64Array(16),this.pixelMatrix),!B)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=B,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Xe=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Xe,Xe,E),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=B;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,b=this._camera.position,E=1/this.height/this._pixelsPerMercatorPixel,I=[h,h,m];s.scale$2(I,I,E),s.scale$2(b,b,-1),s.multiply$2(b,b,I);const B=s.create();s.translate(B,B,b),s.scale(B,B,I),this.mercatorFogMatrix=B,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,m,E)}_computeCameraPosition(h){const m=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,b=this._camera.forward(),E=this.point,I=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-h/this.worldSize*this._centerAltitude;return[E.x/this.worldSize-b[0]*I,E.y/this.worldSize-b[1]*I,h/this.worldSize*this._centerAltitude-b[2]*I]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),b=this._camera.position[2],E=h[2];let I=1;this.projection.wrap&&(this.center=this.center.wrap()),E>0&&(I=Math.min((m-b)/E,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,h,I),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,m=this._camera.forward(),{pitch:b,bearing:E}=this._camera.getPitchBearing(),I=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,B=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),U=Math.max((h[2]-I)/Math.cos(b),B),H=this._zoomFromMercatorZ(U);s.scaleAndAdd(h,h,m,U),this._pitch=s.clamp(b,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(E,-Math.PI,Math.PI),this._setZoom(s.clamp(H,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){const m=B=>{const U=this.getCameraToCenterDistance(this.projection,B);return this.scaleZoom(U/(h*this.tileSize))};let b,E=m(this.zoom),I=Math.abs(E-m(E));for(;b!==I;)E=m(E),b=I,I=Math.abs(E-m(E));return E}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,m){const b=Math.min(h.x,m.x),E=Math.max(h.x,m.x),I=Math.min(h.y,m.y),B=Math.max(h.y,m.y);if(I<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const U=[new s.pointGeometry(b,I),new s.pointGeometry(E,B),new s.pointGeometry(b,B),new s.pointGeometry(E,I)],H=this.renderWorldCopies?-3:0,K=this.renderWorldCopies?4:1;for(const Y of U){const oe=this.pointRayIntersection(Y);if(oe.t<0)return!0;const me=this.rayIntersectionCoordinate(oe);if(me.x<H||me.y<0||me.x>K||me.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.pointGeometry(0,0),new s.pointGeometry(this.width,this.height))}zoomDeltaToMovement(h,m){const b=s.length(s.sub([],this._camera.position,h)),E=this._zoomFromMercatorZ(b)+m;return b-this._mercatorZfromZoom(E)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([m,b,E],I){const B=[m,b,E,1];s.transformMat4$1(B,B,I);const U=B[3]=Math.max(B[3],1e-6);return B[0]/=U,B[1]/=U,B[2]/=U,B}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.pointGeometry(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.pointGeometry(0,h))}}getCameraToCenterDistance(h,m=this.zoom){const b=Xo(h,m,this.width,this.height,1024),E=h.pixelSpaceConversion(this.center.lat,this.worldSize,b);return .5/Math.tan(.5*this._fov)*this.height*E}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(h,h,this.globeMatrix),h}}function vl(y,h){let m=!1,b=null;const E=()=>{b=null,m&&(y(),b=setTimeout(E,h),m=!1)};return()=>(m=!0,b||E(),b)}class hn{constructor(h){this._hashName=h&&encodeURIComponent(h),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=vl(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,s.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const m=ko(h);if(this._hashName){const b=this._hashName;let E=!1;const I=s.window.location.hash.slice(1).split("&").map(B=>{const U=B.split("=")[0];return U===b?(E=!0,`${U}=${m}`):B}).filter(B=>B);return E||I.push(`${b}=${m}`),`#${I.join("&")}`}return`#${m}`}_getCurrentHash(){const h=s.window.location.hash.replace("#","");if(this._hashName){let m;return h.split("&").map(b=>b.split("=")).forEach(b=>{b[0]===this._hashName&&(m=b)}),(m&&m[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(b=>isNaN(b))){const b=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(m[3]||0):h.getBearing();return h.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:b,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,h)}}function ko(y,h){const m=y.getCenter(),b=Math.round(100*y.getZoom())/100,E=Math.ceil((b*Math.LN2+Math.log(512/360/.5))/Math.LN10),I=Math.pow(10,E),B=Math.round(m.lng*I)/I,U=Math.round(m.lat*I)/I,H=y.getBearing(),K=y.getPitch();let Y=h?`/${B}/${U}/${b}`:`${b}/${U}/${B}`;return(H||K)&&(Y+="/"+Math.round(10*H)/10),K&&(Y+=`/${Math.round(K)}`),Y}const Xu={linearity:.3,easing:s.bezier(0,0,.3,1)},em=s.extend({deceleration:2500,maxSpeed:1400},Xu),pf=s.extend({deceleration:20,maxSpeed:1400},Xu),Qc=s.extend({deceleration:1e3,maxSpeed:360},Xu),tm=s.extend({deceleration:1e3,maxSpeed:90},Xu);class mf{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,m=s.exported.now();for(;h.length>0&&m-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const m={zoom:0,bearing:0,pitch:0,pan:new s.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:I}of this._inertiaBuffer)m.zoom+=I.zoomDelta||0,m.bearing+=I.bearingDelta||0,m.pitch+=I.pitchDelta||0,I.panDelta&&m.pan._add(I.panDelta),I.around&&(m.around=I.around),I.pinchAround&&(m.pinchAround=I.pinchAround);const b=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(m.pan.mag()){const I=tu(m.pan.mag(),b,s.extend({},em,h||{}));E.offset=m.pan.mult(I.amount/m.pan.mag()),E.center=this._map.transform.center,eu(E,I)}if(m.zoom){const I=tu(m.zoom,b,pf);E.zoom=this._map.transform.zoom+I.amount,eu(E,I)}if(m.bearing){const I=tu(m.bearing,b,Qc);E.bearing=this._map.transform.bearing+s.clamp(I.amount,-179,179),eu(E,I)}if(m.pitch){const I=tu(m.pitch,b,tm);E.pitch=this._map.transform.pitch+I.amount,eu(E,I)}if(E.zoom||E.bearing){const I=m.pinchAround===void 0?m.around:m.pinchAround;E.around=I?this._map.unproject(I):this._map.getCenter()}return this.clear(),E.noMoveStart=!0,E}}function eu(y,h){(!y.duration||y.duration<h.duration)&&(y.duration=h.duration,y.easing=h.easing)}function tu(y,h,m){const{maxSpeed:b,linearity:E,deceleration:I}=m,B=s.clamp(y*E/(h/1e3),-b,b),U=Math.abs(B)/(I*E);return{easing:m.easing,duration:1e3*U,amount:B*(U/2)}}class vo extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,b,E={}){const I=j(m.getCanvasContainer(),b),B=m.unproject(I);super(h,s.extend({point:I,lngLat:B,originalEvent:b},E)),this._defaultPrevented=!1,this.target=m}}class $u extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,b){const E=h==="touchend"?b.changedTouches:b.touches,I=Q(m.getCanvasContainer(),E),B=I.map(H=>m.unproject(H)),U=I.reduce((H,K,Y,oe)=>H.add(K.div(oe.length)),new s.pointGeometry(0,0));super(h,{points:I,point:U,lngLats:B,lngLat:m.unproject(U),originalEvent:b}),this._defaultPrevented=!1}}class nu extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,b){super(h,{originalEvent:b}),this._defaultPrevented=!1}}class Ng{constructor(h,m){this._map=h,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new nu(h.type,this._map,h))}mousedown(h,m){return this._mousedownPos=m,this._firePreventable(new vo(h.type,this._map,h))}mouseup(h){this._map.fire(new vo(h.type,this._map,h))}preclick(h){const m=s.extend({},h);m.type="preclick",this._map.fire(new vo(m.type,this._map,m))}click(h,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(h),this._map.fire(new vo(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new vo(h.type,this._map,h))}mouseover(h){this._map.fire(new vo(h.type,this._map,h))}mouseout(h){this._map.fire(new vo(h.type,this._map,h))}touchstart(h){return this._firePreventable(new $u(h.type,this._map,h))}touchmove(h){this._map.fire(new $u(h.type,this._map,h))}touchend(h){this._map.fire(new $u(h.type,this._map,h))}touchcancel(h){this._map.fire(new $u(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ug{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new vo(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new vo(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ed{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,m){this.isEnabled()&&h.shiftKey&&h.button===0&&(z(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(h,m){if(!this._active)return;const b=m,E=this._startPos,I=this._lastPos;if(!E||!I||I.equals(b)||!this._box&&b.dist(E)<this._clickTolerance)return;this._lastPos=b,this._box||(this._box=M("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const B=Math.min(E.x,b.x),U=Math.max(E.x,b.x),H=Math.min(E.y,b.y),K=Math.max(E.y,b.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${B}px,${H}px)`,this._box.style.width=U-B+"px",this._box.style.height=K-H+"px")})}mouseupWindow(h,m){if(!this._active)return;const b=this._startPos,E=m;if(b&&h.button===0){if(this.reset(),V(),b.x!==E.x||b.y!==E.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:I=>I.fitScreenCoordinates(b,E,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),F(),delete this._startPos,delete this._lastPos}_fireEvent(h,m){return this._map.fire(new s.Event(h,{originalEvent:m}))}}function Yu(y,h){const m={};for(let b=0;b<y.length;b++)m[y[b].identifier]=h[b];return m}class nm{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,m,b){(this.centroid||b.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),b.length===this.numTouches&&(this.centroid=function(E){const I=new s.pointGeometry(0,0);for(const B of E)I._add(B);return I.div(E.length)}(m),this.touches=Yu(b,m)))}touchmove(h,m,b){if(this.aborted||!this.centroid)return;const E=Yu(b,m);for(const I in this.touches){const B=this.touches[I],U=E[I];(!U||U.dist(B)>30)&&(this.aborted=!0)}}touchend(h,m,b){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),b.length===0){const E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class gf{constructor(h){this.singleTap=new nm(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,m,b){this.singleTap.touchstart(h,m,b)}touchmove(h,m,b){this.singleTap.touchmove(h,m,b)}touchend(h,m,b){const E=this.singleTap.touchend(h,m,b);if(E){const I=h.timeStamp-this.lastTime<500,B=!this.lastTap||this.lastTap.dist(E)<30;if(I&&B||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class _f{constructor(){this._zoomIn=new gf({numTouches:1,numTaps:2}),this._zoomOut=new gf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,m,b){this._zoomIn.touchstart(h,m,b),this._zoomOut.touchstart(h,m,b)}touchmove(h,m,b){this._zoomIn.touchmove(h,m,b),this._zoomOut.touchmove(h,m,b)}touchend(h,m,b){const E=this._zoomIn.touchend(h,m,b),I=this._zoomOut.touchend(h,m,b);return E?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()+1,around:B.unproject(E)},{originalEvent:h})}):I?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:B=>B.easeTo({duration:300,zoom:B.getZoom()-1,around:B.unproject(I)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ku={0:1,2:2};class td{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,m){return!1}_move(h,m){return{}}mousedown(h,m){if(this._lastPoint)return;const b=re(h);this._correctButton(h,b)&&(this._lastPoint=m,this._eventButton=b)}mousemoveWindow(h,m){const b=this._lastPoint;if(b){if(h.preventDefault(),this._eventButton!=null&&function(E,I){const B=Ku[I];return E.buttons===void 0||(E.buttons&B)!==B}(h,this._eventButton))this.reset();else if(this._moved||!(m.dist(b)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(b,m)}}mouseupWindow(h){this._lastPoint&&re(h)===this._eventButton&&(this._moved&&V(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class im extends td{mousedown(h,m){super.mousedown(h,m),this._lastPoint&&(this._active=!0)}_correctButton(h,m){return m===0&&!h.ctrlKey}_move(h,m){return{around:m,panDelta:m.sub(h)}}}class yf extends td{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const b=.8*(m.x-h.x);if(b)return this._active=!0,{bearingDelta:b}}contextmenu(h){h.preventDefault()}}class xf extends td{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const b=-.5*(m.y-h.y);if(b)return this._active=!0,{pitchDelta:b}}contextmenu(h){h.preventDefault()}}class rm{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.pointGeometry(0,0)}touchstart(h,m,b){return this._calculateTransform(h,m,b)}touchmove(h,m,b){if(this._active&&!(b.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(b.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,m,b)}}touchend(h,m,b){this._calculateTransform(h,m,b),this._active&&b.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,m,b){b.length>0&&(this._active=!0);const E=Yu(b,m),I=new s.pointGeometry(0,0),B=new s.pointGeometry(0,0);let U=0;for(const K in E){const Y=E[K],oe=this._touches[K];oe&&(I._add(Y),B._add(Y.sub(oe)),U++,E[K]=Y)}if(this._touches=E,U<this._minTouches||!B.mag())return;const H=B.div(U);return this._sum._add(H),this._sum.mag()<this._clickTolerance?void 0:{around:I.div(U),panDelta:H}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class nd{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,m,b){return{}}touchstart(h,m,b){this._firstTwoTouches||b.length<2||(this._firstTwoTouches=[b[0].identifier,b[1].identifier],this._start([m[0],m[1]]))}touchmove(h,m,b){const E=this._firstTwoTouches;if(!E)return;h.preventDefault();const[I,B]=E,U=_s(b,m,I),H=_s(b,m,B);if(!U||!H)return;const K=this._aroundCenter?null:U.add(H).div(2);return this._move([U,H],K,h)}touchend(h,m,b){if(!this._firstTwoTouches)return;const[E,I]=this._firstTwoTouches,B=_s(b,m,E),U=_s(b,m,I);B&&U||(this._active&&V(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function _s(y,h,m){for(let b=0;b<y.length;b++)if(y[b].identifier===m)return h[b]}function vf(y,h){return Math.log(y/h)/Math.LN2}class Ju extends nd{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,m){const b=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(vf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vf(this._distance,b),pinchAround:m}}}function Qu(y,h){return 180*y.angleWith(h)/Math.PI}class id extends nd{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,m){const b=this._vector;if(this._vector=h[0].sub(h[1]),b&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Qu(this._vector,b),pinchAround:m}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const m=25/(Math.PI*this._minDiameter)*360,b=this._startVector;if(!b)return!1;const E=Qu(h,b);return Math.abs(E)<m}}function iu(y){return Math.abs(y.y)>Math.abs(y.x)}class sm extends nd{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,iu(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,m,b){const E=this._lastPoints;if(!E)return;const I=h[0].sub(E[0]),B=h[1].sub(E[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&b.touches.length<3||(this._valid=this.gestureBeginsVertically(I,B,b.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(I.y+B.y)/2*-.5})}gestureBeginsVertically(h,m,b){if(this._valid!==void 0)return this._valid;const E=h.mag()>=2,I=m.mag()>=2;if(!E&&!I)return;if(!E||!I)return this._firstMove==null&&(this._firstMove=b),b-this._firstMove<100&&void 0;const B=h.y>0==m.y>0;return iu(h)&&iu(m)&&B}}const eh={panStep:100,bearingStep:15,pitchStep:10};class Wi{constructor(){const h=eh;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let m=0,b=0,E=0,I=0,B=0;switch(h.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:h.shiftKey?b=-1:(h.preventDefault(),I=-1);break;case 39:h.shiftKey?b=1:(h.preventDefault(),I=1);break;case 38:h.shiftKey?E=1:(h.preventDefault(),B=-1);break;case 40:h.shiftKey?E=-1:(h.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(b=0,E=0),{cameraAnimation:U=>{const H=U.getZoom();U.easeTo({duration:300,easeId:"keyboardHandler",easing:l0,zoom:m?Math.round(H)+m*(h.shiftKey?2:1):H,bearing:U.getBearing()+b*this._bearingStep,pitch:U.getPitch()+E*this._pitchStep,offset:[-I*this._panStep,-B*this._panStep],center:U.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function l0(y){return y*(2-y)}const om=4.000244140625;class Do{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=h.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const b=s.exported.now(),E=b-(this._lastWheelEventTime||0);this._lastWheelEventTime=b,m!==0&&m%om==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(E*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),h.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=h,this._delta-=m,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=j(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const H=this._type==="wheel"&&Math.abs(this._delta)>om?this._wheelZoomRate:this._defaultZoomRate;let K=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&K!==0&&(K=1/K);const Y=m(),oe=Math.pow(2,Y),me=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):oe;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(me*K))),this._type==="wheel"&&(this._startZoom=Y,this._easing=this._smoothOutEasing(200)),this._delta=0}const b=typeof this._targetZoom=="number"?this._targetZoom:m(),E=this._startZoom,I=this._easing;let B,U=!1;if(this._type==="wheel"&&E&&I){const H=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),K=I(H);B=s.number(E,b,K),H<1?this._frameId||(this._frameId=!0):U=!0}else B=b,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:B-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let m=s.ease;if(this._prevEase){const b=this._prevEase,E=(s.exported.now()-b.start)/b.duration,I=b.easing(E+.01)-b.easing(E),B=.27/Math.sqrt(I*I+1e-4)*.01,U=Math.sqrt(.0729-B*B);m=s.bezier(B,U,.25,1)}return this._prevEase={start:s.exported.now(),duration:h,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ks{constructor(h,m){this._clickZoom=h,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Na{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,m){return h.preventDefault(),{cameraAnimation:b=>{b.easeTo({duration:300,zoom:b.getZoom()+(h.shiftKey?-1:1),around:b.unproject(m)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class am{constructor(){this._tap=new gf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,m,b){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?b.length>0&&(this._swipePoint=m[0],this._swipeTouch=b[0].identifier):this._tap.touchstart(h,m,b))}touchmove(h,m,b){if(this._tapTime){if(this._swipePoint){if(b[0].identifier!==this._swipeTouch)return;const E=m[0],I=E.y-this._swipePoint.y;return this._swipePoint=E,h.preventDefault(),this._active=!0,{zoomDelta:I/128}}}else this._tap.touchmove(h,m,b)}touchend(h,m,b){this._tapTime?this._swipePoint&&b.length===0&&this.reset():this._tap.touchend(h,m,b)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ru{constructor(h,m,b){this._el=h,this._mousePan=m,this._touchPan=b}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xa{constructor(h,m,b){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=m,this._mousePitch=b}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class rd{constructor(h,m,b,E){this._el=h,this._touchZoom=m,this._touchRotate=b,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const dn=y=>y.zoom||y.drag||y.pitch||y.rotate;class lm extends s.Event{}class wf{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,m){const b=s.sub([],m,h);this.radius=s.length(b[2]<0?s.div([],b,this.constants):[b[0],b[1],0])}projectRay(h){s.div(h,h,this.constants),s.normalize(h,h),s.mul$1(h,h,this.constants);const m=s.scale$2([],h,this.radius);if(m[2]>0){const b=s.scale$2([],[0,0,1],s.dot(m,[0,0,1])),E=s.scale$2([],s.normalize([],[m[0],m[1],0]),this.radius),I=s.add([],m,s.scale$2([],s.sub([],s.add([],E,b),m),2));m[0]=I[0],m[1]=I[1]}return m}}function wl(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class th{constructor(h,m){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new mf(h),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new wf,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),s.bindAll(["handleEvent","handleWindowEvent"],this);const b=this._el;this._listeners=[[b,"touchstart",{passive:!0}],[b,"touchmove",{passive:!1}],[b,"touchend",void 0],[b,"touchcancel",void 0],[b,"mousedown",void 0],[b,"mousemove",void 0],[b,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[b,"mouseover",void 0],[b,"mouseout",void 0],[b,"dblclick",void 0],[b,"click",void 0],[b,"keydown",{capture:!1}],[b,"keyup",void 0],[b,"wheel",{passive:!1}],[b,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[E,I,B]of this._listeners)E.addEventListener(I,E===s.window.document?this.handleWindowEvent:this.handleEvent,B)}destroy(){for(const[h,m,b]of this._listeners)h.removeEventListener(m,h===s.window.document?this.handleWindowEvent:this.handleEvent,b)}_addDefaultHandlers(h){const m=this._map,b=m.getCanvasContainer();this._add("mapEvent",new Ng(m,h));const E=m.boxZoom=new ed(m,h);this._add("boxZoom",E);const I=new _f,B=new Na;m.doubleClickZoom=new Ks(B,I),this._add("tapZoom",I),this._add("clickZoom",B);const U=new am;this._add("tapDragZoom",U);const H=m.touchPitch=new sm(m);this._add("touchPitch",H);const K=new yf(h),Y=new xf(h);m.dragRotate=new xa(h,K,Y),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",Y,["mouseRotate"]);const oe=new im(h),me=new rm(m,h);m.dragPan=new ru(b,oe,me),this._add("mousePan",oe),this._add("touchPan",me,["touchZoom","touchRotate"]);const be=new id,we=new Ju;m.touchZoomRotate=new rd(b,we,be,U),this._add("touchRotate",be,["touchPan","touchZoom"]),this._add("touchZoom",we,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ug(m));const Me=m.scrollZoom=new Do(m,this);this._add("scrollZoom",Me,["mousePan"]);const _e=m.keyboard=new Wi;this._add("keyboard",_e);for(const xe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[xe]&&m[xe].enable(h[xe])}_add(h,m,b){this._handlers.push({handlerName:h,handler:m,allowed:b}),this._handlersById[h]=m}stop(h){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!dn(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,m,b){for(const E in h)if(E!==b&&(!m||m.indexOf(E)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const m=[];for(const b of h)this._el.contains(b.target)&&m.push(b);return m}handleEvent(h,m){this._updatingCamera=!0;const b=h.type==="renderFrame",E=b?void 0:h,I={needsRenderFrame:!1},B={},U={},H=h.touches?this._getMapTouches(h.touches):void 0,K=H?Q(this._el,H):b?void 0:j(this._el,h);for(const{handlerName:me,handler:be,allowed:we}of this._handlers){if(!be.isEnabled())continue;let Me;this._blockedByActive(U,we,me)?be.reset():be[m||h.type]&&(Me=be[m||h.type](h,K,H),this.mergeHandlerResult(I,B,Me,me,E),Me&&Me.needsRenderFrame&&this._triggerRenderFrame()),(Me||be.isActive())&&(U[me]=be)}const Y={};for(const me in this._previousActiveHandlers)U[me]||(Y[me]=E);this._previousActiveHandlers=U,(Object.keys(Y).length||wl(I))&&(this._changes.push([I,B,Y]),this._triggerRenderFrame()),(Object.keys(U).length||wl(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:oe}=I;oe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],oe(this._map))}mergeHandlerResult(h,m,b,E,I){if(!b)return;s.extend(h,b);const B={handlerName:E,originalEvent:b.originalEvent||I};b.zoomDelta!==void 0&&(m.zoom=B),b.panDelta!==void 0&&(m.drag=B),b.pitchDelta!==void 0&&(m.pitch=B),b.bearingDelta!==void 0&&(m.rotate=B)}_applyChanges(){const h={},m={},b={};for(const[E,I,B]of this._changes)E.panDelta&&(h.panDelta=(h.panDelta||new s.pointGeometry(0,0))._add(E.panDelta)),E.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(h.around=E.around),E.aroundCoord!==void 0&&(h.aroundCoord=E.aroundCoord),E.pinchAround!==void 0&&(h.pinchAround=E.pinchAround),E.noInertia&&(h.noInertia=E.noInertia),s.extend(m,I),s.extend(b,B);this._updateMapTransform(h,m,b),this._changes=[]}_updateMapTransform(h,m,b){const E=this._map,I=E.transform,B=Le=>[Le.x,Le.y,Le.z];if((Le=>{const Ce=this._eventsInProgress.drag;return Ce&&!this._handlersById[Ce.handlerName].isActive()})()&&!wl(h)){const Le=I.zoom;I.cameraElevationReference="sea",I.recenterOnTerrain(),I.cameraElevationReference="ground",Le!==I.zoom&&this._map._update(!0)}if(I._isCameraConstrained&&E._stop(!0),!wl(h))return void this._fireEvents(m,b,!0);let{panDelta:U,zoomDelta:H,bearingDelta:K,pitchDelta:Y,around:oe,aroundCoord:me,pinchAround:be}=h;I._isCameraConstrained&&(H>0&&(H=0),I._isCameraConstrained=!1),be!==void 0&&(oe=be),(Le=>m.drag&&!this._eventsInProgress.drag)()&&oe&&(this._dragOrigin=B(I.pointCoordinate3D(oe)),this._trackingEllipsoid.setup(I._camera.position,this._dragOrigin)),I.cameraElevationReference="sea",E._stop(!0),oe=oe||E.transform.centerPoint,K&&(I.bearing+=K),Y&&(I.pitch+=Y),I._updateCameraState();const we=[0,0,0];if(U)if(I.projection.name==="mercator"){const Le=this._trackingEllipsoid.projectRay(I.screenPointToMercatorRay(oe).dir),Ce=this._trackingEllipsoid.projectRay(I.screenPointToMercatorRay(oe.sub(U)).dir);we[0]=Ce[0]-Le[0],we[1]=Ce[1]-Le[1]}else{const Le=I.pointCoordinate(oe);if(I.projection.name==="globe"){U=U.rotate(-I.angle);const Ce=I._pixelsPerMercatorPixel/I.worldSize;we[0]=-U.x*s.mercatorScale(s.latFromMercatorY(Le.y))*Ce,we[1]=-U.y*s.mercatorScale(I.center.lat)*Ce}else{const Ce=I.pointCoordinate(oe.sub(U));Le&&Ce&&(we[0]=Ce.x-Le.x,we[1]=Ce.y-Le.y)}}const Me=I.zoom,_e=[0,0,0];if(H){const Le=B(me||I.pointCoordinate3D(oe)),Ce={dir:s.normalize([],s.sub([],Le,I._camera.position))};if(Ce.dir[2]<0){const Ue=I.zoomDeltaToMovement(Le,H);s.scale$2(_e,Ce.dir,Ue)}}const xe=s.add(we,we,_e);I._translateCameraConstrained(xe),H&&Math.abs(I.zoom-Me)>1e-4&&I.recenterOnTerrain(),I.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(m,b,!0)}_fireEvents(h,m,b){const E=dn(this._eventsInProgress),I=dn(h),B={};for(const Y in h){const{originalEvent:oe}=h[Y];this._eventsInProgress[Y]||(B[`${Y}start`]=oe),this._eventsInProgress[Y]=h[Y]}!E&&I&&this._fireEvent("movestart",I.originalEvent);for(const Y in B)this._fireEvent(Y,B[Y]);I&&this._fireEvent("move",I.originalEvent);for(const Y in h){const{originalEvent:oe}=h[Y];this._fireEvent(Y,oe)}const U={};let H;for(const Y in this._eventsInProgress){const{handlerName:oe,originalEvent:me}=this._eventsInProgress[Y];this._handlersById[oe].isActive()||(delete this._eventsInProgress[Y],H=m[oe]||me,U[`${Y}end`]=H)}for(const Y in U)this._fireEvent(Y,U[Y]);const K=dn(this._eventsInProgress);if(b&&(E||I)&&!K){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),oe=me=>me!==0&&-this._bearingSnap<me&&me<this._bearingSnap;Y?(oe(Y.bearing||this._map.getBearing())&&(Y.bearing=0),this._map.easeTo(Y,{originalEvent:H})):(this._map.fire(new s.Event("moveend",{originalEvent:H})),oe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,m){this._map.fire(new s.Event(h,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new lm("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const nh="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class sd extends s.Evented{constructor(h,m){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=m.bearingSnap,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,m){return this.jumpTo({center:h},m)}panBy(h,m,b){return h=s.pointGeometry.convert(h).mult(-1),this.panTo(this.transform.center,s.extend({offset:h},m),b)}panTo(h,m,b){return this.easeTo(s.extend({center:h},m),b)}getZoom(){return this.transform.zoom}setZoom(h,m){return this.jumpTo({zoom:h},m),this}zoomTo(h,m,b){return this.easeTo(s.extend({zoom:h},m),b)}zoomIn(h,m){return this.zoomTo(this.getZoom()+1,h,m),this}zoomOut(h,m){return this.zoomTo(this.getZoom()-1,h,m),this}getBearing(){return this.transform.bearing}setBearing(h,m){return this.jumpTo({bearing:h},m),this}getPadding(){return this.transform.padding}setPadding(h,m){return this.jumpTo({padding:h},m),this}rotateTo(h,m,b){return this.easeTo(s.extend({bearing:h},m),b)}resetNorth(h,m){return this.rotateTo(0,s.extend({duration:1e3},h),m),this}resetNorthPitch(h,m){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},h),m),this}snapToNorth(h,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,m):this}getPitch(){return this.transform.pitch}setPitch(h,m){return this.jumpTo({pitch:h},m),this}cameraForBounds(h,m){h=s.LngLatBounds.convert(h);const b=m&&m.bearing||0,E=m&&m.pitch||0,I=h.getNorthWest(),B=h.getSouthEast();return this._cameraForBounds(this.transform,I,B,b,E,m)}_extendCameraOptions(h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=s.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const b=h.padding;h.padding={top:b,bottom:b,right:b,left:b}}return h.padding=s.extend(m,h.padding),h}_minimumAABBFrustumDistance(h,m){const b=m.max[0]-m.min[0],E=m.max[1]-m.min[1];return b/E>h.aspect?b/(2*Math.tan(.5*h.fovX)*h.aspect):E/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,m,b,E,I,B){const U=h.clone(),H=this._extendCameraOptions(B);U.bearing=E,U.pitch=I;const K=s.LngLat.convert(m),Y=s.LngLat.convert(b),oe=.5*(K.lat+Y.lat),me=.5*(K.lng+Y.lng),be=s.latLngToECEF(oe,me),we=s.normalize([],be),Me=s.normalize([],s.cross([],we,[0,1,0])),_e=s.cross([],Me,we),xe=[Me[0],Me[1],Me[2],0,_e[0],_e[1],_e[2],0,we[0],we[1],we[2],0,0,0,0,1],Le=[be,s.latLngToECEF(K.lat,K.lng),s.latLngToECEF(Y.lat,K.lng),s.latLngToECEF(Y.lat,Y.lng),s.latLngToECEF(K.lat,Y.lng),s.latLngToECEF(oe,K.lng),s.latLngToECEF(oe,Y.lng),s.latLngToECEF(K.lat,me),s.latLngToECEF(Y.lat,me)];let Ce=s.Aabb.fromPoints(Le.map(Ye=>[s.dot(Me,Ye),s.dot(_e,Ye),s.dot(we,Ye)]));const Ue=s.transformMat4([],Ce.center,xe);s.squaredLength(Ue)===0&&s.set(Ue,0,0,1),s.normalize(Ue,Ue),s.scale$2(Ue,Ue,s.GLOBE_RADIUS),U.center=s.ecefToLatLng(Ue);const Xe=U.getWorldToCameraMatrix(),Ze=s.invert(new Float64Array(16),Xe);Ce=s.Aabb.applyTransform(Ce,s.multiply([],Xe,xe)),s.transformMat4(Ue,Ue,Xe);const tt=.5*(Ce.max[2]-Ce.min[2]),ft=this._minimumAABBFrustumDistance(U,Ce),lt=s.scale$2([],[0,0,1],tt),it=s.add(lt,Ue,lt),Wt=ft+(U.pitch===0?0:s.distance(Ue,it)),ot=U.globeCenterInViewSpace,bt=s.sub([],Ue,[ot[0],ot[1],ot[2]]);s.normalize(bt,bt),s.scale$2(bt,bt,Wt);const mt=s.add([],Ue,bt);s.transformMat4(mt,mt,Ze);const Ut=s.earthRadius/s.GLOBE_RADIUS,gt=s.length(mt),Lt=s.mercatorZfromAltitude(gt*Ut-s.earthRadius,0),kt=Math.min(U.zoomFromMercatorZAdjusted(Lt),H.maxZoom);return kt>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(U.setProjection({name:"mercator"}),U.zoom=kt,this._cameraForBounds(U,m,b,E,I,B)):{center:U.center,zoom:kt,bearing:E,pitch:I}}queryTerrainElevation(h,m){const b=this.transform.elevation;return b?(m=s.extend({},{exaggerated:!0},m),b.getAtPoint(s.MercatorCoordinate.fromLngLat(h),null,m.exaggerated)):null}_cameraForBounds(h,m,b,E,I,B){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,m,b,E,I,B);const U=h.clone(),H=this._extendCameraOptions(B),K=U.padding;U.bearing=E,U.pitch=I;const Y=s.LngLat.convert(m),oe=s.LngLat.convert(b),me=new s.LngLat(Y.lng,oe.lat),be=new s.LngLat(oe.lng,Y.lat),we=U.project(Y),Me=U.project(oe),_e=this.queryTerrainElevation(Y),xe=this.queryTerrainElevation(oe),Le=this.queryTerrainElevation(me),Ce=this.queryTerrainElevation(be),Ue=[[we.x,we.y,Math.min(_e||0,xe||0,Le||0,Ce||0)],[Me.x,Me.y,Math.max(_e||0,xe||0,Le||0,Ce||0)]];let Xe=s.Aabb.fromPoints(Ue);const Ze=U.getWorldToCameraMatrix(),tt=s.invert(new Float64Array(16),Ze);Xe=s.Aabb.applyTransform(Xe,Ze);const ft=s.sub([],Xe.max,Xe.min),lt=K.left||0,it=K.right||0,Wt=K.bottom||0,ot=K.top||0,{left:bt,right:mt,top:Ut,bottom:gt}=H.padding,Lt=.5*(lt+it),kt=.5*(ot+Wt),Ye=Math.min(U.scaleZoom(U.scale*Math.min((U.width-(lt+it+bt+mt))/ft[0],(U.height-(Wt+ot+gt+Ut))/ft[1])),H.maxZoom),at=U.scale/U.zoomScale(Ye);Xe=new s.Aabb([Xe.min[0]-(bt+Lt)*at,Xe.min[1]-(gt+kt)*at,Xe.min[2]],[Xe.max[0]+(mt+Lt)*at,Xe.max[1]+(Ut+kt)*at,Xe.max[2]]);const Qt=.5*ft[2],mn=this._minimumAABBFrustumDistance(U,Xe),cn=[0,0,1,0];s.transformMat4$1(cn,cn,Ze),s.normalize$2(cn,cn);const Fn=s.scale$2([],cn,mn+Qt),zn=s.add([],Xe.center,Fn),In=(typeof H.offset.x=="number"&&typeof H.offset.y=="number"?new s.pointGeometry(H.offset.x,H.offset.y):s.pointGeometry.convert(H.offset)).rotate(-s.degToRad(E));Xe.center[0]-=In.x*at,Xe.center[1]+=In.y*at,s.transformMat4(Xe.center,Xe.center,tt),s.transformMat4(zn,zn,tt);const an=[Xe.center[0],Xe.center[1],zn[2]*U.pixelsPerMeter];s.scale$2(an,an,1/U.worldSize);const Li=s.lngFromMercatorX(an[0]),bi=s.latFromMercatorY(an[1]),ki=Math.min(U._zoomFromMercatorZ(an[2]),H.maxZoom),si=new s.LngLat(Li,bi);return U.mercatorFromTransition&&ki<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(U.setProjection({name:"globe"}),U.zoom=ki,this._cameraForBounds(U,m,b,E,I,B)):{center:si,zoom:ki,bearing:E,pitch:I}}fitBounds(h,m,b){const E=this.cameraForBounds(h,m);return this._fitInternal(E,m,b)}fitScreenCoordinates(h,m,b,E,I){const B=s.pointGeometry.convert(h),U=s.pointGeometry.convert(m),H=new s.pointGeometry(Math.min(B.x,U.x),Math.min(B.y,U.y)),K=new s.pointGeometry(Math.max(B.x,U.x),Math.max(B.y,U.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(B,U))return this;const Y=this.transform.pointLocation3D(H),oe=this.transform.pointLocation3D(K),me=this.transform.pointLocation3D(new s.pointGeometry(H.x,K.y)),be=this.transform.pointLocation3D(new s.pointGeometry(K.x,H.y)),we=[Math.min(Y.lng,oe.lng,me.lng,be.lng),Math.min(Y.lat,oe.lat,me.lat,be.lat)],Me=[Math.max(Y.lng,oe.lng,me.lng,be.lng),Math.max(Y.lat,oe.lat,me.lat,be.lat)],_e=E&&E.pitch?E.pitch:this.getPitch(),xe=this._cameraForBounds(this.transform,we,Me,b,_e,E);return this._fitInternal(xe,E,I)}_fitInternal(h,m,b){return h?(delete(m=s.extend(h,m)).padding,m.linear?this.easeTo(m,b):this.flyTo(m,b)):this}jumpTo(h,m){this.stop();const b=h.preloadOnly?this.transform.clone():this.transform;let E=!1,I=!1,B=!1;return"zoom"in h&&b.zoom!==+h.zoom&&(E=!0,b.zoom=+h.zoom),h.center!==void 0&&(b.center=s.LngLat.convert(h.center)),"bearing"in h&&b.bearing!==+h.bearing&&(I=!0,b.bearing=+h.bearing),"pitch"in h&&b.pitch!==+h.pitch&&(B=!0,b.pitch=+h.pitch),h.padding==null||b.isPaddingEqual(h.padding)||(b.padding=h.padding),h.preloadOnly?(this._preloadTiles(b),this):(this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),E&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),I&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),B&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(nh),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,m){const b=this.transform;if(!b.projection.supportsFreeCamera)return s.warnOnce(nh),this;this.stop();const E=b.zoom,I=b.pitch,B=b.bearing;b.setFreeCameraOptions(h);const U=E!==b.zoom,H=I!==b.pitch,K=B!==b.bearing;return this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),U&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),K&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),H&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)),this}easeTo(h,m){this._stop(!1,h.easeId),((h=s.extend({offset:[0,0],duration:500,easing:s.ease},h)).animate===!1||!h.essential&&s.exported.prefersReducedMotion)&&(h.duration=0);const b=this.transform,E=this.getZoom(),I=this.getBearing(),B=this.getPitch(),U=this.getPadding(),H="zoom"in h?+h.zoom:E,K="bearing"in h?this._normalizeBearing(h.bearing,I):I,Y="pitch"in h?+h.pitch:B,oe="padding"in h?h.padding:b.padding,me=s.pointGeometry.convert(h.offset);let be,we,Me;if(b.projection.name==="globe"){const lt=s.MercatorCoordinate.fromLngLat(b.center),it=me.rotate(-b.angle);lt.x+=it.x/b.worldSize,lt.y+=it.y/b.worldSize;const Wt=lt.toLngLat(),ot=s.LngLat.convert(h.center||Wt);this._normalizeCenter(ot),be=b.centerPoint.add(it),we=new s.pointGeometry(lt.x,lt.y).mult(b.worldSize),Me=new s.pointGeometry(s.mercatorXfromLng(ot.lng),s.mercatorYfromLat(ot.lat)).mult(b.worldSize).sub(we)}else{be=b.centerPoint.add(me);const lt=b.pointLocation(be),it=s.LngLat.convert(h.center||lt);this._normalizeCenter(it),we=b.project(lt),Me=b.project(it).sub(we)}const _e=b.zoomScale(H-E);let xe,Le;h.around&&(xe=s.LngLat.convert(h.around),Le=b.locationPoint(xe));const Ce=this._zooming||H!==E,Ue=this._rotating||I!==K,Xe=this._pitching||Y!==B,Ze=!b.isPaddingEqual(oe),tt=lt=>it=>{if(Ce&&(lt.zoom=s.number(E,H,it)),Ue&&(lt.bearing=s.number(I,K,it)),Xe&&(lt.pitch=s.number(B,Y,it)),Ze&&(lt.interpolatePadding(U,oe,it),be=lt.centerPoint.add(me)),xe)lt.setLocationAtPoint(xe,Le);else{const Wt=lt.zoomScale(lt.zoom-E),ot=H>E?Math.min(2,_e):Math.max(.5,_e),bt=Math.pow(ot,1-it),mt=lt.unproject(we.add(Me.mult(it*bt)).mult(Wt));lt.setLocationAtPoint(lt.renderWorldCopies?mt.wrap():mt,be)}return h.preloadOnly||this._fireMoveEvents(m),lt};if(h.preloadOnly){const lt=this._emulate(tt,h.duration,b);return this._preloadTiles(lt),this}const ft={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ce,this._rotating=Ue,this._pitching=Xe,this._padding=Ze,this._easeId=h.easeId,this._prepareEase(m,h.noMoveStart,ft),this._ease(tt(b),lt=>{b.recenterOnTerrain(),this._afterEase(m,lt)},h),this}_prepareEase(h,m,b={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||b.moving||this.fire(new s.Event("movestart",h)),this._zooming&&!b.zooming&&this.fire(new s.Event("zoomstart",h)),this._rotating&&!b.rotating&&this.fire(new s.Event("rotatestart",h)),this._pitching&&!b.pitching&&this.fire(new s.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new s.Event("move",h)),this._zooming&&this.fire(new s.Event("zoom",h)),this._rotating&&this.fire(new s.Event("rotate",h)),this._pitching&&this.fire(new s.Event("pitch",h))}_afterEase(h,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const b=this._zooming,E=this._rotating,I=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new s.Event("zoomend",h)),E&&this.fire(new s.Event("rotateend",h)),I&&this.fire(new s.Event("pitchend",h)),this.fire(new s.Event("moveend",h))}flyTo(h,m){if(!h.essential&&s.exported.prefersReducedMotion){const Ye=s.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ye,m)}this.stop(),h=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},h);const b=this.transform,E=this.getZoom(),I=this.getBearing(),B=this.getPitch(),U=this.getPadding(),H="zoom"in h?s.clamp(+h.zoom,b.minZoom,b.maxZoom):E,K="bearing"in h?this._normalizeBearing(h.bearing,I):I,Y="pitch"in h?+h.pitch:B,oe="padding"in h?h.padding:b.padding,me=b.zoomScale(H-E),be=s.pointGeometry.convert(h.offset);let we=b.centerPoint.add(be);const Me=b.pointLocation(we),_e=s.LngLat.convert(h.center||Me);this._normalizeCenter(_e);const xe=b.project(Me),Le=b.project(_e).sub(xe);let Ce=h.curve;const Ue=Math.max(b.width,b.height),Xe=Ue/me,Ze=Le.mag();if("minZoom"in h){const Ye=s.clamp(Math.min(h.minZoom,E,H),b.minZoom,b.maxZoom),at=Ue/b.zoomScale(Ye-E);Ce=Math.sqrt(at/Ze*2)}const tt=Ce*Ce;function ft(Ye){const at=(Xe*Xe-Ue*Ue+(Ye?-1:1)*tt*tt*Ze*Ze)/(2*(Ye?Xe:Ue)*tt*Ze);return Math.log(Math.sqrt(at*at+1)-at)}function lt(Ye){return(Math.exp(Ye)-Math.exp(-Ye))/2}function it(Ye){return(Math.exp(Ye)+Math.exp(-Ye))/2}const Wt=ft(0);let ot=function(Ye){return it(Wt)/it(Wt+Ce*Ye)},bt=function(Ye){return Ue*((it(Wt)*(lt(at=Wt+Ce*Ye)/it(at))-lt(Wt))/tt)/Ze;var at},mt=(ft(1)-Wt)/Ce;if(Math.abs(Ze)<1e-6||!isFinite(mt)){if(Math.abs(Ue-Xe)<1e-6)return this.easeTo(h,m);const Ye=Xe<Ue?-1:1;mt=Math.abs(Math.log(Xe/Ue))/Ce,bt=function(){return 0},ot=function(at){return Math.exp(Ye*Ce*at)}}h.duration="duration"in h?+h.duration:1e3*mt/("screenSpeed"in h?+h.screenSpeed/Ce:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const Ut=I!==K,gt=Y!==B,Lt=!b.isPaddingEqual(oe),kt=Ye=>at=>{const Qt=at*mt,mn=1/ot(Qt);Ye.zoom=at===1?H:E+Ye.scaleZoom(mn),Ut&&(Ye.bearing=s.number(I,K,at)),gt&&(Ye.pitch=s.number(B,Y,at)),Lt&&(Ye.interpolatePadding(U,oe,at),we=Ye.centerPoint.add(be));const cn=at===1?_e:Ye.unproject(xe.add(Le.mult(bt(Qt))).mult(mn));return Ye.setLocationAtPoint(Ye.renderWorldCopies?cn.wrap():cn,we),Ye._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(m),Ye};if(h.preloadOnly){const Ye=this._emulate(kt,h.duration,b);return this._preloadTiles(Ye),this}return this._zooming=!0,this._rotating=Ut,this._pitching=gt,this._padding=Lt,this._prepareEase(m,!1),this._ease(kt(b),()=>this._afterEase(m),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const b=this._onEaseEnd;this._onEaseEnd=void 0,b.call(this,m)}if(!h){const b=this.handlers;b&&b.stop(!1)}return this}_ease(h,m,b){b.animate===!1||b.duration===0?(h(1),m()):(this._easeStart=s.exported.now(),this._easeOptions=b,this._onEaseFrame=h,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,m){h=s.wrap(h,-180,180);const b=Math.abs(h-m);return Math.abs(h-360-m)<b&&(h-=360),Math.abs(h+360-m)<b&&(h+=360),h}_normalizeCenter(h){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const b=h.lng-m.center.lng;h.lng+=b>180?-360:b<-180?360:0}_emulate(h,m,b){const E=Math.ceil(15*m/1e3),I=[],B=h(b.clone());for(let U=0;U<=E;U++){const H=B(U/E);I.push(H.clone())}return I}}class bf{constructor(h={}){this.options=h,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const m=this.options&&this.options.compact;return this._map=h,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=M("button","mapboxgl-ctrl-attrib-button",this._container),M("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=M("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,m){const b=this._map._getUIString(`AttributionControl.${m}`);h.setAttribute("aria-label",b),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",b)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(h){const b=m.reduce((E,I,B)=>(I.value&&(E+=`${I.key}=${I.value}${B<m.length-1?"&":""}`),E),"?");h.href=`${s.config.FEEDBACK_URL}/${b}#${ko(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}const m=this._map.style._sourceCaches;for(const E in m){const I=m[E];if(I.used){const B=I.getSource();B.attribution&&h.indexOf(B.attribution)<0&&h.push(B.attribution)}}h.sort((E,I)=>E.length-I.length),h=h.filter((E,I)=>{for(let B=I+1;B<h.length;B++)if(h[B].indexOf(E)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const b=h.join(" | ");b!==this._attribHTML&&(this._attribHTML=b,h.length?(this._innerContainer.innerHTML=b,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class od{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=M("div","mapboxgl-ctrl");const m=M("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const m in h){const b=h[m].getSource();if(b.hasOwnProperty("mapbox_logo")&&!b.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const m=h[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class Sf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const m=++this._id;return this._queue.push({callback:h,id:m,cancelled:!1}),m}remove(h){const m=this._currentlyRunning,b=m?this._queue.concat(m):this._queue;for(const E of b)if(E.id===h)return void(E.cancelled=!0)}run(h=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const b of m)if(!b.cancelled&&(b.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Mf(y,h,m){if(y=new s.LngLat(y.lng,y.lat),h){const b=new s.LngLat(y.lng-360,y.lat),E=new s.LngLat(y.lng+360,y.lat),I=360*Math.ceil(Math.abs(y.lng-m.center.lng)/360),B=m.locationPoint(y).distSqr(h),U=h.x<0||h.y<0||h.x>m.width||h.y>m.height;m.locationPoint(b).distSqr(h)<B&&(U||Math.abs(b.lng-m.center.lng)<I)?y=b:m.locationPoint(E).distSqr(h)<B&&(U||Math.abs(E.lng-m.center.lng)<I)&&(y=E)}for(;Math.abs(y.lng-m.center.lng)>180;){const b=m.locationPoint(y);if(b.x>=0&&b.y>=0&&b.x<=m.width&&b.y<=m.height)break;y.lng>m.center.lng?y.lng-=360:y.lng+=360}return y}const bl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ih extends s.Evented{constructor(h,m){if(super(),(h instanceof s.window.HTMLElement||m)&&(h=s.extend({element:h},m)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=s.pointGeometry.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=M("div");const E=41,I=27,B=A("svg",{display:"block",height:E*this._scale+"px",width:I*this._scale+"px",viewBox:`0 0 ${I} ${E}`},this._element),U=A("radialGradient",{id:"shadowGradient"},A("defs",{},B));A("stop",{offset:"10%","stop-opacity":.4},U),A("stop",{offset:"100%","stop-opacity":.05},U),A("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},B),A("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},B),A("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},B),A("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},B),this._offset=s.pointGeometry.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",E=>{E.preventDefault()}),this._element.addEventListener("mousedown",E=>{E.preventDefault()});const b=this._element.classList;for(const E in bl)b.remove(`mapboxgl-marker-anchor-${E}`);b.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const E=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(38.1-13.5+E)],"bottom-right":[-E,-1*(38.1-13.5+E)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const m=h.code,b=h.charCode||h.keyCode;m!=="Space"&&m!=="Enter"&&b!==32&&b!==13||this.togglePopup()}_onMapClick(h){const m=h.originalEvent.target,b=this._element;this._popup&&(m===b||b.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,m=this._pos;if(!h||!m)return!1;const b=h.unproject(m),E=h.getFreeCameraOptions();if(!E.position)return!1;const I=E.position.toLngLat();return I.distanceTo(b)<.9*I.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const m=this._pos;if(!m||m.x<0||m.x>h.transform.width||m.y<0||m.y>h.transform.height)return void this._clearFadeTimer();const b=h.unproject(m);let E;h._showingGlobe()&&s.isLngLatBehindGlobe(h.transform,this._lngLat)?E=0:(E=1-h._queryFogOpacity(b),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(E*=this._occludedOpacity)),this._element.style.opacity=`${E}`,this._element.style.pointerEvents=E>0?"auto":"none",this._popup&&this._popup._setOpacity(E),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${bl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const h=this._pos,m=this._map,b=this.getPitchAlignment();if(!m||!h||b!=="map")return"";if(!m._showingGlobe()){const H=m.getPitch();return H?`rotateX(${H}deg)`:""}const E=s.radToDeg(s.globeTiltAtLngLat(m.transform,this._lngLat)),I=h.sub(s.globeCenterToScreenPoint(m.transform)),B=Math.abs(I.x)+Math.abs(I.y);if(B===0)return"";const U=E/B;return`rotateX(${-I.y*U}deg) rotateY(${I.x*U}deg)`}_calculateZTransform(){const h=this._pos,m=this._map;if(!m||!h)return"";let b=0;const E=this.getRotationAlignment();if(E==="map")if(m._showingGlobe()){const I=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),B=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(I);b=s.radToDeg(Math.atan2(B.y,B.x))-90}else b=-m.getBearing();else if(E==="horizon"){const I=s.smoothstep(4,6,m.getZoom()),B=s.globeCenterToScreenPoint(m.transform);B.y+=I*m.transform.height;const U=h.sub(B),H=s.radToDeg(Math.atan2(U.y,U.x));b=(H>90?H-270:H+90)*(1-I)}return b+=this._rotation,b?`rotateZ(${b}deg)`:""}_update(h){s.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=Mf(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),h===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=s.pointGeometry.convert(h),this._update(),this}_onMove(h){const m=this._map;if(!m)return;const b=this._pointerdownPos,E=this._positionDelta;if(b&&E){if(!this._isDragging){const I=this._clickTolerance||m._clickTolerance;if(h.point.dist(b)<I)return;this._isDragging=!0}this._pos=h.point.sub(E),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(h){const m=this._map,b=this._pos;m&&b&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(b),this._pointerdownPos=h.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const m=this._map;return m&&(h?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const rh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cm=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function va(y=new s.pointGeometry(0,0),h="bottom"){if(typeof y=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(y,2)));switch(h){case"top":return new s.pointGeometry(0,y);case"top-left":return new s.pointGeometry(m,m);case"top-right":return new s.pointGeometry(-m,m);case"bottom":return new s.pointGeometry(0,-y);case"bottom-left":return new s.pointGeometry(m,-m);case"bottom-right":return new s.pointGeometry(-m,-m);case"left":return new s.pointGeometry(y,0);case"right":return new s.pointGeometry(-y,0)}return new s.pointGeometry(0,0)}return y instanceof s.pointGeometry||Array.isArray(y)?s.pointGeometry.convert(y):s.pointGeometry.convert(y[h]||[0,0])}class Vg{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const m=s.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,m,b){this._start=this.getValue(m),this._end=h,this._startTime=m,this._endTime=m+b}}const Gg={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ad={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},nc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wg{constructor(h,m,b=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new yf({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,b&&(this.mousePitch=new xf({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(h,m){this.mouseRotate.mousedown(h,m),this.mousePitch&&this.mousePitch.mousedown(h,m),z()}move(h,m){const b=this.map,E=this.mouseRotate.mousemoveWindow(h,m),I=E&&E.bearingDelta;if(I&&b.setBearing(b.getBearing()+I),this.mousePitch){const B=this.mousePitch.mousemoveWindow(h,m),U=B&&B.pitchDelta;U&&b.setPitch(b.getPitch()+U)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){F(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(s.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),j(this.element,h)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,j(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Q(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=Q(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const xn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ld={maxWidth:100,unit:"metric"};function Tf(y,h,m){const b=Ef(h),E=b/h,I={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[m];this._map._requestDomTask(()=>{this._container.style.width=y*E+"px",this._container.innerHTML=`${b}&nbsp;${I}`})}function Ef(y){const h=Math.pow(10,`${Math.floor(y)}`.length-1);let m=y/h;return m=m>=10?10:m>=5?5:m>=3?3:m>=2?2:m>=1?1:function(b){const E=Math.pow(10,Math.ceil(-Math.log(b)/Math.LN10));return Math.round(b*E)/E}(m),h*m}const cd={version:s.version,supported:p,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends sd{constructor(y){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(y=s.extend({},ad,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(y.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(y.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new tc(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),y),this._interactive=y.interactive,this._minTileCacheSize=y.minTileCacheSize,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=y.crossSourceCollisions,this._collectResourceTiming=y.collectResourceTiming,this._optimizeForTerrain=y.optimizeForTerrain,this._language=this._parseLanguage(y.language),this._worldview=y.worldview,this._renderTaskQueue=new Sf,this._domRenderTaskQueue=new Sf,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},Gg,y.locale),this._clickTolerance=y.clickTolerance,this._cooperativeGestures=y.cooperativeGestures,this._performanceMetricsCollection=y.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Vg(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(y.transformRequest,y.accessToken,y.testMode),this._silenceAuthErrors=!!y.testMode,typeof y.container=="string"){if(this._container=s.window.document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),y.maxBounds&&this.setMaxBounds(y.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new th(this,y),this._localFontFamily=y.localFontFamily,this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),y.projection&&this.setProjection(y.projection),this._hash=y.hash&&new hn(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,s.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),y.attributionControl&&this.addControl(new bf({customAttribution:y.customAttribution})),this._logoControl=new od,this.addControl(this._logoControl,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new s.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new s.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(y,h){if(h===void 0&&(h=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=y.onAdd(this);this._controls.push(y);const b=this._controlPositions[h];return h.indexOf("bottom")!==-1?b.insertBefore(m,b.firstChild):b.appendChild(m),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(y);return h>-1&&this._controls.splice(h,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(y){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new s.Event("movestart",y)).fire(new s.Event("move",y)),this.fire(new s.Event("resize",y)),h&&this.fire(new s.Event("moveend",y)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(y){return this.transform.setMaxBounds(s.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y?this.setZoom(y):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y?this.setZoom(y):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y?this.setPitch(y):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y?this.setPitch(y):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(y){return y==="auto"?s.window.navigator.language:Array.isArray(y)?y.length===0?void 0:y.map(h=>h==="auto"?s.window.navigator.language:h):y}setLanguage(y){const h=this._parseLanguage(y);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(y){return this.style&&y!==this._worldview?(this._worldview=y,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(y){return this._lazyInitEmptyStyle(),y?typeof y=="string"&&(y={name:y}):y=null,this._useExplicitProjection=!!y,this._prioritizeAndUpdateProjection(y,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const y=this.transform,h=y.projection.name;let m;h==="globe"&&y.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(y.setMercatorFromTransition(),m=!0):h==="mercator"&&y.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(y.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(y,h){return this._updateProjection(y||h||{name:"mercator"})}_updateProjection(y){let h;if(h=y.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(y),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(y){return this.transform.locationPoint3D(s.LngLat.convert(y))}unproject(y){return this.transform.pointLocation3D(s.pointGeometry.convert(y))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(y,h,m){if(y==="mouseenter"||y==="mouseover"){let b=!1;const E=B=>{const U=h.filter(K=>this.getLayer(K)),H=U.length?this.queryRenderedFeatures(B.point,{layers:U}):[];H.length?b||(b=!0,m.call(this,new vo(y,this,B.originalEvent,{features:H}))):b=!1},I=()=>{b=!1};return{layers:new Set(h),listener:m,delegates:{mousemove:E,mouseout:I}}}if(y==="mouseleave"||y==="mouseout"){let b=!1;const E=B=>{const U=h.filter(H=>this.getLayer(H));(U.length?this.queryRenderedFeatures(B.point,{layers:U}):[]).length?b=!0:b&&(b=!1,m.call(this,new vo(y,this,B.originalEvent)))},I=B=>{b&&(b=!1,m.call(this,new vo(y,this,B.originalEvent)))};return{layers:new Set(h),listener:m,delegates:{mousemove:E,mouseout:I}}}{const b=E=>{const I=h.filter(U=>this.getLayer(U)),B=I.length?this.queryRenderedFeatures(E.point,{layers:I}):[];B.length&&(E.features=B,m.call(this,E),delete E.features)};return{layers:new Set(h),listener:m,delegates:{[y]:b}}}}on(y,h,m){if(m===void 0)return super.on(y,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(y,h,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(b);for(const E in b.delegates)this.on(E,b.delegates[E]);return this}once(y,h,m){if(m===void 0)return super.once(y,h);Array.isArray(h)||(h=[h]);const b=this._createDelegatedListener(y,h,m);for(const E in b.delegates)this.once(E,b.delegates[E]);return this}off(y,h,m){if(m===void 0)return super.off(y,h);h=new Set(Array.isArray(h)?h:[h]);const b=(I,B)=>{if(I.size!==B.size)return!1;for(const U of I)if(!B.has(U))return!1;return!0},E=this._delegatedListeners?this._delegatedListeners[y]:void 0;return E&&(I=>{for(let B=0;B<I.length;B++){const U=I[B];if(U.listener===m&&b(U.layers,h)){for(const H in U.delegates)this.off(H,U.delegates[H]);return I.splice(B,1),this}}})(E),this}queryRenderedFeatures(y,h){return this.style?(h!==void 0||y===void 0||y instanceof s.pointGeometry||Array.isArray(y)||(h=y,y=void 0),this.style.queryRenderedFeatures(y=y||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(y,h){return this.style.querySourceFeatures(y,h)}setStyle(y,h){return(h=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&y?(this._diffStyle(y,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(y,h))}_getUIString(y){const h=this._locale[y];if(h==null)throw new Error(`Missing UI string '${y}'`);return h}_updateStyle(y,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),y&&(this.style=new Cs(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Cs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,h){if(typeof y=="string"){const m=this._requestManager.normalizeStyleURL(y),b=this._requestManager.transformRequest(m,s.ResourceType.Style);s.getJSON(b,(E,I)=>{E?this.fire(new s.ErrorEvent(E)):I&&this._updateDiff(I,h)})}else typeof y=="object"&&this._updateDiff(y,h)}_updateDiff(y,h){try{this.style.setState(y)&&this._update(!0)}catch(m){s.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(y,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(y,h){return this._lazyInitEmptyStyle(),this.style.addSource(y,h),this._update(!0)}isSourceLoaded(y){return!!this.style&&this.style._isSourceCacheLoaded(y)}areTilesLoaded(){const y=this.style&&this.style._sourceCaches;for(const h in y){const m=y[h]._tiles;for(const b in m){const E=m[b];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}addSourceType(y,h,m){this._lazyInitEmptyStyle(),this.style.addSourceType(y,h,m)}removeSource(y){return this.style.removeSource(y),this._updateTerrain(),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,h,{pixelRatio:m=1,sdf:b=!1,stretchX:E,stretchY:I,content:B}={}){if(this._lazyInitEmptyStyle(),h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap){const{width:U,height:H,data:K}=s.exported.getImageData(h);this.style.addImage(y,{data:new s.RGBAImage({width:U,height:H},K),pixelRatio:m,stretchX:E,stretchY:I,content:B,sdf:b,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:U,height:H}=h,K=h;this.style.addImage(y,{data:new s.RGBAImage({width:U,height:H},new Uint8Array(K.data)),pixelRatio:m,stretchX:E,stretchY:I,content:B,sdf:b,version:0,userImage:K}),K.onAdd&&K.onAdd(this,y)}}updateImage(y,h){const m=this.style.getImage(y);if(!m)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const b=h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap?s.exported.getImageData(h):h,{width:E,height:I}=b;E!==void 0&&I!==void 0?E===m.data.width&&I===m.data.height?(m.data.replace(b.data,!(h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap)),this.style.updateImage(y,m)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${E}, ${I})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,h){s.getImage(this._requestManager.transformRequest(y,s.ResourceType.Image),(m,b)=>{h(m,b instanceof s.window.HTMLImageElement?s.exported.getImageData(b):b)})}listImages(){return this.style.listImages()}addLayer(y,h){return this._lazyInitEmptyStyle(),this.style.addLayer(y,h),this._update(!0)}moveLayer(y,h){return this.style.moveLayer(y,h),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,h,m){return this.style.setLayerZoomRange(y,h,m),this._update(!0)}setFilter(y,h,m={}){return this.style.setFilter(y,h,m),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,h,m,b={}){return this.style.setPaintProperty(y,h,m,b),this._update(!0)}getPaintProperty(y,h){return this.style.getPaintProperty(y,h)}setLayoutProperty(y,h,m,b={}){return this.style.setLayoutProperty(y,h,m,b),this._update(!0)}getLayoutProperty(y,h){return this.style.getLayoutProperty(y,h)}setLight(y,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(y){return this._lazyInitEmptyStyle(),!y&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(y),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(y){return this._lazyInitEmptyStyle(),this.style.setFog(y),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(y){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(y),this.transform):0}setFeatureState(y,h){return this.style.setFeatureState(y,h),this._update()}removeFeatureState(y,h){return this.style.removeFeatureState(y,h),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}_updateContainerDimensions(){if(!this._container)return;const y=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let m,b,E,I=this._container;for(;I&&(!b||!E);){const B=s.window.getComputedStyle(I).transform;B&&B!=="none"&&(m=B.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(b=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(E=m[3])),I=I.parentElement}this._containerWidth=b?Math.abs(y/b):y,this._containerHeight=E?Math.abs(h/E):h}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const y=this._container;y.classList.add("mapboxgl-map"),(this._missingCSSCanary=M("div","mapboxgl-canary",y)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=M("div","mapboxgl-canvas-container",y);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=M("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=M("div","mapboxgl-control-container",y),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{b[E]=M("div",`mapboxgl-ctrl-${E}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,h){const m=s.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(y),this._canvas.height=m*Math.ceil(h),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${h}px`}_addMarker(y){this._markers.push(y)}_removeMarker(y){const h=this._markers.indexOf(y);h!==-1&&this._markers.splice(h,1)}_addPopup(y){this._popups.push(y)}_removePopup(y){const h=this._popups.indexOf(y);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const y=s.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);h?(s.storeAuthState(h,!0),this.painter=new uf(h,this.transform),this.on("data",m=>{m.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(h)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_requestDomTask(y){!this.loaded()||this.loaded()&&!this.isMoving()?y():this._domRenderTaskQueue.add(y)}_render(y){let h;const m=this.painter.context.extTimerQuery,b=s.exported.now();if(this.listens("gpu-timing-frame")&&(h=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(y),this._domRenderTaskQueue.run(y),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,H=this.transform.pitch,K=s.exported.now(),Y=new s.EvaluationParameters(U,{now:K,fadeDuration:E,pitch:H,transition:this.style.getTransition()});this.style.update(Y)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let I=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),I=this._updateAverageElevation(b),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):I=this._updateAverageElevation(b),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const U=s.exported.now()-b;m.endQueryEXT(m.TIME_ELAPSED_EXT,h),setTimeout(()=>{const H=m.getQueryObjectEXT(h,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(h),this.fire(new s.Event("gpu-timing-frame",{cpuTime:U,gpuTime:H})),s.window.performance.mark("frame-gpu",{startTime:b,detail:{gpuTime:H}})},50)}if(this.listens("gpu-timing-layer")){const U=this.painter.collectGpuTimers();setTimeout(()=>{const H=this.painter.queryGpuTimers(U);this.fire(new s.Event("gpu-timing-layer",{layerTimes:H}))},50)}if(this.listens("gpu-timing-deferred-render")){const U=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const H=this.painter.queryGpuTimeDeferredRender(U);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:H}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||I;if(B||this._repaint)this.triggerRepaint();else{const U=!this.isMoving()&&this.loaded();if(U&&(I=this._updateAverageElevation(b,!0)),I)this.triggerRepaint();else if(this._triggerFrame(!1),U&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const H=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:H})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(y){for(const h of this._markers)y&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!y||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(y,h=!1){const m=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((h||y-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(y)){const b=this.transform.averageElevation;let E=this.transform.sampleAverageElevation(),I=!1;this.transform.elevation&&(I=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=y;const B=Math.abs(b-E);if(B>1){if(this._isInitialLoad||I)return this._averageElevation.jumpTo(E),m(E);this._averageElevation.easeTo(E,y,300)}else if(B>1e-4)return this._averageElevation.jumpTo(E),m(E)}return!!this._averageElevation.isEasing(y)&&m(this._averageElevation.getValue(y))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,y=>{if(y&&(y.message===s.AUTH_ERR_MSG||y.status===401)){const h=this.painter.context.gl;s.storeAuthState(h,!1),this._logoControl instanceof od&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const y=this._isDragging();this.painter.updateTerrain(this.style,y)}_calculateSpeedIndex(){const y=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const m=this.painter.context.gl,b=m.createFramebuffer();function E(I){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,I,0);const B=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,B),B}return m.bindFramebuffer(m.FRAMEBUFFER,b),this._canvasPixelComparison(E(y),h.canvasCopies.map(E),h.timeStamps)}_canvasPixelComparison(y,h,m){let b=m[1]-m[0];const E=y.length/4;for(let I=0;I<h.length;I++){const B=h[I];let U=0;for(let H=0;H<B.length;H+=4)B[H]===y[H]&&B[H+1]===y[H+1]&&B[H+2]===y[H+2]&&B[H+3]===y[H+3]&&(U+=1);b+=(m[I+2]-m[I+1])*(1-U/E)}return b}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(y){this._renderNextFrame=this._renderNextFrame||y,this.style&&!this._frame&&(this._frame=s.exported.frame(h=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(h)}))}_preloadTiles(y){const h=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(h,(m,b)=>m._preloadTiles(y,b),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(y){this._showTerrainWireframe!==y&&(this._showTerrainWireframe=y,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(y){this._speedIndexTiming!==y&&(this._speedIndexTiming=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(y){this._showTileAABBs!==y&&(this._showTileAABBs=y,y&&this._update())}_setCacheLimits(y,h){s.setCacheLimits(y,h)}get version(){return s.version}},NavigationControl:class{constructor(y){this.options=s.extend({},nc,y),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),M("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),M("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:h}):m.resetNorth({},{originalEvent:h}))}),this._compassIcon=M("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map;if(!y)return;const h=y.getZoom(),m=h===y.getMaxZoom(),b=h===y.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=b,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",b.toString())}_rotateCompassArrow(){const y=this._map;if(!y)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(y.transform.pitch*(Math.PI/180)),.5)}) rotateX(${y.transform.pitch}deg) rotateZ(${y.transform.angle*(180/Math.PI)}deg)`:`rotate(${y.transform.angle*(180/Math.PI)}deg)`;y._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),y.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&y.on("pitch",this._rotateCompassArrow),y.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wg(y,this._compass,this.options.visualizePitch)),this._container}onRemove(){const y=this._map;y&&(this._container.remove(),this.options.showZoom&&y.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&y.off("pitch",this._rotateCompassArrow),y.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(y,h){const m=M("button",y,this._container);return m.type="button",m.addEventListener("click",h),m}_setButtonTitle(y,h){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${h}`);y.setAttribute("aria-label",m),y.firstElementChild&&y.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends s.Evented{constructor(y){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},xn,y),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=vl(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(y){return this._map=y,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(y){const h=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,y(m)};this._supportsGeolocation!==void 0?y(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(m=>h(m.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(y){const h=this._map.getMaxBounds(),m=y.coords;return!!h&&(m.longitude<h.getWest()||m.longitude>h.getEast()||m.latitude<h.getSouth()||m.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",y)),this._finish()}}_updateCamera(y){const h=new s.LngLat(y.coords.longitude,y.coords.latitude),m=y.coords.accuracy,b=this._map.getBearing(),E=s.extend({bearing:b},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(m),E,{geolocateSource:!0})}_updateMarker(y){if(y){const h=new s.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map.transform,h=s.mercatorZfromAltitude(1,y._center.lat)*y.worldSize,m=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=M("button","mapboxgl-ctrl-geolocate",this._container),M("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M("div","mapboxgl-user-location"),this._dotElement.appendChild(M("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(M("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ih({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=M("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ih({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(y){this._userLocationDotMarker&&(y.webkitCompassHeading?this._heading=y.webkitCompassHeading:y.absolute===!0&&(this._heading=-1*y.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(y={maximumAge:6e5,timeout:0},this._noTimeout=!0):(y=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,y),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const y=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&y()}).catch(console.error):y()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:bf,ScaleControl:class{constructor(y){this.options=s.extend({},ld,y),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=Tf.bind(this)),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const y=this.options.maxWidth||100,h=this._map,m=h._containerHeight/2,b=h._containerWidth/2-y/2,E=h.unproject([b,m]),I=h.unproject([b+y,m]),B=E.distanceTo(I);if(this.options.unit==="imperial"){const U=3.2808*B;U>5280?this._setScale(y,U/5280,"mile"):this._setScale(y,U,"foot")}else this.options.unit==="nautical"?this._setScale(y,B/1852,"nautical-mile"):B>=1e3?this._setScale(y,B/1e3,"kilometer"):this._setScale(y,B,"meter")}_setScale(y,h,m){const b=Ef(h),E=b/h;this._map._requestDomTask(()=>{this._container.style.width=y*E+"px",this._container.innerHTML=m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:m}).format(b):`${b}&nbsp;nm`})}onAdd(y){return this._map=y,this._language=y.getLanguage(),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(y){this._language=y,this._update()}setUnit(y){this.options.unit=y,this._update()}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof s.window.HTMLElement?this._container=y.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=M("button","mapboxgl-ctrl-fullscreen",this._controlContainer);M("span","mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",y)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(y){super(),this.options=s.extend(Object.create(rh),y),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(y&&y.className?y.className.trim().split(/\s+/):[])}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&y.on("preclick",this._onClose),this.options.closeOnMove&&y.on("move",this._onClose),y.on("remove",this.remove),this._update(),y._addPopup(this),this._focusFirstElement(),this._trackPointer?(y.on("mousemove",this._onMouseEvent),y.on("mouseup",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")):y.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const y=this._map;return y&&(y.off("move",this._update),y.off("move",this._onClose),y.off("preclick",this._onClose),y.off("click",this._onClose),y.off("remove",this.remove),y.off("mousemove",this._onMouseEvent),y.off("mouseup",this._onMouseEvent),y.off("drag",this._onMouseEvent),y._canvasContainer&&y._canvasContainer.classList.remove("mapboxgl-track-pointer"),y._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){this._lngLat=s.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const y=this._map;return y&&(y.off("move",this._update),y.on("mousemove",this._onMouseEvent),y.on("drag",this._onMouseEvent),y._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(s.window.document.createTextNode(y))}setHTML(y){const h=s.window.document.createDocumentFragment(),m=s.window.document.createElement("body");let b;for(m.innerHTML=y;b=m.firstChild,b;)h.appendChild(b);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=M("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(y),this.options.closeButton){const m=this._closeButton=M("button","mapboxgl-popup-close-button",h);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(y){return this._classList.add(y),this._updateClassList(),this}removeClassName(y){return this._classList.delete(y),this._updateClassList(),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){let h;return this._classList.delete(y)?h=!1:(this._classList.add(y),h=!0),this._updateClassList(),h}_onMouseEvent(y){this._update(y.point)}_getAnchor(y){if(this.options.anchor)return this.options.anchor;const h=this._map,m=this._container,b=this._pos;if(!h||!m||!b)return"bottom";const E=m.offsetWidth,I=m.offsetHeight,B=b.x<E/2,U=b.x>h.transform.width-E/2;if(b.y+y<I)return B?"top-left":U?"top-right":"top";if(b.y>h.transform.height-I){if(B)return"bottom-left";if(U)return"bottom-right"}return B?"left":U?"right":"bottom"}_updateClassList(){const y=this._container;if(!y)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),y.className=h.join(" ")}_update(y){const h=this._map,m=this._content;if(!h||!this._lngLat&&!this._trackPointer||!m)return;let b=this._container;if(b||(b=this._container=M("div","mapboxgl-popup",h.getContainer()),this._tip=M("div","mapboxgl-popup-tip",b),b.appendChild(m)),this.options.maxWidth&&b.style.maxWidth!==this.options.maxWidth&&(b.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mf(this._lngLat,this._pos,h.transform)),!this._trackPointer||y){const E=this._pos=this._trackPointer&&y?y:h.project(this._lngLat),I=va(this.options.offset),B=this._anchor=this._getAnchor(I.y),U=va(this.options.offset,B),H=E.add(U).round();h._requestDomTask(()=>{this._container&&B&&(this._container.style.transform=`${bl[B]} translate(${H.x}px,${H.y}px)`)})}if(!this._marker&&h._showingGlobe()){const E=s.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(E)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(cm);y&&y.focus()}_onClose(){this.remove()}_setOpacity(y){this._container&&(this._container.style.opacity=`${y}`),this._content&&(this._content.style.pointerEvents=y?"auto":"none")}},Marker:ih,Style:Cs,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.pointGeometry,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:df,Evented:s.Evented,config:s.config,prewarm:function(){gn().acquire(Jt)},clearPrewarmedResources:function(){const y=Xt;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Jt),Xt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(y){s.config.ACCESS_TOKEN=y},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(y){s.config.API_URL=y},get workerCount(){return Yt.workerCount},set workerCount(y){Yt.workerCount=y},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){s.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){s.clearTileCache(y)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return cd});var l=r;return l})})(HJ);const bO=NC;function jJ(){let n=$t.useRef(null),[e,t]=$t.useState(37.01223403257954),[i,r]=$t.useState(-1.0953775626377544);return $t.useEffect(()=>{bO.accessToken="pk.eyJ1IjoidGhlcGFyYWRveDIwIiwiYSI6ImNsZHdlMnpyMTA2bGUzbnBob2Jld2l3NmUifQ.zrAEdfZdTfrWr9yvSuu9Xg";let o=new bO.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v11",center:[e,i],zoom:17});return()=>o.remove()},[]),yr("div",{ref:n,style:{width:"100%",height:"90%"}})}const qJ="/assets/nakuja_logo-3b1c7d44.png";function ZJ({url:n}){console.log("video",n);const e=$t.useRef(null);let[t,i]=$t.useState(!0);return $t.useEffect(()=>{v6.to(e.current,{rotation:"+=360",scale:.5,repeat:-1,yoyo:!0,duration:.7,ease:"power2.inOut"})},[]),Ea(EH,{children:[Ea("div",{className:"choice",children:[yr("button",{id:t?"active":"",onClick:r=>{i(!0)},children:"Live Stream"}),yr("button",{id:t?"":"active",onClick:r=>{i(!1)},children:"Map"})]}),t?yr("div",{className:"w-full h-[297px] md:h-[603px] lg:h-[354px] bg-black flex justify-center items-center",children:yr("div",{ref:e,children:yr("img",{alt:"logo",src:qJ,width:"90",height:"80"})})}):yr(jJ,{})]})}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const QM="150",Um={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Vm={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},b6=0,UC=1,S6=2,XJ=3,M6=0,eT=1,av=2,Ym=3,Ih=0,il=1,bh=2,$J=2,Gd=0,cg=1,VC=2,GC=3,WC=4,T6=5,Wm=100,E6=101,A6=102,HC=103,jC=104,C6=200,I6=201,P6=202,L6=203,mL=204,gL=205,k6=206,D6=207,R6=208,z6=209,O6=210,F6=0,B6=1,N6=2,gM=3,U6=4,V6=5,G6=6,W6=7,x1=0,H6=1,j6=2,Pu=0,q6=1,Z6=2,X6=3,_L=4,$6=5,tT=300,Pp=301,Lp=302,Uv=303,Vv=304,t0=306,kp=1e3,No=1001,Oy=1002,Ss=1003,Gv=1004,YJ=1004,my=1005,KJ=1005,cs=1006,nT=1007,JJ=1007,Ph=1008,QJ=1008,Kd=1009,Y6=1010,K6=1011,yL=1012,J6=1013,cp=1014,Bd=1015,Fy=1016,Q6=1017,eV=1018,ug=1020,tV=1021,$a=1023,nV=1024,iV=1025,Sp=1026,Sg=1027,rV=1028,sV=1029,oV=1030,aV=1031,lV=1033,gS=33776,_S=33777,yS=33778,xS=33779,qC=35840,ZC=35841,XC=35842,$C=35843,cV=36196,YC=37492,KC=37496,JC=37808,QC=37809,eI=37810,tI=37811,nI=37812,iI=37813,rI=37814,sI=37815,oI=37816,aI=37817,lI=37818,cI=37819,uI=37820,hI=37821,vS=36492,uV=36283,dI=36284,fI=36285,pI=36286,hV=2200,dV=2201,fV=2202,By=2300,Mg=2301,wS=2302,Km=2400,Jm=2401,Wv=2402,iT=2500,xL=2501,pV=0,vL=1,_M=2,Jd=3e3,ar=3001,mV=3200,gV=3201,Up=0,_V=1,eQ="",wu="srgb",Ny="srgb-linear",wL="display-p3",tQ=0,bS=7680,nQ=7681,iQ=7682,rQ=7683,sQ=34055,oQ=34056,aQ=5386,lQ=512,cQ=513,uQ=514,hQ=515,dQ=516,fQ=517,pQ=518,yV=519,Hv=35044,mQ=35048,gQ=35040,_Q=35045,yQ=35049,xQ=35041,vQ=35046,wQ=35050,bQ=35042,SQ="100",mI="300 es",yM=1035;class kh{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const o=r.indexOf(t);o!==-1&&r.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let o=0,l=r.length;o<l;o++)r[o].call(this,e);e.target=null}}}const ra=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let SO=1234567;const hg=Math.PI/180,jv=180/Math.PI;function Fl(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(ra[n&255]+ra[n>>8&255]+ra[n>>16&255]+ra[n>>24&255]+"-"+ra[e&255]+ra[e>>8&255]+"-"+ra[e>>16&15|64]+ra[e>>24&255]+"-"+ra[t&63|128]+ra[t>>8&255]+"-"+ra[t>>16&255]+ra[t>>24&255]+ra[i&255]+ra[i>>8&255]+ra[i>>16&255]+ra[i>>24&255]).toLowerCase()}function Fs(n,e,t){return Math.max(e,Math.min(t,n))}function bL(n,e){return(n%e+e)%e}function MQ(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function TQ(n,e,t){return n!==e?(t-n)/(e-n):0}function lv(n,e,t){return(1-t)*n+t*e}function EQ(n,e,t,i){return lv(n,e,1-Math.exp(-t*i))}function AQ(n,e=1){return e-Math.abs(bL(n,e*2)-e)}function CQ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function IQ(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function PQ(n,e){return n+Math.floor(Math.random()*(e-n+1))}function LQ(n,e){return n+Math.random()*(e-n)}function kQ(n){return n*(.5-Math.random())}function DQ(n){n!==void 0&&(SO=n);let e=SO+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function RQ(n){return n*hg}function zQ(n){return n*jv}function gI(n){return(n&n-1)===0&&n!==0}function xV(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function vV(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function OQ(n,e,t,i,r){const o=Math.cos,l=Math.sin,s=o(t/2),d=l(t/2),p=o((e+i)/2),_=l((e+i)/2),w=o((e-i)/2),M=l((e-i)/2),A=o((i-e)/2),P=l((i-e)/2);switch(r){case"XYX":n.set(s*_,d*w,d*M,s*p);break;case"YZY":n.set(d*M,s*_,d*w,s*p);break;case"ZXZ":n.set(d*w,d*M,s*_,s*p);break;case"XZX":n.set(s*_,d*P,d*A,s*p);break;case"YXY":n.set(d*A,s*_,d*P,s*p);break;case"ZYZ":n.set(d*P,d*A,s*_,s*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Nd(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Dr(n,e){switch(e.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const wV={DEG2RAD:hg,RAD2DEG:jv,generateUUID:Fl,clamp:Fs,euclideanModulo:bL,mapLinear:MQ,inverseLerp:TQ,lerp:lv,damp:EQ,pingpong:AQ,smoothstep:CQ,smootherstep:IQ,randInt:PQ,randFloat:LQ,randFloatSpread:kQ,seededRandom:DQ,degToRad:RQ,radToDeg:zQ,isPowerOfTwo:gI,ceilPowerOfTwo:xV,floorPowerOfTwo:vV,setQuaternionFromProperEuler:OQ,normalize:Dr,denormalize:Nd};class Gt{constructor(e=0,t=0){Gt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,l=this.y-e.y;return this.x=o*i-l*r+e.x,this.y=o*r+l*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Uo{constructor(){Uo.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,r,o,l,s,d,p){const _=this.elements;return _[0]=e,_[1]=r,_[2]=s,_[3]=t,_[4]=o,_[5]=d,_[6]=i,_[7]=l,_[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,l=i[0],s=i[3],d=i[6],p=i[1],_=i[4],w=i[7],M=i[2],A=i[5],P=i[8],L=r[0],D=r[3],z=r[6],F=r[1],N=r[4],V=r[7],j=r[2],Q=r[5],re=r[8];return o[0]=l*L+s*F+d*j,o[3]=l*D+s*N+d*Q,o[6]=l*z+s*V+d*re,o[1]=p*L+_*F+w*j,o[4]=p*D+_*N+w*Q,o[7]=p*z+_*V+w*re,o[2]=M*L+A*F+P*j,o[5]=M*D+A*N+P*Q,o[8]=M*z+A*V+P*re,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],s=e[5],d=e[6],p=e[7],_=e[8];return t*l*_-t*s*p-i*o*_+i*s*d+r*o*p-r*l*d}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],s=e[5],d=e[6],p=e[7],_=e[8],w=_*l-s*p,M=s*d-_*o,A=p*o-l*d,P=t*w+i*M+r*A;if(P===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/P;return e[0]=w*L,e[1]=(r*p-_*i)*L,e[2]=(s*i-r*l)*L,e[3]=M*L,e[4]=(_*t-r*d)*L,e[5]=(r*o-s*t)*L,e[6]=A*L,e[7]=(i*d-p*t)*L,e[8]=(l*t-i*o)*L,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,l,s){const d=Math.cos(o),p=Math.sin(o);return this.set(i*d,i*p,-i*(d*l+p*s)+l+e,-r*p,r*d,-r*(-p*l+d*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(y2.makeScale(e,t)),this}rotate(e){return this.premultiply(y2.makeRotation(-e)),this}translate(e,t){return this.premultiply(y2.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const y2=new Uo;function bV(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const FQ={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function ey(n,e){return new FQ[n](e)}function qv(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}class Ao{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,o,l,s){let d=i[r+0],p=i[r+1],_=i[r+2],w=i[r+3];const M=o[l+0],A=o[l+1],P=o[l+2],L=o[l+3];if(s===0){e[t+0]=d,e[t+1]=p,e[t+2]=_,e[t+3]=w;return}if(s===1){e[t+0]=M,e[t+1]=A,e[t+2]=P,e[t+3]=L;return}if(w!==L||d!==M||p!==A||_!==P){let D=1-s;const z=d*M+p*A+_*P+w*L,F=z>=0?1:-1,N=1-z*z;if(N>Number.EPSILON){const j=Math.sqrt(N),Q=Math.atan2(j,z*F);D=Math.sin(D*Q)/j,s=Math.sin(s*Q)/j}const V=s*F;if(d=d*D+M*V,p=p*D+A*V,_=_*D+P*V,w=w*D+L*V,D===1-s){const j=1/Math.sqrt(d*d+p*p+_*_+w*w);d*=j,p*=j,_*=j,w*=j}}e[t]=d,e[t+1]=p,e[t+2]=_,e[t+3]=w}static multiplyQuaternionsFlat(e,t,i,r,o,l){const s=i[r],d=i[r+1],p=i[r+2],_=i[r+3],w=o[l],M=o[l+1],A=o[l+2],P=o[l+3];return e[t]=s*P+_*w+d*A-p*M,e[t+1]=d*P+_*M+p*w-s*A,e[t+2]=p*P+_*A+s*M-d*w,e[t+3]=_*P-s*w-d*M-p*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,r=e._y,o=e._z,l=e._order,s=Math.cos,d=Math.sin,p=s(i/2),_=s(r/2),w=s(o/2),M=d(i/2),A=d(r/2),P=d(o/2);switch(l){case"XYZ":this._x=M*_*w+p*A*P,this._y=p*A*w-M*_*P,this._z=p*_*P+M*A*w,this._w=p*_*w-M*A*P;break;case"YXZ":this._x=M*_*w+p*A*P,this._y=p*A*w-M*_*P,this._z=p*_*P-M*A*w,this._w=p*_*w+M*A*P;break;case"ZXY":this._x=M*_*w-p*A*P,this._y=p*A*w+M*_*P,this._z=p*_*P+M*A*w,this._w=p*_*w-M*A*P;break;case"ZYX":this._x=M*_*w-p*A*P,this._y=p*A*w+M*_*P,this._z=p*_*P-M*A*w,this._w=p*_*w+M*A*P;break;case"YZX":this._x=M*_*w+p*A*P,this._y=p*A*w+M*_*P,this._z=p*_*P-M*A*w,this._w=p*_*w-M*A*P;break;case"XZY":this._x=M*_*w-p*A*P,this._y=p*A*w-M*_*P,this._z=p*_*P+M*A*w,this._w=p*_*w+M*A*P;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],l=t[1],s=t[5],d=t[9],p=t[2],_=t[6],w=t[10],M=i+s+w;if(M>0){const A=.5/Math.sqrt(M+1);this._w=.25/A,this._x=(_-d)*A,this._y=(o-p)*A,this._z=(l-r)*A}else if(i>s&&i>w){const A=2*Math.sqrt(1+i-s-w);this._w=(_-d)/A,this._x=.25*A,this._y=(r+l)/A,this._z=(o+p)/A}else if(s>w){const A=2*Math.sqrt(1+s-i-w);this._w=(o-p)/A,this._x=(r+l)/A,this._y=.25*A,this._z=(d+_)/A}else{const A=2*Math.sqrt(1+w-i-s);this._w=(l-r)/A,this._x=(o+p)/A,this._y=(d+_)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Fs(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,l=e._w,s=t._x,d=t._y,p=t._z,_=t._w;return this._x=i*_+l*s+r*p-o*d,this._y=r*_+l*d+o*s-i*p,this._z=o*_+l*p+i*d-r*s,this._w=l*_-i*s-r*d-o*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,o=this._z,l=this._w;let s=l*e._w+i*e._x+r*e._y+o*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=l,this._x=i,this._y=r,this._z=o,this;const d=1-s*s;if(d<=Number.EPSILON){const A=1-t;return this._w=A*l+t*this._w,this._x=A*i+t*this._x,this._y=A*r+t*this._y,this._z=A*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const p=Math.sqrt(d),_=Math.atan2(p,s),w=Math.sin((1-t)*_)/p,M=Math.sin(t*_)/p;return this._w=l*w+this._w*M,this._x=i*w+this._x*M,this._y=r*w+this._y*M,this._z=o*w+this._z*M,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(o),i*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Fe{constructor(e=0,t=0,i=0){Fe.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(MO.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(MO.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,l=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*l,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*l,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*l,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,l=e.y,s=e.z,d=e.w,p=d*t+l*r-s*i,_=d*i+s*t-o*r,w=d*r+o*i-l*t,M=-o*t-l*i-s*r;return this.x=p*d+M*-o+_*-s-w*-l,this.y=_*d+M*-l+w*-o-p*-s,this.z=w*d+M*-s+p*-l-_*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,l=t.x,s=t.y,d=t.z;return this.x=r*d-o*s,this.y=o*l-i*d,this.z=i*s-r*l,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return x2.copy(this).projectOnVector(e),this.sub(x2)}reflect(e){return this.sub(x2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Fs(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const x2=new Fe,MO=new Ao;function gy(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function v2(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}const BQ=new Uo().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),NQ=new Uo().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),up=new Fe;function UQ(n){return n.convertSRGBToLinear(),up.set(n.r,n.g,n.b).applyMatrix3(NQ),n.setRGB(up.x,up.y,up.z)}function VQ(n){return up.set(n.r,n.g,n.b).applyMatrix3(BQ),n.setRGB(up.x,up.y,up.z).convertLinearToSRGB()}const GQ={[Ny]:n=>n,[wu]:n=>n.convertSRGBToLinear(),[wL]:UQ},WQ={[Ny]:n=>n,[wu]:n=>n.convertLinearToSRGB(),[wL]:VQ},oa={enabled:!1,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return Ny},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=GQ[e],r=WQ[t];if(i===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${t}".`);return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}};let v_;class SL{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{v_===void 0&&(v_=qv("canvas")),v_.width=e.width,v_.height=e.height;const i=v_.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=v_}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=qv("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let l=0;l<o.length;l++)o[l]=gy(o[l]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(gy(t[i]/255)*255):t[i]=gy(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Qm{constructor(e=null){this.isSource=!0,this.uuid=Fl(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let l=0,s=r.length;l<s;l++)r[l].isDataTexture?o.push(w2(r[l].image)):o.push(w2(r[l]))}else o=w2(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function w2(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?SL.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let HQ=0;class Jr extends kh{constructor(e=Jr.DEFAULT_IMAGE,t=Jr.DEFAULT_MAPPING,i=No,r=No,o=cs,l=Ph,s=$a,d=Kd,p=Jr.DEFAULT_ANISOTROPY,_=Jd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:HQ++}),this.uuid=Fl(),this.name="",this.source=new Qm(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=o,this.minFilter=l,this.anisotropy=p,this.format=s,this.internalFormat=null,this.type=d,this.offset=new Gt(0,0),this.repeat=new Gt(1,1),this.center=new Gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Uo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=_,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==tT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case kp:e.x=e.x-Math.floor(e.x);break;case No:e.x=e.x<0?0:1;break;case Oy:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case kp:e.y=e.y-Math.floor(e.y);break;case No:e.y=e.y<0?0:1;break;case Oy:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Jr.DEFAULT_IMAGE=null;Jr.DEFAULT_MAPPING=tT;Jr.DEFAULT_ANISOTROPY=1;class Tr{constructor(e=0,t=0,i=0,r=1){Tr.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,l=e.elements;return this.x=l[0]*t+l[4]*i+l[8]*r+l[12]*o,this.y=l[1]*t+l[5]*i+l[9]*r+l[13]*o,this.z=l[2]*t+l[6]*i+l[10]*r+l[14]*o,this.w=l[3]*t+l[7]*i+l[11]*r+l[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const d=e.elements,p=d[0],_=d[4],w=d[8],M=d[1],A=d[5],P=d[9],L=d[2],D=d[6],z=d[10];if(Math.abs(_-M)<.01&&Math.abs(w-L)<.01&&Math.abs(P-D)<.01){if(Math.abs(_+M)<.1&&Math.abs(w+L)<.1&&Math.abs(P+D)<.1&&Math.abs(p+A+z-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const N=(p+1)/2,V=(A+1)/2,j=(z+1)/2,Q=(_+M)/4,re=(w+L)/4,Z=(P+D)/4;return N>V&&N>j?N<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(N),r=Q/i,o=re/i):V>j?V<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(V),i=Q/r,o=Z/r):j<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(j),i=re/o,r=Z/o),this.set(i,r,o,t),this}let F=Math.sqrt((D-P)*(D-P)+(w-L)*(w-L)+(M-_)*(M-_));return Math.abs(F)<.001&&(F=1),this.x=(D-P)/F,this.y=(w-L)/F,this.z=(M-_)/F,this.w=Math.acos((p+A+z-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Du extends kh{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Tr(0,0,e,t),this.scissorTest=!1,this.viewport=new Tr(0,0,e,t);const r={width:e,height:t,depth:1};this.texture=new Jr(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:cs,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Qm(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class rT extends Jr{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=No,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class jQ extends Du{constructor(e=1,t=1,i=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new rT(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class ML extends Jr{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=No,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class qQ extends Du{constructor(e=1,t=1,i=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new ML(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class ZQ extends Du{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const o=this.texture;this.texture=[];for(let l=0;l<i;l++)this.texture[l]=o.clone(),this.texture[l].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,o=this.texture.length;r<o;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class Vp{constructor(e=new Fe(1/0,1/0,1/0),t=new Fe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,o=-1/0,l=-1/0,s=-1/0;for(let d=0,p=e.length;d<p;d+=3){const _=e[d],w=e[d+1],M=e[d+2];_<t&&(t=_),w<i&&(i=w),M<r&&(r=M),_>o&&(o=_),w>l&&(l=w),M>s&&(s=M)}return this.min.set(t,i,r),this.max.set(o,l,s),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,o=-1/0,l=-1/0,s=-1/0;for(let d=0,p=e.count;d<p;d++){const _=e.getX(d),w=e.getY(d),M=e.getZ(d);_<t&&(t=_),w<i&&(i=w),M<r&&(r=M),_>o&&(o=_),w>l&&(l=w),M>s&&(s=M)}return this.min.set(t,i,r),this.max.set(o,l,s),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Am.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const o=i.attributes.position;for(let l=0,s=o.count;l<s;l++)Am.fromBufferAttribute(o,l).applyMatrix4(e.matrixWorld),this.expandByPoint(Am)}else i.boundingBox===null&&i.computeBoundingBox(),b2.copy(i.boundingBox),b2.applyMatrix4(e.matrixWorld),this.union(b2);const r=e.children;for(let o=0,l=r.length;o<l;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Am),Am.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(px),ub.subVectors(this.max,px),w_.subVectors(e.a,px),b_.subVectors(e.b,px),S_.subVectors(e.c,px),Nf.subVectors(b_,w_),Uf.subVectors(S_,b_),Cm.subVectors(w_,S_);let t=[0,-Nf.z,Nf.y,0,-Uf.z,Uf.y,0,-Cm.z,Cm.y,Nf.z,0,-Nf.x,Uf.z,0,-Uf.x,Cm.z,0,-Cm.x,-Nf.y,Nf.x,0,-Uf.y,Uf.x,0,-Cm.y,Cm.x,0];return!S2(t,w_,b_,S_,ub)||(t=[1,0,0,0,1,0,0,0,1],!S2(t,w_,b_,S_,ub))?!1:(hb.crossVectors(Nf,Uf),t=[hb.x,hb.y,hb.z],S2(t,w_,b_,S_,ub))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Am).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Am).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(yd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yd[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yd),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const yd=[new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe,new Fe],Am=new Fe,b2=new Vp,w_=new Fe,b_=new Fe,S_=new Fe,Nf=new Fe,Uf=new Fe,Cm=new Fe,px=new Fe,ub=new Fe,hb=new Fe,Im=new Fe;function S2(n,e,t,i,r){for(let o=0,l=n.length-3;o<=l;o+=3){Im.fromArray(n,o);const s=r.x*Math.abs(Im.x)+r.y*Math.abs(Im.y)+r.z*Math.abs(Im.z),d=e.dot(Im),p=t.dot(Im),_=i.dot(Im);if(Math.max(-Math.max(d,p,_),Math.min(d,p,_))>s)return!1}return!0}const XQ=new Vp,mx=new Fe,M2=new Fe;class Gp{constructor(e=new Fe,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):XQ.setFromPoints(e).getCenter(i);let r=0;for(let o=0,l=e.length;o<l;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;mx.subVectors(e,this.center);const t=mx.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(mx,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(M2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(mx.copy(e.center).add(M2)),this.expandByPoint(mx.copy(e.center).sub(M2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const xd=new Fe,T2=new Fe,db=new Fe,Vf=new Fe,E2=new Fe,fb=new Fe,A2=new Fe;class v1{constructor(e=new Fe,t=new Fe(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,xd)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=xd.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(xd.copy(this.origin).addScaledVector(this.direction,t),xd.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){T2.copy(e).add(t).multiplyScalar(.5),db.copy(t).sub(e).normalize(),Vf.copy(this.origin).sub(T2);const o=e.distanceTo(t)*.5,l=-this.direction.dot(db),s=Vf.dot(this.direction),d=-Vf.dot(db),p=Vf.lengthSq(),_=Math.abs(1-l*l);let w,M,A,P;if(_>0)if(w=l*d-s,M=l*s-d,P=o*_,w>=0)if(M>=-P)if(M<=P){const L=1/_;w*=L,M*=L,A=w*(w+l*M+2*s)+M*(l*w+M+2*d)+p}else M=o,w=Math.max(0,-(l*M+s)),A=-w*w+M*(M+2*d)+p;else M=-o,w=Math.max(0,-(l*M+s)),A=-w*w+M*(M+2*d)+p;else M<=-P?(w=Math.max(0,-(-l*o+s)),M=w>0?-o:Math.min(Math.max(-o,-d),o),A=-w*w+M*(M+2*d)+p):M<=P?(w=0,M=Math.min(Math.max(-o,-d),o),A=M*(M+2*d)+p):(w=Math.max(0,-(l*o+s)),M=w>0?o:Math.min(Math.max(-o,-d),o),A=-w*w+M*(M+2*d)+p);else M=l>0?-o:o,w=Math.max(0,-(l*M+s)),A=-w*w+M*(M+2*d)+p;return i&&i.copy(this.origin).addScaledVector(this.direction,w),r&&r.copy(T2).addScaledVector(db,M),A}intersectSphere(e,t){xd.subVectors(e.center,this.origin);const i=xd.dot(this.direction),r=xd.dot(xd)-i*i,o=e.radius*e.radius;if(r>o)return null;const l=Math.sqrt(o-r),s=i-l,d=i+l;return d<0?null:s<0?this.at(d,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,l,s,d;const p=1/this.direction.x,_=1/this.direction.y,w=1/this.direction.z,M=this.origin;return p>=0?(i=(e.min.x-M.x)*p,r=(e.max.x-M.x)*p):(i=(e.max.x-M.x)*p,r=(e.min.x-M.x)*p),_>=0?(o=(e.min.y-M.y)*_,l=(e.max.y-M.y)*_):(o=(e.max.y-M.y)*_,l=(e.min.y-M.y)*_),i>l||o>r||((o>i||isNaN(i))&&(i=o),(l<r||isNaN(r))&&(r=l),w>=0?(s=(e.min.z-M.z)*w,d=(e.max.z-M.z)*w):(s=(e.max.z-M.z)*w,d=(e.min.z-M.z)*w),i>d||s>r)||((s>i||i!==i)&&(i=s),(d<r||r!==r)&&(r=d),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,xd)!==null}intersectTriangle(e,t,i,r,o){E2.subVectors(t,e),fb.subVectors(i,e),A2.crossVectors(E2,fb);let l=this.direction.dot(A2),s;if(l>0){if(r)return null;s=1}else if(l<0)s=-1,l=-l;else return null;Vf.subVectors(this.origin,e);const d=s*this.direction.dot(fb.crossVectors(Vf,fb));if(d<0)return null;const p=s*this.direction.dot(E2.cross(Vf));if(p<0||d+p>l)return null;const _=-s*Vf.dot(A2);return _<0?null:this.at(_/l,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class hi{constructor(){hi.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,r,o,l,s,d,p,_,w,M,A,P,L,D){const z=this.elements;return z[0]=e,z[4]=t,z[8]=i,z[12]=r,z[1]=o,z[5]=l,z[9]=s,z[13]=d,z[2]=p,z[6]=_,z[10]=w,z[14]=M,z[3]=A,z[7]=P,z[11]=L,z[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new hi().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/M_.setFromMatrixColumn(e,0).length(),o=1/M_.setFromMatrixColumn(e,1).length(),l=1/M_.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*l,t[9]=i[9]*l,t[10]=i[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,o=e.z,l=Math.cos(i),s=Math.sin(i),d=Math.cos(r),p=Math.sin(r),_=Math.cos(o),w=Math.sin(o);if(e.order==="XYZ"){const M=l*_,A=l*w,P=s*_,L=s*w;t[0]=d*_,t[4]=-d*w,t[8]=p,t[1]=A+P*p,t[5]=M-L*p,t[9]=-s*d,t[2]=L-M*p,t[6]=P+A*p,t[10]=l*d}else if(e.order==="YXZ"){const M=d*_,A=d*w,P=p*_,L=p*w;t[0]=M+L*s,t[4]=P*s-A,t[8]=l*p,t[1]=l*w,t[5]=l*_,t[9]=-s,t[2]=A*s-P,t[6]=L+M*s,t[10]=l*d}else if(e.order==="ZXY"){const M=d*_,A=d*w,P=p*_,L=p*w;t[0]=M-L*s,t[4]=-l*w,t[8]=P+A*s,t[1]=A+P*s,t[5]=l*_,t[9]=L-M*s,t[2]=-l*p,t[6]=s,t[10]=l*d}else if(e.order==="ZYX"){const M=l*_,A=l*w,P=s*_,L=s*w;t[0]=d*_,t[4]=P*p-A,t[8]=M*p+L,t[1]=d*w,t[5]=L*p+M,t[9]=A*p-P,t[2]=-p,t[6]=s*d,t[10]=l*d}else if(e.order==="YZX"){const M=l*d,A=l*p,P=s*d,L=s*p;t[0]=d*_,t[4]=L-M*w,t[8]=P*w+A,t[1]=w,t[5]=l*_,t[9]=-s*_,t[2]=-p*_,t[6]=A*w+P,t[10]=M-L*w}else if(e.order==="XZY"){const M=l*d,A=l*p,P=s*d,L=s*p;t[0]=d*_,t[4]=-w,t[8]=p*_,t[1]=M*w+L,t[5]=l*_,t[9]=A*w-P,t[2]=P*w-A,t[6]=s*_,t[10]=L*w+M}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose($Q,e,YQ)}lookAt(e,t,i){const r=this.elements;return Al.subVectors(e,t),Al.lengthSq()===0&&(Al.z=1),Al.normalize(),Gf.crossVectors(i,Al),Gf.lengthSq()===0&&(Math.abs(i.z)===1?Al.x+=1e-4:Al.z+=1e-4,Al.normalize(),Gf.crossVectors(i,Al)),Gf.normalize(),pb.crossVectors(Al,Gf),r[0]=Gf.x,r[4]=pb.x,r[8]=Al.x,r[1]=Gf.y,r[5]=pb.y,r[9]=Al.y,r[2]=Gf.z,r[6]=pb.z,r[10]=Al.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,l=i[0],s=i[4],d=i[8],p=i[12],_=i[1],w=i[5],M=i[9],A=i[13],P=i[2],L=i[6],D=i[10],z=i[14],F=i[3],N=i[7],V=i[11],j=i[15],Q=r[0],re=r[4],Z=r[8],ne=r[12],he=r[1],De=r[5],He=r[9],ae=r[13],le=r[2],fe=r[6],Oe=r[10],We=r[14],ce=r[3],Te=r[7],Pe=r[11],Qe=r[15];return o[0]=l*Q+s*he+d*le+p*ce,o[4]=l*re+s*De+d*fe+p*Te,o[8]=l*Z+s*He+d*Oe+p*Pe,o[12]=l*ne+s*ae+d*We+p*Qe,o[1]=_*Q+w*he+M*le+A*ce,o[5]=_*re+w*De+M*fe+A*Te,o[9]=_*Z+w*He+M*Oe+A*Pe,o[13]=_*ne+w*ae+M*We+A*Qe,o[2]=P*Q+L*he+D*le+z*ce,o[6]=P*re+L*De+D*fe+z*Te,o[10]=P*Z+L*He+D*Oe+z*Pe,o[14]=P*ne+L*ae+D*We+z*Qe,o[3]=F*Q+N*he+V*le+j*ce,o[7]=F*re+N*De+V*fe+j*Te,o[11]=F*Z+N*He+V*Oe+j*Pe,o[15]=F*ne+N*ae+V*We+j*Qe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],l=e[1],s=e[5],d=e[9],p=e[13],_=e[2],w=e[6],M=e[10],A=e[14],P=e[3],L=e[7],D=e[11],z=e[15];return P*(+o*d*w-r*p*w-o*s*M+i*p*M+r*s*A-i*d*A)+L*(+t*d*A-t*p*M+o*l*M-r*l*A+r*p*_-o*d*_)+D*(+t*p*w-t*s*A-o*l*w+i*l*A+o*s*_-i*p*_)+z*(-r*s*_-t*d*w+t*s*M+r*l*w-i*l*M+i*d*_)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],s=e[5],d=e[6],p=e[7],_=e[8],w=e[9],M=e[10],A=e[11],P=e[12],L=e[13],D=e[14],z=e[15],F=w*D*p-L*M*p+L*d*A-s*D*A-w*d*z+s*M*z,N=P*M*p-_*D*p-P*d*A+l*D*A+_*d*z-l*M*z,V=_*L*p-P*w*p+P*s*A-l*L*A-_*s*z+l*w*z,j=P*w*d-_*L*d-P*s*M+l*L*M+_*s*D-l*w*D,Q=t*F+i*N+r*V+o*j;if(Q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const re=1/Q;return e[0]=F*re,e[1]=(L*M*o-w*D*o-L*r*A+i*D*A+w*r*z-i*M*z)*re,e[2]=(s*D*o-L*d*o+L*r*p-i*D*p-s*r*z+i*d*z)*re,e[3]=(w*d*o-s*M*o-w*r*p+i*M*p+s*r*A-i*d*A)*re,e[4]=N*re,e[5]=(_*D*o-P*M*o+P*r*A-t*D*A-_*r*z+t*M*z)*re,e[6]=(P*d*o-l*D*o-P*r*p+t*D*p+l*r*z-t*d*z)*re,e[7]=(l*M*o-_*d*o+_*r*p-t*M*p-l*r*A+t*d*A)*re,e[8]=V*re,e[9]=(P*w*o-_*L*o-P*i*A+t*L*A+_*i*z-t*w*z)*re,e[10]=(l*L*o-P*s*o+P*i*p-t*L*p-l*i*z+t*s*z)*re,e[11]=(_*s*o-l*w*o-_*i*p+t*w*p+l*i*A-t*s*A)*re,e[12]=j*re,e[13]=(_*L*r-P*w*r+P*i*M-t*L*M-_*i*D+t*w*D)*re,e[14]=(P*s*r-l*L*r-P*i*d+t*L*d+l*i*D-t*s*D)*re,e[15]=(l*w*r-_*s*r+_*i*d-t*w*d-l*i*M+t*s*M)*re,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,l=e.x,s=e.y,d=e.z,p=o*l,_=o*s;return this.set(p*l+i,p*s-r*d,p*d+r*s,0,p*s+r*d,_*s+i,_*d-r*l,0,p*d-r*s,_*d+r*l,o*d*d+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,l){return this.set(1,i,o,0,e,1,l,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,l=t._y,s=t._z,d=t._w,p=o+o,_=l+l,w=s+s,M=o*p,A=o*_,P=o*w,L=l*_,D=l*w,z=s*w,F=d*p,N=d*_,V=d*w,j=i.x,Q=i.y,re=i.z;return r[0]=(1-(L+z))*j,r[1]=(A+V)*j,r[2]=(P-N)*j,r[3]=0,r[4]=(A-V)*Q,r[5]=(1-(M+z))*Q,r[6]=(D+F)*Q,r[7]=0,r[8]=(P+N)*re,r[9]=(D-F)*re,r[10]=(1-(M+L))*re,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=M_.set(r[0],r[1],r[2]).length();const l=M_.set(r[4],r[5],r[6]).length(),s=M_.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],mu.copy(this);const p=1/o,_=1/l,w=1/s;return mu.elements[0]*=p,mu.elements[1]*=p,mu.elements[2]*=p,mu.elements[4]*=_,mu.elements[5]*=_,mu.elements[6]*=_,mu.elements[8]*=w,mu.elements[9]*=w,mu.elements[10]*=w,t.setFromRotationMatrix(mu),i.x=o,i.y=l,i.z=s,this}makePerspective(e,t,i,r,o,l){const s=this.elements,d=2*o/(t-e),p=2*o/(i-r),_=(t+e)/(t-e),w=(i+r)/(i-r),M=-(l+o)/(l-o),A=-2*l*o/(l-o);return s[0]=d,s[4]=0,s[8]=_,s[12]=0,s[1]=0,s[5]=p,s[9]=w,s[13]=0,s[2]=0,s[6]=0,s[10]=M,s[14]=A,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this}makeOrthographic(e,t,i,r,o,l){const s=this.elements,d=1/(t-e),p=1/(i-r),_=1/(l-o),w=(t+e)*d,M=(i+r)*p,A=(l+o)*_;return s[0]=2*d,s[4]=0,s[8]=0,s[12]=-w,s[1]=0,s[5]=2*p,s[9]=0,s[13]=-M,s[2]=0,s[6]=0,s[10]=-2*_,s[14]=-A,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const M_=new Fe,mu=new hi,$Q=new Fe(0,0,0),YQ=new Fe(1,1,1),Gf=new Fe,pb=new Fe,Al=new Fe,TO=new hi,EO=new Ao;class w1{constructor(e=0,t=0,i=0,r=w1.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,o=r[0],l=r[4],s=r[8],d=r[1],p=r[5],_=r[9],w=r[2],M=r[6],A=r[10];switch(t){case"XYZ":this._y=Math.asin(Fs(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-_,A),this._z=Math.atan2(-l,o)):(this._x=Math.atan2(M,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Fs(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(s,A),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-w,o),this._z=0);break;case"ZXY":this._x=Math.asin(Fs(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-w,A),this._z=Math.atan2(-l,p)):(this._y=0,this._z=Math.atan2(d,o));break;case"ZYX":this._y=Math.asin(-Fs(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(M,A),this._z=Math.atan2(d,o)):(this._x=0,this._z=Math.atan2(-l,p));break;case"YZX":this._z=Math.asin(Fs(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-_,p),this._y=Math.atan2(-w,o)):(this._x=0,this._y=Math.atan2(s,A));break;case"XZY":this._z=Math.asin(-Fs(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(M,p),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-_,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return TO.makeRotationFromQuaternion(e),this.setFromRotationMatrix(TO,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return EO.setFromEuler(this),this.setFromQuaternion(EO,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}w1.DEFAULT_ORDER="XYZ";class dg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let KQ=0;const AO=new Fe,T_=new Ao,vd=new hi,mb=new Fe,gx=new Fe,JQ=new Fe,QQ=new Ao,CO=new Fe(1,0,0),IO=new Fe(0,1,0),PO=new Fe(0,0,1),eee={type:"added"},LO={type:"removed"};class tr extends kh{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:KQ++}),this.uuid=Fl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=tr.DEFAULT_UP.clone();const e=new Fe,t=new w1,i=new Ao,r=new Fe(1,1,1);function o(){i.setFromEuler(t,!1)}function l(){t.setFromQuaternion(i,void 0,!1)}t._onChange(o),i._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new hi},normalMatrix:{value:new Uo}}),this.matrix=new hi,this.matrixWorld=new hi,this.matrixAutoUpdate=tr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=tr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new dg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return T_.setFromAxisAngle(e,t),this.quaternion.multiply(T_),this}rotateOnWorldAxis(e,t){return T_.setFromAxisAngle(e,t),this.quaternion.premultiply(T_),this}rotateX(e){return this.rotateOnAxis(CO,e)}rotateY(e){return this.rotateOnAxis(IO,e)}rotateZ(e){return this.rotateOnAxis(PO,e)}translateOnAxis(e,t){return AO.copy(e).applyQuaternion(this.quaternion),this.position.add(AO.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(CO,e)}translateY(e){return this.translateOnAxis(IO,e)}translateZ(e){return this.translateOnAxis(PO,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(vd.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?mb.copy(e):mb.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),gx.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?vd.lookAt(gx,mb,this.up):vd.lookAt(mb,gx,this.up),this.quaternion.setFromRotationMatrix(vd),r&&(vd.extractRotation(r.matrixWorld),T_.setFromRotationMatrix(vd),this.quaternion.premultiply(T_.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(eee)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(LO)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(LO)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),vd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),vd.multiply(e.parent.matrixWorld)),e.applyMatrix4(vd),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const l=this.children[i].getObjectByProperty(e,t);if(l!==void 0)return l}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,o=this.children.length;r<o;r++){const l=this.children[r].getObjectsByProperty(e,t);l.length>0&&(i=i.concat(l))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gx,e,JQ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gx,QQ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const o=t[i];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let o=0,l=r.length;o<l;o++){const s=r[o];s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function o(s,d){return s[d.uuid]===void 0&&(s[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=o(e.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const d=s.shapes;if(Array.isArray(d))for(let p=0,_=d.length;p<_;p++){const w=d[p];o(e.shapes,w)}else o(e.shapes,d)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let d=0,p=this.material.length;d<p;d++)s.push(o(e.materials,this.material[d]));r.material=s}else r.material=o(e.materials,this.material);if(this.children.length>0){r.children=[];for(let s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let s=0;s<this.animations.length;s++){const d=this.animations[s];r.animations.push(o(e.animations,d))}}if(t){const s=l(e.geometries),d=l(e.materials),p=l(e.textures),_=l(e.images),w=l(e.shapes),M=l(e.skeletons),A=l(e.animations),P=l(e.nodes);s.length>0&&(i.geometries=s),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),_.length>0&&(i.images=_),w.length>0&&(i.shapes=w),M.length>0&&(i.skeletons=M),A.length>0&&(i.animations=A),P.length>0&&(i.nodes=P)}return i.object=r,i;function l(s){const d=[];for(const p in s){const _=s[p];delete _.metadata,d.push(_)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}tr.DEFAULT_UP=new Fe(0,1,0);tr.DEFAULT_MATRIX_AUTO_UPDATE=!0;tr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const gu=new Fe,wd=new Fe,C2=new Fe,bd=new Fe,E_=new Fe,A_=new Fe,kO=new Fe,I2=new Fe,P2=new Fe,L2=new Fe;class wc{constructor(e=new Fe,t=new Fe,i=new Fe){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),gu.subVectors(e,t),r.cross(gu);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){gu.subVectors(r,t),wd.subVectors(i,t),C2.subVectors(e,t);const l=gu.dot(gu),s=gu.dot(wd),d=gu.dot(C2),p=wd.dot(wd),_=wd.dot(C2),w=l*p-s*s;if(w===0)return o.set(-2,-1,-1);const M=1/w,A=(p*d-s*_)*M,P=(l*_-s*d)*M;return o.set(1-A-P,P,A)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,bd),bd.x>=0&&bd.y>=0&&bd.x+bd.y<=1}static getUV(e,t,i,r,o,l,s,d){return this.getBarycoord(e,t,i,r,bd),d.set(0,0),d.addScaledVector(o,bd.x),d.addScaledVector(l,bd.y),d.addScaledVector(s,bd.z),d}static isFrontFacing(e,t,i,r){return gu.subVectors(i,t),wd.subVectors(e,t),gu.cross(wd).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return gu.subVectors(this.c,this.b),wd.subVectors(this.a,this.b),gu.cross(wd).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return wc.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return wc.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,o){return wc.getUV(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return wc.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return wc.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let l,s;E_.subVectors(r,i),A_.subVectors(o,i),I2.subVectors(e,i);const d=E_.dot(I2),p=A_.dot(I2);if(d<=0&&p<=0)return t.copy(i);P2.subVectors(e,r);const _=E_.dot(P2),w=A_.dot(P2);if(_>=0&&w<=_)return t.copy(r);const M=d*w-_*p;if(M<=0&&d>=0&&_<=0)return l=d/(d-_),t.copy(i).addScaledVector(E_,l);L2.subVectors(e,o);const A=E_.dot(L2),P=A_.dot(L2);if(P>=0&&A<=P)return t.copy(o);const L=A*p-d*P;if(L<=0&&p>=0&&P<=0)return s=p/(p-P),t.copy(i).addScaledVector(A_,s);const D=_*P-A*w;if(D<=0&&w-_>=0&&A-P>=0)return kO.subVectors(o,r),s=(w-_)/(w-_+(A-P)),t.copy(r).addScaledVector(kO,s);const z=1/(D+L+M);return l=L*z,s=M*z,t.copy(i).addScaledVector(E_,l).addScaledVector(A_,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let tee=0;class Zs extends kh{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:tee++}),this.uuid=Fl(),this.name="",this.type="Material",this.blending=cg,this.side=Ih,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=mL,this.blendDst=gL,this.blendEquation=Wm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=gM,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=yV,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bS,this.stencilZFail=bS,this.stencilZPass=bS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const r=this[t];if(r===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==cg&&(i.blending=this.blending),this.side!==Ih&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(o){const l=[];for(const s in o){const d=o[s];delete d.metadata,l.push(d)}return l}if(t){const o=r(e.textures),l=r(e.images);o.length>0&&(i.textures=o),l.length>0&&(i.images=l)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const SV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_u={h:0,s:0,l:0},gb={h:0,s:0,l:0};function k2(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class An{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=wu){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,oa.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=oa.workingColorSpace){return this.r=e,this.g=t,this.b=i,oa.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=oa.workingColorSpace){if(e=bL(e,1),t=Fs(t,0,1),i=Fs(i,0,1),t===0)this.r=this.g=this.b=i;else{const o=i<=.5?i*(1+t):i+t-i*t,l=2*i-o;this.r=k2(l,o,e+1/3),this.g=k2(l,o,e),this.b=k2(l,o,e-1/3)}return oa.toWorkingColorSpace(this,r),this}setStyle(e,t=wu){function i(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const l=r[1],s=r[2];switch(l){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(o[1],10))/255,this.g=Math.min(255,parseInt(o[2],10))/255,this.b=Math.min(255,parseInt(o[3],10))/255,oa.toWorkingColorSpace(this,t),i(o[4]),this;if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(o[1],10))/100,this.g=Math.min(100,parseInt(o[2],10))/100,this.b=Math.min(100,parseInt(o[3],10))/100,oa.toWorkingColorSpace(this,t),i(o[4]),this;break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const d=parseFloat(o[1])/360,p=parseFloat(o[2])/100,_=parseFloat(o[3])/100;return i(o[4]),this.setHSL(d,p,_,t)}break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=r[1],l=o.length;if(l===3)return this.r=parseInt(o.charAt(0)+o.charAt(0),16)/255,this.g=parseInt(o.charAt(1)+o.charAt(1),16)/255,this.b=parseInt(o.charAt(2)+o.charAt(2),16)/255,oa.toWorkingColorSpace(this,t),this;if(l===6)return this.r=parseInt(o.charAt(0)+o.charAt(1),16)/255,this.g=parseInt(o.charAt(2)+o.charAt(3),16)/255,this.b=parseInt(o.charAt(4)+o.charAt(5),16)/255,oa.toWorkingColorSpace(this,t),this;console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=wu){const i=SV[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=gy(e.r),this.g=gy(e.g),this.b=gy(e.b),this}copyLinearToSRGB(e){return this.r=v2(e.r),this.g=v2(e.g),this.b=v2(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=wu){return oa.fromWorkingColorSpace(sa.copy(this),e),Fs(sa.r*255,0,255)<<16^Fs(sa.g*255,0,255)<<8^Fs(sa.b*255,0,255)<<0}getHexString(e=wu){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=oa.workingColorSpace){oa.fromWorkingColorSpace(sa.copy(this),t);const i=sa.r,r=sa.g,o=sa.b,l=Math.max(i,r,o),s=Math.min(i,r,o);let d,p;const _=(s+l)/2;if(s===l)d=0,p=0;else{const w=l-s;switch(p=_<=.5?w/(l+s):w/(2-l-s),l){case i:d=(r-o)/w+(r<o?6:0);break;case r:d=(o-i)/w+2;break;case o:d=(i-r)/w+4;break}d/=6}return e.h=d,e.s=p,e.l=_,e}getRGB(e,t=oa.workingColorSpace){return oa.fromWorkingColorSpace(sa.copy(this),t),e.r=sa.r,e.g=sa.g,e.b=sa.b,e}getStyle(e=wu){oa.fromWorkingColorSpace(sa.copy(this),e);const t=sa.r,i=sa.g,r=sa.b;return e!==wu?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${t*255|0},${i*255|0},${r*255|0})`}offsetHSL(e,t,i){return this.getHSL(_u),_u.h+=e,_u.s+=t,_u.l+=i,this.setHSL(_u.h,_u.s,_u.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(_u),e.getHSL(gb);const i=lv(_u.h,gb.h,t),r=lv(_u.s,gb.s,t),o=lv(_u.l,gb.l,t);return this.setHSL(i,r,o),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const sa=new An;An.NAMES=SV;class Dl extends Zs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new An(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=x1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Vs=new Fe,_b=new Gt;class vr{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Hv,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)_b.fromBufferAttribute(this,t),_b.applyMatrix3(e),this.setXY(t,_b.x,_b.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.applyMatrix3(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.applyMatrix4(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.applyNormalMatrix(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Vs.fromBufferAttribute(this,t),Vs.transformDirection(e),this.setXYZ(t,Vs.x,Vs.y,Vs.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Nd(t,this.array)),t}setX(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Nd(t,this.array)),t}setY(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Nd(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Nd(t,this.array)),t}setW(e,t){return this.normalized&&(t=Dr(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Dr(t,this.array),i=Dr(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Dr(t,this.array),i=Dr(i,this.array),r=Dr(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e*=this.itemSize,this.normalized&&(t=Dr(t,this.array),i=Dr(i,this.array),r=Dr(r,this.array),o=Dr(o,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Hv&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class nee extends vr{constructor(e,t,i){super(new Int8Array(e),t,i)}}class iee extends vr{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class ree extends vr{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class see extends vr{constructor(e,t,i){super(new Int16Array(e),t,i)}}class TL extends vr{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class oee extends vr{constructor(e,t,i){super(new Int32Array(e),t,i)}}class EL extends vr{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class aee extends vr{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}}class qn extends vr{constructor(e,t,i){super(new Float32Array(e),t,i)}}class lee extends vr{constructor(e,t,i){super(new Float64Array(e),t,i)}}let cee=0;const hc=new hi,D2=new tr,C_=new Fe,Cl=new Vp,_x=new Vp,So=new Fe;class Ti extends kh{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:cee++}),this.uuid=Fl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(bV(e)?EL:TL)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const o=new Uo().getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return hc.makeRotationFromQuaternion(e),this.applyMatrix4(hc),this}rotateX(e){return hc.makeRotationX(e),this.applyMatrix4(hc),this}rotateY(e){return hc.makeRotationY(e),this.applyMatrix4(hc),this}rotateZ(e){return hc.makeRotationZ(e),this.applyMatrix4(hc),this}translate(e,t,i){return hc.makeTranslation(e,t,i),this.applyMatrix4(hc),this}scale(e,t,i){return hc.makeScale(e,t,i),this.applyMatrix4(hc),this}lookAt(e){return D2.lookAt(e),D2.updateMatrix(),this.applyMatrix4(D2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(C_).negate(),this.translate(C_.x,C_.y,C_.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new qn(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vp);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Fe(-1/0,-1/0,-1/0),new Fe(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const o=t[i];Cl.setFromBufferAttribute(o),this.morphTargetsRelative?(So.addVectors(this.boundingBox.min,Cl.min),this.boundingBox.expandByPoint(So),So.addVectors(this.boundingBox.max,Cl.max),this.boundingBox.expandByPoint(So)):(this.boundingBox.expandByPoint(Cl.min),this.boundingBox.expandByPoint(Cl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gp);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Fe,1/0);return}if(e){const i=this.boundingSphere.center;if(Cl.setFromBufferAttribute(e),t)for(let o=0,l=t.length;o<l;o++){const s=t[o];_x.setFromBufferAttribute(s),this.morphTargetsRelative?(So.addVectors(Cl.min,_x.min),Cl.expandByPoint(So),So.addVectors(Cl.max,_x.max),Cl.expandByPoint(So)):(Cl.expandByPoint(_x.min),Cl.expandByPoint(_x.max))}Cl.getCenter(i);let r=0;for(let o=0,l=e.count;o<l;o++)So.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(So));if(t)for(let o=0,l=t.length;o<l;o++){const s=t[o],d=this.morphTargetsRelative;for(let p=0,_=s.count;p<_;p++)So.fromBufferAttribute(s,p),d&&(C_.fromBufferAttribute(e,p),So.add(C_)),r=Math.max(r,i.distanceToSquared(So))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,o=t.normal.array,l=t.uv.array,s=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new vr(new Float32Array(4*s),4));const d=this.getAttribute("tangent").array,p=[],_=[];for(let he=0;he<s;he++)p[he]=new Fe,_[he]=new Fe;const w=new Fe,M=new Fe,A=new Fe,P=new Gt,L=new Gt,D=new Gt,z=new Fe,F=new Fe;function N(he,De,He){w.fromArray(r,he*3),M.fromArray(r,De*3),A.fromArray(r,He*3),P.fromArray(l,he*2),L.fromArray(l,De*2),D.fromArray(l,He*2),M.sub(w),A.sub(w),L.sub(P),D.sub(P);const ae=1/(L.x*D.y-D.x*L.y);isFinite(ae)&&(z.copy(M).multiplyScalar(D.y).addScaledVector(A,-L.y).multiplyScalar(ae),F.copy(A).multiplyScalar(L.x).addScaledVector(M,-D.x).multiplyScalar(ae),p[he].add(z),p[De].add(z),p[He].add(z),_[he].add(F),_[De].add(F),_[He].add(F))}let V=this.groups;V.length===0&&(V=[{start:0,count:i.length}]);for(let he=0,De=V.length;he<De;++he){const He=V[he],ae=He.start,le=He.count;for(let fe=ae,Oe=ae+le;fe<Oe;fe+=3)N(i[fe+0],i[fe+1],i[fe+2])}const j=new Fe,Q=new Fe,re=new Fe,Z=new Fe;function ne(he){re.fromArray(o,he*3),Z.copy(re);const De=p[he];j.copy(De),j.sub(re.multiplyScalar(re.dot(De))).normalize(),Q.crossVectors(Z,De);const ae=Q.dot(_[he])<0?-1:1;d[he*4]=j.x,d[he*4+1]=j.y,d[he*4+2]=j.z,d[he*4+3]=ae}for(let he=0,De=V.length;he<De;++he){const He=V[he],ae=He.start,le=He.count;for(let fe=ae,Oe=ae+le;fe<Oe;fe+=3)ne(i[fe+0]),ne(i[fe+1]),ne(i[fe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new vr(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let M=0,A=i.count;M<A;M++)i.setXYZ(M,0,0,0);const r=new Fe,o=new Fe,l=new Fe,s=new Fe,d=new Fe,p=new Fe,_=new Fe,w=new Fe;if(e)for(let M=0,A=e.count;M<A;M+=3){const P=e.getX(M+0),L=e.getX(M+1),D=e.getX(M+2);r.fromBufferAttribute(t,P),o.fromBufferAttribute(t,L),l.fromBufferAttribute(t,D),_.subVectors(l,o),w.subVectors(r,o),_.cross(w),s.fromBufferAttribute(i,P),d.fromBufferAttribute(i,L),p.fromBufferAttribute(i,D),s.add(_),d.add(_),p.add(_),i.setXYZ(P,s.x,s.y,s.z),i.setXYZ(L,d.x,d.y,d.z),i.setXYZ(D,p.x,p.y,p.z)}else for(let M=0,A=t.count;M<A;M+=3)r.fromBufferAttribute(t,M+0),o.fromBufferAttribute(t,M+1),l.fromBufferAttribute(t,M+2),_.subVectors(l,o),w.subVectors(r,o),_.cross(w),i.setXYZ(M+0,_.x,_.y,_.z),i.setXYZ(M+1,_.x,_.y,_.z),i.setXYZ(M+2,_.x,_.y,_.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)So.fromBufferAttribute(e,t),So.normalize(),e.setXYZ(t,So.x,So.y,So.z)}toNonIndexed(){function e(s,d){const p=s.array,_=s.itemSize,w=s.normalized,M=new p.constructor(d.length*_);let A=0,P=0;for(let L=0,D=d.length;L<D;L++){s.isInterleavedBufferAttribute?A=d[L]*s.data.stride+s.offset:A=d[L]*_;for(let z=0;z<_;z++)M[P++]=p[A++]}return new vr(M,_,w)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Ti,i=this.index.array,r=this.attributes;for(const s in r){const d=r[s],p=e(d,i);t.setAttribute(s,p)}const o=this.morphAttributes;for(const s in o){const d=[],p=o[s];for(let _=0,w=p.length;_<w;_++){const M=p[_],A=e(M,i);d.push(A)}t.morphAttributes[s]=d}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let s=0,d=l.length;s<d;s++){const p=l[s];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const d in i){const p=i[d];e.data.attributes[d]=p.toJSON(e.data)}const r={};let o=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],_=[];for(let w=0,M=p.length;w<M;w++){const A=p[w];_.push(A.toJSON(e.data))}_.length>0&&(r[d]=_,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const p in r){const _=r[p];this.setAttribute(p,_.clone(t))}const o=e.morphAttributes;for(const p in o){const _=[],w=o[p];for(let M=0,A=w.length;M<A;M++)_.push(w[M].clone(t));this.morphAttributes[p]=_}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let p=0,_=l.length;p<_;p++){const w=l[p];this.addGroup(w.start,w.count,w.materialIndex)}const s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const DO=new hi,_h=new v1,yb=new Gp,RO=new Fe,yx=new Fe,xx=new Fe,vx=new Fe,R2=new Fe,xb=new Fe,vb=new Gt,wb=new Gt,bb=new Gt,z2=new Fe,Sb=new Fe;class To extends tr{constructor(e=new Ti,t=new Dl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const s=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,o=i.morphAttributes.position,l=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(o&&s){xb.set(0,0,0);for(let d=0,p=o.length;d<p;d++){const _=s[d],w=o[d];_!==0&&(R2.fromBufferAttribute(w,e),l?xb.addScaledVector(R2,_):xb.addScaledVector(R2.sub(t),_))}t.add(xb)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,r=this.material,o=this.matrixWorld;if(r===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),yb.copy(i.boundingSphere),yb.applyMatrix4(o),_h.copy(e.ray).recast(e.near),yb.containsPoint(_h.origin)===!1&&(_h.intersectSphere(yb,RO)===null||_h.origin.distanceToSquared(RO)>(e.far-e.near)**2))||(DO.copy(o).invert(),_h.copy(e.ray).applyMatrix4(DO),i.boundingBox!==null&&_h.intersectsBox(i.boundingBox)===!1))return;let l;const s=i.index,d=i.attributes.position,p=i.attributes.uv,_=i.attributes.uv2,w=i.groups,M=i.drawRange;if(s!==null)if(Array.isArray(r))for(let A=0,P=w.length;A<P;A++){const L=w[A],D=r[L.materialIndex],z=Math.max(L.start,M.start),F=Math.min(s.count,Math.min(L.start+L.count,M.start+M.count));for(let N=z,V=F;N<V;N+=3){const j=s.getX(N),Q=s.getX(N+1),re=s.getX(N+2);l=Mb(this,D,e,_h,p,_,j,Q,re),l&&(l.faceIndex=Math.floor(N/3),l.face.materialIndex=L.materialIndex,t.push(l))}}else{const A=Math.max(0,M.start),P=Math.min(s.count,M.start+M.count);for(let L=A,D=P;L<D;L+=3){const z=s.getX(L),F=s.getX(L+1),N=s.getX(L+2);l=Mb(this,r,e,_h,p,_,z,F,N),l&&(l.faceIndex=Math.floor(L/3),t.push(l))}}else if(d!==void 0)if(Array.isArray(r))for(let A=0,P=w.length;A<P;A++){const L=w[A],D=r[L.materialIndex],z=Math.max(L.start,M.start),F=Math.min(d.count,Math.min(L.start+L.count,M.start+M.count));for(let N=z,V=F;N<V;N+=3){const j=N,Q=N+1,re=N+2;l=Mb(this,D,e,_h,p,_,j,Q,re),l&&(l.faceIndex=Math.floor(N/3),l.face.materialIndex=L.materialIndex,t.push(l))}}else{const A=Math.max(0,M.start),P=Math.min(d.count,M.start+M.count);for(let L=A,D=P;L<D;L+=3){const z=L,F=L+1,N=L+2;l=Mb(this,r,e,_h,p,_,z,F,N),l&&(l.faceIndex=Math.floor(L/3),t.push(l))}}}}function uee(n,e,t,i,r,o,l,s){let d;if(e.side===il?d=i.intersectTriangle(l,o,r,!0,s):d=i.intersectTriangle(r,o,l,e.side===Ih,s),d===null)return null;Sb.copy(s),Sb.applyMatrix4(n.matrixWorld);const p=t.ray.origin.distanceTo(Sb);return p<t.near||p>t.far?null:{distance:p,point:Sb.clone(),object:n}}function Mb(n,e,t,i,r,o,l,s,d){n.getVertexPosition(l,yx),n.getVertexPosition(s,xx),n.getVertexPosition(d,vx);const p=uee(n,e,t,i,yx,xx,vx,z2);if(p){r&&(vb.fromBufferAttribute(r,l),wb.fromBufferAttribute(r,s),bb.fromBufferAttribute(r,d),p.uv=wc.getUV(z2,yx,xx,vx,vb,wb,bb,new Gt)),o&&(vb.fromBufferAttribute(o,l),wb.fromBufferAttribute(o,s),bb.fromBufferAttribute(o,d),p.uv2=wc.getUV(z2,yx,xx,vx,vb,wb,bb,new Gt));const _={a:l,b:s,c:d,normal:new Fe,materialIndex:0};wc.getNormal(yx,xx,vx,_.normal),p.face=_}return p}class Wp extends Ti{constructor(e=1,t=1,i=1,r=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:l};const s=this;r=Math.floor(r),o=Math.floor(o),l=Math.floor(l);const d=[],p=[],_=[],w=[];let M=0,A=0;P("z","y","x",-1,-1,i,t,e,l,o,0),P("z","y","x",1,-1,i,t,-e,l,o,1),P("x","z","y",1,1,e,i,t,r,l,2),P("x","z","y",1,-1,e,i,-t,r,l,3),P("x","y","z",1,-1,e,t,i,r,o,4),P("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(d),this.setAttribute("position",new qn(p,3)),this.setAttribute("normal",new qn(_,3)),this.setAttribute("uv",new qn(w,2));function P(L,D,z,F,N,V,j,Q,re,Z,ne){const he=V/re,De=j/Z,He=V/2,ae=j/2,le=Q/2,fe=re+1,Oe=Z+1;let We=0,ce=0;const Te=new Fe;for(let Pe=0;Pe<Oe;Pe++){const Qe=Pe*De-ae;for(let Ne=0;Ne<fe;Ne++){const nt=Ne*he-He;Te[L]=nt*F,Te[D]=Qe*N,Te[z]=le,p.push(Te.x,Te.y,Te.z),Te[L]=0,Te[D]=0,Te[z]=Q>0?1:-1,_.push(Te.x,Te.y,Te.z),w.push(Ne/re),w.push(1-Pe/Z),We+=1}}for(let Pe=0;Pe<Z;Pe++)for(let Qe=0;Qe<re;Qe++){const Ne=M+Qe+fe*Pe,nt=M+Qe+fe*(Pe+1),ze=M+(Qe+1)+fe*(Pe+1),et=M+(Qe+1)+fe*Pe;d.push(Ne,nt,et),d.push(nt,ze,et),ce+=6}s.addGroup(A,ce,ne),A+=ce,M+=We}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Wp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Uy(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Ta(n){const e={};for(let t=0;t<n.length;t++){const i=Uy(n[t]);for(const r in i)e[r]=i[r]}return e}function hee(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function MV(n){return n.getRenderTarget()===null&&n.outputEncoding===ar?wu:Ny}const TV={clone:Uy,merge:Ta};var dee=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fee=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Lh extends Zs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=dee,this.fragmentShader=fee,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Uy(e.uniforms),this.uniformsGroups=hee(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const l=this.uniforms[r].value;l&&l.isTexture?t.uniforms[r]={type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?t.uniforms[r]={type:"c",value:l.getHex()}:l&&l.isVector2?t.uniforms[r]={type:"v2",value:l.toArray()}:l&&l.isVector3?t.uniforms[r]={type:"v3",value:l.toArray()}:l&&l.isVector4?t.uniforms[r]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?t.uniforms[r]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?t.uniforms[r]={type:"m4",value:l.toArray()}:t.uniforms[r]={value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class b1 extends tr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new hi,this.projectionMatrix=new hi,this.projectionMatrixInverse=new hi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class qr extends b1{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=jv*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(hg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return jv*2*Math.atan(Math.tan(hg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,o,l){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(hg*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const l=this.view;if(this.view!==null&&this.view.enabled){const d=l.fullWidth,p=l.fullHeight;o+=l.offsetX*r/d,t-=l.offsetY*i/p,r*=l.width/d,i*=l.height/p}const s=this.filmOffset;s!==0&&(o+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const I_=-90,P_=1;class EV extends tr{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new qr(I_,P_,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const o=new qr(I_,P_,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(-1,0,0),this.add(o);const l=new qr(I_,P_,e,t);l.layers=this.layers,l.up.set(0,0,-1),l.lookAt(0,1,0),this.add(l);const s=new qr(I_,P_,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(0,-1,0),this.add(s);const d=new qr(I_,P_,e,t);d.layers=this.layers,d.up.set(0,1,0),d.lookAt(0,0,1),this.add(d);const p=new qr(I_,P_,e,t);p.layers=this.layers,p.up.set(0,1,0),p.lookAt(0,0,-1),this.add(p)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,o,l,s,d,p]=this.children,_=e.getRenderTarget(),w=e.toneMapping,M=e.xr.enabled;e.toneMapping=Pu,e.xr.enabled=!1;const A=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,o),e.setRenderTarget(i,2),e.render(t,l),e.setRenderTarget(i,3),e.render(t,s),e.setRenderTarget(i,4),e.render(t,d),i.texture.generateMipmaps=A,e.setRenderTarget(i,5),e.render(t,p),e.setRenderTarget(_),e.toneMapping=w,e.xr.enabled=M,i.texture.needsPMREMUpdate=!0}}class S1 extends Jr{constructor(e,t,i,r,o,l,s,d,p,_){e=e!==void 0?e:[],t=t!==void 0?t:Pp,super(e,t,i,r,o,l,s,d,p,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class AV extends Du{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new S1(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:cs}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Wp(5,5,5),o=new Lh({name:"CubemapFromEquirect",uniforms:Uy(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:il,blending:Gd});o.uniforms.tEquirect.value=t;const l=new To(r,o),s=t.minFilter;return t.minFilter===Ph&&(t.minFilter=cs),new EV(1,10,this).update(e,l),t.minFilter=s,l.geometry.dispose(),l.material.dispose(),this}clear(e,t,i,r){const o=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,i,r);e.setRenderTarget(o)}}const O2=new Fe,pee=new Fe,mee=new Uo;class Yf{constructor(e=new Fe(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=O2.subVectors(i,t).cross(pee.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(O2),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(e.start).addScaledVector(i,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||mee.getNormalMatrix(e),r=this.coplanarPoint(O2).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const L_=new Gp,Tb=new Fe;class sT{constructor(e=new Yf,t=new Yf,i=new Yf,r=new Yf,o=new Yf,l=new Yf){this.planes=[e,t,i,r,o,l]}set(e,t,i,r,o,l){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(i),s[3].copy(r),s[4].copy(o),s[5].copy(l),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],o=i[1],l=i[2],s=i[3],d=i[4],p=i[5],_=i[6],w=i[7],M=i[8],A=i[9],P=i[10],L=i[11],D=i[12],z=i[13],F=i[14],N=i[15];return t[0].setComponents(s-r,w-d,L-M,N-D).normalize(),t[1].setComponents(s+r,w+d,L+M,N+D).normalize(),t[2].setComponents(s+o,w+p,L+A,N+z).normalize(),t[3].setComponents(s-o,w-p,L-A,N-z).normalize(),t[4].setComponents(s-l,w-_,L-P,N-F).normalize(),t[5].setComponents(s+l,w+_,L+P,N+F).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),L_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(L_)}intersectsSprite(e){return L_.center.set(0,0,0),L_.radius=.7071067811865476,L_.applyMatrix4(e.matrixWorld),this.intersectsSphere(L_)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Tb.x=r.normal.x>0?e.max.x:e.min.x,Tb.y=r.normal.y>0?e.max.y:e.min.y,Tb.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Tb)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function CV(){let n=null,e=!1,t=null,i=null;function r(o,l){t(o,l),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function gee(n,e){const t=e.isWebGL2,i=new WeakMap;function r(p,_){const w=p.array,M=p.usage,A=n.createBuffer();n.bindBuffer(_,A),n.bufferData(_,w,M),p.onUploadCallback();let P;if(w instanceof Float32Array)P=5126;else if(w instanceof Uint16Array)if(p.isFloat16BufferAttribute)if(t)P=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else P=5123;else if(w instanceof Int16Array)P=5122;else if(w instanceof Uint32Array)P=5125;else if(w instanceof Int32Array)P=5124;else if(w instanceof Int8Array)P=5120;else if(w instanceof Uint8Array)P=5121;else if(w instanceof Uint8ClampedArray)P=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+w);return{buffer:A,type:P,bytesPerElement:w.BYTES_PER_ELEMENT,version:p.version}}function o(p,_,w){const M=_.array,A=_.updateRange;n.bindBuffer(w,p),A.count===-1?n.bufferSubData(w,0,M):(t?n.bufferSubData(w,A.offset*M.BYTES_PER_ELEMENT,M,A.offset,A.count):n.bufferSubData(w,A.offset*M.BYTES_PER_ELEMENT,M.subarray(A.offset,A.offset+A.count)),A.count=-1),_.onUploadCallback()}function l(p){return p.isInterleavedBufferAttribute&&(p=p.data),i.get(p)}function s(p){p.isInterleavedBufferAttribute&&(p=p.data);const _=i.get(p);_&&(n.deleteBuffer(_.buffer),i.delete(p))}function d(p,_){if(p.isGLBufferAttribute){const M=i.get(p);(!M||M.version<p.version)&&i.set(p,{buffer:p.buffer,type:p.type,bytesPerElement:p.elementSize,version:p.version});return}p.isInterleavedBufferAttribute&&(p=p.data);const w=i.get(p);w===void 0?i.set(p,r(p,_)):w.version<p.version&&(o(w.buffer,p,_),w.version=p.version)}return{get:l,remove:s,update:d}}class n0 extends Ti{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,l=t/2,s=Math.floor(i),d=Math.floor(r),p=s+1,_=d+1,w=e/s,M=t/d,A=[],P=[],L=[],D=[];for(let z=0;z<_;z++){const F=z*M-l;for(let N=0;N<p;N++){const V=N*w-o;P.push(V,-F,0),L.push(0,0,1),D.push(N/s),D.push(1-z/d)}}for(let z=0;z<d;z++)for(let F=0;F<s;F++){const N=F+p*z,V=F+p*(z+1),j=F+1+p*(z+1),Q=F+1+p*z;A.push(N,V,Q),A.push(V,j,Q)}this.setIndex(A),this.setAttribute("position",new qn(P,3)),this.setAttribute("normal",new qn(L,3)),this.setAttribute("uv",new qn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n0(e.width,e.height,e.widthSegments,e.heightSegments)}}var _ee=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,yee=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,xee=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,vee=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,wee=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,bee=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,See="vec3 transformed = vec3( position );",Mee=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Tee=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Eee=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Aee=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Cee=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Iee=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Pee=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Lee=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,kee=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Dee=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ree=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,zee=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Oee=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Fee=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Bee=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Nee=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Uee=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Vee=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Gee=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Wee="gl_FragColor = linearToOutputTexel( gl_FragColor );",Hee=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,jee=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,qee=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Zee=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Xee=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,$ee=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Yee=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Kee=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Jee=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Qee=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,ete=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,tte=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,nte=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,ite=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,rte=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,ste=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,ote=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,ate=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lte=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,cte=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ute=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hte=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,dte=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,fte=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,pte=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,mte=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,gte=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,_te=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,yte=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,xte=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,vte=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,wte=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,bte=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Ste=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Mte=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Tte=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Ete=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Ate=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Cte=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Ite=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Pte=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Lte=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,kte=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Dte=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Rte=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,zte=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Ote=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Fte=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Bte=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Nte=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Ute=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Vte=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Gte=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Wte=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Hte=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,jte=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,qte=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Zte=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Xte=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,$te=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Yte=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Kte=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Jte=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Qte=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,ene=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,tne=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,nne=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ine=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,rne=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,sne=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,one=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,ane=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, vec2 fullSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		
		vec2 lodFudge = pow( 1.95, lod ) / fullSize;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec2 fullSize = vec2( textureSize( sampler, 0 ) );
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), fullSize, floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), fullSize, ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,lne=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,cne=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,une=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,hne=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,dne=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,fne=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,pne=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const mne=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,gne=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,_ne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,yne=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,xne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,vne=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,wne=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,bne=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Sne=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Mne=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Tne=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Ene=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Ane=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Cne=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ine=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Pne=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lne=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kne=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Dne=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Rne=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zne=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,One=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Fne=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Bne=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Nne=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Une=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vne=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Gne=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wne=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Hne=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,jne=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qne=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Zne=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Xne=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Pi={alphamap_fragment:_ee,alphamap_pars_fragment:yee,alphatest_fragment:xee,alphatest_pars_fragment:vee,aomap_fragment:wee,aomap_pars_fragment:bee,begin_vertex:See,beginnormal_vertex:Mee,bsdfs:Tee,iridescence_fragment:Eee,bumpmap_pars_fragment:Aee,clipping_planes_fragment:Cee,clipping_planes_pars_fragment:Iee,clipping_planes_pars_vertex:Pee,clipping_planes_vertex:Lee,color_fragment:kee,color_pars_fragment:Dee,color_pars_vertex:Ree,color_vertex:zee,common:Oee,cube_uv_reflection_fragment:Fee,defaultnormal_vertex:Bee,displacementmap_pars_vertex:Nee,displacementmap_vertex:Uee,emissivemap_fragment:Vee,emissivemap_pars_fragment:Gee,encodings_fragment:Wee,encodings_pars_fragment:Hee,envmap_fragment:jee,envmap_common_pars_fragment:qee,envmap_pars_fragment:Zee,envmap_pars_vertex:Xee,envmap_physical_pars_fragment:ote,envmap_vertex:$ee,fog_vertex:Yee,fog_pars_vertex:Kee,fog_fragment:Jee,fog_pars_fragment:Qee,gradientmap_pars_fragment:ete,lightmap_fragment:tte,lightmap_pars_fragment:nte,lights_lambert_fragment:ite,lights_lambert_pars_fragment:rte,lights_pars_begin:ste,lights_toon_fragment:ate,lights_toon_pars_fragment:lte,lights_phong_fragment:cte,lights_phong_pars_fragment:ute,lights_physical_fragment:hte,lights_physical_pars_fragment:dte,lights_fragment_begin:fte,lights_fragment_maps:pte,lights_fragment_end:mte,logdepthbuf_fragment:gte,logdepthbuf_pars_fragment:_te,logdepthbuf_pars_vertex:yte,logdepthbuf_vertex:xte,map_fragment:vte,map_pars_fragment:wte,map_particle_fragment:bte,map_particle_pars_fragment:Ste,metalnessmap_fragment:Mte,metalnessmap_pars_fragment:Tte,morphcolor_vertex:Ete,morphnormal_vertex:Ate,morphtarget_pars_vertex:Cte,morphtarget_vertex:Ite,normal_fragment_begin:Pte,normal_fragment_maps:Lte,normal_pars_fragment:kte,normal_pars_vertex:Dte,normal_vertex:Rte,normalmap_pars_fragment:zte,clearcoat_normal_fragment_begin:Ote,clearcoat_normal_fragment_maps:Fte,clearcoat_pars_fragment:Bte,iridescence_pars_fragment:Nte,output_fragment:Ute,packing:Vte,premultiplied_alpha_fragment:Gte,project_vertex:Wte,dithering_fragment:Hte,dithering_pars_fragment:jte,roughnessmap_fragment:qte,roughnessmap_pars_fragment:Zte,shadowmap_pars_fragment:Xte,shadowmap_pars_vertex:$te,shadowmap_vertex:Yte,shadowmask_pars_fragment:Kte,skinbase_vertex:Jte,skinning_pars_vertex:Qte,skinning_vertex:ene,skinnormal_vertex:tne,specularmap_fragment:nne,specularmap_pars_fragment:ine,tonemapping_fragment:rne,tonemapping_pars_fragment:sne,transmission_fragment:one,transmission_pars_fragment:ane,uv_pars_fragment:lne,uv_pars_vertex:cne,uv_vertex:une,uv2_pars_fragment:hne,uv2_pars_vertex:dne,uv2_vertex:fne,worldpos_vertex:pne,background_vert:mne,background_frag:gne,backgroundCube_vert:_ne,backgroundCube_frag:yne,cube_vert:xne,cube_frag:vne,depth_vert:wne,depth_frag:bne,distanceRGBA_vert:Sne,distanceRGBA_frag:Mne,equirect_vert:Tne,equirect_frag:Ene,linedashed_vert:Ane,linedashed_frag:Cne,meshbasic_vert:Ine,meshbasic_frag:Pne,meshlambert_vert:Lne,meshlambert_frag:kne,meshmatcap_vert:Dne,meshmatcap_frag:Rne,meshnormal_vert:zne,meshnormal_frag:One,meshphong_vert:Fne,meshphong_frag:Bne,meshphysical_vert:Nne,meshphysical_frag:Une,meshtoon_vert:Vne,meshtoon_frag:Gne,points_vert:Wne,points_frag:Hne,shadow_vert:jne,shadow_frag:qne,sprite_vert:Zne,sprite_frag:Xne},vn={common:{diffuse:{value:new An(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Uo},uv2Transform:{value:new Uo},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new An(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new An(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Uo}},sprite:{diffuse:{value:new An(16777215)},opacity:{value:1},center:{value:new Gt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Uo}}},Su={basic:{uniforms:Ta([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.fog]),vertexShader:Pi.meshbasic_vert,fragmentShader:Pi.meshbasic_frag},lambert:{uniforms:Ta([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,vn.lights,{emissive:{value:new An(0)}}]),vertexShader:Pi.meshlambert_vert,fragmentShader:Pi.meshlambert_frag},phong:{uniforms:Ta([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,vn.lights,{emissive:{value:new An(0)},specular:{value:new An(1118481)},shininess:{value:30}}]),vertexShader:Pi.meshphong_vert,fragmentShader:Pi.meshphong_frag},standard:{uniforms:Ta([vn.common,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.roughnessmap,vn.metalnessmap,vn.fog,vn.lights,{emissive:{value:new An(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag},toon:{uniforms:Ta([vn.common,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.gradientmap,vn.fog,vn.lights,{emissive:{value:new An(0)}}]),vertexShader:Pi.meshtoon_vert,fragmentShader:Pi.meshtoon_frag},matcap:{uniforms:Ta([vn.common,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,{matcap:{value:null}}]),vertexShader:Pi.meshmatcap_vert,fragmentShader:Pi.meshmatcap_frag},points:{uniforms:Ta([vn.points,vn.fog]),vertexShader:Pi.points_vert,fragmentShader:Pi.points_frag},dashed:{uniforms:Ta([vn.common,vn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pi.linedashed_vert,fragmentShader:Pi.linedashed_frag},depth:{uniforms:Ta([vn.common,vn.displacementmap]),vertexShader:Pi.depth_vert,fragmentShader:Pi.depth_frag},normal:{uniforms:Ta([vn.common,vn.bumpmap,vn.normalmap,vn.displacementmap,{opacity:{value:1}}]),vertexShader:Pi.meshnormal_vert,fragmentShader:Pi.meshnormal_frag},sprite:{uniforms:Ta([vn.sprite,vn.fog]),vertexShader:Pi.sprite_vert,fragmentShader:Pi.sprite_frag},background:{uniforms:{uvTransform:{value:new Uo},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pi.background_vert,fragmentShader:Pi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Pi.backgroundCube_vert,fragmentShader:Pi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pi.cube_vert,fragmentShader:Pi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pi.equirect_vert,fragmentShader:Pi.equirect_frag},distanceRGBA:{uniforms:Ta([vn.common,vn.displacementmap,{referencePosition:{value:new Fe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pi.distanceRGBA_vert,fragmentShader:Pi.distanceRGBA_frag},shadow:{uniforms:Ta([vn.lights,vn.fog,{color:{value:new An(0)},opacity:{value:1}}]),vertexShader:Pi.shadow_vert,fragmentShader:Pi.shadow_frag}};Su.physical={uniforms:Ta([Su.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Gt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new An(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new An(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new An(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag};const Eb={r:0,b:0,g:0};function $ne(n,e,t,i,r,o,l){const s=new An(0);let d=o===!0?0:1,p,_,w=null,M=0,A=null;function P(D,z){let F=!1,N=z.isScene===!0?z.background:null;N&&N.isTexture&&(N=(z.backgroundBlurriness>0?t:e).get(N));const V=n.xr,j=V.getSession&&V.getSession();j&&j.environmentBlendMode==="additive"&&(N=null),N===null?L(s,d):N&&N.isColor&&(L(N,1),F=!0),(n.autoClear||F)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),N&&(N.isCubeTexture||N.mapping===t0)?(_===void 0&&(_=new To(new Wp(1,1,1),new Lh({name:"BackgroundCubeMaterial",uniforms:Uy(Su.backgroundCube.uniforms),vertexShader:Su.backgroundCube.vertexShader,fragmentShader:Su.backgroundCube.fragmentShader,side:il,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(Q,re,Z){this.matrixWorld.copyPosition(Z.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(_)),_.material.uniforms.envMap.value=N,_.material.uniforms.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=z.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=z.backgroundIntensity,_.material.toneMapped=N.encoding!==ar,(w!==N||M!==N.version||A!==n.toneMapping)&&(_.material.needsUpdate=!0,w=N,M=N.version,A=n.toneMapping),_.layers.enableAll(),D.unshift(_,_.geometry,_.material,0,0,null)):N&&N.isTexture&&(p===void 0&&(p=new To(new n0(2,2),new Lh({name:"BackgroundMaterial",uniforms:Uy(Su.background.uniforms),vertexShader:Su.background.vertexShader,fragmentShader:Su.background.fragmentShader,side:Ih,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=N,p.material.uniforms.backgroundIntensity.value=z.backgroundIntensity,p.material.toneMapped=N.encoding!==ar,N.matrixAutoUpdate===!0&&N.updateMatrix(),p.material.uniforms.uvTransform.value.copy(N.matrix),(w!==N||M!==N.version||A!==n.toneMapping)&&(p.material.needsUpdate=!0,w=N,M=N.version,A=n.toneMapping),p.layers.enableAll(),D.unshift(p,p.geometry,p.material,0,0,null))}function L(D,z){D.getRGB(Eb,MV(n)),i.buffers.color.setClear(Eb.r,Eb.g,Eb.b,z,l)}return{getClearColor:function(){return s},setClearColor:function(D,z=1){s.set(D),d=z,L(s,d)},getClearAlpha:function(){return d},setClearAlpha:function(D){d=D,L(s,d)},render:P}}function Yne(n,e,t,i){const r=n.getParameter(34921),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),l=i.isWebGL2||o!==null,s={},d=D(null);let p=d,_=!1;function w(le,fe,Oe,We,ce){let Te=!1;if(l){const Pe=L(We,Oe,fe);p!==Pe&&(p=Pe,A(p.object)),Te=z(le,We,Oe,ce),Te&&F(le,We,Oe,ce)}else{const Pe=fe.wireframe===!0;(p.geometry!==We.id||p.program!==Oe.id||p.wireframe!==Pe)&&(p.geometry=We.id,p.program=Oe.id,p.wireframe=Pe,Te=!0)}ce!==null&&t.update(ce,34963),(Te||_)&&(_=!1,Z(le,fe,Oe,We),ce!==null&&n.bindBuffer(34963,t.get(ce).buffer))}function M(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}function A(le){return i.isWebGL2?n.bindVertexArray(le):o.bindVertexArrayOES(le)}function P(le){return i.isWebGL2?n.deleteVertexArray(le):o.deleteVertexArrayOES(le)}function L(le,fe,Oe){const We=Oe.wireframe===!0;let ce=s[le.id];ce===void 0&&(ce={},s[le.id]=ce);let Te=ce[fe.id];Te===void 0&&(Te={},ce[fe.id]=Te);let Pe=Te[We];return Pe===void 0&&(Pe=D(M()),Te[We]=Pe),Pe}function D(le){const fe=[],Oe=[],We=[];for(let ce=0;ce<r;ce++)fe[ce]=0,Oe[ce]=0,We[ce]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:fe,enabledAttributes:Oe,attributeDivisors:We,object:le,attributes:{},index:null}}function z(le,fe,Oe,We){const ce=p.attributes,Te=fe.attributes;let Pe=0;const Qe=Oe.getAttributes();for(const Ne in Qe)if(Qe[Ne].location>=0){const ze=ce[Ne];let et=Te[Ne];if(et===void 0&&(Ne==="instanceMatrix"&&le.instanceMatrix&&(et=le.instanceMatrix),Ne==="instanceColor"&&le.instanceColor&&(et=le.instanceColor)),ze===void 0||ze.attribute!==et||et&&ze.data!==et.data)return!0;Pe++}return p.attributesNum!==Pe||p.index!==We}function F(le,fe,Oe,We){const ce={},Te=fe.attributes;let Pe=0;const Qe=Oe.getAttributes();for(const Ne in Qe)if(Qe[Ne].location>=0){let ze=Te[Ne];ze===void 0&&(Ne==="instanceMatrix"&&le.instanceMatrix&&(ze=le.instanceMatrix),Ne==="instanceColor"&&le.instanceColor&&(ze=le.instanceColor));const et={};et.attribute=ze,ze&&ze.data&&(et.data=ze.data),ce[Ne]=et,Pe++}p.attributes=ce,p.attributesNum=Pe,p.index=We}function N(){const le=p.newAttributes;for(let fe=0,Oe=le.length;fe<Oe;fe++)le[fe]=0}function V(le){j(le,0)}function j(le,fe){const Oe=p.newAttributes,We=p.enabledAttributes,ce=p.attributeDivisors;Oe[le]=1,We[le]===0&&(n.enableVertexAttribArray(le),We[le]=1),ce[le]!==fe&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](le,fe),ce[le]=fe)}function Q(){const le=p.newAttributes,fe=p.enabledAttributes;for(let Oe=0,We=fe.length;Oe<We;Oe++)fe[Oe]!==le[Oe]&&(n.disableVertexAttribArray(Oe),fe[Oe]=0)}function re(le,fe,Oe,We,ce,Te){i.isWebGL2===!0&&(Oe===5124||Oe===5125)?n.vertexAttribIPointer(le,fe,Oe,ce,Te):n.vertexAttribPointer(le,fe,Oe,We,ce,Te)}function Z(le,fe,Oe,We){if(i.isWebGL2===!1&&(le.isInstancedMesh||We.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;N();const ce=We.attributes,Te=Oe.getAttributes(),Pe=fe.defaultAttributeValues;for(const Qe in Te){const Ne=Te[Qe];if(Ne.location>=0){let nt=ce[Qe];if(nt===void 0&&(Qe==="instanceMatrix"&&le.instanceMatrix&&(nt=le.instanceMatrix),Qe==="instanceColor"&&le.instanceColor&&(nt=le.instanceColor)),nt!==void 0){const ze=nt.normalized,et=nt.itemSize,Et=t.get(nt);if(Et===void 0)continue;const Nt=Et.buffer,qt=Et.type,wn=Et.bytesPerElement;if(nt.isInterleavedBufferAttribute){const _n=nt.data,Rn=_n.stride,At=nt.offset;if(_n.isInstancedInterleavedBuffer){for(let Ot=0;Ot<Ne.locationSize;Ot++)j(Ne.location+Ot,_n.meshPerAttribute);le.isInstancedMesh!==!0&&We._maxInstanceCount===void 0&&(We._maxInstanceCount=_n.meshPerAttribute*_n.count)}else for(let Ot=0;Ot<Ne.locationSize;Ot++)V(Ne.location+Ot);n.bindBuffer(34962,Nt);for(let Ot=0;Ot<Ne.locationSize;Ot++)re(Ne.location+Ot,et/Ne.locationSize,qt,ze,Rn*wn,(At+et/Ne.locationSize*Ot)*wn)}else{if(nt.isInstancedBufferAttribute){for(let _n=0;_n<Ne.locationSize;_n++)j(Ne.location+_n,nt.meshPerAttribute);le.isInstancedMesh!==!0&&We._maxInstanceCount===void 0&&(We._maxInstanceCount=nt.meshPerAttribute*nt.count)}else for(let _n=0;_n<Ne.locationSize;_n++)V(Ne.location+_n);n.bindBuffer(34962,Nt);for(let _n=0;_n<Ne.locationSize;_n++)re(Ne.location+_n,et/Ne.locationSize,qt,ze,et*wn,et/Ne.locationSize*_n*wn)}}else if(Pe!==void 0){const ze=Pe[Qe];if(ze!==void 0)switch(ze.length){case 2:n.vertexAttrib2fv(Ne.location,ze);break;case 3:n.vertexAttrib3fv(Ne.location,ze);break;case 4:n.vertexAttrib4fv(Ne.location,ze);break;default:n.vertexAttrib1fv(Ne.location,ze)}}}}Q()}function ne(){He();for(const le in s){const fe=s[le];for(const Oe in fe){const We=fe[Oe];for(const ce in We)P(We[ce].object),delete We[ce];delete fe[Oe]}delete s[le]}}function he(le){if(s[le.id]===void 0)return;const fe=s[le.id];for(const Oe in fe){const We=fe[Oe];for(const ce in We)P(We[ce].object),delete We[ce];delete fe[Oe]}delete s[le.id]}function De(le){for(const fe in s){const Oe=s[fe];if(Oe[le.id]===void 0)continue;const We=Oe[le.id];for(const ce in We)P(We[ce].object),delete We[ce];delete Oe[le.id]}}function He(){ae(),_=!0,p!==d&&(p=d,A(p.object))}function ae(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:w,reset:He,resetDefaultState:ae,dispose:ne,releaseStatesOfGeometry:he,releaseStatesOfProgram:De,initAttributes:N,enableAttribute:V,disableUnusedAttributes:Q}}function Kne(n,e,t,i){const r=i.isWebGL2;let o;function l(p){o=p}function s(p,_){n.drawArrays(o,p,_),t.update(_,o,1)}function d(p,_,w){if(w===0)return;let M,A;if(r)M=n,A="drawArraysInstanced";else if(M=e.get("ANGLE_instanced_arrays"),A="drawArraysInstancedANGLE",M===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[A](o,p,_,w),t.update(_,o,w)}this.setMode=l,this.render=s,this.renderInstances=d}function Jne(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const re=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(re.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(re){if(re==="highp"){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";re="mediump"}return re==="mediump"&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const l=typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext;let s=t.precision!==void 0?t.precision:"highp";const d=o(s);d!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",d,"instead."),s=d);const p=l||e.has("WEBGL_draw_buffers"),_=t.logarithmicDepthBuffer===!0,w=n.getParameter(34930),M=n.getParameter(35660),A=n.getParameter(3379),P=n.getParameter(34076),L=n.getParameter(34921),D=n.getParameter(36347),z=n.getParameter(36348),F=n.getParameter(36349),N=M>0,V=l||e.has("OES_texture_float"),j=N&&V,Q=l?n.getParameter(36183):0;return{isWebGL2:l,drawBuffers:p,getMaxAnisotropy:r,getMaxPrecision:o,precision:s,logarithmicDepthBuffer:_,maxTextures:w,maxVertexTextures:M,maxTextureSize:A,maxCubemapSize:P,maxAttributes:L,maxVertexUniforms:D,maxVaryings:z,maxFragmentUniforms:F,vertexTextures:N,floatFragmentTextures:V,floatVertexTextures:j,maxSamples:Q}}function Qne(n){const e=this;let t=null,i=0,r=!1,o=!1;const l=new Yf,s=new Uo,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(w,M){const A=w.length!==0||M||i!==0||r;return r=M,i=w.length,A},this.beginShadows=function(){o=!0,_(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(w,M){t=_(w,M,0)},this.setState=function(w,M,A){const P=w.clippingPlanes,L=w.clipIntersection,D=w.clipShadows,z=n.get(w);if(!r||P===null||P.length===0||o&&!D)o?_(null):p();else{const F=o?0:i,N=F*4;let V=z.clippingState||null;d.value=V,V=_(P,M,N,A);for(let j=0;j!==N;++j)V[j]=t[j];z.clippingState=V,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=F}};function p(){d.value!==t&&(d.value=t,d.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function _(w,M,A,P){const L=w!==null?w.length:0;let D=null;if(L!==0){if(D=d.value,P!==!0||D===null){const z=A+L*4,F=M.matrixWorldInverse;s.getNormalMatrix(F),(D===null||D.length<z)&&(D=new Float32Array(z));for(let N=0,V=A;N!==L;++N,V+=4)l.copy(w[N]).applyMatrix4(F,s),l.normal.toArray(D,V),D[V+3]=l.constant}d.value=D,d.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,D}}function eie(n){let e=new WeakMap;function t(l,s){return s===Uv?l.mapping=Pp:s===Vv&&(l.mapping=Lp),l}function i(l){if(l&&l.isTexture&&l.isRenderTargetTexture===!1){const s=l.mapping;if(s===Uv||s===Vv)if(e.has(l)){const d=e.get(l).texture;return t(d,l.mapping)}else{const d=l.image;if(d&&d.height>0){const p=new AV(d.height/2);return p.fromEquirectangularTexture(n,l),e.set(l,p),l.addEventListener("dispose",r),t(p.texture,l.mapping)}else return null}}return l}function r(l){const s=l.target;s.removeEventListener("dispose",r);const d=e.get(s);d!==void 0&&(e.delete(s),d.dispose())}function o(){e=new WeakMap}return{get:i,dispose:o}}class Wd extends b1{constructor(e=-1,t=1,i=1,r=-1,o=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,l=i+e,s=r+t,d=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,l=o+p*this.view.width,s-=_*this.view.offsetY,d=s-_*this.view.height}this.projectionMatrix.makeOrthographic(o,l,s,d,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const ty=4,zO=[.125,.215,.35,.446,.526,.582],Hm=20,F2=new Wd,OO=new An;let B2=null;const Gm=(1+Math.sqrt(5))/2,k_=1/Gm,FO=[new Fe(1,1,1),new Fe(-1,1,1),new Fe(1,1,-1),new Fe(-1,1,-1),new Fe(0,Gm,k_),new Fe(0,Gm,-k_),new Fe(k_,0,Gm),new Fe(-k_,0,Gm),new Fe(Gm,k_,0),new Fe(-Gm,k_,0)];class _I{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){B2=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,r,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=UO(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=NO(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(B2),e.scissorTest=!1,Ab(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Pp||e.mapping===Lp?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),B2=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:cs,minFilter:cs,generateMipmaps:!1,type:Fy,format:$a,encoding:Jd,depthBuffer:!1},r=BO(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=BO(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=tie(o)),this._blurMaterial=nie(o,e,t)}return r}_compileMaterial(e){const t=new To(this._lodPlanes[0],e);this._renderer.compile(t,F2)}_sceneToCubeUV(e,t,i,r){const s=new qr(90,1,t,i),d=[1,-1,1,1,1,1],p=[1,1,1,-1,-1,-1],_=this._renderer,w=_.autoClear,M=_.toneMapping;_.getClearColor(OO),_.toneMapping=Pu,_.autoClear=!1;const A=new Dl({name:"PMREM.Background",side:il,depthWrite:!1,depthTest:!1}),P=new To(new Wp,A);let L=!1;const D=e.background;D?D.isColor&&(A.color.copy(D),e.background=null,L=!0):(A.color.copy(OO),L=!0);for(let z=0;z<6;z++){const F=z%3;F===0?(s.up.set(0,d[z],0),s.lookAt(p[z],0,0)):F===1?(s.up.set(0,0,d[z]),s.lookAt(0,p[z],0)):(s.up.set(0,d[z],0),s.lookAt(0,0,p[z]));const N=this._cubeSize;Ab(r,F*N,z>2?N:0,N,N),_.setRenderTarget(r),L&&_.render(P,s),_.render(e,s)}P.geometry.dispose(),P.material.dispose(),_.toneMapping=M,_.autoClear=w,e.background=D}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Pp||e.mapping===Lp;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=UO()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=NO());const o=r?this._cubemapMaterial:this._equirectMaterial,l=new To(this._lodPlanes[0],o),s=o.uniforms;s.envMap.value=e;const d=this._cubeSize;Ab(t,0,0,3*d,2*d),i.setRenderTarget(t),i.render(l,F2)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),l=FO[(r-1)%FO.length];this._blur(e,r-1,r,o,l)}t.autoClear=i}_blur(e,t,i,r,o){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,i,r,"latitudinal",o),this._halfBlur(l,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,l,s){const d=this._renderer,p=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,w=new To(this._lodPlanes[r],p),M=p.uniforms,A=this._sizeLods[i]-1,P=isFinite(o)?Math.PI/(2*A):2*Math.PI/(2*Hm-1),L=o/P,D=isFinite(o)?1+Math.floor(_*L):Hm;D>Hm&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${D} samples when the maximum is set to ${Hm}`);const z=[];let F=0;for(let re=0;re<Hm;++re){const Z=re/L,ne=Math.exp(-Z*Z/2);z.push(ne),re===0?F+=ne:re<D&&(F+=2*ne)}for(let re=0;re<z.length;re++)z[re]=z[re]/F;M.envMap.value=e.texture,M.samples.value=D,M.weights.value=z,M.latitudinal.value=l==="latitudinal",s&&(M.poleAxis.value=s);const{_lodMax:N}=this;M.dTheta.value=P,M.mipInt.value=N-i;const V=this._sizeLods[r],j=3*V*(r>N-ty?r-N+ty:0),Q=4*(this._cubeSize-V);Ab(t,j,Q,3*V,2*V),d.setRenderTarget(t),d.render(w,F2)}}function tie(n){const e=[],t=[],i=[];let r=n;const o=n-ty+1+zO.length;for(let l=0;l<o;l++){const s=Math.pow(2,r);t.push(s);let d=1/s;l>n-ty?d=zO[l-n+ty-1]:l===0&&(d=0),i.push(d);const p=1/(s-2),_=-p,w=1+p,M=[_,_,w,_,w,w,_,_,w,w,_,w],A=6,P=6,L=3,D=2,z=1,F=new Float32Array(L*P*A),N=new Float32Array(D*P*A),V=new Float32Array(z*P*A);for(let Q=0;Q<A;Q++){const re=Q%3*2/3-1,Z=Q>2?0:-1,ne=[re,Z,0,re+2/3,Z,0,re+2/3,Z+1,0,re,Z,0,re+2/3,Z+1,0,re,Z+1,0];F.set(ne,L*P*Q),N.set(M,D*P*Q);const he=[Q,Q,Q,Q,Q,Q];V.set(he,z*P*Q)}const j=new Ti;j.setAttribute("position",new vr(F,L)),j.setAttribute("uv",new vr(N,D)),j.setAttribute("faceIndex",new vr(V,z)),e.push(j),r>ty&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function BO(n,e,t){const i=new Du(n,e,t);return i.texture.mapping=t0,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Ab(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function nie(n,e,t){const i=new Float32Array(Hm),r=new Fe(0,1,0);return new Lh({name:"SphericalGaussianBlur",defines:{n:Hm,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:AL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Gd,depthTest:!1,depthWrite:!1})}function NO(){return new Lh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:AL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Gd,depthTest:!1,depthWrite:!1})}function UO(){return new Lh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:AL(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Gd,depthTest:!1,depthWrite:!1})}function AL(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function iie(n){let e=new WeakMap,t=null;function i(s){if(s&&s.isTexture){const d=s.mapping,p=d===Uv||d===Vv,_=d===Pp||d===Lp;if(p||_)if(s.isRenderTargetTexture&&s.needsPMREMUpdate===!0){s.needsPMREMUpdate=!1;let w=e.get(s);return t===null&&(t=new _I(n)),w=p?t.fromEquirectangular(s,w):t.fromCubemap(s,w),e.set(s,w),w.texture}else{if(e.has(s))return e.get(s).texture;{const w=s.image;if(p&&w&&w.height>0||_&&w&&r(w)){t===null&&(t=new _I(n));const M=p?t.fromEquirectangular(s):t.fromCubemap(s);return e.set(s,M),s.addEventListener("dispose",o),M.texture}else return null}}}return s}function r(s){let d=0;const p=6;for(let _=0;_<p;_++)s[_]!==void 0&&d++;return d===p}function o(s){const d=s.target;d.removeEventListener("dispose",o);const p=e.get(d);p!==void 0&&(e.delete(d),p.dispose())}function l(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:l}}function rie(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function sie(n,e,t,i){const r={},o=new WeakMap;function l(w){const M=w.target;M.index!==null&&e.remove(M.index);for(const P in M.attributes)e.remove(M.attributes[P]);M.removeEventListener("dispose",l),delete r[M.id];const A=o.get(M);A&&(e.remove(A),o.delete(M)),i.releaseStatesOfGeometry(M),M.isInstancedBufferGeometry===!0&&delete M._maxInstanceCount,t.memory.geometries--}function s(w,M){return r[M.id]===!0||(M.addEventListener("dispose",l),r[M.id]=!0,t.memory.geometries++),M}function d(w){const M=w.attributes;for(const P in M)e.update(M[P],34962);const A=w.morphAttributes;for(const P in A){const L=A[P];for(let D=0,z=L.length;D<z;D++)e.update(L[D],34962)}}function p(w){const M=[],A=w.index,P=w.attributes.position;let L=0;if(A!==null){const F=A.array;L=A.version;for(let N=0,V=F.length;N<V;N+=3){const j=F[N+0],Q=F[N+1],re=F[N+2];M.push(j,Q,Q,re,re,j)}}else{const F=P.array;L=P.version;for(let N=0,V=F.length/3-1;N<V;N+=3){const j=N+0,Q=N+1,re=N+2;M.push(j,Q,Q,re,re,j)}}const D=new(bV(M)?EL:TL)(M,1);D.version=L;const z=o.get(w);z&&e.remove(z),o.set(w,D)}function _(w){const M=o.get(w);if(M){const A=w.index;A!==null&&M.version<A.version&&p(w)}else p(w);return o.get(w)}return{get:s,update:d,getWireframeAttribute:_}}function oie(n,e,t,i){const r=i.isWebGL2;let o;function l(M){o=M}let s,d;function p(M){s=M.type,d=M.bytesPerElement}function _(M,A){n.drawElements(o,A,s,M*d),t.update(A,o,1)}function w(M,A,P){if(P===0)return;let L,D;if(r)L=n,D="drawElementsInstanced";else if(L=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",L===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}L[D](o,A,s,M*d,P),t.update(A,o,P)}this.setMode=l,this.setIndex=p,this.render=_,this.renderInstances=w}function aie(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,l,s){switch(t.calls++,l){case 4:t.triangles+=s*(o/3);break;case 1:t.lines+=s*(o/2);break;case 3:t.lines+=s*(o-1);break;case 2:t.lines+=s*o;break;case 0:t.points+=s*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l);break}}function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function lie(n,e){return n[0]-e[0]}function cie(n,e){return Math.abs(e[1])-Math.abs(n[1])}function uie(n,e,t){const i={},r=new Float32Array(8),o=new WeakMap,l=new Tr,s=[];for(let p=0;p<8;p++)s[p]=[p,0];function d(p,_,w){const M=p.morphTargetInfluences;if(e.isWebGL2===!0){const P=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,L=P!==void 0?P.length:0;let D=o.get(_);if(D===void 0||D.count!==L){let fe=function(){ae.dispose(),o.delete(_),_.removeEventListener("dispose",fe)};var A=fe;D!==void 0&&D.texture.dispose();const N=_.morphAttributes.position!==void 0,V=_.morphAttributes.normal!==void 0,j=_.morphAttributes.color!==void 0,Q=_.morphAttributes.position||[],re=_.morphAttributes.normal||[],Z=_.morphAttributes.color||[];let ne=0;N===!0&&(ne=1),V===!0&&(ne=2),j===!0&&(ne=3);let he=_.attributes.position.count*ne,De=1;he>e.maxTextureSize&&(De=Math.ceil(he/e.maxTextureSize),he=e.maxTextureSize);const He=new Float32Array(he*De*4*L),ae=new rT(He,he,De,L);ae.type=Bd,ae.needsUpdate=!0;const le=ne*4;for(let Oe=0;Oe<L;Oe++){const We=Q[Oe],ce=re[Oe],Te=Z[Oe],Pe=he*De*4*Oe;for(let Qe=0;Qe<We.count;Qe++){const Ne=Qe*le;N===!0&&(l.fromBufferAttribute(We,Qe),He[Pe+Ne+0]=l.x,He[Pe+Ne+1]=l.y,He[Pe+Ne+2]=l.z,He[Pe+Ne+3]=0),V===!0&&(l.fromBufferAttribute(ce,Qe),He[Pe+Ne+4]=l.x,He[Pe+Ne+5]=l.y,He[Pe+Ne+6]=l.z,He[Pe+Ne+7]=0),j===!0&&(l.fromBufferAttribute(Te,Qe),He[Pe+Ne+8]=l.x,He[Pe+Ne+9]=l.y,He[Pe+Ne+10]=l.z,He[Pe+Ne+11]=Te.itemSize===4?l.w:1)}}D={count:L,texture:ae,size:new Gt(he,De)},o.set(_,D),_.addEventListener("dispose",fe)}let z=0;for(let N=0;N<M.length;N++)z+=M[N];const F=_.morphTargetsRelative?1:1-z;w.getUniforms().setValue(n,"morphTargetBaseInfluence",F),w.getUniforms().setValue(n,"morphTargetInfluences",M),w.getUniforms().setValue(n,"morphTargetsTexture",D.texture,t),w.getUniforms().setValue(n,"morphTargetsTextureSize",D.size)}else{const P=M===void 0?0:M.length;let L=i[_.id];if(L===void 0||L.length!==P){L=[];for(let V=0;V<P;V++)L[V]=[V,0];i[_.id]=L}for(let V=0;V<P;V++){const j=L[V];j[0]=V,j[1]=M[V]}L.sort(cie);for(let V=0;V<8;V++)V<P&&L[V][1]?(s[V][0]=L[V][0],s[V][1]=L[V][1]):(s[V][0]=Number.MAX_SAFE_INTEGER,s[V][1]=0);s.sort(lie);const D=_.morphAttributes.position,z=_.morphAttributes.normal;let F=0;for(let V=0;V<8;V++){const j=s[V],Q=j[0],re=j[1];Q!==Number.MAX_SAFE_INTEGER&&re?(D&&_.getAttribute("morphTarget"+V)!==D[Q]&&_.setAttribute("morphTarget"+V,D[Q]),z&&_.getAttribute("morphNormal"+V)!==z[Q]&&_.setAttribute("morphNormal"+V,z[Q]),r[V]=re,F+=re):(D&&_.hasAttribute("morphTarget"+V)===!0&&_.deleteAttribute("morphTarget"+V),z&&_.hasAttribute("morphNormal"+V)===!0&&_.deleteAttribute("morphNormal"+V),r[V]=0)}const N=_.morphTargetsRelative?1:1-F;w.getUniforms().setValue(n,"morphTargetBaseInfluence",N),w.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:d}}function hie(n,e,t,i){let r=new WeakMap;function o(d){const p=i.render.frame,_=d.geometry,w=e.get(d,_);return r.get(w)!==p&&(e.update(w),r.set(w,p)),d.isInstancedMesh&&(d.hasEventListener("dispose",s)===!1&&d.addEventListener("dispose",s),t.update(d.instanceMatrix,34962),d.instanceColor!==null&&t.update(d.instanceColor,34962)),w}function l(){r=new WeakMap}function s(d){const p=d.target;p.removeEventListener("dispose",s),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:o,dispose:l}}const IV=new Jr,PV=new rT,LV=new ML,kV=new S1,VO=[],GO=[],WO=new Float32Array(16),HO=new Float32Array(9),jO=new Float32Array(4);function i0(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=VO[r];if(o===void 0&&(o=new Float32Array(r),VO[r]=o),e!==0){i.toArray(o,0);for(let l=1,s=0;l!==e;++l)s+=t,n[l].toArray(o,s)}return o}function lo(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function co(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function oT(n,e){let t=GO[e];t===void 0&&(t=new Int32Array(e),GO[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function die(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function fie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(lo(t,e))return;n.uniform2fv(this.addr,e),co(t,e)}}function pie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(lo(t,e))return;n.uniform3fv(this.addr,e),co(t,e)}}function mie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(lo(t,e))return;n.uniform4fv(this.addr,e),co(t,e)}}function gie(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(lo(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),co(t,e)}else{if(lo(t,i))return;jO.set(i),n.uniformMatrix2fv(this.addr,!1,jO),co(t,i)}}function _ie(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(lo(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),co(t,e)}else{if(lo(t,i))return;HO.set(i),n.uniformMatrix3fv(this.addr,!1,HO),co(t,i)}}function yie(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(lo(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),co(t,e)}else{if(lo(t,i))return;WO.set(i),n.uniformMatrix4fv(this.addr,!1,WO),co(t,i)}}function xie(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function vie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(lo(t,e))return;n.uniform2iv(this.addr,e),co(t,e)}}function wie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(lo(t,e))return;n.uniform3iv(this.addr,e),co(t,e)}}function bie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(lo(t,e))return;n.uniform4iv(this.addr,e),co(t,e)}}function Sie(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Mie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(lo(t,e))return;n.uniform2uiv(this.addr,e),co(t,e)}}function Tie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(lo(t,e))return;n.uniform3uiv(this.addr,e),co(t,e)}}function Eie(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(lo(t,e))return;n.uniform4uiv(this.addr,e),co(t,e)}}function Aie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||IV,r)}function Cie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||LV,r)}function Iie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||kV,r)}function Pie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||PV,r)}function Lie(n){switch(n){case 5126:return die;case 35664:return fie;case 35665:return pie;case 35666:return mie;case 35674:return gie;case 35675:return _ie;case 35676:return yie;case 5124:case 35670:return xie;case 35667:case 35671:return vie;case 35668:case 35672:return wie;case 35669:case 35673:return bie;case 5125:return Sie;case 36294:return Mie;case 36295:return Tie;case 36296:return Eie;case 35678:case 36198:case 36298:case 36306:case 35682:return Aie;case 35679:case 36299:case 36307:return Cie;case 35680:case 36300:case 36308:case 36293:return Iie;case 36289:case 36303:case 36311:case 36292:return Pie}}function kie(n,e){n.uniform1fv(this.addr,e)}function Die(n,e){const t=i0(e,this.size,2);n.uniform2fv(this.addr,t)}function Rie(n,e){const t=i0(e,this.size,3);n.uniform3fv(this.addr,t)}function zie(n,e){const t=i0(e,this.size,4);n.uniform4fv(this.addr,t)}function Oie(n,e){const t=i0(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function Fie(n,e){const t=i0(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Bie(n,e){const t=i0(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function Nie(n,e){n.uniform1iv(this.addr,e)}function Uie(n,e){n.uniform2iv(this.addr,e)}function Vie(n,e){n.uniform3iv(this.addr,e)}function Gie(n,e){n.uniform4iv(this.addr,e)}function Wie(n,e){n.uniform1uiv(this.addr,e)}function Hie(n,e){n.uniform2uiv(this.addr,e)}function jie(n,e){n.uniform3uiv(this.addr,e)}function qie(n,e){n.uniform4uiv(this.addr,e)}function Zie(n,e,t){const i=this.cache,r=e.length,o=oT(t,r);lo(i,o)||(n.uniform1iv(this.addr,o),co(i,o));for(let l=0;l!==r;++l)t.setTexture2D(e[l]||IV,o[l])}function Xie(n,e,t){const i=this.cache,r=e.length,o=oT(t,r);lo(i,o)||(n.uniform1iv(this.addr,o),co(i,o));for(let l=0;l!==r;++l)t.setTexture3D(e[l]||LV,o[l])}function $ie(n,e,t){const i=this.cache,r=e.length,o=oT(t,r);lo(i,o)||(n.uniform1iv(this.addr,o),co(i,o));for(let l=0;l!==r;++l)t.setTextureCube(e[l]||kV,o[l])}function Yie(n,e,t){const i=this.cache,r=e.length,o=oT(t,r);lo(i,o)||(n.uniform1iv(this.addr,o),co(i,o));for(let l=0;l!==r;++l)t.setTexture2DArray(e[l]||PV,o[l])}function Kie(n){switch(n){case 5126:return kie;case 35664:return Die;case 35665:return Rie;case 35666:return zie;case 35674:return Oie;case 35675:return Fie;case 35676:return Bie;case 5124:case 35670:return Nie;case 35667:case 35671:return Uie;case 35668:case 35672:return Vie;case 35669:case 35673:return Gie;case 5125:return Wie;case 36294:return Hie;case 36295:return jie;case 36296:return qie;case 35678:case 36198:case 36298:case 36306:case 35682:return Zie;case 35679:case 36299:case 36307:return Xie;case 35680:case 36300:case 36308:case 36293:return $ie;case 36289:case 36303:case 36311:case 36292:return Yie}}class Jie{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Lie(t.type)}}class Qie{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=Kie(t.type)}}class ere{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let o=0,l=r.length;o!==l;++o){const s=r[o];s.setValue(e,t[s.id],i)}}}const N2=/(\w+)(\])?(\[|\.)?/g;function qO(n,e){n.seq.push(e),n.map[e.id]=e}function tre(n,e,t){const i=n.name,r=i.length;for(N2.lastIndex=0;;){const o=N2.exec(i),l=N2.lastIndex;let s=o[1];const d=o[2]==="]",p=o[3];if(d&&(s=s|0),p===void 0||p==="["&&l+2===r){qO(t,p===void 0?new Jie(s,n,e):new Qie(s,n,e));break}else{let w=t.map[s];w===void 0&&(w=new ere(s),qO(t,w)),t=w}}}class SS{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const o=e.getActiveUniform(t,r),l=e.getUniformLocation(t,o.name);tre(o,l,this)}}setValue(e,t,i,r){const o=this.map[t];o!==void 0&&o.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let o=0,l=t.length;o!==l;++o){const s=t[o],d=i[s.id];d.needsUpdate!==!1&&s.setValue(e,d.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,o=e.length;r!==o;++r){const l=e[r];l.id in t&&i.push(l)}return i}}function ZO(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let nre=0;function ire(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let l=r;l<o;l++){const s=l+1;i.push(`${s===e?">":" "} ${s}: ${t[l]}`)}return i.join(`
`)}function rre(n){switch(n){case Jd:return["Linear","( value )"];case ar:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function XO(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const l=parseInt(o[1]);return t.toUpperCase()+`

`+r+`

`+ire(n.getShaderSource(e),l)}else return r}function sre(n,e){const t=rre(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ore(n,e){let t;switch(e){case q6:t="Linear";break;case Z6:t="Reinhard";break;case X6:t="OptimizedCineon";break;case _L:t="ACESFilmic";break;case $6:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function are(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Vx).join(`
`)}function lre(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function cre(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),l=o.name;let s=1;o.type===35674&&(s=2),o.type===35675&&(s=3),o.type===35676&&(s=4),t[l]={type:o.type,location:n.getAttribLocation(e,l),locationSize:s}}return t}function Vx(n){return n!==""}function $O(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function YO(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ure=/^[ \t]*#include +<([\w\d./]+)>/gm;function yI(n){return n.replace(ure,hre)}function hre(n,e){const t=Pi[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return yI(t)}const dre=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function KO(n){return n.replace(dre,fre)}function fre(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function JO(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function pre(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===eT?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===av?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Ym&&(e="SHADOWMAP_TYPE_VSM"),e}function mre(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Pp:case Lp:e="ENVMAP_TYPE_CUBE";break;case t0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function gre(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Lp:e="ENVMAP_MODE_REFRACTION";break}return e}function _re(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case x1:e="ENVMAP_BLENDING_MULTIPLY";break;case H6:e="ENVMAP_BLENDING_MIX";break;case j6:e="ENVMAP_BLENDING_ADD";break}return e}function yre(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function xre(n,e,t,i){const r=n.getContext(),o=t.defines;let l=t.vertexShader,s=t.fragmentShader;const d=pre(t),p=mre(t),_=gre(t),w=_re(t),M=yre(t),A=t.isWebGL2?"":are(t),P=lre(o),L=r.createProgram();let D,z,F=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(D=[P].filter(Vx).join(`
`),D.length>0&&(D+=`
`),z=[A,P].filter(Vx).join(`
`),z.length>0&&(z+=`
`)):(D=[JO(t),"#define SHADER_NAME "+t.shaderName,P,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+_:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Vx).join(`
`),z=[A,JO(t),"#define SHADER_NAME "+t.shaderName,P,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+_:"",t.envMap?"#define "+w:"",M?"#define CUBEUV_TEXEL_WIDTH "+M.texelWidth:"",M?"#define CUBEUV_TEXEL_HEIGHT "+M.texelHeight:"",M?"#define CUBEUV_MAX_MIP "+M.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Pu?"#define TONE_MAPPING":"",t.toneMapping!==Pu?Pi.tonemapping_pars_fragment:"",t.toneMapping!==Pu?ore("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pi.encodings_pars_fragment,sre("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Vx).join(`
`)),l=yI(l),l=$O(l,t),l=YO(l,t),s=yI(s),s=$O(s,t),s=YO(s,t),l=KO(l),s=KO(s),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(F=`#version 300 es
`,D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+D,z=["#define varying in",t.glslVersion===mI?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===mI?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+z);const N=F+D+l,V=F+z+s,j=ZO(r,35633,N),Q=ZO(r,35632,V);if(r.attachShader(L,j),r.attachShader(L,Q),t.index0AttributeName!==void 0?r.bindAttribLocation(L,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(L,0,"position"),r.linkProgram(L),n.debug.checkShaderErrors){const ne=r.getProgramInfoLog(L).trim(),he=r.getShaderInfoLog(j).trim(),De=r.getShaderInfoLog(Q).trim();let He=!0,ae=!0;if(r.getProgramParameter(L,35714)===!1){He=!1;const le=XO(r,j,"vertex"),fe=XO(r,Q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(L,35715)+`

Program Info Log: `+ne+`
`+le+`
`+fe)}else ne!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ne):(he===""||De==="")&&(ae=!1);ae&&(this.diagnostics={runnable:He,programLog:ne,vertexShader:{log:he,prefix:D},fragmentShader:{log:De,prefix:z}})}r.deleteShader(j),r.deleteShader(Q);let re;this.getUniforms=function(){return re===void 0&&(re=new SS(r,L)),re};let Z;return this.getAttributes=function(){return Z===void 0&&(Z=cre(r,L)),Z},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(L),this.program=void 0},this.name=t.shaderName,this.id=nre++,this.cacheKey=e,this.usedTimes=1,this.program=L,this.vertexShader=j,this.fragmentShader=Q,this}let vre=0;class wre{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),o=this._getShaderStage(i),l=this._getShaderCacheForMaterial(e);return l.has(r)===!1&&(l.add(r),r.usedTimes++),l.has(o)===!1&&(l.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new bre(e),t.set(e,i)),i}}class bre{constructor(e){this.id=vre++,this.code=e,this.usedTimes=0}}function Sre(n,e,t,i,r,o,l){const s=new dg,d=new wre,p=[],_=r.isWebGL2,w=r.logarithmicDepthBuffer,M=r.vertexTextures;let A=r.precision;const P={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(Z,ne,he,De,He){const ae=De.fog,le=He.geometry,fe=Z.isMeshStandardMaterial?De.environment:null,Oe=(Z.isMeshStandardMaterial?t:e).get(Z.envMap||fe),We=Oe&&Oe.mapping===t0?Oe.image.height:null,ce=P[Z.type];Z.precision!==null&&(A=r.getMaxPrecision(Z.precision),A!==Z.precision&&console.warn("THREE.WebGLProgram.getParameters:",Z.precision,"not supported, using",A,"instead."));const Te=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,Pe=Te!==void 0?Te.length:0;let Qe=0;le.morphAttributes.position!==void 0&&(Qe=1),le.morphAttributes.normal!==void 0&&(Qe=2),le.morphAttributes.color!==void 0&&(Qe=3);let Ne,nt,ze,et;if(ce){const Rn=Su[ce];Ne=Rn.vertexShader,nt=Rn.fragmentShader}else Ne=Z.vertexShader,nt=Z.fragmentShader,d.update(Z),ze=d.getVertexShaderID(Z),et=d.getFragmentShaderID(Z);const Et=n.getRenderTarget(),Nt=Z.alphaTest>0,qt=Z.clearcoat>0,wn=Z.iridescence>0;return{isWebGL2:_,shaderID:ce,shaderName:Z.type,vertexShader:Ne,fragmentShader:nt,defines:Z.defines,customVertexShaderID:ze,customFragmentShaderID:et,isRawShaderMaterial:Z.isRawShaderMaterial===!0,glslVersion:Z.glslVersion,precision:A,instancing:He.isInstancedMesh===!0,instancingColor:He.isInstancedMesh===!0&&He.instanceColor!==null,supportsVertexTextures:M,outputEncoding:Et===null?n.outputEncoding:Et.isXRRenderTarget===!0?Et.texture.encoding:Jd,map:!!Z.map,matcap:!!Z.matcap,envMap:!!Oe,envMapMode:Oe&&Oe.mapping,envMapCubeUVHeight:We,lightMap:!!Z.lightMap,aoMap:!!Z.aoMap,emissiveMap:!!Z.emissiveMap,bumpMap:!!Z.bumpMap,normalMap:!!Z.normalMap,objectSpaceNormalMap:Z.normalMapType===_V,tangentSpaceNormalMap:Z.normalMapType===Up,decodeVideoTexture:!!Z.map&&Z.map.isVideoTexture===!0&&Z.map.encoding===ar,clearcoat:qt,clearcoatMap:qt&&!!Z.clearcoatMap,clearcoatRoughnessMap:qt&&!!Z.clearcoatRoughnessMap,clearcoatNormalMap:qt&&!!Z.clearcoatNormalMap,iridescence:wn,iridescenceMap:wn&&!!Z.iridescenceMap,iridescenceThicknessMap:wn&&!!Z.iridescenceThicknessMap,displacementMap:!!Z.displacementMap,roughnessMap:!!Z.roughnessMap,metalnessMap:!!Z.metalnessMap,specularMap:!!Z.specularMap,specularIntensityMap:!!Z.specularIntensityMap,specularColorMap:!!Z.specularColorMap,opaque:Z.transparent===!1&&Z.blending===cg,alphaMap:!!Z.alphaMap,alphaTest:Nt,gradientMap:!!Z.gradientMap,sheen:Z.sheen>0,sheenColorMap:!!Z.sheenColorMap,sheenRoughnessMap:!!Z.sheenRoughnessMap,transmission:Z.transmission>0,transmissionMap:!!Z.transmissionMap,thicknessMap:!!Z.thicknessMap,combine:Z.combine,vertexTangents:!!Z.normalMap&&!!le.attributes.tangent,vertexColors:Z.vertexColors,vertexAlphas:Z.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,vertexUvs:!!Z.map||!!Z.bumpMap||!!Z.normalMap||!!Z.specularMap||!!Z.alphaMap||!!Z.emissiveMap||!!Z.roughnessMap||!!Z.metalnessMap||!!Z.clearcoatMap||!!Z.clearcoatRoughnessMap||!!Z.clearcoatNormalMap||!!Z.iridescenceMap||!!Z.iridescenceThicknessMap||!!Z.displacementMap||!!Z.transmissionMap||!!Z.thicknessMap||!!Z.specularIntensityMap||!!Z.specularColorMap||!!Z.sheenColorMap||!!Z.sheenRoughnessMap,uvsVertexOnly:!(Z.map||Z.bumpMap||Z.normalMap||Z.specularMap||Z.alphaMap||Z.emissiveMap||Z.roughnessMap||Z.metalnessMap||Z.clearcoatNormalMap||Z.iridescenceMap||Z.iridescenceThicknessMap||Z.transmission>0||Z.transmissionMap||Z.thicknessMap||Z.specularIntensityMap||Z.specularColorMap||Z.sheen>0||Z.sheenColorMap||Z.sheenRoughnessMap)&&!!Z.displacementMap,fog:!!ae,useFog:Z.fog===!0,fogExp2:ae&&ae.isFogExp2,flatShading:!!Z.flatShading,sizeAttenuation:Z.sizeAttenuation,logarithmicDepthBuffer:w,skinning:He.isSkinnedMesh===!0,morphTargets:le.morphAttributes.position!==void 0,morphNormals:le.morphAttributes.normal!==void 0,morphColors:le.morphAttributes.color!==void 0,morphTargetsCount:Pe,morphTextureStride:Qe,numDirLights:ne.directional.length,numPointLights:ne.point.length,numSpotLights:ne.spot.length,numSpotLightMaps:ne.spotLightMap.length,numRectAreaLights:ne.rectArea.length,numHemiLights:ne.hemi.length,numDirLightShadows:ne.directionalShadowMap.length,numPointLightShadows:ne.pointShadowMap.length,numSpotLightShadows:ne.spotShadowMap.length,numSpotLightShadowsWithMaps:ne.numSpotLightShadowsWithMaps,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:Z.dithering,shadowMapEnabled:n.shadowMap.enabled&&he.length>0,shadowMapType:n.shadowMap.type,toneMapping:Z.toneMapped?n.toneMapping:Pu,useLegacyLights:n.useLegacyLights,premultipliedAlpha:Z.premultipliedAlpha,doubleSided:Z.side===bh,flipSided:Z.side===il,useDepthPacking:!!Z.depthPacking,depthPacking:Z.depthPacking||0,index0AttributeName:Z.index0AttributeName,extensionDerivatives:Z.extensions&&Z.extensions.derivatives,extensionFragDepth:Z.extensions&&Z.extensions.fragDepth,extensionDrawBuffers:Z.extensions&&Z.extensions.drawBuffers,extensionShaderTextureLOD:Z.extensions&&Z.extensions.shaderTextureLOD,rendererExtensionFragDepth:_||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||i.has("EXT_shader_texture_lod"),customProgramCacheKey:Z.customProgramCacheKey()}}function D(Z){const ne=[];if(Z.shaderID?ne.push(Z.shaderID):(ne.push(Z.customVertexShaderID),ne.push(Z.customFragmentShaderID)),Z.defines!==void 0)for(const he in Z.defines)ne.push(he),ne.push(Z.defines[he]);return Z.isRawShaderMaterial===!1&&(z(ne,Z),F(ne,Z),ne.push(n.outputEncoding)),ne.push(Z.customProgramCacheKey),ne.join()}function z(Z,ne){Z.push(ne.precision),Z.push(ne.outputEncoding),Z.push(ne.envMapMode),Z.push(ne.envMapCubeUVHeight),Z.push(ne.combine),Z.push(ne.vertexUvs),Z.push(ne.fogExp2),Z.push(ne.sizeAttenuation),Z.push(ne.morphTargetsCount),Z.push(ne.morphAttributeCount),Z.push(ne.numDirLights),Z.push(ne.numPointLights),Z.push(ne.numSpotLights),Z.push(ne.numSpotLightMaps),Z.push(ne.numHemiLights),Z.push(ne.numRectAreaLights),Z.push(ne.numDirLightShadows),Z.push(ne.numPointLightShadows),Z.push(ne.numSpotLightShadows),Z.push(ne.numSpotLightShadowsWithMaps),Z.push(ne.shadowMapType),Z.push(ne.toneMapping),Z.push(ne.numClippingPlanes),Z.push(ne.numClipIntersection),Z.push(ne.depthPacking)}function F(Z,ne){s.disableAll(),ne.isWebGL2&&s.enable(0),ne.supportsVertexTextures&&s.enable(1),ne.instancing&&s.enable(2),ne.instancingColor&&s.enable(3),ne.map&&s.enable(4),ne.matcap&&s.enable(5),ne.envMap&&s.enable(6),ne.lightMap&&s.enable(7),ne.aoMap&&s.enable(8),ne.emissiveMap&&s.enable(9),ne.bumpMap&&s.enable(10),ne.normalMap&&s.enable(11),ne.objectSpaceNormalMap&&s.enable(12),ne.tangentSpaceNormalMap&&s.enable(13),ne.clearcoat&&s.enable(14),ne.clearcoatMap&&s.enable(15),ne.clearcoatRoughnessMap&&s.enable(16),ne.clearcoatNormalMap&&s.enable(17),ne.iridescence&&s.enable(18),ne.iridescenceMap&&s.enable(19),ne.iridescenceThicknessMap&&s.enable(20),ne.displacementMap&&s.enable(21),ne.specularMap&&s.enable(22),ne.roughnessMap&&s.enable(23),ne.metalnessMap&&s.enable(24),ne.gradientMap&&s.enable(25),ne.alphaMap&&s.enable(26),ne.alphaTest&&s.enable(27),ne.vertexColors&&s.enable(28),ne.vertexAlphas&&s.enable(29),ne.vertexUvs&&s.enable(30),ne.vertexTangents&&s.enable(31),ne.uvsVertexOnly&&s.enable(32),Z.push(s.mask),s.disableAll(),ne.fog&&s.enable(0),ne.useFog&&s.enable(1),ne.flatShading&&s.enable(2),ne.logarithmicDepthBuffer&&s.enable(3),ne.skinning&&s.enable(4),ne.morphTargets&&s.enable(5),ne.morphNormals&&s.enable(6),ne.morphColors&&s.enable(7),ne.premultipliedAlpha&&s.enable(8),ne.shadowMapEnabled&&s.enable(9),ne.useLegacyLights&&s.enable(10),ne.doubleSided&&s.enable(11),ne.flipSided&&s.enable(12),ne.useDepthPacking&&s.enable(13),ne.dithering&&s.enable(14),ne.specularIntensityMap&&s.enable(15),ne.specularColorMap&&s.enable(16),ne.transmission&&s.enable(17),ne.transmissionMap&&s.enable(18),ne.thicknessMap&&s.enable(19),ne.sheen&&s.enable(20),ne.sheenColorMap&&s.enable(21),ne.sheenRoughnessMap&&s.enable(22),ne.decodeVideoTexture&&s.enable(23),ne.opaque&&s.enable(24),Z.push(s.mask)}function N(Z){const ne=P[Z.type];let he;if(ne){const De=Su[ne];he=TV.clone(De.uniforms)}else he=Z.uniforms;return he}function V(Z,ne){let he;for(let De=0,He=p.length;De<He;De++){const ae=p[De];if(ae.cacheKey===ne){he=ae,++he.usedTimes;break}}return he===void 0&&(he=new xre(n,ne,Z,o),p.push(he)),he}function j(Z){if(--Z.usedTimes===0){const ne=p.indexOf(Z);p[ne]=p[p.length-1],p.pop(),Z.destroy()}}function Q(Z){d.remove(Z)}function re(){d.dispose()}return{getParameters:L,getProgramCacheKey:D,getUniforms:N,acquireProgram:V,releaseProgram:j,releaseShaderCache:Q,programs:p,dispose:re}}function Mre(){let n=new WeakMap;function e(o){let l=n.get(o);return l===void 0&&(l={},n.set(o,l)),l}function t(o){n.delete(o)}function i(o,l,s){n.get(o)[l]=s}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function Tre(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function QO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function eF(){const n=[];let e=0;const t=[],i=[],r=[];function o(){e=0,t.length=0,i.length=0,r.length=0}function l(w,M,A,P,L,D){let z=n[e];return z===void 0?(z={id:w.id,object:w,geometry:M,material:A,groupOrder:P,renderOrder:w.renderOrder,z:L,group:D},n[e]=z):(z.id=w.id,z.object=w,z.geometry=M,z.material=A,z.groupOrder=P,z.renderOrder=w.renderOrder,z.z=L,z.group=D),e++,z}function s(w,M,A,P,L,D){const z=l(w,M,A,P,L,D);A.transmission>0?i.push(z):A.transparent===!0?r.push(z):t.push(z)}function d(w,M,A,P,L,D){const z=l(w,M,A,P,L,D);A.transmission>0?i.unshift(z):A.transparent===!0?r.unshift(z):t.unshift(z)}function p(w,M){t.length>1&&t.sort(w||Tre),i.length>1&&i.sort(M||QO),r.length>1&&r.sort(M||QO)}function _(){for(let w=e,M=n.length;w<M;w++){const A=n[w];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:t,transmissive:i,transparent:r,init:o,push:s,unshift:d,finish:_,sort:p}}function Ere(){let n=new WeakMap;function e(i,r){const o=n.get(i);let l;return o===void 0?(l=new eF,n.set(i,[l])):r>=o.length?(l=new eF,o.push(l)):l=o[r],l}function t(){n=new WeakMap}return{get:e,dispose:t}}function Are(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Fe,color:new An};break;case"SpotLight":t={position:new Fe,direction:new Fe,color:new An,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Fe,color:new An,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Fe,skyColor:new An,groundColor:new An};break;case"RectAreaLight":t={color:new An,position:new Fe,halfWidth:new Fe,halfHeight:new Fe};break}return n[e.id]=t,t}}}function Cre(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Gt};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Gt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Gt,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let Ire=0;function Pre(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function Lre(n,e){const t=new Are,i=Cre(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let _=0;_<9;_++)r.probe.push(new Fe);const o=new Fe,l=new hi,s=new hi;function d(_,w){let M=0,A=0,P=0;for(let De=0;De<9;De++)r.probe[De].set(0,0,0);let L=0,D=0,z=0,F=0,N=0,V=0,j=0,Q=0,re=0,Z=0;_.sort(Pre);const ne=w===!0?Math.PI:1;for(let De=0,He=_.length;De<He;De++){const ae=_[De],le=ae.color,fe=ae.intensity,Oe=ae.distance,We=ae.shadow&&ae.shadow.map?ae.shadow.map.texture:null;if(ae.isAmbientLight)M+=le.r*fe*ne,A+=le.g*fe*ne,P+=le.b*fe*ne;else if(ae.isLightProbe)for(let ce=0;ce<9;ce++)r.probe[ce].addScaledVector(ae.sh.coefficients[ce],fe);else if(ae.isDirectionalLight){const ce=t.get(ae);if(ce.color.copy(ae.color).multiplyScalar(ae.intensity*ne),ae.castShadow){const Te=ae.shadow,Pe=i.get(ae);Pe.shadowBias=Te.bias,Pe.shadowNormalBias=Te.normalBias,Pe.shadowRadius=Te.radius,Pe.shadowMapSize=Te.mapSize,r.directionalShadow[L]=Pe,r.directionalShadowMap[L]=We,r.directionalShadowMatrix[L]=ae.shadow.matrix,V++}r.directional[L]=ce,L++}else if(ae.isSpotLight){const ce=t.get(ae);ce.position.setFromMatrixPosition(ae.matrixWorld),ce.color.copy(le).multiplyScalar(fe*ne),ce.distance=Oe,ce.coneCos=Math.cos(ae.angle),ce.penumbraCos=Math.cos(ae.angle*(1-ae.penumbra)),ce.decay=ae.decay,r.spot[z]=ce;const Te=ae.shadow;if(ae.map&&(r.spotLightMap[re]=ae.map,re++,Te.updateMatrices(ae),ae.castShadow&&Z++),r.spotLightMatrix[z]=Te.matrix,ae.castShadow){const Pe=i.get(ae);Pe.shadowBias=Te.bias,Pe.shadowNormalBias=Te.normalBias,Pe.shadowRadius=Te.radius,Pe.shadowMapSize=Te.mapSize,r.spotShadow[z]=Pe,r.spotShadowMap[z]=We,Q++}z++}else if(ae.isRectAreaLight){const ce=t.get(ae);ce.color.copy(le).multiplyScalar(fe),ce.halfWidth.set(ae.width*.5,0,0),ce.halfHeight.set(0,ae.height*.5,0),r.rectArea[F]=ce,F++}else if(ae.isPointLight){const ce=t.get(ae);if(ce.color.copy(ae.color).multiplyScalar(ae.intensity*ne),ce.distance=ae.distance,ce.decay=ae.decay,ae.castShadow){const Te=ae.shadow,Pe=i.get(ae);Pe.shadowBias=Te.bias,Pe.shadowNormalBias=Te.normalBias,Pe.shadowRadius=Te.radius,Pe.shadowMapSize=Te.mapSize,Pe.shadowCameraNear=Te.camera.near,Pe.shadowCameraFar=Te.camera.far,r.pointShadow[D]=Pe,r.pointShadowMap[D]=We,r.pointShadowMatrix[D]=ae.shadow.matrix,j++}r.point[D]=ce,D++}else if(ae.isHemisphereLight){const ce=t.get(ae);ce.skyColor.copy(ae.color).multiplyScalar(fe*ne),ce.groundColor.copy(ae.groundColor).multiplyScalar(fe*ne),r.hemi[N]=ce,N++}}F>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=vn.LTC_FLOAT_1,r.rectAreaLTC2=vn.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=vn.LTC_HALF_1,r.rectAreaLTC2=vn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=M,r.ambient[1]=A,r.ambient[2]=P;const he=r.hash;(he.directionalLength!==L||he.pointLength!==D||he.spotLength!==z||he.rectAreaLength!==F||he.hemiLength!==N||he.numDirectionalShadows!==V||he.numPointShadows!==j||he.numSpotShadows!==Q||he.numSpotMaps!==re)&&(r.directional.length=L,r.spot.length=z,r.rectArea.length=F,r.point.length=D,r.hemi.length=N,r.directionalShadow.length=V,r.directionalShadowMap.length=V,r.pointShadow.length=j,r.pointShadowMap.length=j,r.spotShadow.length=Q,r.spotShadowMap.length=Q,r.directionalShadowMatrix.length=V,r.pointShadowMatrix.length=j,r.spotLightMatrix.length=Q+re-Z,r.spotLightMap.length=re,r.numSpotLightShadowsWithMaps=Z,he.directionalLength=L,he.pointLength=D,he.spotLength=z,he.rectAreaLength=F,he.hemiLength=N,he.numDirectionalShadows=V,he.numPointShadows=j,he.numSpotShadows=Q,he.numSpotMaps=re,r.version=Ire++)}function p(_,w){let M=0,A=0,P=0,L=0,D=0;const z=w.matrixWorldInverse;for(let F=0,N=_.length;F<N;F++){const V=_[F];if(V.isDirectionalLight){const j=r.directional[M];j.direction.setFromMatrixPosition(V.matrixWorld),o.setFromMatrixPosition(V.target.matrixWorld),j.direction.sub(o),j.direction.transformDirection(z),M++}else if(V.isSpotLight){const j=r.spot[P];j.position.setFromMatrixPosition(V.matrixWorld),j.position.applyMatrix4(z),j.direction.setFromMatrixPosition(V.matrixWorld),o.setFromMatrixPosition(V.target.matrixWorld),j.direction.sub(o),j.direction.transformDirection(z),P++}else if(V.isRectAreaLight){const j=r.rectArea[L];j.position.setFromMatrixPosition(V.matrixWorld),j.position.applyMatrix4(z),s.identity(),l.copy(V.matrixWorld),l.premultiply(z),s.extractRotation(l),j.halfWidth.set(V.width*.5,0,0),j.halfHeight.set(0,V.height*.5,0),j.halfWidth.applyMatrix4(s),j.halfHeight.applyMatrix4(s),L++}else if(V.isPointLight){const j=r.point[A];j.position.setFromMatrixPosition(V.matrixWorld),j.position.applyMatrix4(z),A++}else if(V.isHemisphereLight){const j=r.hemi[D];j.direction.setFromMatrixPosition(V.matrixWorld),j.direction.transformDirection(z),D++}}}return{setup:d,setupView:p,state:r}}function tF(n,e){const t=new Lre(n,e),i=[],r=[];function o(){i.length=0,r.length=0}function l(w){i.push(w)}function s(w){r.push(w)}function d(w){t.setup(i,w)}function p(w){t.setupView(i,w)}return{init:o,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:d,setupLightsView:p,pushLight:l,pushShadow:s}}function kre(n,e){let t=new WeakMap;function i(o,l=0){const s=t.get(o);let d;return s===void 0?(d=new tF(n,e),t.set(o,[d])):l>=s.length?(d=new tF(n,e),s.push(d)):d=s[l],d}function r(){t=new WeakMap}return{get:i,dispose:r}}class CL extends Zs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=mV,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class IL extends Zs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Fe,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Dre=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Rre=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function zre(n,e,t){let i=new sT;const r=new Gt,o=new Gt,l=new Tr,s=new CL({depthPacking:gV}),d=new IL,p={},_=t.maxTextureSize,w={[Ih]:il,[il]:Ih,[bh]:bh},M=new Lh({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Gt},radius:{value:4}},vertexShader:Dre,fragmentShader:Rre}),A=M.clone();A.defines.HORIZONTAL_PASS=1;const P=new Ti;P.setAttribute("position",new vr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new To(P,M),D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=eT,this.render=function(V,j,Q){if(D.enabled===!1||D.autoUpdate===!1&&D.needsUpdate===!1||V.length===0)return;const re=n.getRenderTarget(),Z=n.getActiveCubeFace(),ne=n.getActiveMipmapLevel(),he=n.state;he.setBlending(Gd),he.buffers.color.setClear(1,1,1,1),he.buffers.depth.setTest(!0),he.setScissorTest(!1);for(let De=0,He=V.length;De<He;De++){const ae=V[De],le=ae.shadow;if(le===void 0){console.warn("THREE.WebGLShadowMap:",ae,"has no shadow.");continue}if(le.autoUpdate===!1&&le.needsUpdate===!1)continue;r.copy(le.mapSize);const fe=le.getFrameExtents();if(r.multiply(fe),o.copy(le.mapSize),(r.x>_||r.y>_)&&(r.x>_&&(o.x=Math.floor(_/fe.x),r.x=o.x*fe.x,le.mapSize.x=o.x),r.y>_&&(o.y=Math.floor(_/fe.y),r.y=o.y*fe.y,le.mapSize.y=o.y)),le.map===null){const We=this.type!==Ym?{minFilter:Ss,magFilter:Ss}:{};le.map=new Du(r.x,r.y,We),le.map.texture.name=ae.name+".shadowMap",le.camera.updateProjectionMatrix()}n.setRenderTarget(le.map),n.clear();const Oe=le.getViewportCount();for(let We=0;We<Oe;We++){const ce=le.getViewport(We);l.set(o.x*ce.x,o.y*ce.y,o.x*ce.z,o.y*ce.w),he.viewport(l),le.updateMatrices(ae,We),i=le.getFrustum(),N(j,Q,le.camera,ae,this.type)}le.isPointLightShadow!==!0&&this.type===Ym&&z(le,Q),le.needsUpdate=!1}D.needsUpdate=!1,n.setRenderTarget(re,Z,ne)};function z(V,j){const Q=e.update(L);M.defines.VSM_SAMPLES!==V.blurSamples&&(M.defines.VSM_SAMPLES=V.blurSamples,A.defines.VSM_SAMPLES=V.blurSamples,M.needsUpdate=!0,A.needsUpdate=!0),V.mapPass===null&&(V.mapPass=new Du(r.x,r.y)),M.uniforms.shadow_pass.value=V.map.texture,M.uniforms.resolution.value=V.mapSize,M.uniforms.radius.value=V.radius,n.setRenderTarget(V.mapPass),n.clear(),n.renderBufferDirect(j,null,Q,M,L,null),A.uniforms.shadow_pass.value=V.mapPass.texture,A.uniforms.resolution.value=V.mapSize,A.uniforms.radius.value=V.radius,n.setRenderTarget(V.map),n.clear(),n.renderBufferDirect(j,null,Q,A,L,null)}function F(V,j,Q,re,Z,ne){let he=null;const De=Q.isPointLight===!0?V.customDistanceMaterial:V.customDepthMaterial;if(De!==void 0)he=De;else if(he=Q.isPointLight===!0?d:s,n.localClippingEnabled&&j.clipShadows===!0&&Array.isArray(j.clippingPlanes)&&j.clippingPlanes.length!==0||j.displacementMap&&j.displacementScale!==0||j.alphaMap&&j.alphaTest>0||j.map&&j.alphaTest>0){const He=he.uuid,ae=j.uuid;let le=p[He];le===void 0&&(le={},p[He]=le);let fe=le[ae];fe===void 0&&(fe=he.clone(),le[ae]=fe),he=fe}return he.visible=j.visible,he.wireframe=j.wireframe,ne===Ym?he.side=j.shadowSide!==null?j.shadowSide:j.side:he.side=j.shadowSide!==null?j.shadowSide:w[j.side],he.alphaMap=j.alphaMap,he.alphaTest=j.alphaTest,he.map=j.map,he.clipShadows=j.clipShadows,he.clippingPlanes=j.clippingPlanes,he.clipIntersection=j.clipIntersection,he.displacementMap=j.displacementMap,he.displacementScale=j.displacementScale,he.displacementBias=j.displacementBias,he.wireframeLinewidth=j.wireframeLinewidth,he.linewidth=j.linewidth,Q.isPointLight===!0&&he.isMeshDistanceMaterial===!0&&(he.referencePosition.setFromMatrixPosition(Q.matrixWorld),he.nearDistance=re,he.farDistance=Z),he}function N(V,j,Q,re,Z){if(V.visible===!1)return;if(V.layers.test(j.layers)&&(V.isMesh||V.isLine||V.isPoints)&&(V.castShadow||V.receiveShadow&&Z===Ym)&&(!V.frustumCulled||i.intersectsObject(V))){V.modelViewMatrix.multiplyMatrices(Q.matrixWorldInverse,V.matrixWorld);const De=e.update(V),He=V.material;if(Array.isArray(He)){const ae=De.groups;for(let le=0,fe=ae.length;le<fe;le++){const Oe=ae[le],We=He[Oe.materialIndex];if(We&&We.visible){const ce=F(V,We,re,Q.near,Q.far,Z);n.renderBufferDirect(Q,null,De,ce,V,Oe)}}}else if(He.visible){const ae=F(V,He,re,Q.near,Q.far,Z);n.renderBufferDirect(Q,null,De,ae,V,null)}}const he=V.children;for(let De=0,He=he.length;De<He;De++)N(he[De],j,Q,re,Z)}}function Ore(n,e,t){const i=t.isWebGL2;function r(){let rt=!1;const Ct=new Tr;let Vt=null;const bn=new Tr(0,0,0,0);return{setMask:function(Ln){Vt!==Ln&&!rt&&(n.colorMask(Ln,Ln,Ln,Ln),Vt=Ln)},setLocked:function(Ln){rt=Ln},setClear:function(Ln,Ri,hr,Fr,Pr){Pr===!0&&(Ln*=Fr,Ri*=Fr,hr*=Fr),Ct.set(Ln,Ri,hr,Fr),bn.equals(Ct)===!1&&(n.clearColor(Ln,Ri,hr,Fr),bn.copy(Ct))},reset:function(){rt=!1,Vt=null,bn.set(-1,0,0,0)}}}function o(){let rt=!1,Ct=null,Vt=null,bn=null;return{setTest:function(Ln){Ln?Nt(2929):qt(2929)},setMask:function(Ln){Ct!==Ln&&!rt&&(n.depthMask(Ln),Ct=Ln)},setFunc:function(Ln){if(Vt!==Ln){switch(Ln){case F6:n.depthFunc(512);break;case B6:n.depthFunc(519);break;case N6:n.depthFunc(513);break;case gM:n.depthFunc(515);break;case U6:n.depthFunc(514);break;case V6:n.depthFunc(518);break;case G6:n.depthFunc(516);break;case W6:n.depthFunc(517);break;default:n.depthFunc(515)}Vt=Ln}},setLocked:function(Ln){rt=Ln},setClear:function(Ln){bn!==Ln&&(n.clearDepth(Ln),bn=Ln)},reset:function(){rt=!1,Ct=null,Vt=null,bn=null}}}function l(){let rt=!1,Ct=null,Vt=null,bn=null,Ln=null,Ri=null,hr=null,Fr=null,Pr=null;return{setTest:function(Gi){rt||(Gi?Nt(2960):qt(2960))},setMask:function(Gi){Ct!==Gi&&!rt&&(n.stencilMask(Gi),Ct=Gi)},setFunc:function(Gi,es,Ee){(Vt!==Gi||bn!==es||Ln!==Ee)&&(n.stencilFunc(Gi,es,Ee),Vt=Gi,bn=es,Ln=Ee)},setOp:function(Gi,es,Ee){(Ri!==Gi||hr!==es||Fr!==Ee)&&(n.stencilOp(Gi,es,Ee),Ri=Gi,hr=es,Fr=Ee)},setLocked:function(Gi){rt=Gi},setClear:function(Gi){Pr!==Gi&&(n.clearStencil(Gi),Pr=Gi)},reset:function(){rt=!1,Ct=null,Vt=null,bn=null,Ln=null,Ri=null,hr=null,Fr=null,Pr=null}}}const s=new r,d=new o,p=new l,_=new WeakMap,w=new WeakMap;let M={},A={},P=new WeakMap,L=[],D=null,z=!1,F=null,N=null,V=null,j=null,Q=null,re=null,Z=null,ne=!1,he=null,De=null,He=null,ae=null,le=null;const fe=n.getParameter(35661);let Oe=!1,We=0;const ce=n.getParameter(7938);ce.indexOf("WebGL")!==-1?(We=parseFloat(/^WebGL (\d)/.exec(ce)[1]),Oe=We>=1):ce.indexOf("OpenGL ES")!==-1&&(We=parseFloat(/^OpenGL ES (\d)/.exec(ce)[1]),Oe=We>=2);let Te=null,Pe={};const Qe=n.getParameter(3088),Ne=n.getParameter(2978),nt=new Tr().fromArray(Qe),ze=new Tr().fromArray(Ne);function et(rt,Ct,Vt){const bn=new Uint8Array(4),Ln=n.createTexture();n.bindTexture(rt,Ln),n.texParameteri(rt,10241,9728),n.texParameteri(rt,10240,9728);for(let Ri=0;Ri<Vt;Ri++)n.texImage2D(Ct+Ri,0,6408,1,1,0,6408,5121,bn);return Ln}const Et={};Et[3553]=et(3553,3553,1),Et[34067]=et(34067,34069,6),s.setClear(0,0,0,1),d.setClear(1),p.setClear(0),Nt(2929),d.setFunc(gM),pn(!1),Vn(UC),Nt(2884),Ft(Gd);function Nt(rt){M[rt]!==!0&&(n.enable(rt),M[rt]=!0)}function qt(rt){M[rt]!==!1&&(n.disable(rt),M[rt]=!1)}function wn(rt,Ct){return A[rt]!==Ct?(n.bindFramebuffer(rt,Ct),A[rt]=Ct,i&&(rt===36009&&(A[36160]=Ct),rt===36160&&(A[36009]=Ct)),!0):!1}function _n(rt,Ct){let Vt=L,bn=!1;if(rt)if(Vt=P.get(Ct),Vt===void 0&&(Vt=[],P.set(Ct,Vt)),rt.isWebGLMultipleRenderTargets){const Ln=rt.texture;if(Vt.length!==Ln.length||Vt[0]!==36064){for(let Ri=0,hr=Ln.length;Ri<hr;Ri++)Vt[Ri]=36064+Ri;Vt.length=Ln.length,bn=!0}}else Vt[0]!==36064&&(Vt[0]=36064,bn=!0);else Vt[0]!==1029&&(Vt[0]=1029,bn=!0);bn&&(t.isWebGL2?n.drawBuffers(Vt):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Vt))}function Rn(rt){return D!==rt?(n.useProgram(rt),D=rt,!0):!1}const At={[Wm]:32774,[E6]:32778,[A6]:32779};if(i)At[HC]=32775,At[jC]=32776;else{const rt=e.get("EXT_blend_minmax");rt!==null&&(At[HC]=rt.MIN_EXT,At[jC]=rt.MAX_EXT)}const Ot={[C6]:0,[I6]:1,[P6]:768,[mL]:770,[O6]:776,[R6]:774,[k6]:772,[L6]:769,[gL]:771,[z6]:775,[D6]:773};function Ft(rt,Ct,Vt,bn,Ln,Ri,hr,Fr){if(rt===Gd){z===!0&&(qt(3042),z=!1);return}if(z===!1&&(Nt(3042),z=!0),rt!==T6){if(rt!==F||Fr!==ne){if((N!==Wm||Q!==Wm)&&(n.blendEquation(32774),N=Wm,Q=Wm),Fr)switch(rt){case cg:n.blendFuncSeparate(1,771,1,771);break;case VC:n.blendFunc(1,1);break;case GC:n.blendFuncSeparate(0,769,0,1);break;case WC:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",rt);break}else switch(rt){case cg:n.blendFuncSeparate(770,771,1,771);break;case VC:n.blendFunc(770,1);break;case GC:n.blendFuncSeparate(0,769,0,1);break;case WC:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",rt);break}V=null,j=null,re=null,Z=null,F=rt,ne=Fr}return}Ln=Ln||Ct,Ri=Ri||Vt,hr=hr||bn,(Ct!==N||Ln!==Q)&&(n.blendEquationSeparate(At[Ct],At[Ln]),N=Ct,Q=Ln),(Vt!==V||bn!==j||Ri!==re||hr!==Z)&&(n.blendFuncSeparate(Ot[Vt],Ot[bn],Ot[Ri],Ot[hr]),V=Vt,j=bn,re=Ri,Z=hr),F=rt,ne=!1}function Cn(rt,Ct){rt.side===bh?qt(2884):Nt(2884);let Vt=rt.side===il;Ct&&(Vt=!Vt),pn(Vt),rt.blending===cg&&rt.transparent===!1?Ft(Gd):Ft(rt.blending,rt.blendEquation,rt.blendSrc,rt.blendDst,rt.blendEquationAlpha,rt.blendSrcAlpha,rt.blendDstAlpha,rt.premultipliedAlpha),d.setFunc(rt.depthFunc),d.setTest(rt.depthTest),d.setMask(rt.depthWrite),s.setMask(rt.colorWrite);const bn=rt.stencilWrite;p.setTest(bn),bn&&(p.setMask(rt.stencilWriteMask),p.setFunc(rt.stencilFunc,rt.stencilRef,rt.stencilFuncMask),p.setOp(rt.stencilFail,rt.stencilZFail,rt.stencilZPass)),Zn(rt.polygonOffset,rt.polygonOffsetFactor,rt.polygonOffsetUnits),rt.alphaToCoverage===!0?Nt(32926):qt(32926)}function pn(rt){he!==rt&&(rt?n.frontFace(2304):n.frontFace(2305),he=rt)}function Vn(rt){rt!==b6?(Nt(2884),rt!==De&&(rt===UC?n.cullFace(1029):rt===S6?n.cullFace(1028):n.cullFace(1032))):qt(2884),De=rt}function On(rt){rt!==He&&(Oe&&n.lineWidth(rt),He=rt)}function Zn(rt,Ct,Vt){rt?(Nt(32823),(ae!==Ct||le!==Vt)&&(n.polygonOffset(Ct,Vt),ae=Ct,le=Vt)):qt(32823)}function ai(rt){rt?Nt(3089):qt(3089)}function Ei(rt){rt===void 0&&(rt=33984+fe-1),Te!==rt&&(n.activeTexture(rt),Te=rt)}function Be(rt,Ct,Vt){Vt===void 0&&(Te===null?Vt=33984+fe-1:Vt=Te);let bn=Pe[Vt];bn===void 0&&(bn={type:void 0,texture:void 0},Pe[Vt]=bn),(bn.type!==rt||bn.texture!==Ct)&&(Te!==Vt&&(n.activeTexture(Vt),Te=Vt),n.bindTexture(rt,Ct||Et[rt]),bn.type=rt,bn.texture=Ct)}function Se(){const rt=Pe[Te];rt!==void 0&&rt.type!==void 0&&(n.bindTexture(rt.type,null),rt.type=void 0,rt.texture=void 0)}function St(){try{n.compressedTexImage2D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function tn(){try{n.compressedTexImage3D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function nn(){try{n.texSubImage2D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function fn(){try{n.texSubImage3D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function Nn(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function yn(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function Dt(){try{n.texStorage2D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function Un(){try{n.texStorage3D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function Je(){try{n.texImage2D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function It(){try{n.texImage3D.apply(n,arguments)}catch(rt){console.error("THREE.WebGLState:",rt)}}function Zt(rt){nt.equals(rt)===!1&&(n.scissor(rt.x,rt.y,rt.z,rt.w),nt.copy(rt))}function sn(rt){ze.equals(rt)===!1&&(n.viewport(rt.x,rt.y,rt.z,rt.w),ze.copy(rt))}function Yn(rt,Ct){let Vt=w.get(Ct);Vt===void 0&&(Vt=new WeakMap,w.set(Ct,Vt));let bn=Vt.get(rt);bn===void 0&&(bn=n.getUniformBlockIndex(Ct,rt.name),Vt.set(rt,bn))}function li(rt,Ct){const bn=w.get(Ct).get(rt);_.get(Ct)!==bn&&(n.uniformBlockBinding(Ct,bn,rt.__bindingPointIndex),_.set(Ct,bn))}function Bi(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),i===!0&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),M={},Te=null,Pe={},A={},P=new WeakMap,L=[],D=null,z=!1,F=null,N=null,V=null,j=null,Q=null,re=null,Z=null,ne=!1,he=null,De=null,He=null,ae=null,le=null,nt.set(0,0,n.canvas.width,n.canvas.height),ze.set(0,0,n.canvas.width,n.canvas.height),s.reset(),d.reset(),p.reset()}return{buffers:{color:s,depth:d,stencil:p},enable:Nt,disable:qt,bindFramebuffer:wn,drawBuffers:_n,useProgram:Rn,setBlending:Ft,setMaterial:Cn,setFlipSided:pn,setCullFace:Vn,setLineWidth:On,setPolygonOffset:Zn,setScissorTest:ai,activeTexture:Ei,bindTexture:Be,unbindTexture:Se,compressedTexImage2D:St,compressedTexImage3D:tn,texImage2D:Je,texImage3D:It,updateUBOMapping:Yn,uniformBlockBinding:li,texStorage2D:Dt,texStorage3D:Un,texSubImage2D:nn,texSubImage3D:fn,compressedTexSubImage2D:Nn,compressedTexSubImage3D:yn,scissor:Zt,viewport:sn,reset:Bi}}function Fre(n,e,t,i,r,o,l){const s=r.isWebGL2,d=r.maxTextures,p=r.maxCubemapSize,_=r.maxTextureSize,w=r.maxSamples,M=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,A=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),P=new WeakMap;let L;const D=new WeakMap;let z=!1;try{z=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function F(Be,Se){return z?new OffscreenCanvas(Be,Se):qv("canvas")}function N(Be,Se,St,tn){let nn=1;if((Be.width>tn||Be.height>tn)&&(nn=tn/Math.max(Be.width,Be.height)),nn<1||Se===!0)if(typeof HTMLImageElement<"u"&&Be instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Be instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Be instanceof ImageBitmap){const fn=Se?vV:Math.floor,Nn=fn(nn*Be.width),yn=fn(nn*Be.height);L===void 0&&(L=F(Nn,yn));const Dt=St?F(Nn,yn):L;return Dt.width=Nn,Dt.height=yn,Dt.getContext("2d").drawImage(Be,0,0,Nn,yn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Be.width+"x"+Be.height+") to ("+Nn+"x"+yn+")."),Dt}else return"data"in Be&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Be.width+"x"+Be.height+")."),Be;return Be}function V(Be){return gI(Be.width)&&gI(Be.height)}function j(Be){return s?!1:Be.wrapS!==No||Be.wrapT!==No||Be.minFilter!==Ss&&Be.minFilter!==cs}function Q(Be,Se){return Be.generateMipmaps&&Se&&Be.minFilter!==Ss&&Be.minFilter!==cs}function re(Be){n.generateMipmap(Be)}function Z(Be,Se,St,tn,nn=!1){if(s===!1)return Se;if(Be!==null){if(n[Be]!==void 0)return n[Be];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Be+"'")}let fn=Se;return Se===6403&&(St===5126&&(fn=33326),St===5131&&(fn=33325),St===5121&&(fn=33321)),Se===33319&&(St===5126&&(fn=33328),St===5131&&(fn=33327),St===5121&&(fn=33323)),Se===6408&&(St===5126&&(fn=34836),St===5131&&(fn=34842),St===5121&&(fn=tn===ar&&nn===!1?35907:32856),St===32819&&(fn=32854),St===32820&&(fn=32855)),(fn===33325||fn===33326||fn===33327||fn===33328||fn===34842||fn===34836)&&e.get("EXT_color_buffer_float"),fn}function ne(Be,Se,St){return Q(Be,St)===!0||Be.isFramebufferTexture&&Be.minFilter!==Ss&&Be.minFilter!==cs?Math.log2(Math.max(Se.width,Se.height))+1:Be.mipmaps!==void 0&&Be.mipmaps.length>0?Be.mipmaps.length:Be.isCompressedTexture&&Array.isArray(Be.image)?Se.mipmaps.length:1}function he(Be){return Be===Ss||Be===Gv||Be===my?9728:9729}function De(Be){const Se=Be.target;Se.removeEventListener("dispose",De),ae(Se),Se.isVideoTexture&&P.delete(Se)}function He(Be){const Se=Be.target;Se.removeEventListener("dispose",He),fe(Se)}function ae(Be){const Se=i.get(Be);if(Se.__webglInit===void 0)return;const St=Be.source,tn=D.get(St);if(tn){const nn=tn[Se.__cacheKey];nn.usedTimes--,nn.usedTimes===0&&le(Be),Object.keys(tn).length===0&&D.delete(St)}i.remove(Be)}function le(Be){const Se=i.get(Be);n.deleteTexture(Se.__webglTexture);const St=Be.source,tn=D.get(St);delete tn[Se.__cacheKey],l.memory.textures--}function fe(Be){const Se=Be.texture,St=i.get(Be),tn=i.get(Se);if(tn.__webglTexture!==void 0&&(n.deleteTexture(tn.__webglTexture),l.memory.textures--),Be.depthTexture&&Be.depthTexture.dispose(),Be.isWebGLCubeRenderTarget)for(let nn=0;nn<6;nn++)n.deleteFramebuffer(St.__webglFramebuffer[nn]),St.__webglDepthbuffer&&n.deleteRenderbuffer(St.__webglDepthbuffer[nn]);else{if(n.deleteFramebuffer(St.__webglFramebuffer),St.__webglDepthbuffer&&n.deleteRenderbuffer(St.__webglDepthbuffer),St.__webglMultisampledFramebuffer&&n.deleteFramebuffer(St.__webglMultisampledFramebuffer),St.__webglColorRenderbuffer)for(let nn=0;nn<St.__webglColorRenderbuffer.length;nn++)St.__webglColorRenderbuffer[nn]&&n.deleteRenderbuffer(St.__webglColorRenderbuffer[nn]);St.__webglDepthRenderbuffer&&n.deleteRenderbuffer(St.__webglDepthRenderbuffer)}if(Be.isWebGLMultipleRenderTargets)for(let nn=0,fn=Se.length;nn<fn;nn++){const Nn=i.get(Se[nn]);Nn.__webglTexture&&(n.deleteTexture(Nn.__webglTexture),l.memory.textures--),i.remove(Se[nn])}i.remove(Se),i.remove(Be)}let Oe=0;function We(){Oe=0}function ce(){const Be=Oe;return Be>=d&&console.warn("THREE.WebGLTextures: Trying to use "+Be+" texture units while this GPU supports only "+d),Oe+=1,Be}function Te(Be){const Se=[];return Se.push(Be.wrapS),Se.push(Be.wrapT),Se.push(Be.wrapR||0),Se.push(Be.magFilter),Se.push(Be.minFilter),Se.push(Be.anisotropy),Se.push(Be.internalFormat),Se.push(Be.format),Se.push(Be.type),Se.push(Be.generateMipmaps),Se.push(Be.premultiplyAlpha),Se.push(Be.flipY),Se.push(Be.unpackAlignment),Se.push(Be.encoding),Se.join()}function Pe(Be,Se){const St=i.get(Be);if(Be.isVideoTexture&&ai(Be),Be.isRenderTargetTexture===!1&&Be.version>0&&St.__version!==Be.version){const tn=Be.image;if(tn===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(tn.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{qt(St,Be,Se);return}}t.bindTexture(3553,St.__webglTexture,33984+Se)}function Qe(Be,Se){const St=i.get(Be);if(Be.version>0&&St.__version!==Be.version){qt(St,Be,Se);return}t.bindTexture(35866,St.__webglTexture,33984+Se)}function Ne(Be,Se){const St=i.get(Be);if(Be.version>0&&St.__version!==Be.version){qt(St,Be,Se);return}t.bindTexture(32879,St.__webglTexture,33984+Se)}function nt(Be,Se){const St=i.get(Be);if(Be.version>0&&St.__version!==Be.version){wn(St,Be,Se);return}t.bindTexture(34067,St.__webglTexture,33984+Se)}const ze={[kp]:10497,[No]:33071,[Oy]:33648},et={[Ss]:9728,[Gv]:9984,[my]:9986,[cs]:9729,[nT]:9985,[Ph]:9987};function Et(Be,Se,St){if(St?(n.texParameteri(Be,10242,ze[Se.wrapS]),n.texParameteri(Be,10243,ze[Se.wrapT]),(Be===32879||Be===35866)&&n.texParameteri(Be,32882,ze[Se.wrapR]),n.texParameteri(Be,10240,et[Se.magFilter]),n.texParameteri(Be,10241,et[Se.minFilter])):(n.texParameteri(Be,10242,33071),n.texParameteri(Be,10243,33071),(Be===32879||Be===35866)&&n.texParameteri(Be,32882,33071),(Se.wrapS!==No||Se.wrapT!==No)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(Be,10240,he(Se.magFilter)),n.texParameteri(Be,10241,he(Se.minFilter)),Se.minFilter!==Ss&&Se.minFilter!==cs&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const tn=e.get("EXT_texture_filter_anisotropic");if(Se.magFilter===Ss||Se.minFilter!==my&&Se.minFilter!==Ph||Se.type===Bd&&e.has("OES_texture_float_linear")===!1||s===!1&&Se.type===Fy&&e.has("OES_texture_half_float_linear")===!1)return;(Se.anisotropy>1||i.get(Se).__currentAnisotropy)&&(n.texParameterf(Be,tn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Se.anisotropy,r.getMaxAnisotropy())),i.get(Se).__currentAnisotropy=Se.anisotropy)}}function Nt(Be,Se){let St=!1;Be.__webglInit===void 0&&(Be.__webglInit=!0,Se.addEventListener("dispose",De));const tn=Se.source;let nn=D.get(tn);nn===void 0&&(nn={},D.set(tn,nn));const fn=Te(Se);if(fn!==Be.__cacheKey){nn[fn]===void 0&&(nn[fn]={texture:n.createTexture(),usedTimes:0},l.memory.textures++,St=!0),nn[fn].usedTimes++;const Nn=nn[Be.__cacheKey];Nn!==void 0&&(nn[Be.__cacheKey].usedTimes--,Nn.usedTimes===0&&le(Se)),Be.__cacheKey=fn,Be.__webglTexture=nn[fn].texture}return St}function qt(Be,Se,St){let tn=3553;(Se.isDataArrayTexture||Se.isCompressedArrayTexture)&&(tn=35866),Se.isData3DTexture&&(tn=32879);const nn=Nt(Be,Se),fn=Se.source;t.bindTexture(tn,Be.__webglTexture,33984+St);const Nn=i.get(fn);if(fn.version!==Nn.__version||nn===!0){t.activeTexture(33984+St),n.pixelStorei(37440,Se.flipY),n.pixelStorei(37441,Se.premultiplyAlpha),n.pixelStorei(3317,Se.unpackAlignment),n.pixelStorei(37443,0);const yn=j(Se)&&V(Se.image)===!1;let Dt=N(Se.image,yn,!1,_);Dt=Ei(Se,Dt);const Un=V(Dt)||s,Je=o.convert(Se.format,Se.encoding);let It=o.convert(Se.type),Zt=Z(Se.internalFormat,Je,It,Se.encoding,Se.isVideoTexture);Et(tn,Se,Un);let sn;const Yn=Se.mipmaps,li=s&&Se.isVideoTexture!==!0,Bi=Nn.__version===void 0||nn===!0,rt=ne(Se,Dt,Un);if(Se.isDepthTexture)Zt=6402,s?Se.type===Bd?Zt=36012:Se.type===cp?Zt=33190:Se.type===ug?Zt=35056:Zt=33189:Se.type===Bd&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Se.format===Sp&&Zt===6402&&Se.type!==yL&&Se.type!==cp&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Se.type=cp,It=o.convert(Se.type)),Se.format===Sg&&Zt===6402&&(Zt=34041,Se.type!==ug&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Se.type=ug,It=o.convert(Se.type))),Bi&&(li?t.texStorage2D(3553,1,Zt,Dt.width,Dt.height):t.texImage2D(3553,0,Zt,Dt.width,Dt.height,0,Je,It,null));else if(Se.isDataTexture)if(Yn.length>0&&Un){li&&Bi&&t.texStorage2D(3553,rt,Zt,Yn[0].width,Yn[0].height);for(let Ct=0,Vt=Yn.length;Ct<Vt;Ct++)sn=Yn[Ct],li?t.texSubImage2D(3553,Ct,0,0,sn.width,sn.height,Je,It,sn.data):t.texImage2D(3553,Ct,Zt,sn.width,sn.height,0,Je,It,sn.data);Se.generateMipmaps=!1}else li?(Bi&&t.texStorage2D(3553,rt,Zt,Dt.width,Dt.height),t.texSubImage2D(3553,0,0,0,Dt.width,Dt.height,Je,It,Dt.data)):t.texImage2D(3553,0,Zt,Dt.width,Dt.height,0,Je,It,Dt.data);else if(Se.isCompressedTexture)if(Se.isCompressedArrayTexture){li&&Bi&&t.texStorage3D(35866,rt,Zt,Yn[0].width,Yn[0].height,Dt.depth);for(let Ct=0,Vt=Yn.length;Ct<Vt;Ct++)sn=Yn[Ct],Se.format!==$a?Je!==null?li?t.compressedTexSubImage3D(35866,Ct,0,0,0,sn.width,sn.height,Dt.depth,Je,sn.data,0,0):t.compressedTexImage3D(35866,Ct,Zt,sn.width,sn.height,Dt.depth,0,sn.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):li?t.texSubImage3D(35866,Ct,0,0,0,sn.width,sn.height,Dt.depth,Je,It,sn.data):t.texImage3D(35866,Ct,Zt,sn.width,sn.height,Dt.depth,0,Je,It,sn.data)}else{li&&Bi&&t.texStorage2D(3553,rt,Zt,Yn[0].width,Yn[0].height);for(let Ct=0,Vt=Yn.length;Ct<Vt;Ct++)sn=Yn[Ct],Se.format!==$a?Je!==null?li?t.compressedTexSubImage2D(3553,Ct,0,0,sn.width,sn.height,Je,sn.data):t.compressedTexImage2D(3553,Ct,Zt,sn.width,sn.height,0,sn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):li?t.texSubImage2D(3553,Ct,0,0,sn.width,sn.height,Je,It,sn.data):t.texImage2D(3553,Ct,Zt,sn.width,sn.height,0,Je,It,sn.data)}else if(Se.isDataArrayTexture)li?(Bi&&t.texStorage3D(35866,rt,Zt,Dt.width,Dt.height,Dt.depth),t.texSubImage3D(35866,0,0,0,0,Dt.width,Dt.height,Dt.depth,Je,It,Dt.data)):t.texImage3D(35866,0,Zt,Dt.width,Dt.height,Dt.depth,0,Je,It,Dt.data);else if(Se.isData3DTexture)li?(Bi&&t.texStorage3D(32879,rt,Zt,Dt.width,Dt.height,Dt.depth),t.texSubImage3D(32879,0,0,0,0,Dt.width,Dt.height,Dt.depth,Je,It,Dt.data)):t.texImage3D(32879,0,Zt,Dt.width,Dt.height,Dt.depth,0,Je,It,Dt.data);else if(Se.isFramebufferTexture){if(Bi)if(li)t.texStorage2D(3553,rt,Zt,Dt.width,Dt.height);else{let Ct=Dt.width,Vt=Dt.height;for(let bn=0;bn<rt;bn++)t.texImage2D(3553,bn,Zt,Ct,Vt,0,Je,It,null),Ct>>=1,Vt>>=1}}else if(Yn.length>0&&Un){li&&Bi&&t.texStorage2D(3553,rt,Zt,Yn[0].width,Yn[0].height);for(let Ct=0,Vt=Yn.length;Ct<Vt;Ct++)sn=Yn[Ct],li?t.texSubImage2D(3553,Ct,0,0,Je,It,sn):t.texImage2D(3553,Ct,Zt,Je,It,sn);Se.generateMipmaps=!1}else li?(Bi&&t.texStorage2D(3553,rt,Zt,Dt.width,Dt.height),t.texSubImage2D(3553,0,0,0,Je,It,Dt)):t.texImage2D(3553,0,Zt,Je,It,Dt);Q(Se,Un)&&re(tn),Nn.__version=fn.version,Se.onUpdate&&Se.onUpdate(Se)}Be.__version=Se.version}function wn(Be,Se,St){if(Se.image.length!==6)return;const tn=Nt(Be,Se),nn=Se.source;t.bindTexture(34067,Be.__webglTexture,33984+St);const fn=i.get(nn);if(nn.version!==fn.__version||tn===!0){t.activeTexture(33984+St),n.pixelStorei(37440,Se.flipY),n.pixelStorei(37441,Se.premultiplyAlpha),n.pixelStorei(3317,Se.unpackAlignment),n.pixelStorei(37443,0);const Nn=Se.isCompressedTexture||Se.image[0].isCompressedTexture,yn=Se.image[0]&&Se.image[0].isDataTexture,Dt=[];for(let Ct=0;Ct<6;Ct++)!Nn&&!yn?Dt[Ct]=N(Se.image[Ct],!1,!0,p):Dt[Ct]=yn?Se.image[Ct].image:Se.image[Ct],Dt[Ct]=Ei(Se,Dt[Ct]);const Un=Dt[0],Je=V(Un)||s,It=o.convert(Se.format,Se.encoding),Zt=o.convert(Se.type),sn=Z(Se.internalFormat,It,Zt,Se.encoding),Yn=s&&Se.isVideoTexture!==!0,li=fn.__version===void 0||tn===!0;let Bi=ne(Se,Un,Je);Et(34067,Se,Je);let rt;if(Nn){Yn&&li&&t.texStorage2D(34067,Bi,sn,Un.width,Un.height);for(let Ct=0;Ct<6;Ct++){rt=Dt[Ct].mipmaps;for(let Vt=0;Vt<rt.length;Vt++){const bn=rt[Vt];Se.format!==$a?It!==null?Yn?t.compressedTexSubImage2D(34069+Ct,Vt,0,0,bn.width,bn.height,It,bn.data):t.compressedTexImage2D(34069+Ct,Vt,sn,bn.width,bn.height,0,bn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Yn?t.texSubImage2D(34069+Ct,Vt,0,0,bn.width,bn.height,It,Zt,bn.data):t.texImage2D(34069+Ct,Vt,sn,bn.width,bn.height,0,It,Zt,bn.data)}}}else{rt=Se.mipmaps,Yn&&li&&(rt.length>0&&Bi++,t.texStorage2D(34067,Bi,sn,Dt[0].width,Dt[0].height));for(let Ct=0;Ct<6;Ct++)if(yn){Yn?t.texSubImage2D(34069+Ct,0,0,0,Dt[Ct].width,Dt[Ct].height,It,Zt,Dt[Ct].data):t.texImage2D(34069+Ct,0,sn,Dt[Ct].width,Dt[Ct].height,0,It,Zt,Dt[Ct].data);for(let Vt=0;Vt<rt.length;Vt++){const Ln=rt[Vt].image[Ct].image;Yn?t.texSubImage2D(34069+Ct,Vt+1,0,0,Ln.width,Ln.height,It,Zt,Ln.data):t.texImage2D(34069+Ct,Vt+1,sn,Ln.width,Ln.height,0,It,Zt,Ln.data)}}else{Yn?t.texSubImage2D(34069+Ct,0,0,0,It,Zt,Dt[Ct]):t.texImage2D(34069+Ct,0,sn,It,Zt,Dt[Ct]);for(let Vt=0;Vt<rt.length;Vt++){const bn=rt[Vt];Yn?t.texSubImage2D(34069+Ct,Vt+1,0,0,It,Zt,bn.image[Ct]):t.texImage2D(34069+Ct,Vt+1,sn,It,Zt,bn.image[Ct])}}}Q(Se,Je)&&re(34067),fn.__version=nn.version,Se.onUpdate&&Se.onUpdate(Se)}Be.__version=Se.version}function _n(Be,Se,St,tn,nn){const fn=o.convert(St.format,St.encoding),Nn=o.convert(St.type),yn=Z(St.internalFormat,fn,Nn,St.encoding);i.get(Se).__hasExternalTextures||(nn===32879||nn===35866?t.texImage3D(nn,0,yn,Se.width,Se.height,Se.depth,0,fn,Nn,null):t.texImage2D(nn,0,yn,Se.width,Se.height,0,fn,Nn,null)),t.bindFramebuffer(36160,Be),Zn(Se)?M.framebufferTexture2DMultisampleEXT(36160,tn,nn,i.get(St).__webglTexture,0,On(Se)):(nn===3553||nn>=34069&&nn<=34074)&&n.framebufferTexture2D(36160,tn,nn,i.get(St).__webglTexture,0),t.bindFramebuffer(36160,null)}function Rn(Be,Se,St){if(n.bindRenderbuffer(36161,Be),Se.depthBuffer&&!Se.stencilBuffer){let tn=33189;if(St||Zn(Se)){const nn=Se.depthTexture;nn&&nn.isDepthTexture&&(nn.type===Bd?tn=36012:nn.type===cp&&(tn=33190));const fn=On(Se);Zn(Se)?M.renderbufferStorageMultisampleEXT(36161,fn,tn,Se.width,Se.height):n.renderbufferStorageMultisample(36161,fn,tn,Se.width,Se.height)}else n.renderbufferStorage(36161,tn,Se.width,Se.height);n.framebufferRenderbuffer(36160,36096,36161,Be)}else if(Se.depthBuffer&&Se.stencilBuffer){const tn=On(Se);St&&Zn(Se)===!1?n.renderbufferStorageMultisample(36161,tn,35056,Se.width,Se.height):Zn(Se)?M.renderbufferStorageMultisampleEXT(36161,tn,35056,Se.width,Se.height):n.renderbufferStorage(36161,34041,Se.width,Se.height),n.framebufferRenderbuffer(36160,33306,36161,Be)}else{const tn=Se.isWebGLMultipleRenderTargets===!0?Se.texture:[Se.texture];for(let nn=0;nn<tn.length;nn++){const fn=tn[nn],Nn=o.convert(fn.format,fn.encoding),yn=o.convert(fn.type),Dt=Z(fn.internalFormat,Nn,yn,fn.encoding),Un=On(Se);St&&Zn(Se)===!1?n.renderbufferStorageMultisample(36161,Un,Dt,Se.width,Se.height):Zn(Se)?M.renderbufferStorageMultisampleEXT(36161,Un,Dt,Se.width,Se.height):n.renderbufferStorage(36161,Dt,Se.width,Se.height)}}n.bindRenderbuffer(36161,null)}function At(Be,Se){if(Se&&Se.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,Be),!(Se.depthTexture&&Se.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(Se.depthTexture).__webglTexture||Se.depthTexture.image.width!==Se.width||Se.depthTexture.image.height!==Se.height)&&(Se.depthTexture.image.width=Se.width,Se.depthTexture.image.height=Se.height,Se.depthTexture.needsUpdate=!0),Pe(Se.depthTexture,0);const tn=i.get(Se.depthTexture).__webglTexture,nn=On(Se);if(Se.depthTexture.format===Sp)Zn(Se)?M.framebufferTexture2DMultisampleEXT(36160,36096,3553,tn,0,nn):n.framebufferTexture2D(36160,36096,3553,tn,0);else if(Se.depthTexture.format===Sg)Zn(Se)?M.framebufferTexture2DMultisampleEXT(36160,33306,3553,tn,0,nn):n.framebufferTexture2D(36160,33306,3553,tn,0);else throw new Error("Unknown depthTexture format")}function Ot(Be){const Se=i.get(Be),St=Be.isWebGLCubeRenderTarget===!0;if(Be.depthTexture&&!Se.__autoAllocateDepthBuffer){if(St)throw new Error("target.depthTexture not supported in Cube render targets");At(Se.__webglFramebuffer,Be)}else if(St){Se.__webglDepthbuffer=[];for(let tn=0;tn<6;tn++)t.bindFramebuffer(36160,Se.__webglFramebuffer[tn]),Se.__webglDepthbuffer[tn]=n.createRenderbuffer(),Rn(Se.__webglDepthbuffer[tn],Be,!1)}else t.bindFramebuffer(36160,Se.__webglFramebuffer),Se.__webglDepthbuffer=n.createRenderbuffer(),Rn(Se.__webglDepthbuffer,Be,!1);t.bindFramebuffer(36160,null)}function Ft(Be,Se,St){const tn=i.get(Be);Se!==void 0&&_n(tn.__webglFramebuffer,Be,Be.texture,36064,3553),St!==void 0&&Ot(Be)}function Cn(Be){const Se=Be.texture,St=i.get(Be),tn=i.get(Se);Be.addEventListener("dispose",He),Be.isWebGLMultipleRenderTargets!==!0&&(tn.__webglTexture===void 0&&(tn.__webglTexture=n.createTexture()),tn.__version=Se.version,l.memory.textures++);const nn=Be.isWebGLCubeRenderTarget===!0,fn=Be.isWebGLMultipleRenderTargets===!0,Nn=V(Be)||s;if(nn){St.__webglFramebuffer=[];for(let yn=0;yn<6;yn++)St.__webglFramebuffer[yn]=n.createFramebuffer()}else{if(St.__webglFramebuffer=n.createFramebuffer(),fn)if(r.drawBuffers){const yn=Be.texture;for(let Dt=0,Un=yn.length;Dt<Un;Dt++){const Je=i.get(yn[Dt]);Je.__webglTexture===void 0&&(Je.__webglTexture=n.createTexture(),l.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(s&&Be.samples>0&&Zn(Be)===!1){const yn=fn?Se:[Se];St.__webglMultisampledFramebuffer=n.createFramebuffer(),St.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,St.__webglMultisampledFramebuffer);for(let Dt=0;Dt<yn.length;Dt++){const Un=yn[Dt];St.__webglColorRenderbuffer[Dt]=n.createRenderbuffer(),n.bindRenderbuffer(36161,St.__webglColorRenderbuffer[Dt]);const Je=o.convert(Un.format,Un.encoding),It=o.convert(Un.type),Zt=Z(Un.internalFormat,Je,It,Un.encoding,Be.isXRRenderTarget===!0),sn=On(Be);n.renderbufferStorageMultisample(36161,sn,Zt,Be.width,Be.height),n.framebufferRenderbuffer(36160,36064+Dt,36161,St.__webglColorRenderbuffer[Dt])}n.bindRenderbuffer(36161,null),Be.depthBuffer&&(St.__webglDepthRenderbuffer=n.createRenderbuffer(),Rn(St.__webglDepthRenderbuffer,Be,!0)),t.bindFramebuffer(36160,null)}}if(nn){t.bindTexture(34067,tn.__webglTexture),Et(34067,Se,Nn);for(let yn=0;yn<6;yn++)_n(St.__webglFramebuffer[yn],Be,Se,36064,34069+yn);Q(Se,Nn)&&re(34067),t.unbindTexture()}else if(fn){const yn=Be.texture;for(let Dt=0,Un=yn.length;Dt<Un;Dt++){const Je=yn[Dt],It=i.get(Je);t.bindTexture(3553,It.__webglTexture),Et(3553,Je,Nn),_n(St.__webglFramebuffer,Be,Je,36064+Dt,3553),Q(Je,Nn)&&re(3553)}t.unbindTexture()}else{let yn=3553;(Be.isWebGL3DRenderTarget||Be.isWebGLArrayRenderTarget)&&(s?yn=Be.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(yn,tn.__webglTexture),Et(yn,Se,Nn),_n(St.__webglFramebuffer,Be,Se,36064,yn),Q(Se,Nn)&&re(yn),t.unbindTexture()}Be.depthBuffer&&Ot(Be)}function pn(Be){const Se=V(Be)||s,St=Be.isWebGLMultipleRenderTargets===!0?Be.texture:[Be.texture];for(let tn=0,nn=St.length;tn<nn;tn++){const fn=St[tn];if(Q(fn,Se)){const Nn=Be.isWebGLCubeRenderTarget?34067:3553,yn=i.get(fn).__webglTexture;t.bindTexture(Nn,yn),re(Nn),t.unbindTexture()}}}function Vn(Be){if(s&&Be.samples>0&&Zn(Be)===!1){const Se=Be.isWebGLMultipleRenderTargets?Be.texture:[Be.texture],St=Be.width,tn=Be.height;let nn=16384;const fn=[],Nn=Be.stencilBuffer?33306:36096,yn=i.get(Be),Dt=Be.isWebGLMultipleRenderTargets===!0;if(Dt)for(let Un=0;Un<Se.length;Un++)t.bindFramebuffer(36160,yn.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Un,36161,null),t.bindFramebuffer(36160,yn.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Un,3553,null,0);t.bindFramebuffer(36008,yn.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,yn.__webglFramebuffer);for(let Un=0;Un<Se.length;Un++){fn.push(36064+Un),Be.depthBuffer&&fn.push(Nn);const Je=yn.__ignoreDepthValues!==void 0?yn.__ignoreDepthValues:!1;if(Je===!1&&(Be.depthBuffer&&(nn|=256),Be.stencilBuffer&&(nn|=1024)),Dt&&n.framebufferRenderbuffer(36008,36064,36161,yn.__webglColorRenderbuffer[Un]),Je===!0&&(n.invalidateFramebuffer(36008,[Nn]),n.invalidateFramebuffer(36009,[Nn])),Dt){const It=i.get(Se[Un]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,It,0)}n.blitFramebuffer(0,0,St,tn,0,0,St,tn,nn,9728),A&&n.invalidateFramebuffer(36008,fn)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Dt)for(let Un=0;Un<Se.length;Un++){t.bindFramebuffer(36160,yn.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Un,36161,yn.__webglColorRenderbuffer[Un]);const Je=i.get(Se[Un]).__webglTexture;t.bindFramebuffer(36160,yn.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Un,3553,Je,0)}t.bindFramebuffer(36009,yn.__webglMultisampledFramebuffer)}}function On(Be){return Math.min(w,Be.samples)}function Zn(Be){const Se=i.get(Be);return s&&Be.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Se.__useRenderToTexture!==!1}function ai(Be){const Se=l.render.frame;P.get(Be)!==Se&&(P.set(Be,Se),Be.update())}function Ei(Be,Se){const St=Be.encoding,tn=Be.format,nn=Be.type;return Be.isCompressedTexture===!0||Be.isVideoTexture===!0||Be.format===yM||St!==Jd&&(St===ar?s===!1?e.has("EXT_sRGB")===!0&&tn===$a?(Be.format=yM,Be.minFilter=cs,Be.generateMipmaps=!1):Se=SL.sRGBToLinear(Se):(tn!==$a||nn!==Kd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",St)),Se}this.allocateTextureUnit=ce,this.resetTextureUnits=We,this.setTexture2D=Pe,this.setTexture2DArray=Qe,this.setTexture3D=Ne,this.setTextureCube=nt,this.rebindTextures=Ft,this.setupRenderTarget=Cn,this.updateRenderTargetMipmap=pn,this.updateMultisampleRenderTarget=Vn,this.setupDepthRenderbuffer=Ot,this.setupFrameBufferTexture=_n,this.useMultisampledRTT=Zn}function DV(n,e,t){const i=t.isWebGL2;function r(o,l=null){let s;if(o===Kd)return 5121;if(o===Q6)return 32819;if(o===eV)return 32820;if(o===Y6)return 5120;if(o===K6)return 5122;if(o===yL)return 5123;if(o===J6)return 5124;if(o===cp)return 5125;if(o===Bd)return 5126;if(o===Fy)return i?5131:(s=e.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(o===tV)return 6406;if(o===$a)return 6408;if(o===nV)return 6409;if(o===iV)return 6410;if(o===Sp)return 6402;if(o===Sg)return 34041;if(o===yM)return s=e.get("EXT_sRGB"),s!==null?s.SRGB_ALPHA_EXT:null;if(o===rV)return 6403;if(o===sV)return 36244;if(o===oV)return 33319;if(o===aV)return 33320;if(o===lV)return 36249;if(o===gS||o===_S||o===yS||o===xS)if(l===ar)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(o===gS)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(o===_S)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(o===yS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(o===xS)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(o===gS)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===_S)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===yS)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===xS)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===qC||o===ZC||o===XC||o===$C)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(o===qC)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===ZC)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===XC)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===$C)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===cV)return s=e.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(o===YC||o===KC)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(o===YC)return l===ar?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(o===KC)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(o===JC||o===QC||o===eI||o===tI||o===nI||o===iI||o===rI||o===sI||o===oI||o===aI||o===lI||o===cI||o===uI||o===hI)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(o===JC)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(o===QC)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(o===eI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(o===tI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(o===nI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(o===iI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(o===rI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(o===sI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(o===oI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(o===aI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(o===lI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(o===cI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(o===uI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(o===hI)return l===ar?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(o===vS)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(o===vS)return l===ar?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(o===uV||o===dI||o===fI||o===pI)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(o===vS)return s.COMPRESSED_RED_RGTC1_EXT;if(o===dI)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(o===fI)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(o===pI)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return o===ug?i?34042:(s=e.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null):n[o]!==void 0?n[o]:null}return{convert:r}}class RV extends qr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Ud extends tr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Bre={type:"move"};class U2{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Ud,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Ud,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Fe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Fe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Ud,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Fe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Fe),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,l=null;const s=this._targetRay,d=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){l=!0;for(const L of e.hand.values()){const D=t.getJointPose(L,i),z=this._getHandJoint(p,L);D!==null&&(z.matrix.fromArray(D.transform.matrix),z.matrix.decompose(z.position,z.rotation,z.scale),z.jointRadius=D.radius),z.visible=D!==null}const _=p.joints["index-finger-tip"],w=p.joints["thumb-tip"],M=_.position.distanceTo(w.position),A=.02,P=.005;p.inputState.pinching&&M>A+P?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&M<=A-P&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),o!==null&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),o.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(o.linearVelocity)):d.hasLinearVelocity=!1,o.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(o.angularVelocity)):d.hasAngularVelocity=!1));s!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&o!==null&&(r=o),r!==null&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Bre)))}return s!==null&&(s.visible=r!==null),d!==null&&(d.visible=o!==null),p!==null&&(p.visible=l!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Ud;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class zV extends Jr{constructor(e,t,i,r,o,l,s,d,p,_){if(_=_!==void 0?_:Sp,_!==Sp&&_!==Sg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&_===Sp&&(i=cp),i===void 0&&_===Sg&&(i=ug),super(null,r,o,l,s,d,_,i,p),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=s!==void 0?s:Ss,this.minFilter=d!==void 0?d:Ss,this.flipY=!1,this.generateMipmaps=!1}}class Nre extends kh{constructor(e,t){super();const i=this;let r=null,o=1,l=null,s="local-floor",d=1,p=null,_=null,w=null,M=null,A=null,P=null;const L=t.getContextAttributes();let D=null,z=null;const F=[],N=[],V=new Set,j=new Map,Q=new qr;Q.layers.enable(1),Q.viewport=new Tr;const re=new qr;re.layers.enable(2),re.viewport=new Tr;const Z=[Q,re],ne=new RV;ne.layers.enable(1),ne.layers.enable(2);let he=null,De=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ne){let nt=F[Ne];return nt===void 0&&(nt=new U2,F[Ne]=nt),nt.getTargetRaySpace()},this.getControllerGrip=function(Ne){let nt=F[Ne];return nt===void 0&&(nt=new U2,F[Ne]=nt),nt.getGripSpace()},this.getHand=function(Ne){let nt=F[Ne];return nt===void 0&&(nt=new U2,F[Ne]=nt),nt.getHandSpace()};function He(Ne){const nt=N.indexOf(Ne.inputSource);if(nt===-1)return;const ze=F[nt];ze!==void 0&&ze.dispatchEvent({type:Ne.type,data:Ne.inputSource})}function ae(){r.removeEventListener("select",He),r.removeEventListener("selectstart",He),r.removeEventListener("selectend",He),r.removeEventListener("squeeze",He),r.removeEventListener("squeezestart",He),r.removeEventListener("squeezeend",He),r.removeEventListener("end",ae),r.removeEventListener("inputsourceschange",le);for(let Ne=0;Ne<F.length;Ne++){const nt=N[Ne];nt!==null&&(N[Ne]=null,F[Ne].disconnect(nt))}he=null,De=null,e.setRenderTarget(D),A=null,M=null,w=null,r=null,z=null,Qe.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ne){o=Ne,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ne){s=Ne,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||l},this.setReferenceSpace=function(Ne){p=Ne},this.getBaseLayer=function(){return M!==null?M:A},this.getBinding=function(){return w},this.getFrame=function(){return P},this.getSession=function(){return r},this.setSession=async function(Ne){if(r=Ne,r!==null){if(D=e.getRenderTarget(),r.addEventListener("select",He),r.addEventListener("selectstart",He),r.addEventListener("selectend",He),r.addEventListener("squeeze",He),r.addEventListener("squeezestart",He),r.addEventListener("squeezeend",He),r.addEventListener("end",ae),r.addEventListener("inputsourceschange",le),L.xrCompatible!==!0&&await t.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const nt={antialias:r.renderState.layers===void 0?L.antialias:!0,alpha:L.alpha,depth:L.depth,stencil:L.stencil,framebufferScaleFactor:o};A=new XRWebGLLayer(r,t,nt),r.updateRenderState({baseLayer:A}),z=new Du(A.framebufferWidth,A.framebufferHeight,{format:$a,type:Kd,encoding:e.outputEncoding,stencilBuffer:L.stencil})}else{let nt=null,ze=null,et=null;L.depth&&(et=L.stencil?35056:33190,nt=L.stencil?Sg:Sp,ze=L.stencil?ug:cp);const Et={colorFormat:32856,depthFormat:et,scaleFactor:o};w=new XRWebGLBinding(r,t),M=w.createProjectionLayer(Et),r.updateRenderState({layers:[M]}),z=new Du(M.textureWidth,M.textureHeight,{format:$a,type:Kd,depthTexture:new zV(M.textureWidth,M.textureHeight,ze,void 0,void 0,void 0,void 0,void 0,void 0,nt),stencilBuffer:L.stencil,encoding:e.outputEncoding,samples:L.antialias?4:0});const Nt=e.properties.get(z);Nt.__ignoreDepthValues=M.ignoreDepthValues}z.isXRRenderTarget=!0,this.setFoveation(d),p=null,l=await r.requestReferenceSpace(s),Qe.setContext(r),Qe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function le(Ne){for(let nt=0;nt<Ne.removed.length;nt++){const ze=Ne.removed[nt],et=N.indexOf(ze);et>=0&&(N[et]=null,F[et].disconnect(ze))}for(let nt=0;nt<Ne.added.length;nt++){const ze=Ne.added[nt];let et=N.indexOf(ze);if(et===-1){for(let Nt=0;Nt<F.length;Nt++)if(Nt>=N.length){N.push(ze),et=Nt;break}else if(N[Nt]===null){N[Nt]=ze,et=Nt;break}if(et===-1)break}const Et=F[et];Et&&Et.connect(ze)}}const fe=new Fe,Oe=new Fe;function We(Ne,nt,ze){fe.setFromMatrixPosition(nt.matrixWorld),Oe.setFromMatrixPosition(ze.matrixWorld);const et=fe.distanceTo(Oe),Et=nt.projectionMatrix.elements,Nt=ze.projectionMatrix.elements,qt=Et[14]/(Et[10]-1),wn=Et[14]/(Et[10]+1),_n=(Et[9]+1)/Et[5],Rn=(Et[9]-1)/Et[5],At=(Et[8]-1)/Et[0],Ot=(Nt[8]+1)/Nt[0],Ft=qt*At,Cn=qt*Ot,pn=et/(-At+Ot),Vn=pn*-At;nt.matrixWorld.decompose(Ne.position,Ne.quaternion,Ne.scale),Ne.translateX(Vn),Ne.translateZ(pn),Ne.matrixWorld.compose(Ne.position,Ne.quaternion,Ne.scale),Ne.matrixWorldInverse.copy(Ne.matrixWorld).invert();const On=qt+pn,Zn=wn+pn,ai=Ft-Vn,Ei=Cn+(et-Vn),Be=_n*wn/Zn*On,Se=Rn*wn/Zn*On;Ne.projectionMatrix.makePerspective(ai,Ei,Be,Se,On,Zn)}function ce(Ne,nt){nt===null?Ne.matrixWorld.copy(Ne.matrix):Ne.matrixWorld.multiplyMatrices(nt.matrixWorld,Ne.matrix),Ne.matrixWorldInverse.copy(Ne.matrixWorld).invert()}this.updateCamera=function(Ne){if(r===null)return;ne.near=re.near=Q.near=Ne.near,ne.far=re.far=Q.far=Ne.far,(he!==ne.near||De!==ne.far)&&(r.updateRenderState({depthNear:ne.near,depthFar:ne.far}),he=ne.near,De=ne.far);const nt=Ne.parent,ze=ne.cameras;ce(ne,nt);for(let Et=0;Et<ze.length;Et++)ce(ze[Et],nt);ne.matrixWorld.decompose(ne.position,ne.quaternion,ne.scale),Ne.matrix.copy(ne.matrix),Ne.matrix.decompose(Ne.position,Ne.quaternion,Ne.scale);const et=Ne.children;for(let Et=0,Nt=et.length;Et<Nt;Et++)et[Et].updateMatrixWorld(!0);ze.length===2?We(ne,Q,re):ne.projectionMatrix.copy(Q.projectionMatrix)},this.getCamera=function(){return ne},this.getFoveation=function(){if(!(M===null&&A===null))return d},this.setFoveation=function(Ne){d=Ne,M!==null&&(M.fixedFoveation=Ne),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=Ne)},this.getPlanes=function(){return V};let Te=null;function Pe(Ne,nt){if(_=nt.getViewerPose(p||l),P=nt,_!==null){const ze=_.views;A!==null&&(e.setRenderTargetFramebuffer(z,A.framebuffer),e.setRenderTarget(z));let et=!1;ze.length!==ne.cameras.length&&(ne.cameras.length=0,et=!0);for(let Et=0;Et<ze.length;Et++){const Nt=ze[Et];let qt=null;if(A!==null)qt=A.getViewport(Nt);else{const _n=w.getViewSubImage(M,Nt);qt=_n.viewport,Et===0&&(e.setRenderTargetTextures(z,_n.colorTexture,M.ignoreDepthValues?void 0:_n.depthStencilTexture),e.setRenderTarget(z))}let wn=Z[Et];wn===void 0&&(wn=new qr,wn.layers.enable(Et),wn.viewport=new Tr,Z[Et]=wn),wn.matrix.fromArray(Nt.transform.matrix),wn.projectionMatrix.fromArray(Nt.projectionMatrix),wn.viewport.set(qt.x,qt.y,qt.width,qt.height),Et===0&&ne.matrix.copy(wn.matrix),et===!0&&ne.cameras.push(wn)}}for(let ze=0;ze<F.length;ze++){const et=N[ze],Et=F[ze];et!==null&&Et!==void 0&&Et.update(et,nt,p||l)}if(Te&&Te(Ne,nt),nt.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:nt.detectedPlanes});let ze=null;for(const et of V)nt.detectedPlanes.has(et)||(ze===null&&(ze=[]),ze.push(et));if(ze!==null)for(const et of ze)V.delete(et),j.delete(et),i.dispatchEvent({type:"planeremoved",data:et});for(const et of nt.detectedPlanes)if(!V.has(et))V.add(et),j.set(et,nt.lastChangedTime),i.dispatchEvent({type:"planeadded",data:et});else{const Et=j.get(et);et.lastChangedTime>Et&&(j.set(et,et.lastChangedTime),i.dispatchEvent({type:"planechanged",data:et}))}}P=null}const Qe=new CV;Qe.setAnimationLoop(Pe),this.setAnimationLoop=function(Ne){Te=Ne},this.dispose=function(){}}}function Ure(n,e){function t(L,D){D.color.getRGB(L.fogColor.value,MV(n)),D.isFog?(L.fogNear.value=D.near,L.fogFar.value=D.far):D.isFogExp2&&(L.fogDensity.value=D.density)}function i(L,D,z,F,N){D.isMeshBasicMaterial||D.isMeshLambertMaterial?r(L,D):D.isMeshToonMaterial?(r(L,D),_(L,D)):D.isMeshPhongMaterial?(r(L,D),p(L,D)):D.isMeshStandardMaterial?(r(L,D),w(L,D),D.isMeshPhysicalMaterial&&M(L,D,N)):D.isMeshMatcapMaterial?(r(L,D),A(L,D)):D.isMeshDepthMaterial?r(L,D):D.isMeshDistanceMaterial?(r(L,D),P(L,D)):D.isMeshNormalMaterial?r(L,D):D.isLineBasicMaterial?(o(L,D),D.isLineDashedMaterial&&l(L,D)):D.isPointsMaterial?s(L,D,z,F):D.isSpriteMaterial?d(L,D):D.isShadowMaterial?(L.color.value.copy(D.color),L.opacity.value=D.opacity):D.isShaderMaterial&&(D.uniformsNeedUpdate=!1)}function r(L,D){L.opacity.value=D.opacity,D.color&&L.diffuse.value.copy(D.color),D.emissive&&L.emissive.value.copy(D.emissive).multiplyScalar(D.emissiveIntensity),D.map&&(L.map.value=D.map),D.alphaMap&&(L.alphaMap.value=D.alphaMap),D.bumpMap&&(L.bumpMap.value=D.bumpMap,L.bumpScale.value=D.bumpScale,D.side===il&&(L.bumpScale.value*=-1)),D.displacementMap&&(L.displacementMap.value=D.displacementMap,L.displacementScale.value=D.displacementScale,L.displacementBias.value=D.displacementBias),D.emissiveMap&&(L.emissiveMap.value=D.emissiveMap),D.normalMap&&(L.normalMap.value=D.normalMap,L.normalScale.value.copy(D.normalScale),D.side===il&&L.normalScale.value.negate()),D.specularMap&&(L.specularMap.value=D.specularMap),D.alphaTest>0&&(L.alphaTest.value=D.alphaTest);const z=e.get(D).envMap;if(z&&(L.envMap.value=z,L.flipEnvMap.value=z.isCubeTexture&&z.isRenderTargetTexture===!1?-1:1,L.reflectivity.value=D.reflectivity,L.ior.value=D.ior,L.refractionRatio.value=D.refractionRatio),D.lightMap){L.lightMap.value=D.lightMap;const V=n.useLegacyLights===!0?Math.PI:1;L.lightMapIntensity.value=D.lightMapIntensity*V}D.aoMap&&(L.aoMap.value=D.aoMap,L.aoMapIntensity.value=D.aoMapIntensity);let F;D.map?F=D.map:D.specularMap?F=D.specularMap:D.displacementMap?F=D.displacementMap:D.normalMap?F=D.normalMap:D.bumpMap?F=D.bumpMap:D.roughnessMap?F=D.roughnessMap:D.metalnessMap?F=D.metalnessMap:D.alphaMap?F=D.alphaMap:D.emissiveMap?F=D.emissiveMap:D.clearcoatMap?F=D.clearcoatMap:D.clearcoatNormalMap?F=D.clearcoatNormalMap:D.clearcoatRoughnessMap?F=D.clearcoatRoughnessMap:D.iridescenceMap?F=D.iridescenceMap:D.iridescenceThicknessMap?F=D.iridescenceThicknessMap:D.specularIntensityMap?F=D.specularIntensityMap:D.specularColorMap?F=D.specularColorMap:D.transmissionMap?F=D.transmissionMap:D.thicknessMap?F=D.thicknessMap:D.sheenColorMap?F=D.sheenColorMap:D.sheenRoughnessMap&&(F=D.sheenRoughnessMap),F!==void 0&&(F.isWebGLRenderTarget&&(F=F.texture),F.matrixAutoUpdate===!0&&F.updateMatrix(),L.uvTransform.value.copy(F.matrix));let N;D.aoMap?N=D.aoMap:D.lightMap&&(N=D.lightMap),N!==void 0&&(N.isWebGLRenderTarget&&(N=N.texture),N.matrixAutoUpdate===!0&&N.updateMatrix(),L.uv2Transform.value.copy(N.matrix))}function o(L,D){L.diffuse.value.copy(D.color),L.opacity.value=D.opacity}function l(L,D){L.dashSize.value=D.dashSize,L.totalSize.value=D.dashSize+D.gapSize,L.scale.value=D.scale}function s(L,D,z,F){L.diffuse.value.copy(D.color),L.opacity.value=D.opacity,L.size.value=D.size*z,L.scale.value=F*.5,D.map&&(L.map.value=D.map),D.alphaMap&&(L.alphaMap.value=D.alphaMap),D.alphaTest>0&&(L.alphaTest.value=D.alphaTest);let N;D.map?N=D.map:D.alphaMap&&(N=D.alphaMap),N!==void 0&&(N.matrixAutoUpdate===!0&&N.updateMatrix(),L.uvTransform.value.copy(N.matrix))}function d(L,D){L.diffuse.value.copy(D.color),L.opacity.value=D.opacity,L.rotation.value=D.rotation,D.map&&(L.map.value=D.map),D.alphaMap&&(L.alphaMap.value=D.alphaMap),D.alphaTest>0&&(L.alphaTest.value=D.alphaTest);let z;D.map?z=D.map:D.alphaMap&&(z=D.alphaMap),z!==void 0&&(z.matrixAutoUpdate===!0&&z.updateMatrix(),L.uvTransform.value.copy(z.matrix))}function p(L,D){L.specular.value.copy(D.specular),L.shininess.value=Math.max(D.shininess,1e-4)}function _(L,D){D.gradientMap&&(L.gradientMap.value=D.gradientMap)}function w(L,D){L.roughness.value=D.roughness,L.metalness.value=D.metalness,D.roughnessMap&&(L.roughnessMap.value=D.roughnessMap),D.metalnessMap&&(L.metalnessMap.value=D.metalnessMap),e.get(D).envMap&&(L.envMapIntensity.value=D.envMapIntensity)}function M(L,D,z){L.ior.value=D.ior,D.sheen>0&&(L.sheenColor.value.copy(D.sheenColor).multiplyScalar(D.sheen),L.sheenRoughness.value=D.sheenRoughness,D.sheenColorMap&&(L.sheenColorMap.value=D.sheenColorMap),D.sheenRoughnessMap&&(L.sheenRoughnessMap.value=D.sheenRoughnessMap)),D.clearcoat>0&&(L.clearcoat.value=D.clearcoat,L.clearcoatRoughness.value=D.clearcoatRoughness,D.clearcoatMap&&(L.clearcoatMap.value=D.clearcoatMap),D.clearcoatRoughnessMap&&(L.clearcoatRoughnessMap.value=D.clearcoatRoughnessMap),D.clearcoatNormalMap&&(L.clearcoatNormalScale.value.copy(D.clearcoatNormalScale),L.clearcoatNormalMap.value=D.clearcoatNormalMap,D.side===il&&L.clearcoatNormalScale.value.negate())),D.iridescence>0&&(L.iridescence.value=D.iridescence,L.iridescenceIOR.value=D.iridescenceIOR,L.iridescenceThicknessMinimum.value=D.iridescenceThicknessRange[0],L.iridescenceThicknessMaximum.value=D.iridescenceThicknessRange[1],D.iridescenceMap&&(L.iridescenceMap.value=D.iridescenceMap),D.iridescenceThicknessMap&&(L.iridescenceThicknessMap.value=D.iridescenceThicknessMap)),D.transmission>0&&(L.transmission.value=D.transmission,L.transmissionSamplerMap.value=z.texture,L.transmissionSamplerSize.value.set(z.width,z.height),D.transmissionMap&&(L.transmissionMap.value=D.transmissionMap),L.thickness.value=D.thickness,D.thicknessMap&&(L.thicknessMap.value=D.thicknessMap),L.attenuationDistance.value=D.attenuationDistance,L.attenuationColor.value.copy(D.attenuationColor)),L.specularIntensity.value=D.specularIntensity,L.specularColor.value.copy(D.specularColor),D.specularIntensityMap&&(L.specularIntensityMap.value=D.specularIntensityMap),D.specularColorMap&&(L.specularColorMap.value=D.specularColorMap)}function A(L,D){D.matcap&&(L.matcap.value=D.matcap)}function P(L,D){L.referencePosition.value.copy(D.referencePosition),L.nearDistance.value=D.nearDistance,L.farDistance.value=D.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function Vre(n,e,t,i){let r={},o={},l=[];const s=t.isWebGL2?n.getParameter(35375):0;function d(F,N){const V=N.program;i.uniformBlockBinding(F,V)}function p(F,N){let V=r[F.id];V===void 0&&(P(F),V=_(F),r[F.id]=V,F.addEventListener("dispose",D));const j=N.program;i.updateUBOMapping(F,j);const Q=e.render.frame;o[F.id]!==Q&&(M(F),o[F.id]=Q)}function _(F){const N=w();F.__bindingPointIndex=N;const V=n.createBuffer(),j=F.__size,Q=F.usage;return n.bindBuffer(35345,V),n.bufferData(35345,j,Q),n.bindBuffer(35345,null),n.bindBufferBase(35345,N,V),V}function w(){for(let F=0;F<s;F++)if(l.indexOf(F)===-1)return l.push(F),F;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function M(F){const N=r[F.id],V=F.uniforms,j=F.__cache;n.bindBuffer(35345,N);for(let Q=0,re=V.length;Q<re;Q++){const Z=V[Q];if(A(Z,Q,j)===!0){const ne=Z.__offset,he=Array.isArray(Z.value)?Z.value:[Z.value];let De=0;for(let He=0;He<he.length;He++){const ae=he[He],le=L(ae);typeof ae=="number"?(Z.__data[0]=ae,n.bufferSubData(35345,ne+De,Z.__data)):ae.isMatrix3?(Z.__data[0]=ae.elements[0],Z.__data[1]=ae.elements[1],Z.__data[2]=ae.elements[2],Z.__data[3]=ae.elements[0],Z.__data[4]=ae.elements[3],Z.__data[5]=ae.elements[4],Z.__data[6]=ae.elements[5],Z.__data[7]=ae.elements[0],Z.__data[8]=ae.elements[6],Z.__data[9]=ae.elements[7],Z.__data[10]=ae.elements[8],Z.__data[11]=ae.elements[0]):(ae.toArray(Z.__data,De),De+=le.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(35345,ne,Z.__data)}}n.bindBuffer(35345,null)}function A(F,N,V){const j=F.value;if(V[N]===void 0){if(typeof j=="number")V[N]=j;else{const Q=Array.isArray(j)?j:[j],re=[];for(let Z=0;Z<Q.length;Z++)re.push(Q[Z].clone());V[N]=re}return!0}else if(typeof j=="number"){if(V[N]!==j)return V[N]=j,!0}else{const Q=Array.isArray(V[N])?V[N]:[V[N]],re=Array.isArray(j)?j:[j];for(let Z=0;Z<Q.length;Z++){const ne=Q[Z];if(ne.equals(re[Z])===!1)return ne.copy(re[Z]),!0}}return!1}function P(F){const N=F.uniforms;let V=0;const j=16;let Q=0;for(let re=0,Z=N.length;re<Z;re++){const ne=N[re],he={boundary:0,storage:0},De=Array.isArray(ne.value)?ne.value:[ne.value];for(let He=0,ae=De.length;He<ae;He++){const le=De[He],fe=L(le);he.boundary+=fe.boundary,he.storage+=fe.storage}if(ne.__data=new Float32Array(he.storage/Float32Array.BYTES_PER_ELEMENT),ne.__offset=V,re>0){Q=V%j;const He=j-Q;Q!==0&&He-he.boundary<0&&(V+=j-Q,ne.__offset=V)}V+=he.storage}return Q=V%j,Q>0&&(V+=j-Q),F.__size=V,F.__cache={},this}function L(F){const N={boundary:0,storage:0};return typeof F=="number"?(N.boundary=4,N.storage=4):F.isVector2?(N.boundary=8,N.storage=8):F.isVector3||F.isColor?(N.boundary=16,N.storage=12):F.isVector4?(N.boundary=16,N.storage=16):F.isMatrix3?(N.boundary=48,N.storage=48):F.isMatrix4?(N.boundary=64,N.storage=64):F.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",F),N}function D(F){const N=F.target;N.removeEventListener("dispose",D);const V=l.indexOf(N.__bindingPointIndex);l.splice(V,1),n.deleteBuffer(r[N.id]),delete r[N.id],delete o[N.id]}function z(){for(const F in r)n.deleteBuffer(r[F]);l=[],r={},o={}}return{bind:d,update:p,dispose:z}}function Gre(){const n=qv("canvas");return n.style.display="block",n}function aT(n={}){this.isWebGLRenderer=!0;const e=n.canvas!==void 0?n.canvas:Gre(),t=n.context!==void 0?n.context:null,i=n.depth!==void 0?n.depth:!0,r=n.stencil!==void 0?n.stencil:!0,o=n.antialias!==void 0?n.antialias:!1,l=n.premultipliedAlpha!==void 0?n.premultipliedAlpha:!0,s=n.preserveDrawingBuffer!==void 0?n.preserveDrawingBuffer:!1,d=n.powerPreference!==void 0?n.powerPreference:"default",p=n.failIfMajorPerformanceCaveat!==void 0?n.failIfMajorPerformanceCaveat:!1;let _;t!==null?_=t.getContextAttributes().alpha:_=n.alpha!==void 0?n.alpha:!1;let w=null,M=null;const A=[],P=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Jd,this.useLegacyLights=!0,this.toneMapping=Pu,this.toneMappingExposure=1;const L=this;let D=!1,z=0,F=0,N=null,V=-1,j=null;const Q=new Tr,re=new Tr;let Z=null,ne=e.width,he=e.height,De=1,He=null,ae=null;const le=new Tr(0,0,ne,he),fe=new Tr(0,0,ne,he);let Oe=!1;const We=new sT;let ce=!1,Te=!1,Pe=null;const Qe=new hi,Ne=new Fe,nt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ze(){return N===null?De:1}let et=t;function Et(ee,pe){for(let Ae=0;Ae<ee.length;Ae++){const ye=ee[Ae],ve=e.getContext(ye,pe);if(ve!==null)return ve}return null}try{const ee={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:s,powerPreference:d,failIfMajorPerformanceCaveat:p};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${QM}`),e.addEventListener("webglcontextlost",It,!1),e.addEventListener("webglcontextrestored",Zt,!1),e.addEventListener("webglcontextcreationerror",sn,!1),et===null){const pe=["webgl2","webgl","experimental-webgl"];if(L.isWebGL1Renderer===!0&&pe.shift(),et=Et(pe,ee),et===null)throw Et(pe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}et.getShaderPrecisionFormat===void 0&&(et.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ee){throw console.error("THREE.WebGLRenderer: "+ee.message),ee}let Nt,qt,wn,_n,Rn,At,Ot,Ft,Cn,pn,Vn,On,Zn,ai,Ei,Be,Se,St,tn,nn,fn,Nn,yn,Dt;function Un(){Nt=new rie(et),qt=new Jne(et,Nt,n),Nt.init(qt),Nn=new DV(et,Nt,qt),wn=new Ore(et,Nt,qt),_n=new aie,Rn=new Mre,At=new Fre(et,Nt,wn,Rn,qt,Nn,_n),Ot=new eie(L),Ft=new iie(L),Cn=new gee(et,qt),yn=new Yne(et,Nt,Cn,qt),pn=new sie(et,Cn,_n,yn),Vn=new hie(et,pn,Cn,_n),tn=new uie(et,qt,At),Be=new Qne(Rn),On=new Sre(L,Ot,Ft,Nt,qt,yn,Be),Zn=new Ure(L,Rn),ai=new Ere,Ei=new kre(Nt,qt),St=new $ne(L,Ot,Ft,wn,Vn,_,l),Se=new zre(L,Vn,qt),Dt=new Vre(et,_n,qt,wn),nn=new Kne(et,Nt,_n,qt),fn=new oie(et,Nt,_n,qt),_n.programs=On.programs,L.capabilities=qt,L.extensions=Nt,L.properties=Rn,L.renderLists=ai,L.shadowMap=Se,L.state=wn,L.info=_n}Un();const Je=new Nre(L,et);this.xr=Je,this.getContext=function(){return et},this.getContextAttributes=function(){return et.getContextAttributes()},this.forceContextLoss=function(){const ee=Nt.get("WEBGL_lose_context");ee&&ee.loseContext()},this.forceContextRestore=function(){const ee=Nt.get("WEBGL_lose_context");ee&&ee.restoreContext()},this.getPixelRatio=function(){return De},this.setPixelRatio=function(ee){ee!==void 0&&(De=ee,this.setSize(ne,he,!1))},this.getSize=function(ee){return ee.set(ne,he)},this.setSize=function(ee,pe,Ae=!0){if(Je.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ne=ee,he=pe,e.width=Math.floor(ee*De),e.height=Math.floor(pe*De),Ae===!0&&(e.style.width=ee+"px",e.style.height=pe+"px"),this.setViewport(0,0,ee,pe)},this.getDrawingBufferSize=function(ee){return ee.set(ne*De,he*De).floor()},this.setDrawingBufferSize=function(ee,pe,Ae){ne=ee,he=pe,De=Ae,e.width=Math.floor(ee*Ae),e.height=Math.floor(pe*Ae),this.setViewport(0,0,ee,pe)},this.getCurrentViewport=function(ee){return ee.copy(Q)},this.getViewport=function(ee){return ee.copy(le)},this.setViewport=function(ee,pe,Ae,ye){ee.isVector4?le.set(ee.x,ee.y,ee.z,ee.w):le.set(ee,pe,Ae,ye),wn.viewport(Q.copy(le).multiplyScalar(De).floor())},this.getScissor=function(ee){return ee.copy(fe)},this.setScissor=function(ee,pe,Ae,ye){ee.isVector4?fe.set(ee.x,ee.y,ee.z,ee.w):fe.set(ee,pe,Ae,ye),wn.scissor(re.copy(fe).multiplyScalar(De).floor())},this.getScissorTest=function(){return Oe},this.setScissorTest=function(ee){wn.setScissorTest(Oe=ee)},this.setOpaqueSort=function(ee){He=ee},this.setTransparentSort=function(ee){ae=ee},this.getClearColor=function(ee){return ee.copy(St.getClearColor())},this.setClearColor=function(){St.setClearColor.apply(St,arguments)},this.getClearAlpha=function(){return St.getClearAlpha()},this.setClearAlpha=function(){St.setClearAlpha.apply(St,arguments)},this.clear=function(ee=!0,pe=!0,Ae=!0){let ye=0;ee&&(ye|=16384),pe&&(ye|=256),Ae&&(ye|=1024),et.clear(ye)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",It,!1),e.removeEventListener("webglcontextrestored",Zt,!1),e.removeEventListener("webglcontextcreationerror",sn,!1),ai.dispose(),Ei.dispose(),Rn.dispose(),Ot.dispose(),Ft.dispose(),Vn.dispose(),yn.dispose(),Dt.dispose(),On.dispose(),Je.dispose(),Je.removeEventListener("sessionstart",Vt),Je.removeEventListener("sessionend",bn),Pe&&(Pe.dispose(),Pe=null),Ln.stop()};function It(ee){ee.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function Zt(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const ee=_n.autoReset,pe=Se.enabled,Ae=Se.autoUpdate,ye=Se.needsUpdate,ve=Se.type;Un(),_n.autoReset=ee,Se.enabled=pe,Se.autoUpdate=Ae,Se.needsUpdate=ye,Se.type=ve}function sn(ee){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ee.statusMessage)}function Yn(ee){const pe=ee.target;pe.removeEventListener("dispose",Yn),li(pe)}function li(ee){Bi(ee),Rn.remove(ee)}function Bi(ee){const pe=Rn.get(ee).programs;pe!==void 0&&(pe.forEach(function(Ae){On.releaseProgram(Ae)}),ee.isShaderMaterial&&On.releaseShaderCache(ee))}this.renderBufferDirect=function(ee,pe,Ae,ye,ve,Ke){pe===null&&(pe=nt);const ht=ve.isMesh&&ve.matrixWorld.determinant()<0,zt=se(ee,pe,Ae,ye,ve);wn.setMaterial(ye,ht);let vt=Ae.index,Jt=1;ye.wireframe===!0&&(vt=pn.getWireframeAttribute(Ae),Jt=2);const Yt=Ae.drawRange,Xt=Ae.attributes.position;let gn=Yt.start*Jt,Xn=(Yt.start+Yt.count)*Jt;Ke!==null&&(gn=Math.max(gn,Ke.start*Jt),Xn=Math.min(Xn,(Ke.start+Ke.count)*Jt)),vt!==null?(gn=Math.max(gn,0),Xn=Math.min(Xn,vt.count)):Xt!=null&&(gn=Math.max(gn,0),Xn=Math.min(Xn,Xt.count));const ii=Xn-gn;if(ii<0||ii===1/0)return;yn.setup(ve,ye,zt,Ae,vt);let Sn,Jn=nn;if(vt!==null&&(Sn=Cn.get(vt),Jn=fn,Jn.setIndex(Sn)),ve.isMesh)ye.wireframe===!0?(wn.setLineWidth(ye.wireframeLinewidth*ze()),Jn.setMode(1)):Jn.setMode(4);else if(ve.isLine){let kn=ye.linewidth;kn===void 0&&(kn=1),wn.setLineWidth(kn*ze()),ve.isLineSegments?Jn.setMode(1):ve.isLineLoop?Jn.setMode(2):Jn.setMode(3)}else ve.isPoints?Jn.setMode(0):ve.isSprite&&Jn.setMode(4);if(ve.isInstancedMesh)Jn.renderInstances(gn,ii,ve.count);else if(Ae.isInstancedBufferGeometry){const kn=Ae._maxInstanceCount!==void 0?Ae._maxInstanceCount:1/0,ps=Math.min(Ae.instanceCount,kn);Jn.renderInstances(gn,ii,ps)}else Jn.render(gn,ii)},this.compile=function(ee,pe){function Ae(ye,ve,Ke){ye.transparent===!0&&ye.side===bh&&ye.forceSinglePass===!1?(ye.side=il,ye.needsUpdate=!0,es(ye,ve,Ke),ye.side=Ih,ye.needsUpdate=!0,es(ye,ve,Ke),ye.side=bh):es(ye,ve,Ke)}M=Ei.get(ee),M.init(),P.push(M),ee.traverseVisible(function(ye){ye.isLight&&ye.layers.test(pe.layers)&&(M.pushLight(ye),ye.castShadow&&M.pushShadow(ye))}),M.setupLights(L.useLegacyLights),ee.traverse(function(ye){const ve=ye.material;if(ve)if(Array.isArray(ve))for(let Ke=0;Ke<ve.length;Ke++){const ht=ve[Ke];Ae(ht,ee,ye)}else Ae(ve,ee,ye)}),P.pop(),M=null};let rt=null;function Ct(ee){rt&&rt(ee)}function Vt(){Ln.stop()}function bn(){Ln.start()}const Ln=new CV;Ln.setAnimationLoop(Ct),typeof self<"u"&&Ln.setContext(self),this.setAnimationLoop=function(ee){rt=ee,Je.setAnimationLoop(ee),ee===null?Ln.stop():Ln.start()},Je.addEventListener("sessionstart",Vt),Je.addEventListener("sessionend",bn),this.render=function(ee,pe){if(pe!==void 0&&pe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(D===!0)return;ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),pe.parent===null&&pe.matrixWorldAutoUpdate===!0&&pe.updateMatrixWorld(),Je.enabled===!0&&Je.isPresenting===!0&&(Je.cameraAutoUpdate===!0&&Je.updateCamera(pe),pe=Je.getCamera()),ee.isScene===!0&&ee.onBeforeRender(L,ee,pe,N),M=Ei.get(ee,P.length),M.init(),P.push(M),Qe.multiplyMatrices(pe.projectionMatrix,pe.matrixWorldInverse),We.setFromProjectionMatrix(Qe),Te=this.localClippingEnabled,ce=Be.init(this.clippingPlanes,Te),w=ai.get(ee,A.length),w.init(),A.push(w),Ri(ee,pe,0,L.sortObjects),w.finish(),L.sortObjects===!0&&w.sort(He,ae),ce===!0&&Be.beginShadows();const Ae=M.state.shadowsArray;if(Se.render(Ae,ee,pe),ce===!0&&Be.endShadows(),this.info.autoReset===!0&&this.info.reset(),St.render(w,ee),M.setupLights(L.useLegacyLights),pe.isArrayCamera){const ye=pe.cameras;for(let ve=0,Ke=ye.length;ve<Ke;ve++){const ht=ye[ve];hr(w,ee,ht,ht.viewport)}}else hr(w,ee,pe);N!==null&&(At.updateMultisampleRenderTarget(N),At.updateRenderTargetMipmap(N)),ee.isScene===!0&&ee.onAfterRender(L,ee,pe),yn.resetDefaultState(),V=-1,j=null,P.pop(),P.length>0?M=P[P.length-1]:M=null,A.pop(),A.length>0?w=A[A.length-1]:w=null};function Ri(ee,pe,Ae,ye){if(ee.visible===!1)return;if(ee.layers.test(pe.layers)){if(ee.isGroup)Ae=ee.renderOrder;else if(ee.isLOD)ee.autoUpdate===!0&&ee.update(pe);else if(ee.isLight)M.pushLight(ee),ee.castShadow&&M.pushShadow(ee);else if(ee.isSprite){if(!ee.frustumCulled||We.intersectsSprite(ee)){ye&&Ne.setFromMatrixPosition(ee.matrixWorld).applyMatrix4(Qe);const ht=Vn.update(ee),zt=ee.material;zt.visible&&w.push(ee,ht,zt,Ae,Ne.z,null)}}else if((ee.isMesh||ee.isLine||ee.isPoints)&&(ee.isSkinnedMesh&&ee.skeleton.frame!==_n.render.frame&&(ee.skeleton.update(),ee.skeleton.frame=_n.render.frame),!ee.frustumCulled||We.intersectsObject(ee))){ye&&Ne.setFromMatrixPosition(ee.matrixWorld).applyMatrix4(Qe);const ht=Vn.update(ee),zt=ee.material;if(Array.isArray(zt)){const vt=ht.groups;for(let Jt=0,Yt=vt.length;Jt<Yt;Jt++){const Xt=vt[Jt],gn=zt[Xt.materialIndex];gn&&gn.visible&&w.push(ee,ht,gn,Ae,Ne.z,Xt)}}else zt.visible&&w.push(ee,ht,zt,Ae,Ne.z,null)}}const Ke=ee.children;for(let ht=0,zt=Ke.length;ht<zt;ht++)Ri(Ke[ht],pe,Ae,ye)}function hr(ee,pe,Ae,ye){const ve=ee.opaque,Ke=ee.transmissive,ht=ee.transparent;M.setupLightsView(Ae),ce===!0&&Be.setGlobalState(L.clippingPlanes,Ae),Ke.length>0&&Fr(ve,pe,Ae),ye&&wn.viewport(Q.copy(ye)),ve.length>0&&Pr(ve,pe,Ae),Ke.length>0&&Pr(Ke,pe,Ae),ht.length>0&&Pr(ht,pe,Ae),wn.buffers.depth.setTest(!0),wn.buffers.depth.setMask(!0),wn.buffers.color.setMask(!0),wn.setPolygonOffset(!1)}function Fr(ee,pe,Ae){const ye=qt.isWebGL2;Pe===null&&(Pe=new Du(1024,1024,{generateMipmaps:!0,type:Nt.has("EXT_color_buffer_half_float")?Fy:Kd,minFilter:Ph,samples:ye&&o===!0?4:0}));const ve=L.getRenderTarget();L.setRenderTarget(Pe),L.clear();const Ke=L.toneMapping;L.toneMapping=Pu,Pr(ee,pe,Ae),L.toneMapping=Ke,At.updateMultisampleRenderTarget(Pe),At.updateRenderTargetMipmap(Pe),L.setRenderTarget(ve)}function Pr(ee,pe,Ae){const ye=pe.isScene===!0?pe.overrideMaterial:null;for(let ve=0,Ke=ee.length;ve<Ke;ve++){const ht=ee[ve],zt=ht.object,vt=ht.geometry,Jt=ye===null?ht.material:ye,Yt=ht.group;zt.layers.test(Ae.layers)&&Gi(zt,pe,Ae,vt,Jt,Yt)}}function Gi(ee,pe,Ae,ye,ve,Ke){ee.onBeforeRender(L,pe,Ae,ye,ve,Ke),ee.modelViewMatrix.multiplyMatrices(Ae.matrixWorldInverse,ee.matrixWorld),ee.normalMatrix.getNormalMatrix(ee.modelViewMatrix),ve.onBeforeRender(L,pe,Ae,ye,ee,Ke),ve.transparent===!0&&ve.side===bh&&ve.forceSinglePass===!1?(ve.side=il,ve.needsUpdate=!0,L.renderBufferDirect(Ae,pe,ye,ve,ee,Ke),ve.side=Ih,ve.needsUpdate=!0,L.renderBufferDirect(Ae,pe,ye,ve,ee,Ke),ve.side=bh):L.renderBufferDirect(Ae,pe,ye,ve,ee,Ke),ee.onAfterRender(L,pe,Ae,ye,ve,Ke)}function es(ee,pe,Ae){pe.isScene!==!0&&(pe=nt);const ye=Rn.get(ee),ve=M.state.lights,Ke=M.state.shadowsArray,ht=ve.state.version,zt=On.getParameters(ee,ve.state,Ke,pe,Ae),vt=On.getProgramCacheKey(zt);let Jt=ye.programs;ye.environment=ee.isMeshStandardMaterial?pe.environment:null,ye.fog=pe.fog,ye.envMap=(ee.isMeshStandardMaterial?Ft:Ot).get(ee.envMap||ye.environment),Jt===void 0&&(ee.addEventListener("dispose",Yn),Jt=new Map,ye.programs=Jt);let Yt=Jt.get(vt);if(Yt!==void 0){if(ye.currentProgram===Yt&&ye.lightsStateVersion===ht)return Ee(ee,zt),Yt}else zt.uniforms=On.getUniforms(ee),ee.onBuild(Ae,zt,L),ee.onBeforeCompile(zt,L),Yt=On.acquireProgram(zt,vt),Jt.set(vt,Yt),ye.uniforms=zt.uniforms;const Xt=ye.uniforms;(!ee.isShaderMaterial&&!ee.isRawShaderMaterial||ee.clipping===!0)&&(Xt.clippingPlanes=Be.uniform),Ee(ee,zt),ye.needsLights=Ie(ee),ye.lightsStateVersion=ht,ye.needsLights&&(Xt.ambientLightColor.value=ve.state.ambient,Xt.lightProbe.value=ve.state.probe,Xt.directionalLights.value=ve.state.directional,Xt.directionalLightShadows.value=ve.state.directionalShadow,Xt.spotLights.value=ve.state.spot,Xt.spotLightShadows.value=ve.state.spotShadow,Xt.rectAreaLights.value=ve.state.rectArea,Xt.ltc_1.value=ve.state.rectAreaLTC1,Xt.ltc_2.value=ve.state.rectAreaLTC2,Xt.pointLights.value=ve.state.point,Xt.pointLightShadows.value=ve.state.pointShadow,Xt.hemisphereLights.value=ve.state.hemi,Xt.directionalShadowMap.value=ve.state.directionalShadowMap,Xt.directionalShadowMatrix.value=ve.state.directionalShadowMatrix,Xt.spotShadowMap.value=ve.state.spotShadowMap,Xt.spotLightMatrix.value=ve.state.spotLightMatrix,Xt.spotLightMap.value=ve.state.spotLightMap,Xt.pointShadowMap.value=ve.state.pointShadowMap,Xt.pointShadowMatrix.value=ve.state.pointShadowMatrix);const gn=Yt.getUniforms(),Xn=SS.seqWithValue(gn.seq,Xt);return ye.currentProgram=Yt,ye.uniformsList=Xn,Yt}function Ee(ee,pe){const Ae=Rn.get(ee);Ae.outputEncoding=pe.outputEncoding,Ae.instancing=pe.instancing,Ae.skinning=pe.skinning,Ae.morphTargets=pe.morphTargets,Ae.morphNormals=pe.morphNormals,Ae.morphColors=pe.morphColors,Ae.morphTargetsCount=pe.morphTargetsCount,Ae.numClippingPlanes=pe.numClippingPlanes,Ae.numIntersection=pe.numClipIntersection,Ae.vertexAlphas=pe.vertexAlphas,Ae.vertexTangents=pe.vertexTangents,Ae.toneMapping=pe.toneMapping}function se(ee,pe,Ae,ye,ve){pe.isScene!==!0&&(pe=nt),At.resetTextureUnits();const Ke=pe.fog,ht=ye.isMeshStandardMaterial?pe.environment:null,zt=N===null?L.outputEncoding:N.isXRRenderTarget===!0?N.texture.encoding:Jd,vt=(ye.isMeshStandardMaterial?Ft:Ot).get(ye.envMap||ht),Jt=ye.vertexColors===!0&&!!Ae.attributes.color&&Ae.attributes.color.itemSize===4,Yt=!!ye.normalMap&&!!Ae.attributes.tangent,Xt=!!Ae.morphAttributes.position,gn=!!Ae.morphAttributes.normal,Xn=!!Ae.morphAttributes.color,ii=ye.toneMapped?L.toneMapping:Pu,Sn=Ae.morphAttributes.position||Ae.morphAttributes.normal||Ae.morphAttributes.color,Jn=Sn!==void 0?Sn.length:0,kn=Rn.get(ye),ps=M.state.lights;if(ce===!0&&(Te===!0||ee!==j)){const wr=ee===j&&ye.id===V;Be.setState(ye,ee,wr)}let nr=!1;ye.version===kn.__version?(kn.needsLights&&kn.lightsStateVersion!==ps.state.version||kn.outputEncoding!==zt||ve.isInstancedMesh&&kn.instancing===!1||!ve.isInstancedMesh&&kn.instancing===!0||ve.isSkinnedMesh&&kn.skinning===!1||!ve.isSkinnedMesh&&kn.skinning===!0||kn.envMap!==vt||ye.fog===!0&&kn.fog!==Ke||kn.numClippingPlanes!==void 0&&(kn.numClippingPlanes!==Be.numPlanes||kn.numIntersection!==Be.numIntersection)||kn.vertexAlphas!==Jt||kn.vertexTangents!==Yt||kn.morphTargets!==Xt||kn.morphNormals!==gn||kn.morphColors!==Xn||kn.toneMapping!==ii||qt.isWebGL2===!0&&kn.morphTargetsCount!==Jn)&&(nr=!0):(nr=!0,kn.__version=ye.version);let Br=kn.currentProgram;nr===!0&&(Br=es(ye,pe,ve));let wt=!1,Es=!1,ir=!1;const Ni=Br.getUniforms(),zi=kn.uniforms;if(wn.useProgram(Br.program)&&(wt=!0,Es=!0,ir=!0),ye.id!==V&&(V=ye.id,Es=!0),wt||j!==ee){if(Ni.setValue(et,"projectionMatrix",ee.projectionMatrix),qt.logarithmicDepthBuffer&&Ni.setValue(et,"logDepthBufFC",2/(Math.log(ee.far+1)/Math.LN2)),j!==ee&&(j=ee,Es=!0,ir=!0),ye.isShaderMaterial||ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshStandardMaterial||ye.envMap){const wr=Ni.map.cameraPosition;wr!==void 0&&wr.setValue(et,Ne.setFromMatrixPosition(ee.matrixWorld))}(ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshLambertMaterial||ye.isMeshBasicMaterial||ye.isMeshStandardMaterial||ye.isShaderMaterial)&&Ni.setValue(et,"isOrthographic",ee.isOrthographicCamera===!0),(ye.isMeshPhongMaterial||ye.isMeshToonMaterial||ye.isMeshLambertMaterial||ye.isMeshBasicMaterial||ye.isMeshStandardMaterial||ye.isShaderMaterial||ye.isShadowMaterial||ve.isSkinnedMesh)&&Ni.setValue(et,"viewMatrix",ee.matrixWorldInverse)}if(ve.isSkinnedMesh){Ni.setOptional(et,ve,"bindMatrix"),Ni.setOptional(et,ve,"bindMatrixInverse");const wr=ve.skeleton;wr&&(qt.floatVertexTextures?(wr.boneTexture===null&&wr.computeBoneTexture(),Ni.setValue(et,"boneTexture",wr.boneTexture,At),Ni.setValue(et,"boneTextureSize",wr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const ci=Ae.morphAttributes;if((ci.position!==void 0||ci.normal!==void 0||ci.color!==void 0&&qt.isWebGL2===!0)&&tn.update(ve,Ae,Br),(Es||kn.receiveShadow!==ve.receiveShadow)&&(kn.receiveShadow=ve.receiveShadow,Ni.setValue(et,"receiveShadow",ve.receiveShadow)),ye.isMeshGouraudMaterial&&ye.envMap!==null&&(zi.envMap.value=vt,zi.flipEnvMap.value=vt.isCubeTexture&&vt.isRenderTargetTexture===!1?-1:1),Es&&(Ni.setValue(et,"toneMappingExposure",L.toneMappingExposure),kn.needsLights&&de(zi,ir),Ke&&ye.fog===!0&&Zn.refreshFogUniforms(zi,Ke),Zn.refreshMaterialUniforms(zi,ye,De,he,Pe),SS.upload(et,kn.uniformsList,zi,At)),ye.isShaderMaterial&&ye.uniformsNeedUpdate===!0&&(SS.upload(et,kn.uniformsList,zi,At),ye.uniformsNeedUpdate=!1),ye.isSpriteMaterial&&Ni.setValue(et,"center",ve.center),Ni.setValue(et,"modelViewMatrix",ve.modelViewMatrix),Ni.setValue(et,"normalMatrix",ve.normalMatrix),Ni.setValue(et,"modelMatrix",ve.matrixWorld),ye.isShaderMaterial||ye.isRawShaderMaterial){const wr=ye.uniformsGroups;for(let Ur=0,qi=wr.length;Ur<qi;Ur++)if(qt.isWebGL2){const Kt=wr[Ur];Dt.update(Kt,Br),Dt.bind(Kt,Br)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Br}function de(ee,pe){ee.ambientLightColor.needsUpdate=pe,ee.lightProbe.needsUpdate=pe,ee.directionalLights.needsUpdate=pe,ee.directionalLightShadows.needsUpdate=pe,ee.pointLights.needsUpdate=pe,ee.pointLightShadows.needsUpdate=pe,ee.spotLights.needsUpdate=pe,ee.spotLightShadows.needsUpdate=pe,ee.rectAreaLights.needsUpdate=pe,ee.hemisphereLights.needsUpdate=pe}function Ie(ee){return ee.isMeshLambertMaterial||ee.isMeshToonMaterial||ee.isMeshPhongMaterial||ee.isMeshStandardMaterial||ee.isShadowMaterial||ee.isShaderMaterial&&ee.lights===!0}this.getActiveCubeFace=function(){return z},this.getActiveMipmapLevel=function(){return F},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(ee,pe,Ae){Rn.get(ee.texture).__webglTexture=pe,Rn.get(ee.depthTexture).__webglTexture=Ae;const ye=Rn.get(ee);ye.__hasExternalTextures=!0,ye.__hasExternalTextures&&(ye.__autoAllocateDepthBuffer=Ae===void 0,ye.__autoAllocateDepthBuffer||Nt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ye.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ee,pe){const Ae=Rn.get(ee);Ae.__webglFramebuffer=pe,Ae.__useDefaultFramebuffer=pe===void 0},this.setRenderTarget=function(ee,pe=0,Ae=0){N=ee,z=pe,F=Ae;let ye=!0,ve=null,Ke=!1,ht=!1;if(ee){const vt=Rn.get(ee);vt.__useDefaultFramebuffer!==void 0?(wn.bindFramebuffer(36160,null),ye=!1):vt.__webglFramebuffer===void 0?At.setupRenderTarget(ee):vt.__hasExternalTextures&&At.rebindTextures(ee,Rn.get(ee.texture).__webglTexture,Rn.get(ee.depthTexture).__webglTexture);const Jt=ee.texture;(Jt.isData3DTexture||Jt.isDataArrayTexture||Jt.isCompressedArrayTexture)&&(ht=!0);const Yt=Rn.get(ee).__webglFramebuffer;ee.isWebGLCubeRenderTarget?(ve=Yt[pe],Ke=!0):qt.isWebGL2&&ee.samples>0&&At.useMultisampledRTT(ee)===!1?ve=Rn.get(ee).__webglMultisampledFramebuffer:ve=Yt,Q.copy(ee.viewport),re.copy(ee.scissor),Z=ee.scissorTest}else Q.copy(le).multiplyScalar(De).floor(),re.copy(fe).multiplyScalar(De).floor(),Z=Oe;if(wn.bindFramebuffer(36160,ve)&&qt.drawBuffers&&ye&&wn.drawBuffers(ee,ve),wn.viewport(Q),wn.scissor(re),wn.setScissorTest(Z),Ke){const vt=Rn.get(ee.texture);et.framebufferTexture2D(36160,36064,34069+pe,vt.__webglTexture,Ae)}else if(ht){const vt=Rn.get(ee.texture),Jt=pe||0;et.framebufferTextureLayer(36160,36064,vt.__webglTexture,Ae||0,Jt)}V=-1},this.readRenderTargetPixels=function(ee,pe,Ae,ye,ve,Ke,ht){if(!(ee&&ee.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let zt=Rn.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&ht!==void 0&&(zt=zt[ht]),zt){wn.bindFramebuffer(36160,zt);try{const vt=ee.texture,Jt=vt.format,Yt=vt.type;if(Jt!==$a&&Nn.convert(Jt)!==et.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Xt=Yt===Fy&&(Nt.has("EXT_color_buffer_half_float")||qt.isWebGL2&&Nt.has("EXT_color_buffer_float"));if(Yt!==Kd&&Nn.convert(Yt)!==et.getParameter(35738)&&!(Yt===Bd&&(qt.isWebGL2||Nt.has("OES_texture_float")||Nt.has("WEBGL_color_buffer_float")))&&!Xt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}pe>=0&&pe<=ee.width-ye&&Ae>=0&&Ae<=ee.height-ve&&et.readPixels(pe,Ae,ye,ve,Nn.convert(Jt),Nn.convert(Yt),Ke)}finally{const vt=N!==null?Rn.get(N).__webglFramebuffer:null;wn.bindFramebuffer(36160,vt)}}},this.copyFramebufferToTexture=function(ee,pe,Ae=0){const ye=Math.pow(2,-Ae),ve=Math.floor(pe.image.width*ye),Ke=Math.floor(pe.image.height*ye);At.setTexture2D(pe,0),et.copyTexSubImage2D(3553,Ae,0,0,ee.x,ee.y,ve,Ke),wn.unbindTexture()},this.copyTextureToTexture=function(ee,pe,Ae,ye=0){const ve=pe.image.width,Ke=pe.image.height,ht=Nn.convert(Ae.format),zt=Nn.convert(Ae.type);At.setTexture2D(Ae,0),et.pixelStorei(37440,Ae.flipY),et.pixelStorei(37441,Ae.premultiplyAlpha),et.pixelStorei(3317,Ae.unpackAlignment),pe.isDataTexture?et.texSubImage2D(3553,ye,ee.x,ee.y,ve,Ke,ht,zt,pe.image.data):pe.isCompressedTexture?et.compressedTexSubImage2D(3553,ye,ee.x,ee.y,pe.mipmaps[0].width,pe.mipmaps[0].height,ht,pe.mipmaps[0].data):et.texSubImage2D(3553,ye,ee.x,ee.y,ht,zt,pe.image),ye===0&&Ae.generateMipmaps&&et.generateMipmap(3553),wn.unbindTexture()},this.copyTextureToTexture3D=function(ee,pe,Ae,ye,ve=0){if(L.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ke=ee.max.x-ee.min.x+1,ht=ee.max.y-ee.min.y+1,zt=ee.max.z-ee.min.z+1,vt=Nn.convert(ye.format),Jt=Nn.convert(ye.type);let Yt;if(ye.isData3DTexture)At.setTexture3D(ye,0),Yt=32879;else if(ye.isDataArrayTexture)At.setTexture2DArray(ye,0),Yt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}et.pixelStorei(37440,ye.flipY),et.pixelStorei(37441,ye.premultiplyAlpha),et.pixelStorei(3317,ye.unpackAlignment);const Xt=et.getParameter(3314),gn=et.getParameter(32878),Xn=et.getParameter(3316),ii=et.getParameter(3315),Sn=et.getParameter(32877),Jn=Ae.isCompressedTexture?Ae.mipmaps[0]:Ae.image;et.pixelStorei(3314,Jn.width),et.pixelStorei(32878,Jn.height),et.pixelStorei(3316,ee.min.x),et.pixelStorei(3315,ee.min.y),et.pixelStorei(32877,ee.min.z),Ae.isDataTexture||Ae.isData3DTexture?et.texSubImage3D(Yt,ve,pe.x,pe.y,pe.z,Ke,ht,zt,vt,Jt,Jn.data):Ae.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),et.compressedTexSubImage3D(Yt,ve,pe.x,pe.y,pe.z,Ke,ht,zt,vt,Jn.data)):et.texSubImage3D(Yt,ve,pe.x,pe.y,pe.z,Ke,ht,zt,vt,Jt,Jn),et.pixelStorei(3314,Xt),et.pixelStorei(32878,gn),et.pixelStorei(3316,Xn),et.pixelStorei(3315,ii),et.pixelStorei(32877,Sn),ve===0&&ye.generateMipmaps&&et.generateMipmap(Yt),wn.unbindTexture()},this.initTexture=function(ee){ee.isCubeTexture?At.setTextureCube(ee,0):ee.isData3DTexture?At.setTexture3D(ee,0):ee.isDataArrayTexture||ee.isCompressedArrayTexture?At.setTexture2DArray(ee,0):At.setTexture2D(ee,0),wn.unbindTexture()},this.resetState=function(){z=0,F=0,N=null,wn.reset(),yn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Object.defineProperties(aT.prototype,{physicallyCorrectLights:{get:function(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(n){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!n}}});class OV extends aT{}OV.prototype.isWebGL1Renderer=!0;class lT{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new An(e),this.density=t}clone(){return new lT(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class cT{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new An(e),this.near=t,this.far=i}clone(){return new cT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class xM extends tr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class M1{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Hv,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Fl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ma=new Fe;class Dp{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Ma.fromBufferAttribute(this,t),Ma.applyMatrix4(e),this.setXYZ(t,Ma.x,Ma.y,Ma.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ma.fromBufferAttribute(this,t),Ma.applyNormalMatrix(e),this.setXYZ(t,Ma.x,Ma.y,Ma.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ma.fromBufferAttribute(this,t),Ma.transformDirection(e),this.setXYZ(t,Ma.x,Ma.y,Ma.z);return this}setX(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Dr(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Nd(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Nd(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Nd(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Nd(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dr(t,this.array),i=Dr(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dr(t,this.array),i=Dr(i,this.array),r=Dr(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=Dr(t,this.array),i=Dr(i,this.array),r=Dr(r,this.array),o=Dr(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new vr(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Dp(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class PL extends Zs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new An(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let D_;const wx=new Fe,R_=new Fe,z_=new Fe,O_=new Gt,bx=new Gt,FV=new hi,Cb=new Fe,Sx=new Fe,Ib=new Fe,nF=new Gt,V2=new Gt,iF=new Gt;class BV extends tr{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",D_===void 0){D_=new Ti;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new M1(t,5);D_.setIndex([0,1,2,0,2,3]),D_.setAttribute("position",new Dp(i,3,0,!1)),D_.setAttribute("uv",new Dp(i,2,3,!1))}this.geometry=D_,this.material=e!==void 0?e:new PL,this.center=new Gt(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),R_.setFromMatrixScale(this.matrixWorld),FV.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),z_.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&R_.multiplyScalar(-z_.z);const i=this.material.rotation;let r,o;i!==0&&(o=Math.cos(i),r=Math.sin(i));const l=this.center;Pb(Cb.set(-.5,-.5,0),z_,l,R_,r,o),Pb(Sx.set(.5,-.5,0),z_,l,R_,r,o),Pb(Ib.set(.5,.5,0),z_,l,R_,r,o),nF.set(0,0),V2.set(1,0),iF.set(1,1);let s=e.ray.intersectTriangle(Cb,Sx,Ib,!1,wx);if(s===null&&(Pb(Sx.set(-.5,.5,0),z_,l,R_,r,o),V2.set(0,1),s=e.ray.intersectTriangle(Cb,Ib,Sx,!1,wx),s===null))return;const d=e.ray.origin.distanceTo(wx);d<e.near||d>e.far||t.push({distance:d,point:wx.clone(),uv:wc.getUV(wx,Cb,Sx,Ib,nF,V2,iF,new Gt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Pb(n,e,t,i,r,o){O_.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(bx.x=o*O_.x-r*O_.y,bx.y=r*O_.x+o*O_.y):bx.copy(O_),n.copy(e),n.x+=bx.x,n.y+=bx.y,n.applyMatrix4(FV)}const Lb=new Fe,rF=new Fe;class NV extends tr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const o=t[i];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let o;for(o=0;o<r.length&&!(t<r[o].distance);o++);return r.splice(o,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),e<o)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Lb.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Lb);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Lb.setFromMatrixPosition(e.matrixWorld),rF.setFromMatrixPosition(this.matrixWorld);const i=Lb.distanceTo(rF)/e.zoom;t[0].object.visible=!0;let r,o;for(r=1,o=t.length;r<o;r++){let l=t[r].distance;if(t[r].object.visible&&(l-=l*t[r].hysteresis),i>=l)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<o;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,o=i.length;r<o;r++){const l=i[r];t.object.levels.push({object:l.object.uuid,distance:l.distance,hysteresis:l.hysteresis})}return t}}const sF=new Fe,oF=new Tr,aF=new Tr,Wre=new Fe,lF=new hi;class LL extends To{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new hi,this.bindMatrixInverse=new hi}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Tr,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,r=this.geometry;oF.fromBufferAttribute(r.attributes.skinIndex,e),aF.fromBufferAttribute(r.attributes.skinWeight,e),sF.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const l=aF.getComponent(o);if(l!==0){const s=oF.getComponent(o);lF.multiplyMatrices(i.bones[s].matrixWorld,i.boneInverses[s]),t.addScaledVector(Wre.copy(sF).applyMatrix4(lF),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}class uT extends tr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class _y extends Jr{constructor(e=null,t=1,i=1,r,o,l,s,d,p=Ss,_=Ss,w,M){super(null,l,s,d,p,_,r,o,w,M),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const cF=new hi,Hre=new hi;class T1{constructor(e=[],t=[]){this.uuid=Fl(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new hi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new hi;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let o=0,l=e.length;o<l;o++){const s=e[o]?e[o].matrixWorld:Hre;cF.multiplyMatrices(s,t[o]),cF.toArray(i,o*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new T1(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=xV(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new _y(t,e,e,$a,Bd);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const o=e.bones[i];let l=t[o];l===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),l=new uT),this.bones.push(l),this.boneInverses.push(new hi().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,o=t.length;r<o;r++){const l=t[r];e.bones.push(l.uuid);const s=i[r];e.boneInverses.push(s.toArray())}return e}}class Vy extends vr{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const uF=new hi,hF=new hi,kb=[],jre=new hi,Mx=new To;class kL extends To{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vy(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let r=0;r<i;r++)this.setMatrixAt(r,jre)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(Mx.geometry=this.geometry,Mx.material=this.material,Mx.material!==void 0)for(let o=0;o<r;o++){this.getMatrixAt(o,uF),hF.multiplyMatrices(i,uF),Mx.matrixWorld=hF,Mx.raycast(e,kb);for(let l=0,s=kb.length;l<s;l++){const d=kb[l];d.instanceId=o,d.object=this,t.push(d)}kb.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Vy(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class ga extends Zs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new An(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const dF=new Fe,fF=new Fe,pF=new hi,G2=new v1,Db=new Gp;class Qd extends tr{constructor(e=new Ti,t=new ga){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)dF.fromBufferAttribute(t,r-1),fF.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=dF.distanceTo(fF);e.setAttribute("lineDistance",new qn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,l=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Db.copy(i.boundingSphere),Db.applyMatrix4(r),Db.radius+=o,e.ray.intersectsSphere(Db)===!1)return;pF.copy(r).invert(),G2.copy(e.ray).applyMatrix4(pF);const s=o/((this.scale.x+this.scale.y+this.scale.z)/3),d=s*s,p=new Fe,_=new Fe,w=new Fe,M=new Fe,A=this.isLineSegments?2:1,P=i.index,D=i.attributes.position;if(P!==null){const z=Math.max(0,l.start),F=Math.min(P.count,l.start+l.count);for(let N=z,V=F-1;N<V;N+=A){const j=P.getX(N),Q=P.getX(N+1);if(p.fromBufferAttribute(D,j),_.fromBufferAttribute(D,Q),G2.distanceSqToSegment(p,_,M,w)>d)continue;M.applyMatrix4(this.matrixWorld);const Z=e.ray.origin.distanceTo(M);Z<e.near||Z>e.far||t.push({distance:Z,point:w.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}else{const z=Math.max(0,l.start),F=Math.min(D.count,l.start+l.count);for(let N=z,V=F-1;N<V;N+=A){if(p.fromBufferAttribute(D,N),_.fromBufferAttribute(D,N+1),G2.distanceSqToSegment(p,_,M,w)>d)continue;M.applyMatrix4(this.matrixWorld);const Q=e.ray.origin.distanceTo(M);Q<e.near||Q>e.far||t.push({distance:Q,point:w.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const s=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}}const mF=new Fe,gF=new Fe;class Ou extends Qd{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)mF.fromBufferAttribute(t,r),gF.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+mF.distanceTo(gF);e.setAttribute("lineDistance",new qn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class DL extends Qd{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class hT extends Zs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new An(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const _F=new hi,xI=new v1,Rb=new Gp,zb=new Fe;class RL extends tr{constructor(e=new Ti,t=new hT){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,l=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Rb.copy(i.boundingSphere),Rb.applyMatrix4(r),Rb.radius+=o,e.ray.intersectsSphere(Rb)===!1)return;_F.copy(r).invert(),xI.copy(e.ray).applyMatrix4(_F);const s=o/((this.scale.x+this.scale.y+this.scale.z)/3),d=s*s,p=i.index,w=i.attributes.position;if(p!==null){const M=Math.max(0,l.start),A=Math.min(p.count,l.start+l.count);for(let P=M,L=A;P<L;P++){const D=p.getX(P);zb.fromBufferAttribute(w,D),yF(zb,D,d,r,e,t,this)}}else{const M=Math.max(0,l.start),A=Math.min(w.count,l.start+l.count);for(let P=M,L=A;P<L;P++)zb.fromBufferAttribute(w,P),yF(zb,P,d,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const s=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=o}}}}}function yF(n,e,t,i,r,o,l){const s=xI.distanceSqToPoint(n);if(s<t){const d=new Fe;xI.closestPointToPoint(n,d),d.applyMatrix4(i);const p=r.ray.origin.distanceTo(d);if(p<r.near||p>r.far)return;o.push({distance:p,distanceToRay:Math.sqrt(s),point:d,index:e,face:null,object:l})}}class qre extends Jr{constructor(e,t,i,r,o,l,s,d,p){super(e,t,i,r,o,l,s,d,p),this.isVideoTexture=!0,this.minFilter=l!==void 0?l:cs,this.magFilter=o!==void 0?o:cs,this.generateMipmaps=!1;const _=this;function w(){_.needsUpdate=!0,e.requestVideoFrameCallback(w)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(w)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Zre extends Jr{constructor(e,t,i){super({width:e,height:t}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=Ss,this.minFilter=Ss,this.generateMipmaps=!1,this.needsUpdate=!0}}class zL extends Jr{constructor(e,t,i,r,o,l,s,d,p,_,w,M){super(null,l,s,d,p,_,r,o,w,M),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Xre extends zL{constructor(e,t,i,r,o,l){super(e,t,i,o,l),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=No}}class $re extends Jr{constructor(e,t,i,r,o,l,s,d,p){super(e,t,i,r,o,l,s,d,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Fu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),o=0;t.push(0);for(let l=1;l<=e;l++)i=this.getPoint(l/e),o+=i.distanceTo(r),t.push(o),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const o=i.length;let l;t?l=t:l=e*i[o-1];let s=0,d=o-1,p;for(;s<=d;)if(r=Math.floor(s+(d-s)/2),p=i[r]-l,p<0)s=r+1;else if(p>0)d=r-1;else{d=r;break}if(r=d,i[r]===l)return r/(o-1);const _=i[r],M=i[r+1]-_,A=(l-_)/M;return(r+A)/(o-1)}getTangent(e,t){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);const l=this.getPoint(r),s=this.getPoint(o),d=t||(l.isVector2?new Gt:new Fe);return d.copy(s).sub(l).normalize(),d}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new Fe,r=[],o=[],l=[],s=new Fe,d=new hi;for(let A=0;A<=e;A++){const P=A/e;r[A]=this.getTangentAt(P,new Fe)}o[0]=new Fe,l[0]=new Fe;let p=Number.MAX_VALUE;const _=Math.abs(r[0].x),w=Math.abs(r[0].y),M=Math.abs(r[0].z);_<=p&&(p=_,i.set(1,0,0)),w<=p&&(p=w,i.set(0,1,0)),M<=p&&i.set(0,0,1),s.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],s),l[0].crossVectors(r[0],o[0]);for(let A=1;A<=e;A++){if(o[A]=o[A-1].clone(),l[A]=l[A-1].clone(),s.crossVectors(r[A-1],r[A]),s.length()>Number.EPSILON){s.normalize();const P=Math.acos(Fs(r[A-1].dot(r[A]),-1,1));o[A].applyMatrix4(d.makeRotationAxis(s,P))}l[A].crossVectors(r[A],o[A])}if(t===!0){let A=Math.acos(Fs(o[0].dot(o[e]),-1,1));A/=e,r[0].dot(s.crossVectors(o[0],o[e]))>0&&(A=-A);for(let P=1;P<=e;P++)o[P].applyMatrix4(d.makeRotationAxis(r[P],A*P)),l[P].crossVectors(r[P],o[P])}return{tangents:r,normals:o,binormals:l}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class dT extends Fu{constructor(e=0,t=0,i=1,r=1,o=0,l=Math.PI*2,s=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=l,this.aClockwise=s,this.aRotation=d}getPoint(e,t){const i=t||new Gt,r=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const l=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(l?o=0:o=r),this.aClockwise===!0&&!l&&(o===r?o=-r:o=o-r);const s=this.aStartAngle+e*o;let d=this.aX+this.xRadius*Math.cos(s),p=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){const _=Math.cos(this.aRotation),w=Math.sin(this.aRotation),M=d-this.aX,A=p-this.aY;d=M*_-A*w+this.aX,p=M*w+A*_+this.aY}return i.set(d,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class UV extends dT{constructor(e,t,i,r,o,l){super(e,t,i,i,r,o,l),this.isArcCurve=!0,this.type="ArcCurve"}}function OL(){let n=0,e=0,t=0,i=0;function r(o,l,s,d){n=o,e=s,t=-3*o+3*l-2*s-d,i=2*o-2*l+s+d}return{initCatmullRom:function(o,l,s,d,p){r(l,s,p*(s-o),p*(d-l))},initNonuniformCatmullRom:function(o,l,s,d,p,_,w){let M=(l-o)/p-(s-o)/(p+_)+(s-l)/_,A=(s-l)/_-(d-l)/(_+w)+(d-s)/w;M*=_,A*=_,r(l,s,M,A)},calc:function(o){const l=o*o,s=l*o;return n+e*o+t*l+i*s}}}const Ob=new Fe,W2=new OL,H2=new OL,j2=new OL;class VV extends Fu{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new Fe){const i=t,r=this.points,o=r.length,l=(o-(this.closed?0:1))*e;let s=Math.floor(l),d=l-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/o)+1)*o:d===0&&s===o-1&&(s=o-2,d=1);let p,_;this.closed||s>0?p=r[(s-1)%o]:(Ob.subVectors(r[0],r[1]).add(r[0]),p=Ob);const w=r[s%o],M=r[(s+1)%o];if(this.closed||s+2<o?_=r[(s+2)%o]:(Ob.subVectors(r[o-1],r[o-2]).add(r[o-1]),_=Ob),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let P=Math.pow(p.distanceToSquared(w),A),L=Math.pow(w.distanceToSquared(M),A),D=Math.pow(M.distanceToSquared(_),A);L<1e-4&&(L=1),P<1e-4&&(P=L),D<1e-4&&(D=L),W2.initNonuniformCatmullRom(p.x,w.x,M.x,_.x,P,L,D),H2.initNonuniformCatmullRom(p.y,w.y,M.y,_.y,P,L,D),j2.initNonuniformCatmullRom(p.z,w.z,M.z,_.z,P,L,D)}else this.curveType==="catmullrom"&&(W2.initCatmullRom(p.x,w.x,M.x,_.x,this.tension),H2.initCatmullRom(p.y,w.y,M.y,_.y,this.tension),j2.initCatmullRom(p.z,w.z,M.z,_.z,this.tension));return i.set(W2.calc(d),H2.calc(d),j2.calc(d)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new Fe().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function xF(n,e,t,i,r){const o=(i-e)*.5,l=(r-t)*.5,s=n*n,d=n*s;return(2*t-2*i+o+l)*d+(-3*t+3*i-2*o-l)*s+o*n+t}function Yre(n,e){const t=1-n;return t*t*e}function Kre(n,e){return 2*(1-n)*n*e}function Jre(n,e){return n*n*e}function cv(n,e,t,i){return Yre(n,e)+Kre(n,t)+Jre(n,i)}function Qre(n,e){const t=1-n;return t*t*t*e}function ese(n,e){const t=1-n;return 3*t*t*n*e}function tse(n,e){return 3*(1-n)*n*n*e}function nse(n,e){return n*n*n*e}function uv(n,e,t,i,r){return Qre(n,e)+ese(n,t)+tse(n,i)+nse(n,r)}class FL extends Fu{constructor(e=new Gt,t=new Gt,i=new Gt,r=new Gt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Gt){const i=t,r=this.v0,o=this.v1,l=this.v2,s=this.v3;return i.set(uv(e,r.x,o.x,l.x,s.x),uv(e,r.y,o.y,l.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class GV extends Fu{constructor(e=new Fe,t=new Fe,i=new Fe,r=new Fe){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Fe){const i=t,r=this.v0,o=this.v1,l=this.v2,s=this.v3;return i.set(uv(e,r.x,o.x,l.x,s.x),uv(e,r.y,o.y,l.y,s.y),uv(e,r.z,o.z,l.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class fT extends Fu{constructor(e=new Gt,t=new Gt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Gt){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Gt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class WV extends Fu{constructor(e=new Fe,t=new Fe){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Fe){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Fe){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class BL extends Fu{constructor(e=new Gt,t=new Gt,i=new Gt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Gt){const i=t,r=this.v0,o=this.v1,l=this.v2;return i.set(cv(e,r.x,o.x,l.x),cv(e,r.y,o.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class NL extends Fu{constructor(e=new Fe,t=new Fe,i=new Fe){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Fe){const i=t,r=this.v0,o=this.v1,l=this.v2;return i.set(cv(e,r.x,o.x,l.x),cv(e,r.y,o.y,l.y),cv(e,r.z,o.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class UL extends Fu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Gt){const i=t,r=this.points,o=(r.length-1)*e,l=Math.floor(o),s=o-l,d=r[l===0?l:l-1],p=r[l],_=r[l>r.length-2?r.length-1:l+1],w=r[l>r.length-3?r.length-1:l+2];return i.set(xF(s,d.x,p.x,_.x,w.x),xF(s,d.y,p.y,_.y,w.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new Gt().fromArray(r))}return this}}var VL=Object.freeze({__proto__:null,ArcCurve:UV,CatmullRomCurve3:VV,CubicBezierCurve:FL,CubicBezierCurve3:GV,EllipseCurve:dT,LineCurve:fT,LineCurve3:WV,QuadraticBezierCurve:BL,QuadraticBezierCurve3:NL,SplineCurve:UL});class HV extends Fu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new fT(t,e))}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let o=0;for(;o<r.length;){if(r[o]>=i){const l=r[o]-i,s=this.curves[o],d=s.getLength(),p=d===0?0:1-l/d;return s.getPointAt(p,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,o=this.curves;r<o.length;r++){const l=o[r],s=l.isEllipseCurve?e*2:l.isLineCurve||l.isLineCurve3?1:l.isSplineCurve?e*l.points.length:e,d=l.getPoints(s);for(let p=0;p<d.length;p++){const _=d[p];i&&i.equals(_)||(t.push(_),i=_)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new VL[r.type]().fromJSON(r))}return this}}class Zv extends HV{constructor(e){super(),this.type="Path",this.currentPoint=new Gt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new fT(this.currentPoint.clone(),new Gt(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const o=new BL(this.currentPoint.clone(),new Gt(e,t),new Gt(i,r));return this.curves.push(o),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,o,l){const s=new FL(this.currentPoint.clone(),new Gt(e,t),new Gt(i,r),new Gt(o,l));return this.curves.push(s),this.currentPoint.set(o,l),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new UL(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,o,l){const s=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+s,t+d,i,r,o,l),this}absarc(e,t,i,r,o,l){return this.absellipse(e,t,i,i,r,o,l),this}ellipse(e,t,i,r,o,l,s,d){const p=this.currentPoint.x,_=this.currentPoint.y;return this.absellipse(e+p,t+_,i,r,o,l,s,d),this}absellipse(e,t,i,r,o,l,s,d){const p=new dT(e,t,i,r,o,l,s,d);if(this.curves.length>0){const w=p.getPoint(0);w.equals(this.currentPoint)||this.lineTo(w.x,w.y)}this.curves.push(p);const _=p.getPoint(1);return this.currentPoint.copy(_),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class r0 extends Ti{constructor(e=[new Gt(0,-.5),new Gt(.5,0),new Gt(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=Fs(r,0,Math.PI*2);const o=[],l=[],s=[],d=[],p=[],_=1/t,w=new Fe,M=new Gt,A=new Fe,P=new Fe,L=new Fe;let D=0,z=0;for(let F=0;F<=e.length-1;F++)switch(F){case 0:D=e[F+1].x-e[F].x,z=e[F+1].y-e[F].y,A.x=z*1,A.y=-D,A.z=z*0,L.copy(A),A.normalize(),d.push(A.x,A.y,A.z);break;case e.length-1:d.push(L.x,L.y,L.z);break;default:D=e[F+1].x-e[F].x,z=e[F+1].y-e[F].y,A.x=z*1,A.y=-D,A.z=z*0,P.copy(A),A.x+=L.x,A.y+=L.y,A.z+=L.z,A.normalize(),d.push(A.x,A.y,A.z),L.copy(P)}for(let F=0;F<=t;F++){const N=i+F*_*r,V=Math.sin(N),j=Math.cos(N);for(let Q=0;Q<=e.length-1;Q++){w.x=e[Q].x*V,w.y=e[Q].y,w.z=e[Q].x*j,l.push(w.x,w.y,w.z),M.x=F/t,M.y=Q/(e.length-1),s.push(M.x,M.y);const re=d[3*Q+0]*V,Z=d[3*Q+1],ne=d[3*Q+0]*j;p.push(re,Z,ne)}}for(let F=0;F<t;F++)for(let N=0;N<e.length-1;N++){const V=N+F*e.length,j=V,Q=V+e.length,re=V+e.length+1,Z=V+1;o.push(j,Q,Z),o.push(re,Z,Q)}this.setIndex(o),this.setAttribute("position",new qn(l,3)),this.setAttribute("uv",new qn(s,2)),this.setAttribute("normal",new qn(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r0(e.points,e.segments,e.phiStart,e.phiLength)}}class E1 extends r0{constructor(e=1,t=1,i=4,r=8){const o=new Zv;o.absarc(0,-t/2,e,Math.PI*1.5,0),o.absarc(0,t/2,e,0,Math.PI*.5),super(o.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new E1(e.radius,e.length,e.capSegments,e.radialSegments)}}class A1 extends Ti{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const o=[],l=[],s=[],d=[],p=new Fe,_=new Gt;l.push(0,0,0),s.push(0,0,1),d.push(.5,.5);for(let w=0,M=3;w<=t;w++,M+=3){const A=i+w/t*r;p.x=e*Math.cos(A),p.y=e*Math.sin(A),l.push(p.x,p.y,p.z),s.push(0,0,1),_.x=(l[M]/e+1)/2,_.y=(l[M+1]/e+1)/2,d.push(_.x,_.y)}for(let w=1;w<=t;w++)o.push(w,w+1,0);this.setIndex(o),this.setAttribute("position",new qn(l,3)),this.setAttribute("normal",new qn(s,3)),this.setAttribute("uv",new qn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new A1(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class kg extends Ti{constructor(e=1,t=1,i=1,r=32,o=1,l=!1,s=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:o,openEnded:l,thetaStart:s,thetaLength:d};const p=this;r=Math.floor(r),o=Math.floor(o);const _=[],w=[],M=[],A=[];let P=0;const L=[],D=i/2;let z=0;F(),l===!1&&(e>0&&N(!0),t>0&&N(!1)),this.setIndex(_),this.setAttribute("position",new qn(w,3)),this.setAttribute("normal",new qn(M,3)),this.setAttribute("uv",new qn(A,2));function F(){const V=new Fe,j=new Fe;let Q=0;const re=(t-e)/i;for(let Z=0;Z<=o;Z++){const ne=[],he=Z/o,De=he*(t-e)+e;for(let He=0;He<=r;He++){const ae=He/r,le=ae*d+s,fe=Math.sin(le),Oe=Math.cos(le);j.x=De*fe,j.y=-he*i+D,j.z=De*Oe,w.push(j.x,j.y,j.z),V.set(fe,re,Oe).normalize(),M.push(V.x,V.y,V.z),A.push(ae,1-he),ne.push(P++)}L.push(ne)}for(let Z=0;Z<r;Z++)for(let ne=0;ne<o;ne++){const he=L[ne][Z],De=L[ne+1][Z],He=L[ne+1][Z+1],ae=L[ne][Z+1];_.push(he,De,ae),_.push(De,He,ae),Q+=6}p.addGroup(z,Q,0),z+=Q}function N(V){const j=P,Q=new Gt,re=new Fe;let Z=0;const ne=V===!0?e:t,he=V===!0?1:-1;for(let He=1;He<=r;He++)w.push(0,D*he,0),M.push(0,he,0),A.push(.5,.5),P++;const De=P;for(let He=0;He<=r;He++){const le=He/r*d+s,fe=Math.cos(le),Oe=Math.sin(le);re.x=ne*Oe,re.y=D*he,re.z=ne*fe,w.push(re.x,re.y,re.z),M.push(0,he,0),Q.x=fe*.5+.5,Q.y=Oe*.5*he+.5,A.push(Q.x,Q.y),P++}for(let He=0;He<r;He++){const ae=j+He,le=De+He;V===!0?_.push(le,le+1,ae):_.push(le+1,le,ae),Z+=3}p.addGroup(z,Z,V===!0?1:2),z+=Z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kg(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class C1 extends kg{constructor(e=1,t=1,i=32,r=1,o=!1,l=0,s=Math.PI*2){super(0,e,t,i,r,o,l,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:o,thetaStart:l,thetaLength:s}}static fromJSON(e){return new C1(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class tf extends Ti{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const o=[],l=[];s(r),p(i),_(),this.setAttribute("position",new qn(o,3)),this.setAttribute("normal",new qn(o.slice(),3)),this.setAttribute("uv",new qn(l,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function s(F){const N=new Fe,V=new Fe,j=new Fe;for(let Q=0;Q<t.length;Q+=3)A(t[Q+0],N),A(t[Q+1],V),A(t[Q+2],j),d(N,V,j,F)}function d(F,N,V,j){const Q=j+1,re=[];for(let Z=0;Z<=Q;Z++){re[Z]=[];const ne=F.clone().lerp(V,Z/Q),he=N.clone().lerp(V,Z/Q),De=Q-Z;for(let He=0;He<=De;He++)He===0&&Z===Q?re[Z][He]=ne:re[Z][He]=ne.clone().lerp(he,He/De)}for(let Z=0;Z<Q;Z++)for(let ne=0;ne<2*(Q-Z)-1;ne++){const he=Math.floor(ne/2);ne%2===0?(M(re[Z][he+1]),M(re[Z+1][he]),M(re[Z][he])):(M(re[Z][he+1]),M(re[Z+1][he+1]),M(re[Z+1][he]))}}function p(F){const N=new Fe;for(let V=0;V<o.length;V+=3)N.x=o[V+0],N.y=o[V+1],N.z=o[V+2],N.normalize().multiplyScalar(F),o[V+0]=N.x,o[V+1]=N.y,o[V+2]=N.z}function _(){const F=new Fe;for(let N=0;N<o.length;N+=3){F.x=o[N+0],F.y=o[N+1],F.z=o[N+2];const V=D(F)/2/Math.PI+.5,j=z(F)/Math.PI+.5;l.push(V,1-j)}P(),w()}function w(){for(let F=0;F<l.length;F+=6){const N=l[F+0],V=l[F+2],j=l[F+4],Q=Math.max(N,V,j),re=Math.min(N,V,j);Q>.9&&re<.1&&(N<.2&&(l[F+0]+=1),V<.2&&(l[F+2]+=1),j<.2&&(l[F+4]+=1))}}function M(F){o.push(F.x,F.y,F.z)}function A(F,N){const V=F*3;N.x=e[V+0],N.y=e[V+1],N.z=e[V+2]}function P(){const F=new Fe,N=new Fe,V=new Fe,j=new Fe,Q=new Gt,re=new Gt,Z=new Gt;for(let ne=0,he=0;ne<o.length;ne+=9,he+=6){F.set(o[ne+0],o[ne+1],o[ne+2]),N.set(o[ne+3],o[ne+4],o[ne+5]),V.set(o[ne+6],o[ne+7],o[ne+8]),Q.set(l[he+0],l[he+1]),re.set(l[he+2],l[he+3]),Z.set(l[he+4],l[he+5]),j.copy(F).add(N).add(V).divideScalar(3);const De=D(j);L(Q,he+0,F,De),L(re,he+2,N,De),L(Z,he+4,V,De)}}function L(F,N,V,j){j<0&&F.x===1&&(l[N]=F.x-1),V.x===0&&V.z===0&&(l[N]=j/2/Math.PI+.5)}function D(F){return Math.atan2(F.z,-F.x)}function z(F){return Math.atan2(-F.y,Math.sqrt(F.x*F.x+F.z*F.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new tf(e.vertices,e.indices,e.radius,e.details)}}class I1 extends tf{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],l=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,l,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new I1(e.radius,e.detail)}}const Fb=new Fe,Bb=new Fe,q2=new Fe,Nb=new wc;class jV extends Ti{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),o=Math.cos(hg*t),l=e.getIndex(),s=e.getAttribute("position"),d=l?l.count:s.count,p=[0,0,0],_=["a","b","c"],w=new Array(3),M={},A=[];for(let P=0;P<d;P+=3){l?(p[0]=l.getX(P),p[1]=l.getX(P+1),p[2]=l.getX(P+2)):(p[0]=P,p[1]=P+1,p[2]=P+2);const{a:L,b:D,c:z}=Nb;if(L.fromBufferAttribute(s,p[0]),D.fromBufferAttribute(s,p[1]),z.fromBufferAttribute(s,p[2]),Nb.getNormal(q2),w[0]=`${Math.round(L.x*r)},${Math.round(L.y*r)},${Math.round(L.z*r)}`,w[1]=`${Math.round(D.x*r)},${Math.round(D.y*r)},${Math.round(D.z*r)}`,w[2]=`${Math.round(z.x*r)},${Math.round(z.y*r)},${Math.round(z.z*r)}`,!(w[0]===w[1]||w[1]===w[2]||w[2]===w[0]))for(let F=0;F<3;F++){const N=(F+1)%3,V=w[F],j=w[N],Q=Nb[_[F]],re=Nb[_[N]],Z=`${V}_${j}`,ne=`${j}_${V}`;ne in M&&M[ne]?(q2.dot(M[ne].normal)<=o&&(A.push(Q.x,Q.y,Q.z),A.push(re.x,re.y,re.z)),M[ne]=null):Z in M||(M[Z]={index0:p[F],index1:p[N],normal:q2.clone()})}}for(const P in M)if(M[P]){const{index0:L,index1:D}=M[P];Fb.fromBufferAttribute(s,L),Bb.fromBufferAttribute(s,D),A.push(Fb.x,Fb.y,Fb.z),A.push(Bb.x,Bb.y,Bb.z)}this.setAttribute("position",new qn(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class fg extends Zv{constructor(e){super(e),this.uuid=Fl(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Zv().fromJSON(r))}return this}}const ise={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let o=qV(n,0,r,t,!0);const l=[];if(!o||o.next===o.prev)return l;let s,d,p,_,w,M,A;if(i&&(o=lse(n,e,o,t)),n.length>80*t){s=p=n[0],d=_=n[1];for(let P=t;P<r;P+=t)w=n[P],M=n[P+1],w<s&&(s=w),M<d&&(d=M),w>p&&(p=w),M>_&&(_=M);A=Math.max(p-s,_-d),A=A!==0?32767/A:0}return Xv(o,l,t,s,d,A,0),l}};function qV(n,e,t,i,r){let o,l;if(r===xse(n,e,t,i)>0)for(o=e;o<t;o+=i)l=vF(o,n[o],n[o+1],l);else for(o=t-i;o>=e;o-=i)l=vF(o,n[o],n[o+1],l);return l&&pT(l,l.next)&&(Yv(l),l=l.next),l}function Tg(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(pT(t,t.next)||hs(t.prev,t,t.next)===0)){if(Yv(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Xv(n,e,t,i,r,o,l){if(!n)return;!l&&o&&fse(n,i,r,o);let s=n,d,p;for(;n.prev!==n.next;){if(d=n.prev,p=n.next,o?sse(n,i,r,o):rse(n)){e.push(d.i/t|0),e.push(n.i/t|0),e.push(p.i/t|0),Yv(n),n=p.next,s=p.next;continue}if(n=p,n===s){l?l===1?(n=ose(Tg(n),e,t),Xv(n,e,t,i,r,o,2)):l===2&&ase(n,e,t,i,r,o):Xv(Tg(n),e,t,i,r,o,1);break}}}function rse(n){const e=n.prev,t=n,i=n.next;if(hs(e,t,i)>=0)return!1;const r=e.x,o=t.x,l=i.x,s=e.y,d=t.y,p=i.y,_=r<o?r<l?r:l:o<l?o:l,w=s<d?s<p?s:p:d<p?d:p,M=r>o?r>l?r:l:o>l?o:l,A=s>d?s>p?s:p:d>p?d:p;let P=i.next;for(;P!==e;){if(P.x>=_&&P.x<=M&&P.y>=w&&P.y<=A&&ny(r,s,o,d,l,p,P.x,P.y)&&hs(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function sse(n,e,t,i){const r=n.prev,o=n,l=n.next;if(hs(r,o,l)>=0)return!1;const s=r.x,d=o.x,p=l.x,_=r.y,w=o.y,M=l.y,A=s<d?s<p?s:p:d<p?d:p,P=_<w?_<M?_:M:w<M?w:M,L=s>d?s>p?s:p:d>p?d:p,D=_>w?_>M?_:M:w>M?w:M,z=vI(A,P,e,t,i),F=vI(L,D,e,t,i);let N=n.prevZ,V=n.nextZ;for(;N&&N.z>=z&&V&&V.z<=F;){if(N.x>=A&&N.x<=L&&N.y>=P&&N.y<=D&&N!==r&&N!==l&&ny(s,_,d,w,p,M,N.x,N.y)&&hs(N.prev,N,N.next)>=0||(N=N.prevZ,V.x>=A&&V.x<=L&&V.y>=P&&V.y<=D&&V!==r&&V!==l&&ny(s,_,d,w,p,M,V.x,V.y)&&hs(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;N&&N.z>=z;){if(N.x>=A&&N.x<=L&&N.y>=P&&N.y<=D&&N!==r&&N!==l&&ny(s,_,d,w,p,M,N.x,N.y)&&hs(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;V&&V.z<=F;){if(V.x>=A&&V.x<=L&&V.y>=P&&V.y<=D&&V!==r&&V!==l&&ny(s,_,d,w,p,M,V.x,V.y)&&hs(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function ose(n,e,t){let i=n;do{const r=i.prev,o=i.next.next;!pT(r,o)&&ZV(r,i,i.next,o)&&$v(r,o)&&$v(o,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(o.i/t|0),Yv(i),Yv(i.next),i=n=o),i=i.next}while(i!==n);return Tg(i)}function ase(n,e,t,i,r,o){let l=n;do{let s=l.next.next;for(;s!==l.prev;){if(l.i!==s.i&&gse(l,s)){let d=XV(l,s);l=Tg(l,l.next),d=Tg(d,d.next),Xv(l,e,t,i,r,o,0),Xv(d,e,t,i,r,o,0);return}s=s.next}l=l.next}while(l!==n)}function lse(n,e,t,i){const r=[];let o,l,s,d,p;for(o=0,l=e.length;o<l;o++)s=e[o]*i,d=o<l-1?e[o+1]*i:n.length,p=qV(n,s,d,i,!1),p===p.next&&(p.steiner=!0),r.push(mse(p));for(r.sort(cse),o=0;o<r.length;o++)t=use(r[o],t);return t}function cse(n,e){return n.x-e.x}function use(n,e){const t=hse(n,e);if(!t)return e;const i=XV(t,n);return Tg(i,i.next),Tg(t,t.next)}function hse(n,e){let t=e,i=-1/0,r;const o=n.x,l=n.y;do{if(l<=t.y&&l>=t.next.y&&t.next.y!==t.y){const M=t.x+(l-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(M<=o&&M>i&&(i=M,r=t.x<t.next.x?t:t.next,M===o))return r}t=t.next}while(t!==e);if(!r)return null;const s=r,d=r.x,p=r.y;let _=1/0,w;t=r;do o>=t.x&&t.x>=d&&o!==t.x&&ny(l<p?o:i,l,d,p,l<p?i:o,l,t.x,t.y)&&(w=Math.abs(l-t.y)/(o-t.x),$v(t,n)&&(w<_||w===_&&(t.x>r.x||t.x===r.x&&dse(r,t)))&&(r=t,_=w)),t=t.next;while(t!==s);return r}function dse(n,e){return hs(n.prev,n,e.prev)<0&&hs(e.next,n,n.next)<0}function fse(n,e,t,i){let r=n;do r.z===0&&(r.z=vI(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,pse(r)}function pse(n){let e,t,i,r,o,l,s,d,p=1;do{for(t=n,n=null,o=null,l=0;t;){for(l++,i=t,s=0,e=0;e<p&&(s++,i=i.nextZ,!!i);e++);for(d=p;s>0||d>0&&i;)s!==0&&(d===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,s--):(r=i,i=i.nextZ,d--),o?o.nextZ=r:n=r,r.prevZ=o,o=r;t=i}o.nextZ=null,p*=2}while(l>1);return n}function vI(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function mse(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function ny(n,e,t,i,r,o,l,s){return(r-l)*(e-s)>=(n-l)*(o-s)&&(n-l)*(i-s)>=(t-l)*(e-s)&&(t-l)*(o-s)>=(r-l)*(i-s)}function gse(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!_se(n,e)&&($v(n,e)&&$v(e,n)&&yse(n,e)&&(hs(n.prev,n,e.prev)||hs(n,e.prev,e))||pT(n,e)&&hs(n.prev,n,n.next)>0&&hs(e.prev,e,e.next)>0)}function hs(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function pT(n,e){return n.x===e.x&&n.y===e.y}function ZV(n,e,t,i){const r=Vb(hs(n,e,t)),o=Vb(hs(n,e,i)),l=Vb(hs(t,i,n)),s=Vb(hs(t,i,e));return!!(r!==o&&l!==s||r===0&&Ub(n,t,e)||o===0&&Ub(n,i,e)||l===0&&Ub(t,n,i)||s===0&&Ub(t,e,i))}function Ub(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Vb(n){return n>0?1:n<0?-1:0}function _se(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&ZV(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function $v(n,e){return hs(n.prev,n,n.next)<0?hs(n,e,n.next)>=0&&hs(n,n.prev,e)>=0:hs(n,e,n.prev)<0||hs(n,n.next,e)<0}function yse(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,o=(n.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function XV(n,e){const t=new wI(n.i,n.x,n.y),i=new wI(e.i,e.x,e.y),r=n.next,o=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,o.next=i,i.prev=o,i}function vF(n,e,t,i){const r=new wI(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Yv(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function wI(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xse(n,e,t,i){let r=0;for(let o=e,l=t-i;o<t;o+=i)r+=(n[l]-n[o])*(n[o+1]+n[l+1]),l=o;return r}class Ah{static area(e){const t=e.length;let i=0;for(let r=t-1,o=0;o<t;r=o++)i+=e[r].x*e[o].y-e[o].x*e[r].y;return i*.5}static isClockWise(e){return Ah.area(e)<0}static triangulateShape(e,t){const i=[],r=[],o=[];wF(e),bF(i,e);let l=e.length;t.forEach(wF);for(let d=0;d<t.length;d++)r.push(l),l+=t[d].length,bF(i,t[d]);const s=ise.triangulate(i,r);for(let d=0;d<s.length;d+=3)o.push(s.slice(d,d+3));return o}}function wF(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function bF(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class P1 extends Ti{constructor(e=new fg([new Gt(.5,.5),new Gt(-.5,.5),new Gt(-.5,-.5),new Gt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],o=[];for(let s=0,d=e.length;s<d;s++){const p=e[s];l(p)}this.setAttribute("position",new qn(r,3)),this.setAttribute("uv",new qn(o,2)),this.computeVertexNormals();function l(s){const d=[],p=t.curveSegments!==void 0?t.curveSegments:12,_=t.steps!==void 0?t.steps:1,w=t.depth!==void 0?t.depth:1;let M=t.bevelEnabled!==void 0?t.bevelEnabled:!0,A=t.bevelThickness!==void 0?t.bevelThickness:.2,P=t.bevelSize!==void 0?t.bevelSize:A-.1,L=t.bevelOffset!==void 0?t.bevelOffset:0,D=t.bevelSegments!==void 0?t.bevelSegments:3;const z=t.extrudePath,F=t.UVGenerator!==void 0?t.UVGenerator:vse;let N,V=!1,j,Q,re,Z;z&&(N=z.getSpacedPoints(_),V=!0,M=!1,j=z.computeFrenetFrames(_,!1),Q=new Fe,re=new Fe,Z=new Fe),M||(D=0,A=0,P=0,L=0);const ne=s.extractPoints(p);let he=ne.shape;const De=ne.holes;if(!Ah.isClockWise(he)){he=he.reverse();for(let At=0,Ot=De.length;At<Ot;At++){const Ft=De[At];Ah.isClockWise(Ft)&&(De[At]=Ft.reverse())}}const ae=Ah.triangulateShape(he,De),le=he;for(let At=0,Ot=De.length;At<Ot;At++){const Ft=De[At];he=he.concat(Ft)}function fe(At,Ot,Ft){return Ot||console.error("THREE.ExtrudeGeometry: vec does not exist"),At.clone().addScaledVector(Ot,Ft)}const Oe=he.length,We=ae.length;function ce(At,Ot,Ft){let Cn,pn,Vn;const On=At.x-Ot.x,Zn=At.y-Ot.y,ai=Ft.x-At.x,Ei=Ft.y-At.y,Be=On*On+Zn*Zn,Se=On*Ei-Zn*ai;if(Math.abs(Se)>Number.EPSILON){const St=Math.sqrt(Be),tn=Math.sqrt(ai*ai+Ei*Ei),nn=Ot.x-Zn/St,fn=Ot.y+On/St,Nn=Ft.x-Ei/tn,yn=Ft.y+ai/tn,Dt=((Nn-nn)*Ei-(yn-fn)*ai)/(On*Ei-Zn*ai);Cn=nn+On*Dt-At.x,pn=fn+Zn*Dt-At.y;const Un=Cn*Cn+pn*pn;if(Un<=2)return new Gt(Cn,pn);Vn=Math.sqrt(Un/2)}else{let St=!1;On>Number.EPSILON?ai>Number.EPSILON&&(St=!0):On<-Number.EPSILON?ai<-Number.EPSILON&&(St=!0):Math.sign(Zn)===Math.sign(Ei)&&(St=!0),St?(Cn=-Zn,pn=On,Vn=Math.sqrt(Be)):(Cn=On,pn=Zn,Vn=Math.sqrt(Be/2))}return new Gt(Cn/Vn,pn/Vn)}const Te=[];for(let At=0,Ot=le.length,Ft=Ot-1,Cn=At+1;At<Ot;At++,Ft++,Cn++)Ft===Ot&&(Ft=0),Cn===Ot&&(Cn=0),Te[At]=ce(le[At],le[Ft],le[Cn]);const Pe=[];let Qe,Ne=Te.concat();for(let At=0,Ot=De.length;At<Ot;At++){const Ft=De[At];Qe=[];for(let Cn=0,pn=Ft.length,Vn=pn-1,On=Cn+1;Cn<pn;Cn++,Vn++,On++)Vn===pn&&(Vn=0),On===pn&&(On=0),Qe[Cn]=ce(Ft[Cn],Ft[Vn],Ft[On]);Pe.push(Qe),Ne=Ne.concat(Qe)}for(let At=0;At<D;At++){const Ot=At/D,Ft=A*Math.cos(Ot*Math.PI/2),Cn=P*Math.sin(Ot*Math.PI/2)+L;for(let pn=0,Vn=le.length;pn<Vn;pn++){const On=fe(le[pn],Te[pn],Cn);Nt(On.x,On.y,-Ft)}for(let pn=0,Vn=De.length;pn<Vn;pn++){const On=De[pn];Qe=Pe[pn];for(let Zn=0,ai=On.length;Zn<ai;Zn++){const Ei=fe(On[Zn],Qe[Zn],Cn);Nt(Ei.x,Ei.y,-Ft)}}}const nt=P+L;for(let At=0;At<Oe;At++){const Ot=M?fe(he[At],Ne[At],nt):he[At];V?(re.copy(j.normals[0]).multiplyScalar(Ot.x),Q.copy(j.binormals[0]).multiplyScalar(Ot.y),Z.copy(N[0]).add(re).add(Q),Nt(Z.x,Z.y,Z.z)):Nt(Ot.x,Ot.y,0)}for(let At=1;At<=_;At++)for(let Ot=0;Ot<Oe;Ot++){const Ft=M?fe(he[Ot],Ne[Ot],nt):he[Ot];V?(re.copy(j.normals[At]).multiplyScalar(Ft.x),Q.copy(j.binormals[At]).multiplyScalar(Ft.y),Z.copy(N[At]).add(re).add(Q),Nt(Z.x,Z.y,Z.z)):Nt(Ft.x,Ft.y,w/_*At)}for(let At=D-1;At>=0;At--){const Ot=At/D,Ft=A*Math.cos(Ot*Math.PI/2),Cn=P*Math.sin(Ot*Math.PI/2)+L;for(let pn=0,Vn=le.length;pn<Vn;pn++){const On=fe(le[pn],Te[pn],Cn);Nt(On.x,On.y,w+Ft)}for(let pn=0,Vn=De.length;pn<Vn;pn++){const On=De[pn];Qe=Pe[pn];for(let Zn=0,ai=On.length;Zn<ai;Zn++){const Ei=fe(On[Zn],Qe[Zn],Cn);V?Nt(Ei.x,Ei.y+N[_-1].y,N[_-1].x+Ft):Nt(Ei.x,Ei.y,w+Ft)}}}ze(),et();function ze(){const At=r.length/3;if(M){let Ot=0,Ft=Oe*Ot;for(let Cn=0;Cn<We;Cn++){const pn=ae[Cn];qt(pn[2]+Ft,pn[1]+Ft,pn[0]+Ft)}Ot=_+D*2,Ft=Oe*Ot;for(let Cn=0;Cn<We;Cn++){const pn=ae[Cn];qt(pn[0]+Ft,pn[1]+Ft,pn[2]+Ft)}}else{for(let Ot=0;Ot<We;Ot++){const Ft=ae[Ot];qt(Ft[2],Ft[1],Ft[0])}for(let Ot=0;Ot<We;Ot++){const Ft=ae[Ot];qt(Ft[0]+Oe*_,Ft[1]+Oe*_,Ft[2]+Oe*_)}}i.addGroup(At,r.length/3-At,0)}function et(){const At=r.length/3;let Ot=0;Et(le,Ot),Ot+=le.length;for(let Ft=0,Cn=De.length;Ft<Cn;Ft++){const pn=De[Ft];Et(pn,Ot),Ot+=pn.length}i.addGroup(At,r.length/3-At,1)}function Et(At,Ot){let Ft=At.length;for(;--Ft>=0;){const Cn=Ft;let pn=Ft-1;pn<0&&(pn=At.length-1);for(let Vn=0,On=_+D*2;Vn<On;Vn++){const Zn=Oe*Vn,ai=Oe*(Vn+1),Ei=Ot+Cn+Zn,Be=Ot+pn+Zn,Se=Ot+pn+ai,St=Ot+Cn+ai;wn(Ei,Be,Se,St)}}}function Nt(At,Ot,Ft){d.push(At),d.push(Ot),d.push(Ft)}function qt(At,Ot,Ft){_n(At),_n(Ot),_n(Ft);const Cn=r.length/3,pn=F.generateTopUV(i,r,Cn-3,Cn-2,Cn-1);Rn(pn[0]),Rn(pn[1]),Rn(pn[2])}function wn(At,Ot,Ft,Cn){_n(At),_n(Ot),_n(Cn),_n(Ot),_n(Ft),_n(Cn);const pn=r.length/3,Vn=F.generateSideWallUV(i,r,pn-6,pn-3,pn-2,pn-1);Rn(Vn[0]),Rn(Vn[1]),Rn(Vn[3]),Rn(Vn[1]),Rn(Vn[2]),Rn(Vn[3])}function _n(At){r.push(d[At*3+0]),r.push(d[At*3+1]),r.push(d[At*3+2])}function Rn(At){o.push(At.x),o.push(At.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return wse(t,i,e)}static fromJSON(e,t){const i=[];for(let o=0,l=e.shapes.length;o<l;o++){const s=t[e.shapes[o]];i.push(s)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new VL[r.type]().fromJSON(r)),new P1(i,e.options)}}const vse={generateTopUV:function(n,e,t,i,r){const o=e[t*3],l=e[t*3+1],s=e[i*3],d=e[i*3+1],p=e[r*3],_=e[r*3+1];return[new Gt(o,l),new Gt(s,d),new Gt(p,_)]},generateSideWallUV:function(n,e,t,i,r,o){const l=e[t*3],s=e[t*3+1],d=e[t*3+2],p=e[i*3],_=e[i*3+1],w=e[i*3+2],M=e[r*3],A=e[r*3+1],P=e[r*3+2],L=e[o*3],D=e[o*3+1],z=e[o*3+2];return Math.abs(s-_)<Math.abs(l-p)?[new Gt(l,1-d),new Gt(p,1-w),new Gt(M,1-P),new Gt(L,1-z)]:[new Gt(s,1-d),new Gt(_,1-w),new Gt(A,1-P),new Gt(D,1-z)]}};function wse(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const o=n[i];t.shapes.push(o.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class L1 extends tf{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new L1(e.radius,e.detail)}}class s0 extends tf{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new s0(e.radius,e.detail)}}class k1 extends Ti{constructor(e=.5,t=1,i=32,r=1,o=0,l=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:o,thetaLength:l},i=Math.max(3,i),r=Math.max(1,r);const s=[],d=[],p=[],_=[];let w=e;const M=(t-e)/r,A=new Fe,P=new Gt;for(let L=0;L<=r;L++){for(let D=0;D<=i;D++){const z=o+D/i*l;A.x=w*Math.cos(z),A.y=w*Math.sin(z),d.push(A.x,A.y,A.z),p.push(0,0,1),P.x=(A.x/t+1)/2,P.y=(A.y/t+1)/2,_.push(P.x,P.y)}w+=M}for(let L=0;L<r;L++){const D=L*(i+1);for(let z=0;z<i;z++){const F=z+D,N=F,V=F+i+1,j=F+i+2,Q=F+1;s.push(N,V,Q),s.push(V,j,Q)}}this.setIndex(s),this.setAttribute("position",new qn(d,3)),this.setAttribute("normal",new qn(p,3)),this.setAttribute("uv",new qn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new k1(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class D1 extends Ti{constructor(e=new fg([new Gt(0,.5),new Gt(-.5,-.5),new Gt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],o=[],l=[];let s=0,d=0;if(Array.isArray(e)===!1)p(e);else for(let _=0;_<e.length;_++)p(e[_]),this.addGroup(s,d,_),s+=d,d=0;this.setIndex(i),this.setAttribute("position",new qn(r,3)),this.setAttribute("normal",new qn(o,3)),this.setAttribute("uv",new qn(l,2));function p(_){const w=r.length/3,M=_.extractPoints(t);let A=M.shape;const P=M.holes;Ah.isClockWise(A)===!1&&(A=A.reverse());for(let D=0,z=P.length;D<z;D++){const F=P[D];Ah.isClockWise(F)===!0&&(P[D]=F.reverse())}const L=Ah.triangulateShape(A,P);for(let D=0,z=P.length;D<z;D++){const F=P[D];A=A.concat(F)}for(let D=0,z=A.length;D<z;D++){const F=A[D];r.push(F.x,F.y,0),o.push(0,0,1),l.push(F.x,F.y)}for(let D=0,z=L.length;D<z;D++){const F=L[D],N=F[0]+w,V=F[1]+w,j=F[2]+w;i.push(N,V,j),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return bse(t,e)}static fromJSON(e,t){const i=[];for(let r=0,o=e.shapes.length;r<o;r++){const l=t[e.shapes[r]];i.push(l)}return new D1(i,e.curveSegments)}}function bse(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class o0 extends Ti{constructor(e=1,t=32,i=16,r=0,o=Math.PI*2,l=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:o,thetaStart:l,thetaLength:s},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const d=Math.min(l+s,Math.PI);let p=0;const _=[],w=new Fe,M=new Fe,A=[],P=[],L=[],D=[];for(let z=0;z<=i;z++){const F=[],N=z/i;let V=0;z==0&&l==0?V=.5/t:z==i&&d==Math.PI&&(V=-.5/t);for(let j=0;j<=t;j++){const Q=j/t;w.x=-e*Math.cos(r+Q*o)*Math.sin(l+N*s),w.y=e*Math.cos(l+N*s),w.z=e*Math.sin(r+Q*o)*Math.sin(l+N*s),P.push(w.x,w.y,w.z),M.copy(w).normalize(),L.push(M.x,M.y,M.z),D.push(Q+V,1-N),F.push(p++)}_.push(F)}for(let z=0;z<i;z++)for(let F=0;F<t;F++){const N=_[z][F+1],V=_[z][F],j=_[z+1][F],Q=_[z+1][F+1];(z!==0||l>0)&&A.push(N,V,Q),(z!==i-1||d<Math.PI)&&A.push(V,j,Q)}this.setIndex(A),this.setAttribute("position",new qn(P,3)),this.setAttribute("normal",new qn(L,3)),this.setAttribute("uv",new qn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new o0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class R1 extends tf{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new R1(e.radius,e.detail)}}class z1 extends Ti{constructor(e=1,t=.4,i=12,r=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:o},i=Math.floor(i),r=Math.floor(r);const l=[],s=[],d=[],p=[],_=new Fe,w=new Fe,M=new Fe;for(let A=0;A<=i;A++)for(let P=0;P<=r;P++){const L=P/r*o,D=A/i*Math.PI*2;w.x=(e+t*Math.cos(D))*Math.cos(L),w.y=(e+t*Math.cos(D))*Math.sin(L),w.z=t*Math.sin(D),s.push(w.x,w.y,w.z),_.x=e*Math.cos(L),_.y=e*Math.sin(L),M.subVectors(w,_).normalize(),d.push(M.x,M.y,M.z),p.push(P/r),p.push(A/i)}for(let A=1;A<=i;A++)for(let P=1;P<=r;P++){const L=(r+1)*A+P-1,D=(r+1)*(A-1)+P-1,z=(r+1)*(A-1)+P,F=(r+1)*A+P;l.push(L,D,F),l.push(D,z,F)}this.setIndex(l),this.setAttribute("position",new qn(s,3)),this.setAttribute("normal",new qn(d,3)),this.setAttribute("uv",new qn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new z1(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class O1 extends Ti{constructor(e=1,t=.4,i=64,r=8,o=2,l=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:o,q:l},i=Math.floor(i),r=Math.floor(r);const s=[],d=[],p=[],_=[],w=new Fe,M=new Fe,A=new Fe,P=new Fe,L=new Fe,D=new Fe,z=new Fe;for(let N=0;N<=i;++N){const V=N/i*o*Math.PI*2;F(V,o,l,e,A),F(V+.01,o,l,e,P),D.subVectors(P,A),z.addVectors(P,A),L.crossVectors(D,z),z.crossVectors(L,D),L.normalize(),z.normalize();for(let j=0;j<=r;++j){const Q=j/r*Math.PI*2,re=-t*Math.cos(Q),Z=t*Math.sin(Q);w.x=A.x+(re*z.x+Z*L.x),w.y=A.y+(re*z.y+Z*L.y),w.z=A.z+(re*z.z+Z*L.z),d.push(w.x,w.y,w.z),M.subVectors(w,A).normalize(),p.push(M.x,M.y,M.z),_.push(N/i),_.push(j/r)}}for(let N=1;N<=i;N++)for(let V=1;V<=r;V++){const j=(r+1)*(N-1)+(V-1),Q=(r+1)*N+(V-1),re=(r+1)*N+V,Z=(r+1)*(N-1)+V;s.push(j,Q,Z),s.push(Q,re,Z)}this.setIndex(s),this.setAttribute("position",new qn(d,3)),this.setAttribute("normal",new qn(p,3)),this.setAttribute("uv",new qn(_,2));function F(N,V,j,Q,re){const Z=Math.cos(N),ne=Math.sin(N),he=j/V*N,De=Math.cos(he);re.x=Q*(2+De)*.5*Z,re.y=Q*(2+De)*ne*.5,re.z=Q*Math.sin(he)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new O1(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class F1 extends Ti{constructor(e=new NL(new Fe(-1,-1,0),new Fe(-1,1,0),new Fe(1,1,0)),t=64,i=1,r=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:o};const l=e.computeFrenetFrames(t,o);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const s=new Fe,d=new Fe,p=new Gt;let _=new Fe;const w=[],M=[],A=[],P=[];L(),this.setIndex(P),this.setAttribute("position",new qn(w,3)),this.setAttribute("normal",new qn(M,3)),this.setAttribute("uv",new qn(A,2));function L(){for(let N=0;N<t;N++)D(N);D(o===!1?t:0),F(),z()}function D(N){_=e.getPointAt(N/t,_);const V=l.normals[N],j=l.binormals[N];for(let Q=0;Q<=r;Q++){const re=Q/r*Math.PI*2,Z=Math.sin(re),ne=-Math.cos(re);d.x=ne*V.x+Z*j.x,d.y=ne*V.y+Z*j.y,d.z=ne*V.z+Z*j.z,d.normalize(),M.push(d.x,d.y,d.z),s.x=_.x+i*d.x,s.y=_.y+i*d.y,s.z=_.z+i*d.z,w.push(s.x,s.y,s.z)}}function z(){for(let N=1;N<=t;N++)for(let V=1;V<=r;V++){const j=(r+1)*(N-1)+(V-1),Q=(r+1)*N+(V-1),re=(r+1)*N+V,Z=(r+1)*(N-1)+V;P.push(j,Q,Z),P.push(Q,re,Z)}}function F(){for(let N=0;N<=t;N++)for(let V=0;V<=r;V++)p.x=N/t,p.y=V/r,A.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new F1(new VL[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class $V extends Ti{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new Fe,o=new Fe;if(e.index!==null){const l=e.attributes.position,s=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:s.count,materialIndex:0}]);for(let p=0,_=d.length;p<_;++p){const w=d[p],M=w.start,A=w.count;for(let P=M,L=M+A;P<L;P+=3)for(let D=0;D<3;D++){const z=s.getX(P+D),F=s.getX(P+(D+1)%3);r.fromBufferAttribute(l,z),o.fromBufferAttribute(l,F),SF(r,o,i)===!0&&(t.push(r.x,r.y,r.z),t.push(o.x,o.y,o.z))}}}else{const l=e.attributes.position;for(let s=0,d=l.count/3;s<d;s++)for(let p=0;p<3;p++){const _=3*s+p,w=3*s+(p+1)%3;r.fromBufferAttribute(l,_),o.fromBufferAttribute(l,w),SF(r,o,i)===!0&&(t.push(r.x,r.y,r.z),t.push(o.x,o.y,o.z))}}this.setAttribute("position",new qn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function SF(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var MF=Object.freeze({__proto__:null,BoxGeometry:Wp,CapsuleGeometry:E1,CircleGeometry:A1,ConeGeometry:C1,CylinderGeometry:kg,DodecahedronGeometry:I1,EdgesGeometry:jV,ExtrudeGeometry:P1,IcosahedronGeometry:L1,LatheGeometry:r0,OctahedronGeometry:s0,PlaneGeometry:n0,PolyhedronGeometry:tf,RingGeometry:k1,ShapeGeometry:D1,SphereGeometry:o0,TetrahedronGeometry:R1,TorusGeometry:z1,TorusKnotGeometry:O1,TubeGeometry:F1,WireframeGeometry:$V});class YV extends Zs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new An(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class KV extends Lh{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class B1 extends Zs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new An(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new An(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Up,this.normalScale=new Gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class nf extends B1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Fs(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new An(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new An(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new An(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class JV extends Zs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new An(16777215),this.specular=new An(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new An(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Up,this.normalScale=new Gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=x1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class QV extends Zs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new An(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new An(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Up,this.normalScale=new Gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class eG extends Zs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Up,this.normalScale=new Gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class tG extends Zs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new An(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new An(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Up,this.normalScale=new Gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=x1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class nG extends Zs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new An(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Up,this.normalScale=new Gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iG extends ga{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function gc(n,e,t){return GL(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)}function eg(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function GL(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function rG(n){function e(r,o){return n[r]-n[o]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function bI(n,e,t){const i=n.length,r=new n.constructor(i);for(let o=0,l=0;l!==i;++o){const s=t[o]*e;for(let d=0;d!==e;++d)r[l++]=n[s+d]}return r}function WL(n,e,t,i){let r=1,o=n[0];for(;o!==void 0&&o[i]===void 0;)o=n[r++];if(o===void 0)return;let l=o[i];if(l!==void 0)if(Array.isArray(l))do l=o[i],l!==void 0&&(e.push(o.time),t.push.apply(t,l)),o=n[r++];while(o!==void 0);else if(l.toArray!==void 0)do l=o[i],l!==void 0&&(e.push(o.time),l.toArray(t,t.length)),o=n[r++];while(o!==void 0);else do l=o[i],l!==void 0&&(e.push(o.time),t.push(l)),o=n[r++];while(o!==void 0)}function Sse(n,e,t,i,r=30){const o=n.clone();o.name=e;const l=[];for(let d=0;d<o.tracks.length;++d){const p=o.tracks[d],_=p.getValueSize(),w=[],M=[];for(let A=0;A<p.times.length;++A){const P=p.times[A]*r;if(!(P<t||P>=i)){w.push(p.times[A]);for(let L=0;L<_;++L)M.push(p.values[A*_+L])}}w.length!==0&&(p.times=eg(w,p.times.constructor),p.values=eg(M,p.values.constructor),l.push(p))}o.tracks=l;let s=1/0;for(let d=0;d<o.tracks.length;++d)s>o.tracks[d].times[0]&&(s=o.tracks[d].times[0]);for(let d=0;d<o.tracks.length;++d)o.tracks[d].shift(-1*s);return o.resetDuration(),o}function Mse(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,o=e/i;for(let l=0;l<r;++l){const s=t.tracks[l],d=s.ValueTypeName;if(d==="bool"||d==="string")continue;const p=n.tracks.find(function(z){return z.name===s.name&&z.ValueTypeName===d});if(p===void 0)continue;let _=0;const w=s.getValueSize();s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=w/3);let M=0;const A=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(M=A/3);const P=s.times.length-1;let L;if(o<=s.times[0]){const z=_,F=w-_;L=gc(s.values,z,F)}else if(o>=s.times[P]){const z=P*w+_,F=z+w-_;L=gc(s.values,z,F)}else{const z=s.createInterpolant(),F=_,N=w-_;z.evaluate(o),L=gc(z.resultBuffer,F,N)}d==="quaternion"&&new Ao().fromArray(L).normalize().conjugate().toArray(L);const D=p.times.length;for(let z=0;z<D;++z){const F=z*A+M;if(d==="quaternion")Ao.multiplyQuaternionsFlat(p.values,F,L,0,p.values,F);else{const N=A-M*2;for(let V=0;V<N;++V)p.values[F+V]-=L[V]}}}return n.blendMode=xL,n}const Tse={arraySlice:gc,convertArray:eg,isTypedArray:GL,getKeyframeOrder:rG,sortedArray:bI,flattenJSON:WL,subclip:Sse,makeClipAdditive:Mse};class a0{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],o=t[i-1];e:{t:{let l;n:{i:if(!(e<r)){for(let s=i+2;;){if(r===void 0){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===s)break;if(o=r,r=t[++i],e<r)break t}l=t.length;break n}if(!(e>=o)){const s=t[1];e<s&&(i=2,o=s);for(let d=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===d)break;if(r=o,o=t[--i-1],e>=o)break t}l=i,i=0;break n}break e}for(;i<l;){const s=i+l>>>1;e<t[s]?l=s:i=s+1}if(r=t[i],o=t[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let l=0;l!==r;++l)t[l]=i[o+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class sG extends a0{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Km,endingEnd:Km}}intervalChanged_(e,t,i){const r=this.parameterPositions;let o=e-2,l=e+1,s=r[o],d=r[l];if(s===void 0)switch(this.getSettings_().endingStart){case Jm:o=e,s=2*t-i;break;case Wv:o=r.length-2,s=t+r[o]-r[o+1];break;default:o=e,s=i}if(d===void 0)switch(this.getSettings_().endingEnd){case Jm:l=e,d=2*i-t;break;case Wv:l=1,d=i+r[1]-r[0];break;default:l=e-1,d=t}const p=(i-t)*.5,_=this.valueSize;this._weightPrev=p/(t-s),this._weightNext=p/(d-i),this._offsetPrev=o*_,this._offsetNext=l*_}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,s=this.valueSize,d=e*s,p=d-s,_=this._offsetPrev,w=this._offsetNext,M=this._weightPrev,A=this._weightNext,P=(i-t)/(r-t),L=P*P,D=L*P,z=-M*D+2*M*L-M*P,F=(1+M)*D+(-1.5-2*M)*L+(-.5+M)*P+1,N=(-1-A)*D+(1.5+A)*L+.5*P,V=A*D-A*L;for(let j=0;j!==s;++j)o[j]=z*l[_+j]+F*l[p+j]+N*l[d+j]+V*l[w+j];return o}}class HL extends a0{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,s=this.valueSize,d=e*s,p=d-s,_=(i-t)/(r-t),w=1-_;for(let M=0;M!==s;++M)o[M]=l[p+M]*w+l[d+M]*_;return o}}class oG extends a0{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Bu{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=eg(t,this.TimeBufferType),this.values=eg(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:eg(e.times,Array),values:eg(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new oG(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new HL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new sG(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case By:t=this.InterpolantFactoryMethodDiscrete;break;case Mg:t=this.InterpolantFactoryMethodLinear;break;case wS:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return By;case this.InterpolantFactoryMethodLinear:return Mg;case this.InterpolantFactoryMethodSmooth:return wS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let o=0,l=r-1;for(;o!==r&&i[o]<e;)++o;for(;l!==-1&&i[l]>t;)--l;if(++l,o!==0||l!==r){o>=l&&(l=Math.max(l,1),o=l-1);const s=this.getValueSize();this.times=gc(i,o,l),this.values=gc(this.values,o*s,l*s)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let s=0;s!==o;s++){const d=i[s];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,d),e=!1;break}if(l!==null&&l>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,d,l),e=!1;break}l=d}if(r!==void 0&&GL(r))for(let s=0,d=r.length;s!==d;++s){const p=r[s];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,p),e=!1;break}}return e}optimize(){const e=gc(this.times),t=gc(this.values),i=this.getValueSize(),r=this.getInterpolation()===wS,o=e.length-1;let l=1;for(let s=1;s<o;++s){let d=!1;const p=e[s],_=e[s+1];if(p!==_&&(s!==1||p!==e[0]))if(r)d=!0;else{const w=s*i,M=w-i,A=w+i;for(let P=0;P!==i;++P){const L=t[w+P];if(L!==t[M+P]||L!==t[A+P]){d=!0;break}}}if(d){if(s!==l){e[l]=e[s];const w=s*i,M=l*i;for(let A=0;A!==i;++A)t[M+A]=t[w+A]}++l}}if(o>0){e[l]=e[o];for(let s=o*i,d=l*i,p=0;p!==i;++p)t[d+p]=t[s+p];++l}return l!==e.length?(this.times=gc(e,0,l),this.values=gc(t,0,l*i)):(this.times=e,this.values=t),this}clone(){const e=gc(this.times,0),t=gc(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Bu.prototype.TimeBufferType=Float32Array;Bu.prototype.ValueBufferType=Float32Array;Bu.prototype.DefaultInterpolation=Mg;class Dg extends Bu{}Dg.prototype.ValueTypeName="bool";Dg.prototype.ValueBufferType=Array;Dg.prototype.DefaultInterpolation=By;Dg.prototype.InterpolantFactoryMethodLinear=void 0;Dg.prototype.InterpolantFactoryMethodSmooth=void 0;class jL extends Bu{}jL.prototype.ValueTypeName="color";class Gy extends Bu{}Gy.prototype.ValueTypeName="number";class aG extends a0{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,s=this.valueSize,d=(i-t)/(r-t);let p=e*s;for(let _=p+s;p!==_;p+=4)Ao.slerpFlat(o,0,l,p-s,l,p,d);return o}}class Rp extends Bu{InterpolantFactoryMethodLinear(e){return new aG(this.times,this.values,this.getValueSize(),e)}}Rp.prototype.ValueTypeName="quaternion";Rp.prototype.DefaultInterpolation=Mg;Rp.prototype.InterpolantFactoryMethodSmooth=void 0;class Rg extends Bu{}Rg.prototype.ValueTypeName="string";Rg.prototype.ValueBufferType=Array;Rg.prototype.DefaultInterpolation=By;Rg.prototype.InterpolantFactoryMethodLinear=void 0;Rg.prototype.InterpolantFactoryMethodSmooth=void 0;class Wy extends Bu{}Wy.prototype.ValueTypeName="vector";class Hy{constructor(e,t=-1,i,r=iT){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Fl(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let l=0,s=i.length;l!==s;++l)t.push(Ase(i[l]).scale(r));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,l=i.length;o!==l;++o)t.push(Bu.toJSON(i[o]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const o=t.length,l=[];for(let s=0;s<o;s++){let d=[],p=[];d.push((s+o-1)%o,s,(s+1)%o),p.push(0,1,0);const _=rG(d);d=bI(d,1,_),p=bI(p,1,_),!r&&d[0]===0&&(d.push(o),p.push(p[0])),l.push(new Gy(".morphTargetInfluences["+t[s].name+"]",d,p).scale(1/i))}return new this(e,-1,l)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},o=/^([\w-]*?)([\d]+)$/;for(let s=0,d=e.length;s<d;s++){const p=e[s],_=p.name.match(o);if(_&&_.length>1){const w=_[1];let M=r[w];M||(r[w]=M=[]),M.push(p)}}const l=[];for(const s in r)l.push(this.CreateFromMorphTargetSequence(s,r[s],t,i));return l}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(w,M,A,P,L){if(A.length!==0){const D=[],z=[];WL(A,D,z,P),D.length!==0&&L.push(new w(M,D,z))}},r=[],o=e.name||"default",l=e.fps||30,s=e.blendMode;let d=e.length||-1;const p=e.hierarchy||[];for(let w=0;w<p.length;w++){const M=p[w].keys;if(!(!M||M.length===0))if(M[0].morphTargets){const A={};let P;for(P=0;P<M.length;P++)if(M[P].morphTargets)for(let L=0;L<M[P].morphTargets.length;L++)A[M[P].morphTargets[L]]=-1;for(const L in A){const D=[],z=[];for(let F=0;F!==M[P].morphTargets.length;++F){const N=M[P];D.push(N.time),z.push(N.morphTarget===L?1:0)}r.push(new Gy(".morphTargetInfluence["+L+"]",D,z))}d=A.length*l}else{const A=".bones["+t[w].name+"]";i(Wy,A+".position",M,"pos",r),i(Rp,A+".quaternion",M,"rot",r),i(Wy,A+".scale",M,"scl",r)}}return r.length===0?null:new this(o,d,r,s)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const o=this.tracks[i];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Ese(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gy;case"vector":case"vector2":case"vector3":case"vector4":return Wy;case"color":return jL;case"quaternion":return Rp;case"bool":case"boolean":return Dg;case"string":return Rg}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function Ase(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Ese(n.type);if(n.times===void 0){const t=[],i=[];WL(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Eg={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class qL{constructor(e,t,i){const r=this;let o=!1,l=0,s=0,d;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(_){s++,o===!1&&r.onStart!==void 0&&r.onStart(_,l,s),o=!0},this.itemEnd=function(_){l++,r.onProgress!==void 0&&r.onProgress(_,l,s),l===s&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(_){r.onError!==void 0&&r.onError(_)},this.resolveURL=function(_){return d?d(_):_},this.setURLModifier=function(_){return d=_,this},this.addHandler=function(_,w){return p.push(_,w),this},this.removeHandler=function(_){const w=p.indexOf(_);return w!==-1&&p.splice(w,2),this},this.getHandler=function(_){for(let w=0,M=p.length;w<M;w+=2){const A=p[w],P=p[w+1];if(A.global&&(A.lastIndex=0),A.test(_))return P}return null}}}const lG=new qL;class rl{constructor(e){this.manager=e!==void 0?e:lG,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,o){i.load(e,r,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Sd={};class Cse extends Error{constructor(e,t){super(e),this.response=t}}class Ru extends rl{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=Eg.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(Sd[e]!==void 0){Sd[e].push({onLoad:t,onProgress:i,onError:r});return}Sd[e]=[],Sd[e].push({onLoad:t,onProgress:i,onError:r});const l=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,d=this.responseType;fetch(l).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const _=Sd[e],w=p.body.getReader(),M=p.headers.get("Content-Length")||p.headers.get("X-File-Size"),A=M?parseInt(M):0,P=A!==0;let L=0;const D=new ReadableStream({start(z){F();function F(){w.read().then(({done:N,value:V})=>{if(N)z.close();else{L+=V.byteLength;const j=new ProgressEvent("progress",{lengthComputable:P,loaded:L,total:A});for(let Q=0,re=_.length;Q<re;Q++){const Z=_[Q];Z.onProgress&&Z.onProgress(j)}z.enqueue(V),F()}})}}});return new Response(D)}else throw new Cse(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(_=>new DOMParser().parseFromString(_,s));case"json":return p.json();default:if(s===void 0)return p.text();{const w=/charset="?([^;"\s]*)"?/i.exec(s),M=w&&w[1]?w[1].toLowerCase():void 0,A=new TextDecoder(M);return p.arrayBuffer().then(P=>A.decode(P))}}}).then(p=>{Eg.add(e,p);const _=Sd[e];delete Sd[e];for(let w=0,M=_.length;w<M;w++){const A=_[w];A.onLoad&&A.onLoad(p)}}).catch(p=>{const _=Sd[e];if(_===void 0)throw this.manager.itemError(e),p;delete Sd[e];for(let w=0,M=_.length;w<M;w++){const A=_[w];A.onError&&A.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Ise extends rl{constructor(e){super(e)}load(e,t,i,r){const o=this,l=new Ru(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(s){try{t(o.parse(JSON.parse(s)))}catch(d){r?r(d):console.error(d),o.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=Hy.parse(e[i]);t.push(r)}return t}}class Pse extends rl{constructor(e){super(e)}load(e,t,i,r){const o=this,l=[],s=new zL,d=new Ru(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(o.withCredentials);let p=0;function _(w){d.load(e[w],function(M){const A=o.parse(M,!0);l[w]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps},p+=1,p===6&&(A.mipmapCount===1&&(s.minFilter=cs),s.image=l,s.format=A.format,s.needsUpdate=!0,t&&t(s))},i,r)}if(Array.isArray(e))for(let w=0,M=e.length;w<M;++w)_(w);else d.load(e,function(w){const M=o.parse(w,!0);if(M.isCubemap){const A=M.mipmaps.length/M.mipmapCount;for(let P=0;P<A;P++){l[P]={mipmaps:[]};for(let L=0;L<M.mipmapCount;L++)l[P].mipmaps.push(M.mipmaps[P*M.mipmapCount+L]),l[P].format=M.format,l[P].width=M.width,l[P].height=M.height}s.image=l}else s.image.width=M.width,s.image.height=M.height,s.mipmaps=M.mipmaps;M.mipmapCount===1&&(s.minFilter=cs),s.format=M.format,s.needsUpdate=!0,t&&t(s)},i,r);return s}}class Kv extends rl{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=Eg.get(e);if(l!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(l),o.manager.itemEnd(e)},0),l;const s=qv("img");function d(){_(),Eg.add(e,this),t&&t(this),o.manager.itemEnd(e)}function p(w){_(),r&&r(w),o.manager.itemError(e),o.manager.itemEnd(e)}function _(){s.removeEventListener("load",d,!1),s.removeEventListener("error",p,!1)}return s.addEventListener("load",d,!1),s.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),o.manager.itemStart(e),s.src=e,s}}class Lse extends rl{constructor(e){super(e)}load(e,t,i,r){const o=new S1,l=new Kv(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let s=0;function d(p){l.load(e[p],function(_){o.images[p]=_,s++,s===6&&(o.needsUpdate=!0,t&&t(o))},void 0,r)}for(let p=0;p<e.length;++p)d(p);return o}}class kse extends rl{constructor(e){super(e)}load(e,t,i,r){const o=this,l=new _y,s=new Ru(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(o.withCredentials),s.load(e,function(d){const p=o.parse(d);p&&(p.image!==void 0?l.image=p.image:p.data!==void 0&&(l.image.width=p.width,l.image.height=p.height,l.image.data=p.data),l.wrapS=p.wrapS!==void 0?p.wrapS:No,l.wrapT=p.wrapT!==void 0?p.wrapT:No,l.magFilter=p.magFilter!==void 0?p.magFilter:cs,l.minFilter=p.minFilter!==void 0?p.minFilter:cs,l.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.encoding!==void 0&&(l.encoding=p.encoding),p.flipY!==void 0&&(l.flipY=p.flipY),p.format!==void 0&&(l.format=p.format),p.type!==void 0&&(l.type=p.type),p.mipmaps!==void 0&&(l.mipmaps=p.mipmaps,l.minFilter=Ph),p.mipmapCount===1&&(l.minFilter=cs),p.generateMipmaps!==void 0&&(l.generateMipmaps=p.generateMipmaps),l.needsUpdate=!0,t&&t(l,p))},i,r),l}}class cG extends rl{constructor(e){super(e)}load(e,t,i,r){const o=new Jr,l=new Kv(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,function(s){o.image=s,o.needsUpdate=!0,t!==void 0&&t(o)},i,r),o}}class Hp extends tr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new An(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class uG extends Hp{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(tr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new An(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const Z2=new hi,TF=new Fe,EF=new Fe;class ZL{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Gt(512,512),this.map=null,this.mapPass=null,this.matrix=new hi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sT,this._frameExtents=new Gt(1,1),this._viewportCount=1,this._viewports=[new Tr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;TF.setFromMatrixPosition(e.matrixWorld),t.position.copy(TF),EF.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(EF),t.updateMatrixWorld(),Z2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Z2),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Z2)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Dse extends ZL{constructor(){super(new qr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=jv*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(i!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=i,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class XL extends Hp{constructor(e,t,i=0,r=Math.PI/3,o=0,l=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(tr.DEFAULT_UP),this.updateMatrix(),this.target=new tr,this.distance=i,this.angle=r,this.penumbra=o,this.decay=l,this.map=null,this.shadow=new Dse}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const AF=new hi,Tx=new Fe,X2=new Fe;class Rse extends ZL{constructor(){super(new qr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Gt(4,2),this._viewportCount=6,this._viewports=[new Tr(2,1,1,1),new Tr(0,1,1,1),new Tr(3,1,1,1),new Tr(1,1,1,1),new Tr(3,0,1,1),new Tr(1,0,1,1)],this._cubeDirections=[new Fe(1,0,0),new Fe(-1,0,0),new Fe(0,0,1),new Fe(0,0,-1),new Fe(0,1,0),new Fe(0,-1,0)],this._cubeUps=[new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,1,0),new Fe(0,0,1),new Fe(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,o=e.distance||i.far;o!==i.far&&(i.far=o,i.updateProjectionMatrix()),Tx.setFromMatrixPosition(e.matrixWorld),i.position.copy(Tx),X2.copy(i.position),X2.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(X2),i.updateMatrixWorld(),r.makeTranslation(-Tx.x,-Tx.y,-Tx.z),AF.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(AF)}}class $L extends Hp{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Rse}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class zse extends ZL{constructor(){super(new Wd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class YL extends Hp{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(tr.DEFAULT_UP),this.updateMatrix(),this.target=new tr,this.shadow=new zse}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class hG extends Hp{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class dG extends Hp{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class fG{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Fe)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,o=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.282095),t.addScaledVector(l[1],.488603*r),t.addScaledVector(l[2],.488603*o),t.addScaledVector(l[3],.488603*i),t.addScaledVector(l[4],1.092548*(i*r)),t.addScaledVector(l[5],1.092548*(r*o)),t.addScaledVector(l[6],.315392*(3*o*o-1)),t.addScaledVector(l[7],1.092548*(i*o)),t.addScaledVector(l[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,o=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.886227),t.addScaledVector(l[1],2*.511664*r),t.addScaledVector(l[2],2*.511664*o),t.addScaledVector(l[3],2*.511664*i),t.addScaledVector(l[4],2*.429043*i*r),t.addScaledVector(l[5],2*.429043*r*o),t.addScaledVector(l[6],.743125*o*o-.247708),t.addScaledVector(l[7],2*.429043*i*o),t.addScaledVector(l[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,o=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*o,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*i*o,t[8]=.546274*(i*i-r*r)}}class mT extends Hp{constructor(e=new fG,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class gT extends rl{constructor(e){super(e),this.textures={}}load(e,t,i,r){const o=this,l=new Ru(o.manager);l.setPath(o.path),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(s){try{t(o.parse(JSON.parse(s)))}catch(d){r?r(d):console.error(d),o.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(o){return t[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),t[o]}const r=gT.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new An().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const l=e.uniforms[o];switch(r.uniforms[o]={},l.type){case"t":r.uniforms[o].value=i(l.value);break;case"c":r.uniforms[o].value=new An().setHex(l.value);break;case"v2":r.uniforms[o].value=new Gt().fromArray(l.value);break;case"v3":r.uniforms[o].value=new Fe().fromArray(l.value);break;case"v4":r.uniforms[o].value=new Tr().fromArray(l.value);break;case"m3":r.uniforms[o].value=new Uo().fromArray(l.value);break;case"m4":r.uniforms[o].value=new hi().fromArray(l.value);break;default:r.uniforms[o].value=l.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)r.extensions[o]=e.extensions[o];if(e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=new Gt().fromArray(o)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Gt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:YV,SpriteMaterial:PL,RawShaderMaterial:KV,ShaderMaterial:Lh,PointsMaterial:hT,MeshPhysicalMaterial:nf,MeshStandardMaterial:B1,MeshPhongMaterial:JV,MeshToonMaterial:QV,MeshNormalMaterial:eG,MeshLambertMaterial:tG,MeshDepthMaterial:CL,MeshDistanceMaterial:IL,MeshBasicMaterial:Dl,MeshMatcapMaterial:nG,LineDashedMaterial:iG,LineBasicMaterial:ga,Material:Zs};return new t[e]}}class jy{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class pG extends Ti{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class mG extends rl{constructor(e){super(e)}load(e,t,i,r){const o=this,l=new Ru(o.manager);l.setPath(o.path),l.setRequestHeader(o.requestHeader),l.setWithCredentials(o.withCredentials),l.load(e,function(s){try{t(o.parse(JSON.parse(s)))}catch(d){r?r(d):console.error(d),o.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(A,P){if(t[P]!==void 0)return t[P];const D=A.interleavedBuffers[P],z=o(A,D.buffer),F=ey(D.type,z),N=new M1(F,D.stride);return N.uuid=D.uuid,t[P]=N,N}function o(A,P){if(i[P]!==void 0)return i[P];const D=A.arrayBuffers[P],z=new Uint32Array(D).buffer;return i[P]=z,z}const l=e.isInstancedBufferGeometry?new pG:new Ti,s=e.data.index;if(s!==void 0){const A=ey(s.type,s.array);l.setIndex(new vr(A,1))}const d=e.data.attributes;for(const A in d){const P=d[A];let L;if(P.isInterleavedBufferAttribute){const D=r(e.data,P.data);L=new Dp(D,P.itemSize,P.offset,P.normalized)}else{const D=ey(P.type,P.array),z=P.isInstancedBufferAttribute?Vy:vr;L=new z(D,P.itemSize,P.normalized)}P.name!==void 0&&(L.name=P.name),P.usage!==void 0&&L.setUsage(P.usage),P.updateRange!==void 0&&(L.updateRange.offset=P.updateRange.offset,L.updateRange.count=P.updateRange.count),l.setAttribute(A,L)}const p=e.data.morphAttributes;if(p)for(const A in p){const P=p[A],L=[];for(let D=0,z=P.length;D<z;D++){const F=P[D];let N;if(F.isInterleavedBufferAttribute){const V=r(e.data,F.data);N=new Dp(V,F.itemSize,F.offset,F.normalized)}else{const V=ey(F.type,F.array);N=new vr(V,F.itemSize,F.normalized)}F.name!==void 0&&(N.name=F.name),L.push(N)}l.morphAttributes[A]=L}e.data.morphTargetsRelative&&(l.morphTargetsRelative=!0);const w=e.data.groups||e.data.drawcalls||e.data.offsets;if(w!==void 0)for(let A=0,P=w.length;A!==P;++A){const L=w[A];l.addGroup(L.start,L.count,L.materialIndex)}const M=e.data.boundingSphere;if(M!==void 0){const A=new Fe;M.center!==void 0&&A.fromArray(M.center),l.boundingSphere=new Gp(A,M.radius)}return e.name&&(l.name=e.name),e.userData&&(l.userData=e.userData),l}}class Ose extends rl{constructor(e){super(e)}load(e,t,i,r){const o=this,l=this.path===""?jy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||l;const s=new Ru(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(d){let p=null;try{p=JSON.parse(d)}catch(w){r!==void 0&&r(w),console.error("THREE:ObjectLoader: Can't parse "+e+".",w.message);return}const _=p.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(p,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?jy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const o=new Ru(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const l=await o.loadAsync(e,t),s=JSON.parse(l),d=s.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(s)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),l=this.parseImages(e.images,function(){t!==void 0&&t(p)}),s=this.parseTextures(e.textures,l),d=this.parseMaterials(e.materials,s),p=this.parseObject(e.object,o,d,s,i),_=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,_),t!==void 0){let w=!1;for(const M in l)if(l[M].data instanceof HTMLImageElement){w=!0;break}w===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),o=await this.parseImagesAsync(e.images),l=this.parseTextures(e.textures,o),s=this.parseMaterials(e.materials,l),d=this.parseObject(e.object,r,s,l,t),p=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,p),d}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const o=new fg().fromJSON(e[i]);t[o.uuid]=o}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(o){o.isBone&&(r[o.uuid]=o)}),e!==void 0)for(let o=0,l=e.length;o<l;o++){const s=new T1().fromJSON(e[o],r);i[s.uuid]=s}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new mG;for(let o=0,l=e.length;o<l;o++){let s;const d=e[o];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":s=r.parse(d);break;default:d.type in MF?s=MF[d.type].fromJSON(d,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}s.uuid=d.uuid,d.name!==void 0&&(s.name=d.name),d.userData!==void 0&&(s.userData=d.userData),i[d.uuid]=s}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const o=new gT;o.setTextures(t);for(let l=0,s=e.length;l<s;l++){const d=e[l];i[d.uuid]===void 0&&(i[d.uuid]=o.parse(d)),r[d.uuid]=i[d.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],o=Hy.parse(r);t[o.uuid]=o}return t}parseImages(e,t){const i=this,r={};let o;function l(d){return i.manager.itemStart(d),o.load(d,function(){i.manager.itemEnd(d)},void 0,function(){i.manager.itemError(d),i.manager.itemEnd(d)})}function s(d){if(typeof d=="string"){const p=d,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:i.resourcePath+p;return l(_)}else return d.data?{data:ey(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new qL(t);o=new Kv(d),o.setCrossOrigin(this.crossOrigin);for(let p=0,_=e.length;p<_;p++){const w=e[p],M=w.url;if(Array.isArray(M)){const A=[];for(let P=0,L=M.length;P<L;P++){const D=M[P],z=s(D);z!==null&&(z instanceof HTMLImageElement?A.push(z):A.push(new _y(z.data,z.width,z.height)))}r[w.uuid]=new Qm(A)}else{const A=s(w.url);r[w.uuid]=new Qm(A)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function o(l){if(typeof l=="string"){const s=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(s)?s:t.resourcePath+s;return await r.loadAsync(d)}else return l.data?{data:ey(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){r=new Kv(this.manager),r.setCrossOrigin(this.crossOrigin);for(let l=0,s=e.length;l<s;l++){const d=e[l],p=d.url;if(Array.isArray(p)){const _=[];for(let w=0,M=p.length;w<M;w++){const A=p[w],P=await o(A);P!==null&&(P instanceof HTMLImageElement?_.push(P):_.push(new _y(P.data,P.width,P.height)))}i[d.uuid]=new Qm(_)}else{const _=await o(d.url);i[d.uuid]=new Qm(_)}}}return i}parseTextures(e,t){function i(o,l){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),l[o])}const r={};if(e!==void 0)for(let o=0,l=e.length;o<l;o++){const s=e[o];s.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),t[s.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const d=t[s.image],p=d.data;let _;Array.isArray(p)?(_=new S1,p.length===6&&(_.needsUpdate=!0)):(p&&p.data?_=new _y:_=new Jr,p&&(_.needsUpdate=!0)),_.source=d,_.uuid=s.uuid,s.name!==void 0&&(_.name=s.name),s.mapping!==void 0&&(_.mapping=i(s.mapping,Fse)),s.offset!==void 0&&_.offset.fromArray(s.offset),s.repeat!==void 0&&_.repeat.fromArray(s.repeat),s.center!==void 0&&_.center.fromArray(s.center),s.rotation!==void 0&&(_.rotation=s.rotation),s.wrap!==void 0&&(_.wrapS=i(s.wrap[0],CF),_.wrapT=i(s.wrap[1],CF)),s.format!==void 0&&(_.format=s.format),s.internalFormat!==void 0&&(_.internalFormat=s.internalFormat),s.type!==void 0&&(_.type=s.type),s.encoding!==void 0&&(_.encoding=s.encoding),s.minFilter!==void 0&&(_.minFilter=i(s.minFilter,IF)),s.magFilter!==void 0&&(_.magFilter=i(s.magFilter,IF)),s.anisotropy!==void 0&&(_.anisotropy=s.anisotropy),s.flipY!==void 0&&(_.flipY=s.flipY),s.generateMipmaps!==void 0&&(_.generateMipmaps=s.generateMipmaps),s.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=s.premultiplyAlpha),s.unpackAlignment!==void 0&&(_.unpackAlignment=s.unpackAlignment),s.userData!==void 0&&(_.userData=s.userData),r[s.uuid]=_}return r}parseObject(e,t,i,r,o){let l;function s(M){return t[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",M),t[M]}function d(M){if(M!==void 0){if(Array.isArray(M)){const A=[];for(let P=0,L=M.length;P<L;P++){const D=M[P];i[D]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",D),A.push(i[D])}return A}return i[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),i[M]}}function p(M){return r[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",M),r[M]}let _,w;switch(e.type){case"Scene":l=new xM,e.background!==void 0&&(Number.isInteger(e.background)?l.background=new An(e.background):l.background=p(e.background)),e.environment!==void 0&&(l.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new cT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new lT(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(l.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(l.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":l=new qr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new Wd(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new hG(e.color,e.intensity);break;case"DirectionalLight":l=new YL(e.color,e.intensity);break;case"PointLight":l=new $L(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new dG(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new XL(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":l=new uG(e.color,e.groundColor,e.intensity);break;case"LightProbe":l=new mT().fromJSON(e);break;case"SkinnedMesh":_=s(e.geometry),w=d(e.material),l=new LL(_,w),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":_=s(e.geometry),w=d(e.material),l=new To(_,w);break;case"InstancedMesh":_=s(e.geometry),w=d(e.material);const M=e.count,A=e.instanceMatrix,P=e.instanceColor;l=new kL(_,w,M),l.instanceMatrix=new Vy(new Float32Array(A.array),16),P!==void 0&&(l.instanceColor=new Vy(new Float32Array(P.array),P.itemSize));break;case"LOD":l=new NV;break;case"Line":l=new Qd(s(e.geometry),d(e.material));break;case"LineLoop":l=new DL(s(e.geometry),d(e.material));break;case"LineSegments":l=new Ou(s(e.geometry),d(e.material));break;case"PointCloud":case"Points":l=new RL(s(e.geometry),d(e.material));break;case"Sprite":l=new BV(d(e.material));break;case"Group":l=new Ud;break;case"Bone":l=new uT;break;default:l=new tr}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const M=e.children;for(let A=0;A<M.length;A++)l.add(this.parseObject(M[A],t,i,r,o))}if(e.animations!==void 0){const M=e.animations;for(let A=0;A<M.length;A++){const P=M[A];l.animations.push(o[P])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const M=e.levels;for(let A=0;A<M.length;A++){const P=M[A],L=l.getObjectByProperty("uuid",P.object);L!==void 0&&l.addLevel(L,P.distance,P.hysteresis)}}return l}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const Fse={UVMapping:tT,CubeReflectionMapping:Pp,CubeRefractionMapping:Lp,EquirectangularReflectionMapping:Uv,EquirectangularRefractionMapping:Vv,CubeUVReflectionMapping:t0},CF={RepeatWrapping:kp,ClampToEdgeWrapping:No,MirroredRepeatWrapping:Oy},IF={NearestFilter:Ss,NearestMipmapNearestFilter:Gv,NearestMipmapLinearFilter:my,LinearFilter:cs,LinearMipmapNearestFilter:nT,LinearMipmapLinearFilter:Ph};class gG extends rl{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,l=Eg.get(e);if(l!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(l),o.manager.itemEnd(e)},0),l;const s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader,fetch(e,s).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(d){Eg.add(e,d),t&&t(d),o.manager.itemEnd(e)}).catch(function(d){r&&r(d),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}}let Gb;class KL{static getContext(){return Gb===void 0&&(Gb=new(window.AudioContext||window.webkitAudioContext)),Gb}static setContext(e){Gb=e}}class Bse extends rl{constructor(e){super(e)}load(e,t,i,r){const o=this,l=new Ru(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(s){try{const d=s.slice(0);KL.getContext().decodeAudioData(d,function(_){t(_)})}catch(d){r?r(d):console.error(d),o.manager.itemError(e)}},i,r)}}class Nse extends mT{constructor(e,t,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const r=new An().set(e),o=new An().set(t),l=new Fe(r.r,r.g,r.b),s=new Fe(o.r,o.g,o.b),d=Math.sqrt(Math.PI),p=d*Math.sqrt(.75);this.sh.coefficients[0].copy(l).add(s).multiplyScalar(d),this.sh.coefficients[1].copy(l).sub(s).multiplyScalar(p)}}class Use extends mT{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;const i=new An().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const PF=new hi,LF=new hi,Pm=new hi;class Vse{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Pm.copy(e.projectionMatrix);const r=t.eyeSep/2,o=r*t.near/t.focus,l=t.near*Math.tan(hg*t.fov*.5)/t.zoom;let s,d;LF.elements[12]=-r,PF.elements[12]=r,s=-l*t.aspect+o,d=l*t.aspect+o,Pm.elements[0]=2*t.near/(d-s),Pm.elements[8]=(d+s)/(d-s),this.cameraL.projectionMatrix.copy(Pm),s=-l*t.aspect-o,d=l*t.aspect-o,Pm.elements[0]=2*t.near/(d-s),Pm.elements[8]=(d+s)/(d-s),this.cameraR.projectionMatrix.copy(Pm)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(LF),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(PF)}}class JL{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=kF(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=kF();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function kF(){return(typeof performance>"u"?Date:performance).now()}const Lm=new Fe,DF=new Ao,Gse=new Fe,km=new Fe;class Wse extends tr{constructor(){super(),this.type="AudioListener",this.context=KL.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new JL}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Lm,DF,Gse),km.set(0,0,-1).applyQuaternion(DF),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Lm.x,r),t.positionY.linearRampToValueAtTime(Lm.y,r),t.positionZ.linearRampToValueAtTime(Lm.z,r),t.forwardX.linearRampToValueAtTime(km.x,r),t.forwardY.linearRampToValueAtTime(km.y,r),t.forwardZ.linearRampToValueAtTime(km.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Lm.x,Lm.y,Lm.z),t.setOrientation(km.x,km.y,km.z,i.x,i.y,i.z)}}class _G extends tr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Dm=new Fe,RF=new Ao,Hse=new Fe,Rm=new Fe;class jse extends _G{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Dm,RF,Hse),Rm.set(0,0,1).applyQuaternion(RF);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Dm.x,i),t.positionY.linearRampToValueAtTime(Dm.y,i),t.positionZ.linearRampToValueAtTime(Dm.z,i),t.orientationX.linearRampToValueAtTime(Rm.x,i),t.orientationY.linearRampToValueAtTime(Rm.y,i),t.orientationZ.linearRampToValueAtTime(Rm.z,i)}else t.setPosition(Dm.x,Dm.y,Dm.z),t.setOrientation(Rm.x,Rm.y,Rm.z)}}class qse{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class yG{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,o,l;switch(t){case"quaternion":r=this._slerp,o=this._slerpAdditive,l=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,l=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,o=this._lerpAdditive,l=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=l,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,o=e*r+r;let l=this.cumulativeWeight;if(l===0){for(let s=0;s!==r;++s)i[o+s]=i[s];l=t}else{l+=t;const s=t/l;this._mixBufferRegion(i,o,0,s,r)}this.cumulativeWeight=l}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,o=this.cumulativeWeight,l=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const d=t*this._origIndex;this._mixBufferRegion(i,r,d,1-o,t)}l>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let d=t,p=t+t;d!==p;++d)if(i[d]!==i[d+t]){s.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let o=i,l=r;o!==l;++o)t[o]=t[r+o%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,o){if(r>=.5)for(let l=0;l!==o;++l)e[t+l]=e[i+l]}_slerp(e,t,i,r){Ao.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,o){const l=this._workIndex*o;Ao.multiplyQuaternionsFlat(e,l,e,t,e,i),Ao.slerpFlat(e,t,e,t,e,l,r)}_lerp(e,t,i,r,o){const l=1-r;for(let s=0;s!==o;++s){const d=t+s;e[d]=e[d]*l+e[i+s]*r}}_lerpAdditive(e,t,i,r,o){for(let l=0;l!==o;++l){const s=t+l;e[s]=e[s]+e[i+l]*r}}}const QL="\\[\\]\\.:\\/",Zse=new RegExp("["+QL+"]","g"),ek="[^"+QL+"]",Xse="[^"+QL.replace("\\.","")+"]",$se=/((?:WC+[\/:])*)/.source.replace("WC",ek),Yse=/(WCOD+)?/.source.replace("WCOD",Xse),Kse=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ek),Jse=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ek),Qse=new RegExp("^"+$se+Yse+Kse+Jse+"$"),eoe=["material","materials","bones","map"];class toe{constructor(e,t,i){const r=i||Qi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Qi{constructor(e,t,i){this.path=t,this.parsedPath=i||Qi.parseTrackName(t),this.node=Qi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Qi.Composite(e,t,i):new Qi(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Zse,"")}static parseTrackName(e){const t=Qse.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const o=i.nodeName.substring(r+1);eoe.indexOf(o)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=o)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(o){for(let l=0;l<o.length;l++){const s=o[l];if(s.name===t||s.uuid===t)return s;const d=i(s.children);if(d)return d}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,o=i.length;r!==o;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let o=t.propertyIndex;if(e||(e=Qi.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let p=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let _=0;_<e.length;_++)if(e[_].name===p){p=_;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const l=e[r];if(l===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?s=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(o!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}d=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=o}else l.fromArray!==void 0&&l.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(d=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=r;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Qi.Composite=toe;Qi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Qi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Qi.prototype.GetterByBindingType=[Qi.prototype._getValue_direct,Qi.prototype._getValue_array,Qi.prototype._getValue_arrayElement,Qi.prototype._getValue_toArray];Qi.prototype.SetterByBindingTypeAndVersioning=[[Qi.prototype._setValue_direct,Qi.prototype._setValue_direct_setNeedsUpdate,Qi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qi.prototype._setValue_array,Qi.prototype._setValue_array_setNeedsUpdate,Qi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qi.prototype._setValue_arrayElement,Qi.prototype._setValue_arrayElement_setNeedsUpdate,Qi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qi.prototype._setValue_fromArray,Qi.prototype._setValue_fromArray_setNeedsUpdate,Qi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class noe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Fl(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,o=this._bindings,l=o.length;let s,d=e.length,p=this.nCachedObjects_;for(let _=0,w=arguments.length;_!==w;++_){const M=arguments[_],A=M.uuid;let P=t[A];if(P===void 0){P=d++,t[A]=P,e.push(M);for(let L=0,D=l;L!==D;++L)o[L].push(new Qi(M,i[L],r[L]))}else if(P<p){s=e[P];const L=--p,D=e[L];t[D.uuid]=P,e[P]=D,t[A]=L,e[L]=M;for(let z=0,F=l;z!==F;++z){const N=o[z],V=N[L];let j=N[P];N[P]=V,j===void 0&&(j=new Qi(M,i[z],r[z])),N[L]=j}}else e[P]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let o=this.nCachedObjects_;for(let l=0,s=arguments.length;l!==s;++l){const d=arguments[l],p=d.uuid,_=t[p];if(_!==void 0&&_>=o){const w=o++,M=e[w];t[M.uuid]=_,e[_]=M,t[p]=w,e[w]=d;for(let A=0,P=r;A!==P;++A){const L=i[A],D=L[w],z=L[_];L[_]=D,L[w]=z}}}this.nCachedObjects_=o}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let o=this.nCachedObjects_,l=e.length;for(let s=0,d=arguments.length;s!==d;++s){const p=arguments[s],_=p.uuid,w=t[_];if(w!==void 0)if(delete t[_],w<o){const M=--o,A=e[M],P=--l,L=e[P];t[A.uuid]=w,e[w]=A,t[L.uuid]=M,e[M]=L,e.pop();for(let D=0,z=r;D!==z;++D){const F=i[D],N=F[M],V=F[P];F[w]=N,F[M]=V,F.pop()}}else{const M=--l,A=e[M];M>0&&(t[A.uuid]=w),e[w]=A,e.pop();for(let P=0,L=r;P!==L;++P){const D=i[P];D[w]=D[M],D.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const o=this._bindings;if(r!==void 0)return o[r];const l=this._paths,s=this._parsedPaths,d=this._objects,p=d.length,_=this.nCachedObjects_,w=new Array(p);r=o.length,i[e]=r,l.push(e),s.push(t),o.push(w);for(let M=_,A=d.length;M!==A;++M){const P=d[M];w[M]=new Qi(P,e,t)}return w}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,o=this._parsedPaths,l=this._bindings,s=l.length-1,d=l[s],p=e[s];t[p]=i,l[i]=d,l.pop(),o[i]=o[s],o.pop(),r[i]=r[s],r.pop()}}}class ioe{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const o=t.tracks,l=o.length,s=new Array(l),d={endingStart:Km,endingEnd:Km};for(let p=0;p!==l;++p){const _=o[p].createInterpolant(null);s[p]=_,_.settings=d}this._interpolantSettings=d,this._interpolants=s,this._propertyBindings=new Array(l),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=dV,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,o=e._clip.duration,l=o/r,s=r/o;e.warp(1,l,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,o=r.time,l=this.timeScale;let s=this._timeScaleInterpolant;s===null&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const d=s.parameterPositions,p=s.sampleValues;return d[0]=o,d[1]=o+i,p[0]=e/l,p[1]=t/l,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const d=(e-o)*i;d<0||i===0?t=0:(this._startTime=null,t=i*d)}t*=this._updateTimeScale(e);const l=this._updateTime(t),s=this._updateWeight(e);if(s>0){const d=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case xL:for(let _=0,w=d.length;_!==w;++_)d[_].evaluate(l),p[_].accumulateAdditive(s);break;case iT:default:for(let _=0,w=d.length;_!==w;++_)d[_].evaluate(l),p[_].accumulate(r,s)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,o=this._loopCount;const l=i===fV;if(e===0)return o===-1?r:l&&(o&1)===1?t-r:r;if(i===hV){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,l)):this._setEndings(this.repetitions===0,!0,l)),r>=t||r<0){const s=Math.floor(r/t);r-=t*s,o+=Math.abs(s);const d=this.repetitions-o;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const p=e<0;this._setEndings(p,!p,l)}else this._setEndings(!1,!1,l);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}else this.time=r;if(l&&(o&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=Jm,r.endingEnd=Jm):(e?r.endingStart=this.zeroSlopeAtStart?Jm:Km:r.endingStart=Wv,t?r.endingEnd=this.zeroSlopeAtEnd?Jm:Km:r.endingEnd=Wv)}_scheduleFading(e,t,i){const r=this._mixer,o=r.time;let l=this._weightInterpolant;l===null&&(l=r._lendControlInterpolant(),this._weightInterpolant=l);const s=l.parameterPositions,d=l.sampleValues;return s[0]=o,d[0]=t,s[1]=o+e,d[1]=i,this}}const roe=new Float32Array(1);class soe extends kh{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,o=r.length,l=e._propertyBindings,s=e._interpolants,d=i.uuid,p=this._bindingsByRootAndName;let _=p[d];_===void 0&&(_={},p[d]=_);for(let w=0;w!==o;++w){const M=r[w],A=M.name;let P=_[A];if(P!==void 0)++P.referenceCount,l[w]=P;else{if(P=l[w],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,d,A));continue}const L=t&&t._propertyBindings[w].binding.parsedPath;P=new yG(Qi.create(i,A,L),M.ValueTypeName,M.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,d,A),l[w]=P}s[w].resultBuffer=P.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,o=this._actionsByClip;let l=o[t];if(l===void 0)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=l;else{const s=l.knownActions;e._byClipCacheIndex=s.length,s.push(e)}e._cacheIndex=r.length,r.push(e),l.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,l=this._actionsByClip,s=l[o],d=s.knownActions,p=d[d.length-1],_=e._byClipCacheIndex;p._byClipCacheIndex=_,d[_]=p,d.pop(),e._byClipCacheIndex=null;const w=s.actionByRoot,M=(e._localRoot||this._root).uuid;delete w[M],d.length===0&&delete l[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const o=t[i];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,o=this._bindings;let l=r[t];l===void 0&&(l={},r[t]=l),l[i]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,o=i.path,l=this._bindingsByRootAndName,s=l[r],d=t[t.length-1],p=e._cacheIndex;d._cacheIndex=p,t[p]=d,t.pop(),delete s[o],Object.keys(s).length===0&&delete l[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=i,t[i]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new HL(new Float32Array(2),new Float32Array(2),1,roe),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=t[r];e.__cacheIndex=r,t[r]=e,o.__cacheIndex=i,t[i]=o}clipAction(e,t,i){const r=t||this._root,o=r.uuid;let l=typeof e=="string"?Hy.findByName(r,e):e;const s=l!==null?l.uuid:e,d=this._actionsByClip[s];let p=null;if(i===void 0&&(l!==null?i=l.blendMode:i=iT),d!==void 0){const w=d.actionByRoot[o];if(w!==void 0&&w.blendMode===i)return w;p=d.knownActions[0],l===null&&(l=p._clip)}if(l===null)return null;const _=new ioe(this,l,t,i);return this._bindAction(_,p),this._addInactiveAction(_,s,o),_}existingAction(e,t){const i=t||this._root,r=i.uuid,o=typeof e=="string"?Hy.findByName(i,e):e,l=o?o.uuid:e,s=this._actionsByClip[l];return s!==void 0&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,o=Math.sign(e),l=this._accuIndex^=1;for(let p=0;p!==i;++p)t[p]._update(r,e,o,l);const s=this._bindings,d=this._nActiveBindings;for(let p=0;p!==d;++p)s[p].apply(l);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,o=r[i];if(o!==void 0){const l=o.knownActions;for(let s=0,d=l.length;s!==d;++s){const p=l[s];this._deactivateAction(p);const _=p._cacheIndex,w=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,w._cacheIndex=_,t[_]=w,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const l in i){const s=i[l].actionByRoot,d=s[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const r=this._bindingsByRootAndName,o=r[t];if(o!==void 0)for(const l in o){const s=o[l];s.restoreOriginalState(),this._removeInactiveBinding(s)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class tk{constructor(e){this.value=e}clone(){return new tk(this.value.clone===void 0?this.value:this.value.clone())}}let ooe=0;class aoe extends kh{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:ooe++}),this.name="",this.usage=Hv,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++)this.uniforms.push(t[i].clone());return this}clone(){return new this.constructor().copy(this)}}class loe extends M1{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class coe{constructor(e,t,i,r,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class xG{constructor(e,t,i=0,r=1/0){this.ray=new v1(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new dg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return SI(e,this,i,t),i.sort(zF),i}intersectObjects(e,t=!0,i=[]){for(let r=0,o=e.length;r<o;r++)SI(e[r],this,i,t);return i.sort(zF),i}}function zF(n,e){return n.distance-e.distance}function SI(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let o=0,l=r.length;o<l;o++)SI(r[o],e,t,!0)}}class MI{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Fs(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class uoe{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const OF=new Gt;class hoe{constructor(e=new Gt(1/0,1/0),t=new Gt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=OF.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,OF).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const FF=new Fe,Wb=new Fe;class doe{constructor(e=new Fe,t=new Fe){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){FF.subVectors(e,this.start),Wb.subVectors(this.end,this.start);const i=Wb.dot(Wb);let o=Wb.dot(FF)/i;return t&&(o=Fs(o,0,1)),o}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const BF=new Fe;class foe extends tr{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new Ti,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let l=0,s=1,d=32;l<d;l++,s++){const p=l/d*Math.PI*2,_=s/d*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(_),Math.sin(_),1)}i.setAttribute("position",new qn(r,3));const o=new ga({fog:!1,toneMapped:!1});this.cone=new Ou(i,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),BF.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(BF),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Wf=new Fe,Hb=new hi,$2=new hi;class poe extends Ou{constructor(e){const t=vG(e),i=new Ti,r=[],o=[],l=new An(0,0,1),s=new An(0,1,0);for(let p=0;p<t.length;p++){const _=t[p];_.parent&&_.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(l.r,l.g,l.b),o.push(s.r,s.g,s.b))}i.setAttribute("position",new qn(r,3)),i.setAttribute("color",new qn(o,3));const d=new ga({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,d),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");$2.copy(this.root.matrixWorld).invert();for(let o=0,l=0;o<t.length;o++){const s=t[o];s.parent&&s.parent.isBone&&(Hb.multiplyMatrices($2,s.matrixWorld),Wf.setFromMatrixPosition(Hb),r.setXYZ(l,Wf.x,Wf.y,Wf.z),Hb.multiplyMatrices($2,s.parent.matrixWorld),Wf.setFromMatrixPosition(Hb),r.setXYZ(l+1,Wf.x,Wf.y,Wf.z),l+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function vG(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,vG(n.children[t]));return e}class moe extends To{constructor(e,t,i){const r=new o0(t,4,2),o=new Dl({wireframe:!0,fog:!1,toneMapped:!1});super(r,o),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const goe=new Fe,NF=new An,UF=new An;class _oe extends tr{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new s0(t);r.rotateY(Math.PI*.5),this.material=new Dl({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=r.getAttribute("position"),l=new Float32Array(o.count*3);r.setAttribute("color",new vr(l,3)),this.add(new To(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");NF.copy(this.light.color),UF.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const o=i<r/2?NF:UF;t.setXYZ(i,o.r,o.g,o.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(goe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class yoe extends Ou{constructor(e=10,t=10,i=4473924,r=8947848){i=new An(i),r=new An(r);const o=t/2,l=e/t,s=e/2,d=[],p=[];for(let M=0,A=0,P=-s;M<=t;M++,P+=l){d.push(-s,0,P,s,0,P),d.push(P,0,-s,P,0,s);const L=M===o?i:r;L.toArray(p,A),A+=3,L.toArray(p,A),A+=3,L.toArray(p,A),A+=3,L.toArray(p,A),A+=3}const _=new Ti;_.setAttribute("position",new qn(d,3)),_.setAttribute("color",new qn(p,3));const w=new ga({vertexColors:!0,toneMapped:!1});super(_,w),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class xoe extends Ou{constructor(e=10,t=16,i=8,r=64,o=4473924,l=8947848){o=new An(o),l=new An(l);const s=[],d=[];if(t>1)for(let w=0;w<t;w++){const M=w/t*(Math.PI*2),A=Math.sin(M)*e,P=Math.cos(M)*e;s.push(0,0,0),s.push(A,0,P);const L=w&1?o:l;d.push(L.r,L.g,L.b),d.push(L.r,L.g,L.b)}for(let w=0;w<i;w++){const M=w&1?o:l,A=e-e/i*w;for(let P=0;P<r;P++){let L=P/r*(Math.PI*2),D=Math.sin(L)*A,z=Math.cos(L)*A;s.push(D,0,z),d.push(M.r,M.g,M.b),L=(P+1)/r*(Math.PI*2),D=Math.sin(L)*A,z=Math.cos(L)*A,s.push(D,0,z),d.push(M.r,M.g,M.b)}}const p=new Ti;p.setAttribute("position",new qn(s,3)),p.setAttribute("color",new qn(d,3));const _=new ga({vertexColors:!0,toneMapped:!1});super(p,_),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const VF=new Fe,jb=new Fe,GF=new Fe;class voe extends tr{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Ti;r.setAttribute("position",new qn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new ga({fog:!1,toneMapped:!1});this.lightPlane=new Qd(r,o),this.add(this.lightPlane),r=new Ti,r.setAttribute("position",new qn([0,0,0,0,0,1],3)),this.targetLine=new Qd(r,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),VF.setFromMatrixPosition(this.light.matrixWorld),jb.setFromMatrixPosition(this.light.target.matrixWorld),GF.subVectors(jb,VF),this.lightPlane.lookAt(jb),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(jb),this.targetLine.scale.z=GF.length()}}const qb=new Fe,vs=new b1;class woe extends Ou{constructor(e){const t=new Ti,i=new ga({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],o=[],l={};s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4");function s(P,L){d(P),d(L)}function d(P){r.push(0,0,0),o.push(0,0,0),l[P]===void 0&&(l[P]=[]),l[P].push(r.length/3-1)}t.setAttribute("position",new qn(r,3)),t.setAttribute("color",new qn(o,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=l,this.update();const p=new An(16755200),_=new An(16711680),w=new An(43775),M=new An(16777215),A=new An(3355443);this.setColors(p,_,w,M,A)}setColors(e,t,i,r,o){const s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,o.r,o.g,o.b),s.setXYZ(41,o.r,o.g,o.b),s.setXYZ(42,o.r,o.g,o.b),s.setXYZ(43,o.r,o.g,o.b),s.setXYZ(44,o.r,o.g,o.b),s.setXYZ(45,o.r,o.g,o.b),s.setXYZ(46,o.r,o.g,o.b),s.setXYZ(47,o.r,o.g,o.b),s.setXYZ(48,o.r,o.g,o.b),s.setXYZ(49,o.r,o.g,o.b),s.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;vs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Rs("c",t,e,vs,0,0,-1),Rs("t",t,e,vs,0,0,1),Rs("n1",t,e,vs,-i,-r,-1),Rs("n2",t,e,vs,i,-r,-1),Rs("n3",t,e,vs,-i,r,-1),Rs("n4",t,e,vs,i,r,-1),Rs("f1",t,e,vs,-i,-r,1),Rs("f2",t,e,vs,i,-r,1),Rs("f3",t,e,vs,-i,r,1),Rs("f4",t,e,vs,i,r,1),Rs("u1",t,e,vs,i*.7,r*1.1,-1),Rs("u2",t,e,vs,-i*.7,r*1.1,-1),Rs("u3",t,e,vs,0,r*2,-1),Rs("cf1",t,e,vs,-i,0,1),Rs("cf2",t,e,vs,i,0,1),Rs("cf3",t,e,vs,0,-r,1),Rs("cf4",t,e,vs,0,r,1),Rs("cn1",t,e,vs,-i,0,-1),Rs("cn2",t,e,vs,i,0,-1),Rs("cn3",t,e,vs,0,-r,-1),Rs("cn4",t,e,vs,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Rs(n,e,t,i,r,o,l){qb.set(r,o,l).unproject(i);const s=e[n];if(s!==void 0){const d=t.getAttribute("position");for(let p=0,_=s.length;p<_;p++)d.setXYZ(s[p],qb.x,qb.y,qb.z)}}const Zb=new Vp;class boe extends Ou{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),o=new Ti;o.setIndex(new vr(i,1)),o.setAttribute("position",new vr(r,3)),super(o,new ga({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Zb.setFromObject(this.object),Zb.isEmpty())return;const t=Zb.min,i=Zb.max,r=this.geometry.attributes.position,o=r.array;o[0]=i.x,o[1]=i.y,o[2]=i.z,o[3]=t.x,o[4]=i.y,o[5]=i.z,o[6]=t.x,o[7]=t.y,o[8]=i.z,o[9]=i.x,o[10]=t.y,o[11]=i.z,o[12]=i.x,o[13]=i.y,o[14]=t.z,o[15]=t.x,o[16]=i.y,o[17]=t.z,o[18]=t.x,o[19]=t.y,o[20]=t.z,o[21]=i.x,o[22]=t.y,o[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Soe extends Ou{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Ti;o.setIndex(new vr(i,1)),o.setAttribute("position",new qn(r,3)),super(o,new ga({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Moe extends Qd{constructor(e,t=1,i=16776960){const r=i,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],l=new Ti;l.setAttribute("position",new qn(o,3)),l.computeBoundingSphere(),super(l,new ga({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const s=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new Ti;d.setAttribute("position",new qn(s,3)),d.computeBoundingSphere(),this.add(new To(d,new Dl({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const WF=new Fe;let Xb,Y2;class Toe extends tr{constructor(e=new Fe(0,0,1),t=new Fe(0,0,0),i=1,r=16776960,o=i*.2,l=o*.2){super(),this.type="ArrowHelper",Xb===void 0&&(Xb=new Ti,Xb.setAttribute("position",new qn([0,0,0,0,1,0],3)),Y2=new kg(0,.5,1,5,1),Y2.translate(0,-.5,0)),this.position.copy(t),this.line=new Qd(Xb,new ga({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new To(Y2,new Dl({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,o,l)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{WF.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(WF,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Eoe extends Ou{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Ti;r.setAttribute("position",new qn(t,3)),r.setAttribute("color",new qn(i,3));const o=new ga({vertexColors:!0,toneMapped:!1});super(r,o),this.type="AxesHelper"}setColors(e,t,i){const r=new An,o=this.geometry.attributes.color.array;return r.set(e),r.toArray(o,0),r.toArray(o,3),r.set(t),r.toArray(o,6),r.toArray(o,9),r.set(i),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Aoe{constructor(){this.type="ShapePath",this.color=new An,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Zv,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,o,l){return this.currentPath.bezierCurveTo(e,t,i,r,o,l),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(z){const F=[];for(let N=0,V=z.length;N<V;N++){const j=z[N],Q=new fg;Q.curves=j.curves,F.push(Q)}return F}function i(z,F){const N=F.length;let V=!1;for(let j=N-1,Q=0;Q<N;j=Q++){let re=F[j],Z=F[Q],ne=Z.x-re.x,he=Z.y-re.y;if(Math.abs(he)>Number.EPSILON){if(he<0&&(re=F[Q],ne=-ne,Z=F[j],he=-he),z.y<re.y||z.y>Z.y)continue;if(z.y===re.y){if(z.x===re.x)return!0}else{const De=he*(z.x-re.x)-ne*(z.y-re.y);if(De===0)return!0;if(De<0)continue;V=!V}}else{if(z.y!==re.y)continue;if(Z.x<=z.x&&z.x<=re.x||re.x<=z.x&&z.x<=Z.x)return!0}}return V}const r=Ah.isClockWise,o=this.subPaths;if(o.length===0)return[];let l,s,d;const p=[];if(o.length===1)return s=o[0],d=new fg,d.curves=s.curves,p.push(d),p;let _=!r(o[0].getPoints());_=e?!_:_;const w=[],M=[];let A=[],P=0,L;M[P]=void 0,A[P]=[];for(let z=0,F=o.length;z<F;z++)s=o[z],L=s.getPoints(),l=r(L),l=e?!l:l,l?(!_&&M[P]&&P++,M[P]={s:new fg,p:L},M[P].s.curves=s.curves,_&&P++,A[P]=[]):A[P].push({h:s,p:L[0]});if(!M[0])return t(o);if(M.length>1){let z=!1,F=0;for(let N=0,V=M.length;N<V;N++)w[N]=[];for(let N=0,V=M.length;N<V;N++){const j=A[N];for(let Q=0;Q<j.length;Q++){const re=j[Q];let Z=!0;for(let ne=0;ne<M.length;ne++)i(re.p,M[ne].p)&&(N!==ne&&F++,Z?(Z=!1,w[ne].push(re)):z=!0);Z&&w[N].push(re)}}F>0&&z===!1&&(A=w)}let D;for(let z=0,F=M.length;z<F;z++){d=M[z].s,p.push(d),D=A[z];for(let N=0,V=D.length;N<V;N++)d.holes.push(D[N].h)}return p}}const kd=Coe();function Coe(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let d=0;d<256;++d){const p=d-127;p<-27?(i[d]=0,i[d|256]=32768,r[d]=24,r[d|256]=24):p<-14?(i[d]=1024>>-p-14,i[d|256]=1024>>-p-14|32768,r[d]=-p-1,r[d|256]=-p-1):p<=15?(i[d]=p+15<<10,i[d|256]=p+15<<10|32768,r[d]=13,r[d|256]=13):p<128?(i[d]=31744,i[d|256]=64512,r[d]=24,r[d|256]=24):(i[d]=31744,i[d|256]=64512,r[d]=13,r[d|256]=13)}const o=new Uint32Array(2048),l=new Uint32Array(64),s=new Uint32Array(64);for(let d=1;d<1024;++d){let p=d<<13,_=0;for(;!(p&8388608);)p<<=1,_-=8388608;p&=-8388609,_+=947912704,o[d]=p|_}for(let d=1024;d<2048;++d)o[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)l[d]=d<<23;l[31]=1199570944,l[32]=2147483648;for(let d=33;d<63;++d)l[d]=2147483648+(d-32<<23);l[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(s[d]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:o,exponentTable:l,offsetTable:s}}function Ioe(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Fs(n,-65504,65504),kd.floatView[0]=n;const e=kd.uint32View[0],t=e>>23&511;return kd.baseTable[t]+((e&8388607)>>kd.shiftTable[t])}function Poe(n){const e=n>>10;return kd.uint32View[0]=kd.mantissaTable[kd.offsetTable[e]+(n&1023)]+kd.exponentTable[e],kd.floatView[0]}const Loe={toHalfFloat:Ioe,fromHalfFloat:Poe};class koe extends Wp{constructor(e,t,i,r,o,l){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,t,i,r,o,l)}}class Doe extends E1{constructor(e,t,i,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,t,i,r)}}class Roe extends A1{constructor(e,t,i,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,t,i,r)}}class zoe extends C1{constructor(e,t,i,r,o,l,s){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,t,i,r,o,l,s)}}class Ooe extends kg{constructor(e,t,i,r,o,l,s,d){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,t,i,r,o,l,s,d)}}class Foe extends I1{constructor(e,t){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,t)}}class Boe extends P1{constructor(e,t){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,t)}}class Noe extends L1{constructor(e,t){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,t)}}class Uoe extends r0{constructor(e,t,i,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,t,i,r)}}class Voe extends s0{constructor(e,t){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,t)}}class Goe extends n0{constructor(e,t,i,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,t,i,r)}}class Woe extends tf{constructor(e,t,i,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,t,i,r)}}class Hoe extends k1{constructor(e,t,i,r,o,l){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,t,i,r,o,l)}}class joe extends D1{constructor(e,t){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,t)}}class qoe extends o0{constructor(e,t,i,r,o,l,s){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,t,i,r,o,l,s)}}class Zoe extends R1{constructor(e,t){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,t)}}class Xoe extends z1{constructor(e,t,i,r,o){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,t,i,r,o)}}class $oe extends O1{constructor(e,t,i,r,o,l){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,t,i,r,o,l)}}class Yoe extends F1{constructor(e,t,i,r,o){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,t,i,r,o)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:QM}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=QM);const Koe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:_L,AddEquation:Wm,AddOperation:j6,AdditiveAnimationBlendMode:xL,AdditiveBlending:VC,AlphaFormat:tV,AlwaysDepth:B6,AlwaysStencilFunc:yV,AmbientLight:hG,AmbientLightProbe:Use,AnimationClip:Hy,AnimationLoader:Ise,AnimationMixer:soe,AnimationObjectGroup:noe,AnimationUtils:Tse,ArcCurve:UV,ArrayCamera:RV,ArrowHelper:Toe,Audio:_G,AudioAnalyser:qse,AudioContext:KL,AudioListener:Wse,AudioLoader:Bse,AxesHelper:Eoe,BackSide:il,BasicDepthPacking:mV,BasicShadowMap:M6,Bone:uT,BooleanKeyframeTrack:Dg,Box2:hoe,Box3:Vp,Box3Helper:Soe,BoxBufferGeometry:koe,BoxGeometry:Wp,BoxHelper:boe,BufferAttribute:vr,BufferGeometry:Ti,BufferGeometryLoader:mG,ByteType:Y6,Cache:Eg,Camera:b1,CameraHelper:woe,CanvasTexture:$re,CapsuleBufferGeometry:Doe,CapsuleGeometry:E1,CatmullRomCurve3:VV,CineonToneMapping:X6,CircleBufferGeometry:Roe,CircleGeometry:A1,ClampToEdgeWrapping:No,Clock:JL,Color:An,ColorKeyframeTrack:jL,ColorManagement:oa,CompressedArrayTexture:Xre,CompressedTexture:zL,CompressedTextureLoader:Pse,ConeBufferGeometry:zoe,ConeGeometry:C1,CubeCamera:EV,CubeReflectionMapping:Pp,CubeRefractionMapping:Lp,CubeTexture:S1,CubeTextureLoader:Lse,CubeUVReflectionMapping:t0,CubicBezierCurve:FL,CubicBezierCurve3:GV,CubicInterpolant:sG,CullFaceBack:UC,CullFaceFront:S6,CullFaceFrontBack:XJ,CullFaceNone:b6,Curve:Fu,CurvePath:HV,CustomBlending:T6,CustomToneMapping:$6,CylinderBufferGeometry:Ooe,CylinderGeometry:kg,Cylindrical:uoe,Data3DTexture:ML,DataArrayTexture:rT,DataTexture:_y,DataTextureLoader:kse,DataUtils:Loe,DecrementStencilOp:rQ,DecrementWrapStencilOp:oQ,DefaultLoadingManager:lG,DepthFormat:Sp,DepthStencilFormat:Sg,DepthTexture:zV,DirectionalLight:YL,DirectionalLightHelper:voe,DiscreteInterpolant:oG,DisplayP3ColorSpace:wL,DodecahedronBufferGeometry:Foe,DodecahedronGeometry:I1,DoubleSide:bh,DstAlphaFactor:k6,DstColorFactor:R6,DynamicCopyUsage:wQ,DynamicDrawUsage:mQ,DynamicReadUsage:yQ,EdgesGeometry:jV,EllipseCurve:dT,EqualDepth:U6,EqualStencilFunc:uQ,EquirectangularReflectionMapping:Uv,EquirectangularRefractionMapping:Vv,Euler:w1,EventDispatcher:kh,ExtrudeBufferGeometry:Boe,ExtrudeGeometry:P1,FileLoader:Ru,Float16BufferAttribute:aee,Float32BufferAttribute:qn,Float64BufferAttribute:lee,FloatType:Bd,Fog:cT,FogExp2:lT,FramebufferTexture:Zre,FrontSide:Ih,Frustum:sT,GLBufferAttribute:coe,GLSL1:SQ,GLSL3:mI,GreaterDepth:G6,GreaterEqualDepth:V6,GreaterEqualStencilFunc:pQ,GreaterStencilFunc:dQ,GridHelper:yoe,Group:Ud,HalfFloatType:Fy,HemisphereLight:uG,HemisphereLightHelper:_oe,HemisphereLightProbe:Nse,IcosahedronBufferGeometry:Noe,IcosahedronGeometry:L1,ImageBitmapLoader:gG,ImageLoader:Kv,ImageUtils:SL,IncrementStencilOp:iQ,IncrementWrapStencilOp:sQ,InstancedBufferAttribute:Vy,InstancedBufferGeometry:pG,InstancedInterleavedBuffer:loe,InstancedMesh:kL,Int16BufferAttribute:see,Int32BufferAttribute:oee,Int8BufferAttribute:nee,IntType:J6,InterleavedBuffer:M1,InterleavedBufferAttribute:Dp,Interpolant:a0,InterpolateDiscrete:By,InterpolateLinear:Mg,InterpolateSmooth:wS,InvertStencilOp:aQ,KeepStencilOp:bS,KeyframeTrack:Bu,LOD:NV,LatheBufferGeometry:Uoe,LatheGeometry:r0,Layers:dg,LessDepth:N6,LessEqualDepth:gM,LessEqualStencilFunc:hQ,LessStencilFunc:cQ,Light:Hp,LightProbe:mT,Line:Qd,Line3:doe,LineBasicMaterial:ga,LineCurve:fT,LineCurve3:WV,LineDashedMaterial:iG,LineLoop:DL,LineSegments:Ou,LinearEncoding:Jd,LinearFilter:cs,LinearInterpolant:HL,LinearMipMapLinearFilter:QJ,LinearMipMapNearestFilter:JJ,LinearMipmapLinearFilter:Ph,LinearMipmapNearestFilter:nT,LinearSRGBColorSpace:Ny,LinearToneMapping:q6,Loader:rl,LoaderUtils:jy,LoadingManager:qL,LoopOnce:hV,LoopPingPong:fV,LoopRepeat:dV,LuminanceAlphaFormat:iV,LuminanceFormat:nV,MOUSE:Um,Material:Zs,MaterialLoader:gT,MathUtils:wV,Matrix3:Uo,Matrix4:hi,MaxEquation:jC,Mesh:To,MeshBasicMaterial:Dl,MeshDepthMaterial:CL,MeshDistanceMaterial:IL,MeshLambertMaterial:tG,MeshMatcapMaterial:nG,MeshNormalMaterial:eG,MeshPhongMaterial:JV,MeshPhysicalMaterial:nf,MeshStandardMaterial:B1,MeshToonMaterial:QV,MinEquation:HC,MirroredRepeatWrapping:Oy,MixOperation:H6,MultiplyBlending:WC,MultiplyOperation:x1,NearestFilter:Ss,NearestMipMapLinearFilter:KJ,NearestMipMapNearestFilter:YJ,NearestMipmapLinearFilter:my,NearestMipmapNearestFilter:Gv,NeverDepth:F6,NeverStencilFunc:lQ,NoBlending:Gd,NoColorSpace:eQ,NoToneMapping:Pu,NormalAnimationBlendMode:iT,NormalBlending:cg,NotEqualDepth:W6,NotEqualStencilFunc:fQ,NumberKeyframeTrack:Gy,Object3D:tr,ObjectLoader:Ose,ObjectSpaceNormalMap:_V,OctahedronBufferGeometry:Voe,OctahedronGeometry:s0,OneFactor:I6,OneMinusDstAlphaFactor:D6,OneMinusDstColorFactor:z6,OneMinusSrcAlphaFactor:gL,OneMinusSrcColorFactor:L6,OrthographicCamera:Wd,PCFShadowMap:eT,PCFSoftShadowMap:av,PMREMGenerator:_I,Path:Zv,PerspectiveCamera:qr,Plane:Yf,PlaneBufferGeometry:Goe,PlaneGeometry:n0,PlaneHelper:Moe,PointLight:$L,PointLightHelper:moe,Points:RL,PointsMaterial:hT,PolarGridHelper:xoe,PolyhedronBufferGeometry:Woe,PolyhedronGeometry:tf,PositionalAudio:jse,PropertyBinding:Qi,PropertyMixer:yG,QuadraticBezierCurve:BL,QuadraticBezierCurve3:NL,Quaternion:Ao,QuaternionKeyframeTrack:Rp,QuaternionLinearInterpolant:aG,RED_GREEN_RGTC2_Format:fI,RED_RGTC1_Format:uV,REVISION:QM,RGBADepthPacking:gV,RGBAFormat:$a,RGBAIntegerFormat:lV,RGBA_ASTC_10x10_Format:cI,RGBA_ASTC_10x5_Format:oI,RGBA_ASTC_10x6_Format:aI,RGBA_ASTC_10x8_Format:lI,RGBA_ASTC_12x10_Format:uI,RGBA_ASTC_12x12_Format:hI,RGBA_ASTC_4x4_Format:JC,RGBA_ASTC_5x4_Format:QC,RGBA_ASTC_5x5_Format:eI,RGBA_ASTC_6x5_Format:tI,RGBA_ASTC_6x6_Format:nI,RGBA_ASTC_8x5_Format:iI,RGBA_ASTC_8x6_Format:rI,RGBA_ASTC_8x8_Format:sI,RGBA_BPTC_Format:vS,RGBA_ETC2_EAC_Format:KC,RGBA_PVRTC_2BPPV1_Format:$C,RGBA_PVRTC_4BPPV1_Format:XC,RGBA_S3TC_DXT1_Format:_S,RGBA_S3TC_DXT3_Format:yS,RGBA_S3TC_DXT5_Format:xS,RGB_ETC1_Format:cV,RGB_ETC2_Format:YC,RGB_PVRTC_2BPPV1_Format:ZC,RGB_PVRTC_4BPPV1_Format:qC,RGB_S3TC_DXT1_Format:gS,RGFormat:oV,RGIntegerFormat:aV,RawShaderMaterial:KV,Ray:v1,Raycaster:xG,RectAreaLight:dG,RedFormat:rV,RedIntegerFormat:sV,ReinhardToneMapping:Z6,RepeatWrapping:kp,ReplaceStencilOp:nQ,ReverseSubtractEquation:A6,RingBufferGeometry:Hoe,RingGeometry:k1,SIGNED_RED_GREEN_RGTC2_Format:pI,SIGNED_RED_RGTC1_Format:dI,SRGBColorSpace:wu,Scene:xM,ShaderChunk:Pi,ShaderLib:Su,ShaderMaterial:Lh,ShadowMaterial:YV,Shape:fg,ShapeBufferGeometry:joe,ShapeGeometry:D1,ShapePath:Aoe,ShapeUtils:Ah,ShortType:K6,Skeleton:T1,SkeletonHelper:poe,SkinnedMesh:LL,Source:Qm,Sphere:Gp,SphereBufferGeometry:qoe,SphereGeometry:o0,Spherical:MI,SphericalHarmonics3:fG,SplineCurve:UL,SpotLight:XL,SpotLightHelper:foe,Sprite:BV,SpriteMaterial:PL,SrcAlphaFactor:mL,SrcAlphaSaturateFactor:O6,SrcColorFactor:P6,StaticCopyUsage:vQ,StaticDrawUsage:Hv,StaticReadUsage:_Q,StereoCamera:Vse,StreamCopyUsage:bQ,StreamDrawUsage:gQ,StreamReadUsage:xQ,StringKeyframeTrack:Rg,SubtractEquation:E6,SubtractiveBlending:GC,TOUCH:Vm,TangentSpaceNormalMap:Up,TetrahedronBufferGeometry:Zoe,TetrahedronGeometry:R1,Texture:Jr,TextureLoader:cG,TorusBufferGeometry:Xoe,TorusGeometry:z1,TorusKnotBufferGeometry:$oe,TorusKnotGeometry:O1,Triangle:wc,TriangleFanDrawMode:_M,TriangleStripDrawMode:vL,TrianglesDrawMode:pV,TubeBufferGeometry:Yoe,TubeGeometry:F1,TwoPassDoubleSide:$J,UVMapping:tT,Uint16BufferAttribute:TL,Uint32BufferAttribute:EL,Uint8BufferAttribute:iee,Uint8ClampedBufferAttribute:ree,Uniform:tk,UniformsGroup:aoe,UniformsLib:vn,UniformsUtils:TV,UnsignedByteType:Kd,UnsignedInt248Type:ug,UnsignedIntType:cp,UnsignedShort4444Type:Q6,UnsignedShort5551Type:eV,UnsignedShortType:yL,VSMShadowMap:Ym,Vector2:Gt,Vector3:Fe,Vector4:Tr,VectorKeyframeTrack:Wy,VideoTexture:qre,WebGL1Renderer:OV,WebGL3DRenderTarget:qQ,WebGLArrayRenderTarget:jQ,WebGLCubeRenderTarget:AV,WebGLMultipleRenderTargets:ZQ,WebGLRenderTarget:Du,WebGLRenderer:aT,WebGLUtils:DV,WireframeGeometry:$V,WrapAroundEnding:Wv,ZeroCurvatureEnding:Km,ZeroFactor:C6,ZeroSlopeEnding:Jm,ZeroStencilOp:tQ,_SRGBAFormat:yM,sRGBEncoding:ar},Symbol.toStringTag,{value:"Module"}));var hp={},Joe={get exports(){return hp},set exports(n){hp=n}},zg={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */zg.ConcurrentRoot=1;zg.ContinuousEventPriority=4;zg.DefaultEventPriority=16;zg.DiscreteEventPriority=1;zg.IdleEventPriority=536870912;zg.LegacyRoot=0;(function(n){n.exports=zg})(Joe);function Qoe(n){let e;const t=new Set,i=(p,_)=>{const w=typeof p=="function"?p(e):p;if(w!==e){const M=e;e=_?w:Object.assign({},e,w),t.forEach(A=>A(e,M))}},r=()=>e,o=(p,_=r,w=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let M=_(e);function A(){const P=_(e);if(!w(M,P)){const L=M;p(M=P,L)}}return t.add(A),()=>t.delete(A)},d={setState:i,getState:r,subscribe:(p,_,w)=>_||w?o(p,_,w):(t.add(p),()=>t.delete(p)),destroy:()=>t.clear()};return e=n(i,r,d),d}const eae=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),HF=eae?$t.useEffect:$t.useLayoutEffect;function tae(n){const e=typeof n=="function"?Qoe(n):n,t=(i=e.getState,r=Object.is)=>{const[,o]=$t.useReducer(D=>D+1,0),l=e.getState(),s=$t.useRef(l),d=$t.useRef(i),p=$t.useRef(r),_=$t.useRef(!1),w=$t.useRef();w.current===void 0&&(w.current=i(l));let M,A=!1;(s.current!==l||d.current!==i||p.current!==r||_.current)&&(M=i(l),A=!r(w.current,M)),HF(()=>{A&&(w.current=M),s.current=l,d.current=i,p.current=r,_.current=!1});const P=$t.useRef(l);HF(()=>{const D=()=>{try{const F=e.getState(),N=d.current(F);p.current(w.current,N)||(s.current=F,w.current=N,o())}catch{_.current=!0,o()}},z=e.subscribe(D);return e.getState()!==P.current&&D(),z},[]);const L=A?M:w.current;return $t.useDebugValue(L),L};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[t,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},t}var TI={},nae={get exports(){return TI},set exports(n){TI=n}},vM={},iae={get exports(){return vM},set exports(n){vM=n}},K2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jF;function rae(){return jF||(jF=1,function(n){function e(ce,Te){var Pe=ce.length;ce.push(Te);e:for(;0<Pe;){var Qe=Pe-1>>>1,Ne=ce[Qe];if(0<r(Ne,Te))ce[Qe]=Te,ce[Pe]=Ne,Pe=Qe;else break e}}function t(ce){return ce.length===0?null:ce[0]}function i(ce){if(ce.length===0)return null;var Te=ce[0],Pe=ce.pop();if(Pe!==Te){ce[0]=Pe;e:for(var Qe=0,Ne=ce.length,nt=Ne>>>1;Qe<nt;){var ze=2*(Qe+1)-1,et=ce[ze],Et=ze+1,Nt=ce[Et];if(0>r(et,Pe))Et<Ne&&0>r(Nt,et)?(ce[Qe]=Nt,ce[Et]=Pe,Qe=Et):(ce[Qe]=et,ce[ze]=Pe,Qe=ze);else if(Et<Ne&&0>r(Nt,Pe))ce[Qe]=Nt,ce[Et]=Pe,Qe=Et;else break e}}return Te}function r(ce,Te){var Pe=ce.sortIndex-Te.sortIndex;return Pe!==0?Pe:ce.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,s=l.now();n.unstable_now=function(){return l.now()-s}}var d=[],p=[],_=1,w=null,M=3,A=!1,P=!1,L=!1,D=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ce){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=ce)i(p),Te.sortIndex=Te.expirationTime,e(d,Te);else break;Te=t(p)}}function V(ce){if(L=!1,N(ce),!P)if(t(d)!==null)P=!0,Oe(j);else{var Te=t(p);Te!==null&&We(V,Te.startTime-ce)}}function j(ce,Te){P=!1,L&&(L=!1,z(Z),Z=-1),A=!0;var Pe=M;try{for(N(Te),w=t(d);w!==null&&(!(w.expirationTime>Te)||ce&&!De());){var Qe=w.callback;if(typeof Qe=="function"){w.callback=null,M=w.priorityLevel;var Ne=Qe(w.expirationTime<=Te);Te=n.unstable_now(),typeof Ne=="function"?w.callback=Ne:w===t(d)&&i(d),N(Te)}else i(d);w=t(d)}if(w!==null)var nt=!0;else{var ze=t(p);ze!==null&&We(V,ze.startTime-Te),nt=!1}return nt}finally{w=null,M=Pe,A=!1}}var Q=!1,re=null,Z=-1,ne=5,he=-1;function De(){return!(n.unstable_now()-he<ne)}function He(){if(re!==null){var ce=n.unstable_now();he=ce;var Te=!0;try{Te=re(!0,ce)}finally{Te?ae():(Q=!1,re=null)}}else Q=!1}var ae;if(typeof F=="function")ae=function(){F(He)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,fe=le.port2;le.port1.onmessage=He,ae=function(){fe.postMessage(null)}}else ae=function(){D(He,0)};function Oe(ce){re=ce,Q||(Q=!0,ae())}function We(ce,Te){Z=D(function(){ce(n.unstable_now())},Te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){P||A||(P=!0,Oe(j))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return M},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ce){switch(M){case 1:case 2:case 3:var Te=3;break;default:Te=M}var Pe=M;M=Te;try{return ce()}finally{M=Pe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Te){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Pe=M;M=ce;try{return Te()}finally{M=Pe}},n.unstable_scheduleCallback=function(ce,Te,Pe){var Qe=n.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?Qe+Pe:Qe):Pe=Qe,ce){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=Pe+Ne,ce={id:_++,callback:Te,priorityLevel:ce,startTime:Pe,expirationTime:Ne,sortIndex:-1},Pe>Qe?(ce.sortIndex=Pe,e(p,ce),t(d)===null&&ce===t(p)&&(L?(z(Z),Z=-1):L=!0,We(V,Pe-Qe))):(ce.sortIndex=Ne,e(d,ce),P||A||(P=!0,Oe(j))),ce},n.unstable_shouldYield=De,n.unstable_wrapCallback=function(ce){var Te=M;return function(){var Pe=M;M=Te;try{return ce.apply(this,arguments)}finally{M=Pe}}}}(K2)),K2}var qF;function sae(){return qF||(qF=1,function(n){n.exports=rae()}(iae)),vM}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oae=function(e){var t={},i=$t,r=sae(),o=Object.assign;function l(x){for(var S="https://reactjs.org/docs/error-decoder.html?invariant="+x,R=1;R<arguments.length;R++)S+="&args[]="+encodeURIComponent(arguments[R]);return"Minified React error #"+x+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d=Symbol.for("react.element"),p=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),P=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),j=Symbol.iterator;function Q(x){return x===null||typeof x!="object"?null:(x=j&&x[j]||x["@@iterator"],typeof x=="function"?x:null)}function re(x){if(x==null)return null;if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case _:return"Fragment";case p:return"Portal";case M:return"Profiler";case w:return"StrictMode";case D:return"Suspense";case z:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case P:return(x.displayName||"Context")+".Consumer";case A:return(x._context.displayName||"Context")+".Provider";case L:var S=x.render;return x=x.displayName,x||(x=S.displayName||S.name||"",x=x!==""?"ForwardRef("+x+")":"ForwardRef"),x;case F:return S=x.displayName||null,S!==null?S:re(x.type)||"Memo";case N:S=x._payload,x=x._init;try{return re(x(S))}catch{}}return null}function Z(x){var S=x.type;switch(x.tag){case 24:return"Cache";case 9:return(S.displayName||"Context")+".Consumer";case 10:return(S._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return x=S.render,x=x.displayName||x.name||"",S.displayName||(x!==""?"ForwardRef("+x+")":"ForwardRef");case 7:return"Fragment";case 5:return S;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return re(S);case 8:return S===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof S=="function")return S.displayName||S.name||null;if(typeof S=="string")return S}return null}function ne(x){var S=x,R=x;if(x.alternate)for(;S.return;)S=S.return;else{x=S;do S=x,S.flags&4098&&(R=S.return),x=S.return;while(x)}return S.tag===3?R:null}function he(x){if(ne(x)!==x)throw Error(l(188))}function De(x){var S=x.alternate;if(!S){if(S=ne(x),S===null)throw Error(l(188));return S!==x?null:x}for(var R=x,G=S;;){var X=R.return;if(X===null)break;var te=X.alternate;if(te===null){if(G=X.return,G!==null){R=G;continue}break}if(X.child===te.child){for(te=X.child;te;){if(te===R)return he(X),x;if(te===G)return he(X),S;te=te.sibling}throw Error(l(188))}if(R.return!==G.return)R=X,G=te;else{for(var Ve=!1,st=X.child;st;){if(st===R){Ve=!0,R=X,G=te;break}if(st===G){Ve=!0,G=X,R=te;break}st=st.sibling}if(!Ve){for(st=te.child;st;){if(st===R){Ve=!0,R=te,G=X;break}if(st===G){Ve=!0,G=te,R=X;break}st=st.sibling}if(!Ve)throw Error(l(189))}}if(R.alternate!==G)throw Error(l(190))}if(R.tag!==3)throw Error(l(188));return R.stateNode.current===R?x:S}function He(x){return x=De(x),x!==null?ae(x):null}function ae(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){var S=ae(x);if(S!==null)return S;x=x.sibling}return null}function le(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){if(x.tag!==4){var S=le(x);if(S!==null)return S}x=x.sibling}return null}var fe=Array.isArray,Oe=e.getPublicInstance,We=e.getRootHostContext,ce=e.getChildHostContext,Te=e.prepareForCommit,Pe=e.resetAfterCommit,Qe=e.createInstance,Ne=e.appendInitialChild,nt=e.finalizeInitialChildren,ze=e.prepareUpdate,et=e.shouldSetTextContent,Et=e.createTextInstance,Nt=e.scheduleTimeout,qt=e.cancelTimeout,wn=e.noTimeout,_n=e.isPrimaryRenderer,Rn=e.supportsMutation,At=e.supportsPersistence,Ot=e.supportsHydration,Ft=e.getInstanceFromNode,Cn=e.preparePortalMount,pn=e.getCurrentEventPriority,Vn=e.detachDeletedInstance,On=e.supportsMicrotasks,Zn=e.scheduleMicrotask,ai=e.supportsTestSelectors,Ei=e.findFiberRoot,Be=e.getBoundingRect,Se=e.getTextContent,St=e.isHiddenSubtree,tn=e.matchAccessibilityRole,nn=e.setFocusIfFocusable,fn=e.setupIntersectionObserver,Nn=e.appendChild,yn=e.appendChildToContainer,Dt=e.commitTextUpdate,Un=e.commitMount,Je=e.commitUpdate,It=e.insertBefore,Zt=e.insertInContainerBefore,sn=e.removeChild,Yn=e.removeChildFromContainer,li=e.resetTextContent,Bi=e.hideInstance,rt=e.hideTextInstance,Ct=e.unhideInstance,Vt=e.unhideTextInstance,bn=e.clearContainer,Ln=e.cloneInstance,Ri=e.createContainerChildSet,hr=e.appendChildToContainerChildSet,Fr=e.finalizeContainerChildren,Pr=e.replaceContainerChildren,Gi=e.cloneHiddenInstance,es=e.cloneHiddenTextInstance,Ee=e.canHydrateInstance,se=e.canHydrateTextInstance,de=e.canHydrateSuspenseInstance,Ie=e.isSuspenseInstancePending,ee=e.isSuspenseInstanceFallback,pe=e.registerSuspenseInstanceRetry,Ae=e.getNextHydratableSibling,ye=e.getFirstHydratableChild,ve=e.getFirstHydratableChildWithinContainer,Ke=e.getFirstHydratableChildWithinSuspenseInstance,ht=e.hydrateInstance,zt=e.hydrateTextInstance,vt=e.hydrateSuspenseInstance,Jt=e.getNextHydratableInstanceAfterSuspenseInstance,Yt=e.commitHydratedContainer,Xt=e.commitHydratedSuspenseInstance,gn=e.clearSuspenseBoundary,Xn=e.clearSuspenseBoundaryFromContainer,ii=e.shouldDeleteUnhydratedTailInstances,Sn=e.didNotMatchHydratedContainerTextInstance,Jn=e.didNotMatchHydratedTextInstance,kn;function ps(x){if(kn===void 0)try{throw Error()}catch(R){var S=R.stack.trim().match(/\n( *(at )?)/);kn=S&&S[1]||""}return`
`+kn+x}var nr=!1;function Br(x,S){if(!x||nr)return"";nr=!0;var R=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(S)if(S=function(){throw Error()},Object.defineProperty(S.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(S,[])}catch(ln){var G=ln}Reflect.construct(x,[],S)}else{try{S.call()}catch(ln){G=ln}x.call(S.prototype)}else{try{throw Error()}catch(ln){G=ln}x()}}catch(ln){if(ln&&G&&typeof ln.stack=="string"){for(var X=ln.stack.split(`
`),te=G.stack.split(`
`),Ve=X.length-1,st=te.length-1;1<=Ve&&0<=st&&X[Ve]!==te[st];)st--;for(;1<=Ve&&0<=st;Ve--,st--)if(X[Ve]!==te[st]){if(Ve!==1||st!==1)do if(Ve--,st--,0>st||X[Ve]!==te[st]){var pt=`
`+X[Ve].replace(" at new "," at ");return x.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",x.displayName)),pt}while(1<=Ve&&0<=st);break}}}finally{nr=!1,Error.prepareStackTrace=R}return(x=x?x.displayName||x.name:"")?ps(x):""}var wt=Object.prototype.hasOwnProperty,Es=[],ir=-1;function Ni(x){return{current:x}}function zi(x){0>ir||(x.current=Es[ir],Es[ir]=null,ir--)}function ci(x,S){ir++,Es[ir]=x.current,x.current=S}var wr={},Ur=Ni(wr),qi=Ni(!1),Kt=wr;function ni(x,S){var R=x.type.contextTypes;if(!R)return wr;var G=x.stateNode;if(G&&G.__reactInternalMemoizedUnmaskedChildContext===S)return G.__reactInternalMemoizedMaskedChildContext;var X={},te;for(te in R)X[te]=S[te];return G&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=S,x.__reactInternalMemoizedMaskedChildContext=X),X}function Kn(x){return x=x.childContextTypes,x!=null}function uo(){zi(qi),zi(Ur)}function Wl(x,S,R){if(Ur.current!==wr)throw Error(l(168));ci(Ur,S),ci(qi,R)}function ri(x,S,R){var G=x.stateNode;if(S=S.childContextTypes,typeof G.getChildContext!="function")return R;G=G.getChildContext();for(var X in G)if(!(X in S))throw Error(l(108,Z(x)||"Unknown",X));return o({},R,G)}function Hl(x){return x=(x=x.stateNode)&&x.__reactInternalMemoizedMergedChildContext||wr,Kt=Ur.current,ci(Ur,x),ci(qi,qi.current),!0}function Rc(x,S,R){var G=x.stateNode;if(!G)throw Error(l(169));R?(x=ri(x,S,Kt),G.__reactInternalMemoizedMergedChildContext=x,zi(qi),zi(Ur),ci(Ur,x)):zi(qi),ci(qi,R)}var ms=Math.clz32?Math.clz32:Da,As=Math.log,br=Math.LN2;function Da(x){return x>>>=0,x===0?32:31-(As(x)/br|0)|0}var jl=64,ql=4194304;function sl(x){switch(x&-x){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return x&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return x}}function Zl(x,S){var R=x.pendingLanes;if(R===0)return 0;var G=0,X=x.suspendedLanes,te=x.pingedLanes,Ve=R&268435455;if(Ve!==0){var st=Ve&~X;st!==0?G=sl(st):(te&=Ve,te!==0&&(G=sl(te)))}else Ve=R&~X,Ve!==0?G=sl(Ve):te!==0&&(G=sl(te));if(G===0)return 0;if(S!==0&&S!==G&&!(S&X)&&(X=G&-G,te=S&-S,X>=te||X===16&&(te&4194240)!==0))return S;if(G&4&&(G|=R&16),S=x.entangledLanes,S!==0)for(x=x.entanglements,S&=G;0<S;)R=31-ms(S),X=1<<R,G|=x[R],S&=~X;return G}function jp(x,S){switch(x){case 1:case 2:case 4:return S+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return S+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xl(x,S){for(var R=x.suspendedLanes,G=x.pingedLanes,X=x.expirationTimes,te=x.pendingLanes;0<te;){var Ve=31-ms(te),st=1<<Ve,pt=X[Ve];pt===-1?(!(st&R)||st&G)&&(X[Ve]=jp(st,S)):pt<=S&&(x.expiredLanes|=st),te&=~st}}function zc(x){return x=x.pendingLanes&-1073741825,x!==0?x:x&1073741824?1073741824:0}function Nu(x){for(var S=[],R=0;31>R;R++)S.push(x);return S}function Oc(x,S,R){x.pendingLanes|=S,S!==536870912&&(x.suspendedLanes=0,x.pingedLanes=0),x=x.eventTimes,S=31-ms(S),x[S]=R}function ho(x,S){var R=x.pendingLanes&~S;x.pendingLanes=S,x.suspendedLanes=0,x.pingedLanes=0,x.expiredLanes&=S,x.mutableReadLanes&=S,x.entangledLanes&=S,S=x.entanglements;var G=x.eventTimes;for(x=x.expirationTimes;0<R;){var X=31-ms(R),te=1<<X;S[X]=0,G[X]=-1,x[X]=-1,R&=~te}}function Sr(x,S){var R=x.entangledLanes|=S;for(x=x.entanglements;R;){var G=31-ms(R),X=1<<G;X&S|x[G]&S&&(x[G]|=S),R&=~X}}var Ai=0;function rf(x){return x&=-x,1<x?4<x?x&268435455?16:536870912:4:1}var ts=r.unstable_scheduleCallback,Io=r.unstable_cancelCallback,Og=r.unstable_shouldYield,sf=r.unstable_requestPaint,wi=r.unstable_now,Fc=r.unstable_ImmediatePriority,qp=r.unstable_UserBlockingPriority,Bc=r.unstable_NormalPriority,gs=r.unstable_IdlePriority,ol=null,Wo=null;function al(x){if(Wo&&typeof Wo.onCommitFiberRoot=="function")try{Wo.onCommitFiberRoot(ol,x,void 0,(x.current.flags&128)===128)}catch{}}function Dh(x,S){return x===S&&(x!==0||1/x===1/S)||x!==x&&S!==S}var Po=typeof Object.is=="function"?Object.is:Dh,ll=null,Uu=!1,cl=!1;function Rh(x){ll===null?ll=[x]:ll.push(x)}function Fg(x){Uu=!0,Rh(x)}function Xs(){if(!cl&&ll!==null){cl=!0;var x=0,S=Ai;try{var R=ll;for(Ai=1;x<R.length;x++){var G=R[x];do G=G(!0);while(G!==null)}ll=null,Uu=!1}catch(X){throw ll!==null&&(ll=ll.slice(x+1)),ts(Fc,Xs),X}finally{Ai=S,cl=!1}}return null}var $l=s.ReactCurrentBatchConfig;function Nc(x,S){if(Po(x,S))return!0;if(typeof x!="object"||x===null||typeof S!="object"||S===null)return!1;var R=Object.keys(x),G=Object.keys(S);if(R.length!==G.length)return!1;for(G=0;G<R.length;G++){var X=R[G];if(!wt.call(S,X)||!Po(x[X],S[X]))return!1}return!0}function Cs(x){switch(x.tag){case 5:return ps(x.type);case 16:return ps("Lazy");case 13:return ps("Suspense");case 19:return ps("SuspenseList");case 0:case 2:case 15:return x=Br(x.type,!1),x;case 11:return x=Br(x.type.render,!1),x;case 1:return x=Br(x.type,!0),x;default:return""}}function fo(x,S){if(x&&x.defaultProps){S=o({},S),x=x.defaultProps;for(var R in x)S[R]===void 0&&(S[R]=x[R]);return S}return S}var Yl=Ni(null),zh=null,Uc=null,Vu=null;function of(){Vu=Uc=zh=null}function Oh(x,S,R){_n?(ci(Yl,S._currentValue),S._currentValue=R):(ci(Yl,S._currentValue2),S._currentValue2=R)}function Vc(x){var S=Yl.current;zi(Yl),_n?x._currentValue=S:x._currentValue2=S}function Fh(x,S,R){for(;x!==null;){var G=x.alternate;if((x.childLanes&S)!==S?(x.childLanes|=S,G!==null&&(G.childLanes|=S)):G!==null&&(G.childLanes&S)!==S&&(G.childLanes|=S),x===R)break;x=x.return}}function Gc(x,S){zh=x,Vu=Uc=null,x=x.dependencies,x!==null&&x.firstContext!==null&&(x.lanes&S&&(Do=!0),x.firstContext=null)}function Bs(x){var S=_n?x._currentValue:x._currentValue2;if(Vu!==x)if(x={context:x,memoizedValue:S,next:null},Uc===null){if(zh===null)throw Error(l(308));Uc=x,zh.dependencies={lanes:0,firstContext:x}}else Uc=Uc.next=x;return S}var Ho=null,po=!1;function Ci(x){x.updateQueue={baseState:x.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zp(x,S){x=x.updateQueue,S.updateQueue===x&&(S.updateQueue={baseState:x.baseState,firstBaseUpdate:x.firstBaseUpdate,lastBaseUpdate:x.lastBaseUpdate,shared:x.shared,effects:x.effects})}function Lo(x,S){return{eventTime:x,lane:S,tag:0,payload:null,callback:null,next:null}}function Ra(x,S){var R=x.updateQueue;R!==null&&(R=R.shared,at!==null&&x.mode&1&&!(Ye&2)?(x=R.interleaved,x===null?(S.next=S,Ho===null?Ho=[R]:Ho.push(R)):(S.next=x.next,x.next=S),R.interleaved=S):(x=R.pending,x===null?S.next=S:(S.next=x.next,x.next=S),R.pending=S))}function ul(x,S,R){if(S=S.updateQueue,S!==null&&(S=S.shared,(R&4194240)!==0)){var G=S.lanes;G&=x.pendingLanes,R|=G,S.lanes=R,Sr(x,R)}}function Bh(x,S){var R=x.updateQueue,G=x.alternate;if(G!==null&&(G=G.updateQueue,R===G)){var X=null,te=null;if(R=R.firstBaseUpdate,R!==null){do{var Ve={eventTime:R.eventTime,lane:R.lane,tag:R.tag,payload:R.payload,callback:R.callback,next:null};te===null?X=te=Ve:te=te.next=Ve,R=R.next}while(R!==null);te===null?X=te=S:te=te.next=S}else X=te=S;R={baseState:G.baseState,firstBaseUpdate:X,lastBaseUpdate:te,shared:G.shared,effects:G.effects},x.updateQueue=R;return}x=R.lastBaseUpdate,x===null?R.firstBaseUpdate=S:x.next=S,R.lastBaseUpdate=S}function Kl(x,S,R,G){var X=x.updateQueue;po=!1;var te=X.firstBaseUpdate,Ve=X.lastBaseUpdate,st=X.shared.pending;if(st!==null){X.shared.pending=null;var pt=st,ln=pt.next;pt.next=null,Ve===null?te=ln:Ve.next=ln,Ve=pt;var Dn=x.alternate;Dn!==null&&(Dn=Dn.updateQueue,st=Dn.lastBaseUpdate,st!==Ve&&(st===null?Dn.firstBaseUpdate=ln:st.next=ln,Dn.lastBaseUpdate=pt))}if(te!==null){var Qn=X.baseState;Ve=0,Dn=ln=pt=null,st=te;do{var Gn=st.lane,Ii=st.eventTime;if((G&Gn)===Gn){Dn!==null&&(Dn=Dn.next={eventTime:Ii,lane:0,tag:st.tag,payload:st.payload,callback:st.callback,next:null});e:{var Pn=x,Hi=st;switch(Gn=S,Ii=R,Hi.tag){case 1:if(Pn=Hi.payload,typeof Pn=="function"){Qn=Pn.call(Ii,Qn,Gn);break e}Qn=Pn;break e;case 3:Pn.flags=Pn.flags&-65537|128;case 0:if(Pn=Hi.payload,Gn=typeof Pn=="function"?Pn.call(Ii,Qn,Gn):Pn,Gn==null)break e;Qn=o({},Qn,Gn);break e;case 2:po=!0}}st.callback!==null&&st.lane!==0&&(x.flags|=64,Gn=X.effects,Gn===null?X.effects=[st]:Gn.push(st))}else Ii={eventTime:Ii,lane:Gn,tag:st.tag,payload:st.payload,callback:st.callback,next:null},Dn===null?(ln=Dn=Ii,pt=Qn):Dn=Dn.next=Ii,Ve|=Gn;if(st=st.next,st===null){if(st=X.shared.pending,st===null)break;Gn=st,st=Gn.next,Gn.next=null,X.lastBaseUpdate=Gn,X.shared.pending=null}}while(1);if(Dn===null&&(pt=Qn),X.baseState=pt,X.firstBaseUpdate=ln,X.lastBaseUpdate=Dn,S=X.shared.interleaved,S!==null){X=S;do Ve|=X.lane,X=X.next;while(X!==S)}else te===null&&(X.shared.lanes=0);an|=Ve,x.lanes=Ve,x.memoizedState=Qn}}function Nh(x,S,R){if(x=S.effects,S.effects=null,x!==null)for(S=0;S<x.length;S++){var G=x[S],X=G.callback;if(X!==null){if(G.callback=null,G=R,typeof X!="function")throw Error(l(191,X));X.call(G)}}}var af=new i.Component().refs;function Gu(x,S,R,G){S=x.memoizedState,R=R(G,S),R=R==null?S:o({},S,R),x.memoizedState=R,x.lanes===0&&(x.updateQueue.baseState=R)}var za={isMounted:function(x){return(x=x._reactInternals)?ne(x)===x:!1},enqueueSetState:function(x,S,R){x=x._reactInternals;var G=Xi(),X=rs(x),te=Lo(G,X);te.payload=S,R!=null&&(te.callback=R),Ra(x,te),S=Vr(x,X,G),S!==null&&ul(S,x,X)},enqueueReplaceState:function(x,S,R){x=x._reactInternals;var G=Xi(),X=rs(x),te=Lo(G,X);te.tag=1,te.payload=S,R!=null&&(te.callback=R),Ra(x,te),S=Vr(x,X,G),S!==null&&ul(S,x,X)},enqueueForceUpdate:function(x,S){x=x._reactInternals;var R=Xi(),G=rs(x),X=Lo(R,G);X.tag=2,S!=null&&(X.callback=S),Ra(x,X),S=Vr(x,G,R),S!==null&&ul(S,x,G)}};function Wc(x,S,R,G,X,te,Ve){return x=x.stateNode,typeof x.shouldComponentUpdate=="function"?x.shouldComponentUpdate(G,te,Ve):S.prototype&&S.prototype.isPureReactComponent?!Nc(R,G)||!Nc(X,te):!0}function Uh(x,S,R){var G=!1,X=wr,te=S.contextType;return typeof te=="object"&&te!==null?te=Bs(te):(X=Kn(S)?Kt:Ur.current,G=S.contextTypes,te=(G=G!=null)?ni(x,X):wr),S=new S(R,te),x.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=za,x.stateNode=S,S._reactInternals=x,G&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=X,x.__reactInternalMemoizedMaskedChildContext=te),S}function Wu(x,S,R,G){x=S.state,typeof S.componentWillReceiveProps=="function"&&S.componentWillReceiveProps(R,G),typeof S.UNSAFE_componentWillReceiveProps=="function"&&S.UNSAFE_componentWillReceiveProps(R,G),S.state!==x&&za.enqueueReplaceState(S,S.state,null)}function Hu(x,S,R,G){var X=x.stateNode;X.props=R,X.state=x.memoizedState,X.refs=af,Ci(x);var te=S.contextType;typeof te=="object"&&te!==null?X.context=Bs(te):(te=Kn(S)?Kt:Ur.current,X.context=ni(x,te)),X.state=x.memoizedState,te=S.getDerivedStateFromProps,typeof te=="function"&&(Gu(x,S,te,R),X.state=x.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof X.getSnapshotBeforeUpdate=="function"||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(S=X.state,typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount(),S!==X.state&&za.enqueueReplaceState(X,X.state,null),Kl(x,R,X,G),X.state=x.memoizedState),typeof X.componentDidMount=="function"&&(x.flags|=4194308)}var di=[],hl=0,ju=null,Vh=0,mo=[],$s=0,Jl=null,Oa=1,dl="";function Fa(x,S){di[hl++]=Vh,di[hl++]=ju,ju=x,Vh=S}function Gh(x,S,R){mo[$s++]=Oa,mo[$s++]=dl,mo[$s++]=Jl,Jl=x;var G=Oa;x=dl;var X=32-ms(G)-1;G&=~(1<<X),R+=1;var te=32-ms(S)+X;if(30<te){var Ve=X-X%5;te=(G&(1<<Ve)-1).toString(32),G>>=Ve,X-=Ve,Oa=1<<32-ms(S)+X|R<<X|G,dl=te+x}else Oa=1<<te|R<<X|G,dl=x}function Wh(x){x.return!==null&&(Fa(x,1),Gh(x,1,0))}function Hh(x){for(;x===ju;)ju=di[--hl],di[hl]=null,Vh=di[--hl],di[hl]=null;for(;x===Jl;)Jl=mo[--$s],mo[$s]=null,dl=mo[--$s],mo[$s]=null,Oa=mo[--$s],mo[$s]=null}var go=null,_o=null,Ar=!1,fl=!1,Ns=null;function Xp(x,S){var R=wa(5,null,null,0);R.elementType="DELETED",R.stateNode=S,R.return=x,S=x.deletions,S===null?(x.deletions=[R],x.flags|=16):S.push(R)}function jh(x,S){switch(x.tag){case 5:return S=Ee(S,x.type,x.pendingProps),S!==null?(x.stateNode=S,go=x,_o=ye(S),!0):!1;case 6:return S=se(S,x.pendingProps),S!==null?(x.stateNode=S,go=x,_o=null,!0):!1;case 13:if(S=de(S),S!==null){var R=Jl!==null?{id:Oa,overflow:dl}:null;return x.memoizedState={dehydrated:S,treeContext:R,retryLane:1073741824},R=wa(18,null,null,0),R.stateNode=S,R.return=x,x.child=R,go=x,_o=null,!0}return!1;default:return!1}}function qh(x){return(x.mode&1)!==0&&(x.flags&128)===0}function jo(x){if(Ar){var S=_o;if(S){var R=S;if(!jh(x,S)){if(qh(x))throw Error(l(418));S=Ae(R);var G=go;S&&jh(x,S)?Xp(G,R):(x.flags=x.flags&-4097|2,Ar=!1,go=x)}}else{if(qh(x))throw Error(l(418));x.flags=x.flags&-4097|2,Ar=!1,go=x}}}function Zh(x){for(x=x.return;x!==null&&x.tag!==5&&x.tag!==3&&x.tag!==13;)x=x.return;go=x}function Hc(x){if(!Ot||x!==go)return!1;if(!Ar)return Zh(x),Ar=!0,!1;if(x.tag!==3&&(x.tag!==5||ii(x.type)&&!et(x.type,x.memoizedProps))){var S=_o;if(S){if(qh(x)){for(x=_o;x;)x=Ae(x);throw Error(l(418))}for(;S;)Xp(x,S),S=Ae(S)}}if(Zh(x),x.tag===13){if(!Ot)throw Error(l(316));if(x=x.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(l(317));_o=Jt(x)}else _o=go?Ae(x.stateNode):null;return!0}function pl(){Ot&&(_o=go=null,fl=Ar=!1)}function lf(x){Ns===null?Ns=[x]:Ns.push(x)}function jc(x,S,R){if(x=R.ref,x!==null&&typeof x!="function"&&typeof x!="object"){if(R._owner){if(R=R._owner,R){if(R.tag!==1)throw Error(l(309));var G=R.stateNode}if(!G)throw Error(l(147,x));var X=G,te=""+x;return S!==null&&S.ref!==null&&typeof S.ref=="function"&&S.ref._stringRef===te?S.ref:(S=function(Ve){var st=X.refs;st===af&&(st=X.refs={}),Ve===null?delete st[te]:st[te]=Ve},S._stringRef=te,S)}if(typeof x!="string")throw Error(l(284));if(!R._owner)throw Error(l(290,x))}return x}function Xh(x,S){throw x=Object.prototype.toString.call(S),Error(l(31,x==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":x))}function $h(x){var S=x._init;return S(x._payload)}function $p(x){function S(_t,ct){if(x){var Mt=_t.deletions;Mt===null?(_t.deletions=[ct],_t.flags|=16):Mt.push(ct)}}function R(_t,ct){if(!x)return null;for(;ct!==null;)S(_t,ct),ct=ct.sibling;return null}function G(_t,ct){for(_t=new Map;ct!==null;)ct.key!==null?_t.set(ct.key,ct):_t.set(ct.index,ct),ct=ct.sibling;return _t}function X(_t,ct){return _t=ah(_t,ct),_t.index=0,_t.sibling=null,_t}function te(_t,ct,Mt){return _t.index=Mt,x?(Mt=_t.alternate,Mt!==null?(Mt=Mt.index,Mt<ct?(_t.flags|=2,ct):Mt):(_t.flags|=2,ct)):(_t.flags|=1048576,ct)}function Ve(_t){return x&&_t.alternate===null&&(_t.flags|=2),_t}function st(_t,ct,Mt,Mn){return ct===null||ct.tag!==6?(ct=Ml(Mt,_t.mode,Mn),ct.return=_t,ct):(ct=X(ct,Mt),ct.return=_t,ct)}function pt(_t,ct,Mt,Mn){var Hn=Mt.type;return Hn===_?Dn(_t,ct,Mt.props.children,Mn,Mt.key):ct!==null&&(ct.elementType===Hn||typeof Hn=="object"&&Hn!==null&&Hn.$$typeof===N&&$h(Hn)===ct.type)?(Mn=X(ct,Mt.props),Mn.ref=jc(_t,ct,Mt),Mn.return=_t,Mn):(Mn=Af(Mt.type,Mt.key,Mt.props,null,_t.mode,Mn),Mn.ref=jc(_t,ct,Mt),Mn.return=_t,Mn)}function ln(_t,ct,Mt,Mn){return ct===null||ct.tag!==4||ct.stateNode.containerInfo!==Mt.containerInfo||ct.stateNode.implementation!==Mt.implementation?(ct=ba(Mt,_t.mode,Mn),ct.return=_t,ct):(ct=X(ct,Mt.children||[]),ct.return=_t,ct)}function Dn(_t,ct,Mt,Mn,Hn){return ct===null||ct.tag!==7?(ct=Sl(Mt,_t.mode,Mn,Hn),ct.return=_t,ct):(ct=X(ct,Mt),ct.return=_t,ct)}function Qn(_t,ct,Mt){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return ct=Ml(""+ct,_t.mode,Mt),ct.return=_t,ct;if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case d:return Mt=Af(ct.type,ct.key,ct.props,null,_t.mode,Mt),Mt.ref=jc(_t,null,ct),Mt.return=_t,Mt;case p:return ct=ba(ct,_t.mode,Mt),ct.return=_t,ct;case N:var Mn=ct._init;return Qn(_t,Mn(ct._payload),Mt)}if(fe(ct)||Q(ct))return ct=Sl(ct,_t.mode,Mt,null),ct.return=_t,ct;Xh(_t,ct)}return null}function Gn(_t,ct,Mt,Mn){var Hn=ct!==null?ct.key:null;if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number")return Hn!==null?null:st(_t,ct,""+Mt,Mn);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case d:return Mt.key===Hn?pt(_t,ct,Mt,Mn):null;case p:return Mt.key===Hn?ln(_t,ct,Mt,Mn):null;case N:return Hn=Mt._init,Gn(_t,ct,Hn(Mt._payload),Mn)}if(fe(Mt)||Q(Mt))return Hn!==null?null:Dn(_t,ct,Mt,Mn,null);Xh(_t,Mt)}return null}function Ii(_t,ct,Mt,Mn,Hn){if(typeof Mn=="string"&&Mn!==""||typeof Mn=="number")return _t=_t.get(Mt)||null,st(ct,_t,""+Mn,Hn);if(typeof Mn=="object"&&Mn!==null){switch(Mn.$$typeof){case d:return _t=_t.get(Mn.key===null?Mt:Mn.key)||null,pt(ct,_t,Mn,Hn);case p:return _t=_t.get(Mn.key===null?Mt:Mn.key)||null,ln(ct,_t,Mn,Hn);case N:var mi=Mn._init;return Ii(_t,ct,Mt,mi(Mn._payload),Hn)}if(fe(Mn)||Q(Mn))return _t=_t.get(Mt)||null,Dn(ct,_t,Mn,Hn,null);Xh(ct,Mn)}return null}function Pn(_t,ct,Mt,Mn){for(var Hn=null,mi=null,fi=ct,Ui=ct=0,ks=null;fi!==null&&Ui<Mt.length;Ui++){fi.index>Ui?(ks=fi,fi=null):ks=fi.sibling;var $i=Gn(_t,fi,Mt[Ui],Mn);if($i===null){fi===null&&(fi=ks);break}x&&fi&&$i.alternate===null&&S(_t,fi),ct=te($i,ct,Ui),mi===null?Hn=$i:mi.sibling=$i,mi=$i,fi=ks}if(Ui===Mt.length)return R(_t,fi),Ar&&Fa(_t,Ui),Hn;if(fi===null){for(;Ui<Mt.length;Ui++)fi=Qn(_t,Mt[Ui],Mn),fi!==null&&(ct=te(fi,ct,Ui),mi===null?Hn=fi:mi.sibling=fi,mi=fi);return Ar&&Fa(_t,Ui),Hn}for(fi=G(_t,fi);Ui<Mt.length;Ui++)ks=Ii(fi,_t,Ui,Mt[Ui],Mn),ks!==null&&(x&&ks.alternate!==null&&fi.delete(ks.key===null?Ui:ks.key),ct=te(ks,ct,Ui),mi===null?Hn=ks:mi.sibling=ks,mi=ks);return x&&fi.forEach(function(wo){return S(_t,wo)}),Ar&&Fa(_t,Ui),Hn}function Hi(_t,ct,Mt,Mn){var Hn=Q(Mt);if(typeof Hn!="function")throw Error(l(150));if(Mt=Hn.call(Mt),Mt==null)throw Error(l(151));for(var mi=Hn=null,fi=ct,Ui=ct=0,ks=null,$i=Mt.next();fi!==null&&!$i.done;Ui++,$i=Mt.next()){fi.index>Ui?(ks=fi,fi=null):ks=fi.sibling;var wo=Gn(_t,fi,$i.value,Mn);if(wo===null){fi===null&&(fi=ks);break}x&&fi&&wo.alternate===null&&S(_t,fi),ct=te(wo,ct,Ui),mi===null?Hn=wo:mi.sibling=wo,mi=wo,fi=ks}if($i.done)return R(_t,fi),Ar&&Fa(_t,Ui),Hn;if(fi===null){for(;!$i.done;Ui++,$i=Mt.next())$i=Qn(_t,$i.value,Mn),$i!==null&&(ct=te($i,ct,Ui),mi===null?Hn=$i:mi.sibling=$i,mi=$i);return Ar&&Fa(_t,Ui),Hn}for(fi=G(_t,fi);!$i.done;Ui++,$i=Mt.next())$i=Ii(fi,_t,Ui,$i.value,Mn),$i!==null&&(x&&$i.alternate!==null&&fi.delete($i.key===null?Ui:$i.key),ct=te($i,ct,Ui),mi===null?Hn=$i:mi.sibling=$i,mi=$i);return x&&fi.forEach(function(hd){return S(_t,hd)}),Ar&&Fa(_t,Ui),Hn}function Sa(_t,ct,Mt,Mn){if(typeof Mt=="object"&&Mt!==null&&Mt.type===_&&Mt.key===null&&(Mt=Mt.props.children),typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case d:e:{for(var Hn=Mt.key,mi=ct;mi!==null;){if(mi.key===Hn){if(Hn=Mt.type,Hn===_){if(mi.tag===7){R(_t,mi.sibling),ct=X(mi,Mt.props.children),ct.return=_t,_t=ct;break e}}else if(mi.elementType===Hn||typeof Hn=="object"&&Hn!==null&&Hn.$$typeof===N&&$h(Hn)===mi.type){R(_t,mi.sibling),ct=X(mi,Mt.props),ct.ref=jc(_t,mi,Mt),ct.return=_t,_t=ct;break e}R(_t,mi);break}else S(_t,mi);mi=mi.sibling}Mt.type===_?(ct=Sl(Mt.props.children,_t.mode,Mn,Mt.key),ct.return=_t,_t=ct):(Mn=Af(Mt.type,Mt.key,Mt.props,null,_t.mode,Mn),Mn.ref=jc(_t,ct,Mt),Mn.return=_t,_t=Mn)}return Ve(_t);case p:e:{for(mi=Mt.key;ct!==null;){if(ct.key===mi)if(ct.tag===4&&ct.stateNode.containerInfo===Mt.containerInfo&&ct.stateNode.implementation===Mt.implementation){R(_t,ct.sibling),ct=X(ct,Mt.children||[]),ct.return=_t,_t=ct;break e}else{R(_t,ct);break}else S(_t,ct);ct=ct.sibling}ct=ba(Mt,_t.mode,Mn),ct.return=_t,_t=ct}return Ve(_t);case N:return mi=Mt._init,Sa(_t,ct,mi(Mt._payload),Mn)}if(fe(Mt))return Pn(_t,ct,Mt,Mn);if(Q(Mt))return Hi(_t,ct,Mt,Mn);Xh(_t,Mt)}return typeof Mt=="string"&&Mt!==""||typeof Mt=="number"?(Mt=""+Mt,ct!==null&&ct.tag===6?(R(_t,ct.sibling),ct=X(ct,Mt),ct.return=_t,_t=ct):(R(_t,ct),ct=Ml(Mt,_t.mode,Mn),ct.return=_t,_t=ct),Ve(_t)):R(_t,ct)}return Sa}var ml=$p(!0),Bg=$p(!1),qc={},qo=Ni(qc),Ba=Ni(qc),Zc=Ni(qc);function yo(x){if(x===qc)throw Error(l(174));return x}function Yp(x,S){ci(Zc,S),ci(Ba,x),ci(qo,qc),x=We(S),zi(qo),ci(qo,x)}function Xc(){zi(qo),zi(Ba),zi(Zc)}function Kp(x){var S=yo(Zc.current),R=yo(qo.current);S=ce(R,x.type,S),R!==S&&(ci(Ba,x),ci(qo,S))}function gl(x){Ba.current===x&&(zi(qo),zi(Ba))}var Cr=Ni(0);function Yh(x){for(var S=x;S!==null;){if(S.tag===13){var R=S.memoizedState;if(R!==null&&(R=R.dehydrated,R===null||Ie(R)||ee(R)))return S}else if(S.tag===19&&S.memoizedProps.revealOrder!==void 0){if(S.flags&128)return S}else if(S.child!==null){S.child.return=S,S=S.child;continue}if(S===x)break;for(;S.sibling===null;){if(S.return===null||S.return===x)return null;S=S.return}S.sibling.return=S.return,S=S.sibling}return null}var Kh=[];function Jp(){for(var x=0;x<Kh.length;x++){var S=Kh[x];_n?S._workInProgressVersionPrimary=null:S._workInProgressVersionSecondary=null}Kh.length=0}var cf=s.ReactCurrentDispatcher,Zo=s.ReactCurrentBatchConfig,Ql=0,Ir=null,Is=null,ns=null,qu=!1,ec=!1,xo=0,Jh=0;function Ps(){throw Error(l(321))}function Ys(x,S){if(S===null)return!1;for(var R=0;R<S.length&&R<x.length;R++)if(!Po(x[R],S[R]))return!1;return!0}function _l(x,S,R,G,X,te){if(Ql=te,Ir=S,S.memoizedState=null,S.updateQueue=null,S.lanes=0,cf.current=x===null||x.memoizedState===null?Yu:nm,x=R(G,X),ec){te=0;do{if(ec=!1,xo=0,25<=te)throw Error(l(301));te+=1,ns=Is=null,S.updateQueue=null,cf.current=gf,x=R(G,X)}while(ec)}if(cf.current=ed,S=Is!==null&&Is.next!==null,Ql=0,ns=Is=Ir=null,qu=!1,S)throw Error(l(300));return x}function yl(){var x=xo!==0;return xo=0,x}function _a(){var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ns===null?Ir.memoizedState=ns=x:ns=ns.next=x,ns}function oi(){if(Is===null){var x=Ir.alternate;x=x!==null?x.memoizedState:null}else x=Is.next;var S=ns===null?Ir.memoizedState:ns.next;if(S!==null)ns=S,Is=x;else{if(x===null)throw Error(l(310));Is=x,x={memoizedState:Is.memoizedState,baseState:Is.baseState,baseQueue:Is.baseQueue,queue:Is.queue,next:null},ns===null?Ir.memoizedState=ns=x:ns=ns.next=x}return ns}function ya(x,S){return typeof S=="function"?S(x):S}function uf(x){var S=oi(),R=S.queue;if(R===null)throw Error(l(311));R.lastRenderedReducer=x;var G=Is,X=G.baseQueue,te=R.pending;if(te!==null){if(X!==null){var Ve=X.next;X.next=te.next,te.next=Ve}G.baseQueue=X=te,R.pending=null}if(X!==null){te=X.next,G=G.baseState;var st=Ve=null,pt=null,ln=te;do{var Dn=ln.lane;if((Ql&Dn)===Dn)pt!==null&&(pt=pt.next={lane:0,action:ln.action,hasEagerState:ln.hasEagerState,eagerState:ln.eagerState,next:null}),G=ln.hasEagerState?ln.eagerState:x(G,ln.action);else{var Qn={lane:Dn,action:ln.action,hasEagerState:ln.hasEagerState,eagerState:ln.eagerState,next:null};pt===null?(st=pt=Qn,Ve=G):pt=pt.next=Qn,Ir.lanes|=Dn,an|=Dn}ln=ln.next}while(ln!==null&&ln!==te);pt===null?Ve=G:pt.next=st,Po(G,S.memoizedState)||(Do=!0),S.memoizedState=G,S.baseState=Ve,S.baseQueue=pt,R.lastRenderedState=G}if(x=R.interleaved,x!==null){X=x;do te=X.lane,Ir.lanes|=te,an|=te,X=X.next;while(X!==x)}else X===null&&(R.lanes=0);return[S.memoizedState,R.dispatch]}function $c(x){var S=oi(),R=S.queue;if(R===null)throw Error(l(311));R.lastRenderedReducer=x;var G=R.dispatch,X=R.pending,te=S.memoizedState;if(X!==null){R.pending=null;var Ve=X=X.next;do te=x(te,Ve.action),Ve=Ve.next;while(Ve!==X);Po(te,S.memoizedState)||(Do=!0),S.memoizedState=te,S.baseQueue===null&&(S.baseState=te),R.lastRenderedState=te}return[te,G]}function Yc(){}function hf(x,S){var R=Ir,G=oi(),X=S(),te=!Po(G.memoizedState,X);if(te&&(G.memoizedState=X,Do=!0),G=G.queue,vl(ff.bind(null,R,G,x),[x]),G.getSnapshot!==S||te||ns!==null&&ns.memoizedState.tag&1){if(R.flags|=2048,Xo(9,df.bind(null,R,G,X,S),void 0,null),at===null)throw Error(l(349));Ql&30||Qp(R,S,X)}return X}function Qp(x,S,R){x.flags|=16384,x={getSnapshot:S,value:R},S=Ir.updateQueue,S===null?(S={lastEffect:null,stores:null},Ir.updateQueue=S,S.stores=[x]):(R=S.stores,R===null?S.stores=[x]:R.push(x))}function df(x,S,R,G){S.value=R,S.getSnapshot=G,Qh(S)&&Vr(x,1,-1)}function ff(x,S,R){return R(function(){Qh(S)&&Vr(x,1,-1)})}function Qh(x){var S=x.getSnapshot;x=x.value;try{var R=S();return!Po(x,R)}catch{return!0}}function Kc(x){var S=_a();return typeof x=="function"&&(x=x()),S.memoizedState=S.baseState=x,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:x},S.queue=x,x=x.dispatch=vo.bind(null,Ir,x),[S.memoizedState,x]}function Xo(x,S,R,G){return x={tag:x,create:S,destroy:R,deps:G,next:null},S=Ir.updateQueue,S===null?(S={lastEffect:null,stores:null},Ir.updateQueue=S,S.lastEffect=x.next=x):(R=S.lastEffect,R===null?S.lastEffect=x.next=x:(G=R.next,R.next=x,x.next=G,S.lastEffect=x)),x}function xl(){return oi().memoizedState}function Jc(x,S,R,G){var X=_a();Ir.flags|=x,X.memoizedState=Xo(1|S,R,void 0,G===void 0?null:G)}function Zu(x,S,R,G){var X=oi();G=G===void 0?null:G;var te=void 0;if(Is!==null){var Ve=Is.memoizedState;if(te=Ve.destroy,G!==null&&Ys(G,Ve.deps)){X.memoizedState=Xo(S,R,te,G);return}}Ir.flags|=x,X.memoizedState=Xo(1|S,R,te,G)}function tc(x,S){return Jc(8390656,8,x,S)}function vl(x,S){return Zu(2048,8,x,S)}function hn(x,S){return Zu(4,2,x,S)}function ko(x,S){return Zu(4,4,x,S)}function Xu(x,S){if(typeof S=="function")return x=x(),S(x),function(){S(null)};if(S!=null)return x=x(),S.current=x,function(){S.current=null}}function em(x,S,R){return R=R!=null?R.concat([x]):null,Zu(4,4,Xu.bind(null,S,x),R)}function pf(){}function Qc(x,S){var R=oi();S=S===void 0?null:S;var G=R.memoizedState;return G!==null&&S!==null&&Ys(S,G[1])?G[0]:(R.memoizedState=[x,S],x)}function tm(x,S){var R=oi();S=S===void 0?null:S;var G=R.memoizedState;return G!==null&&S!==null&&Ys(S,G[1])?G[0]:(x=x(),R.memoizedState=[x,S],x)}function mf(x,S){var R=Ai;Ai=R!==0&&4>R?R:4,x(!0);var G=Zo.transition;Zo.transition={};try{x(!1),S()}finally{Ai=R,Zo.transition=G}}function eu(){return oi().memoizedState}function tu(x,S,R){var G=rs(x);R={lane:G,action:R,hasEagerState:!1,eagerState:null,next:null},$u(x)?nu(S,R):(Ng(x,S,R),R=Xi(),x=Vr(x,G,R),x!==null&&Ug(x,S,G))}function vo(x,S,R){var G=rs(x),X={lane:G,action:R,hasEagerState:!1,eagerState:null,next:null};if($u(x))nu(S,X);else{Ng(x,S,X);var te=x.alternate;if(x.lanes===0&&(te===null||te.lanes===0)&&(te=S.lastRenderedReducer,te!==null))try{var Ve=S.lastRenderedState,st=te(Ve,R);if(X.hasEagerState=!0,X.eagerState=st,Po(st,Ve))return}catch{}finally{}R=Xi(),x=Vr(x,G,R),x!==null&&Ug(x,S,G)}}function $u(x){var S=x.alternate;return x===Ir||S!==null&&S===Ir}function nu(x,S){ec=qu=!0;var R=x.pending;R===null?S.next=S:(S.next=R.next,R.next=S),x.pending=S}function Ng(x,S,R){at!==null&&x.mode&1&&!(Ye&2)?(x=S.interleaved,x===null?(R.next=R,Ho===null?Ho=[S]:Ho.push(S)):(R.next=x.next,x.next=R),S.interleaved=R):(x=S.pending,x===null?R.next=R:(R.next=x.next,x.next=R),S.pending=R)}function Ug(x,S,R){if(R&4194240){var G=S.lanes;G&=x.pendingLanes,R|=G,S.lanes=R,Sr(x,R)}}var ed={readContext:Bs,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useInsertionEffect:Ps,useLayoutEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useMutableSource:Ps,useSyncExternalStore:Ps,useId:Ps,unstable_isNewReconciler:!1},Yu={readContext:Bs,useCallback:function(x,S){return _a().memoizedState=[x,S===void 0?null:S],x},useContext:Bs,useEffect:tc,useImperativeHandle:function(x,S,R){return R=R!=null?R.concat([x]):null,Jc(4194308,4,Xu.bind(null,S,x),R)},useLayoutEffect:function(x,S){return Jc(4194308,4,x,S)},useInsertionEffect:function(x,S){return Jc(4,2,x,S)},useMemo:function(x,S){var R=_a();return S=S===void 0?null:S,x=x(),R.memoizedState=[x,S],x},useReducer:function(x,S,R){var G=_a();return S=R!==void 0?R(S):S,G.memoizedState=G.baseState=S,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:S},G.queue=x,x=x.dispatch=tu.bind(null,Ir,x),[G.memoizedState,x]},useRef:function(x){var S=_a();return x={current:x},S.memoizedState=x},useState:Kc,useDebugValue:pf,useDeferredValue:function(x){var S=Kc(x),R=S[0],G=S[1];return tc(function(){var X=Zo.transition;Zo.transition={};try{G(x)}finally{Zo.transition=X}},[x]),R},useTransition:function(){var x=Kc(!1),S=x[0];return x=mf.bind(null,x[1]),_a().memoizedState=x,[S,x]},useMutableSource:function(){},useSyncExternalStore:function(x,S,R){var G=Ir,X=_a();if(Ar){if(R===void 0)throw Error(l(407));R=R()}else{if(R=S(),at===null)throw Error(l(349));Ql&30||Qp(G,S,R)}X.memoizedState=R;var te={value:R,getSnapshot:S};return X.queue=te,tc(ff.bind(null,G,te,x),[x]),G.flags|=2048,Xo(9,df.bind(null,G,te,R,S),void 0,null),R},useId:function(){var x=_a(),S=at.identifierPrefix;if(Ar){var R=dl,G=Oa;R=(G&~(1<<32-ms(G)-1)).toString(32)+R,S=":"+S+"R"+R,R=xo++,0<R&&(S+="H"+R.toString(32)),S+=":"}else R=Jh++,S=":"+S+"r"+R.toString(32)+":";return x.memoizedState=S},unstable_isNewReconciler:!1},nm={readContext:Bs,useCallback:Qc,useContext:Bs,useEffect:vl,useImperativeHandle:em,useInsertionEffect:hn,useLayoutEffect:ko,useMemo:tm,useReducer:uf,useRef:xl,useState:function(){return uf(ya)},useDebugValue:pf,useDeferredValue:function(x){var S=uf(ya),R=S[0],G=S[1];return vl(function(){var X=Zo.transition;Zo.transition={};try{G(x)}finally{Zo.transition=X}},[x]),R},useTransition:function(){var x=uf(ya)[0],S=oi().memoizedState;return[x,S]},useMutableSource:Yc,useSyncExternalStore:hf,useId:eu,unstable_isNewReconciler:!1},gf={readContext:Bs,useCallback:Qc,useContext:Bs,useEffect:vl,useImperativeHandle:em,useInsertionEffect:hn,useLayoutEffect:ko,useMemo:tm,useReducer:$c,useRef:xl,useState:function(){return $c(ya)},useDebugValue:pf,useDeferredValue:function(x){var S=$c(ya),R=S[0],G=S[1];return vl(function(){var X=Zo.transition;Zo.transition={};try{G(x)}finally{Zo.transition=X}},[x]),R},useTransition:function(){var x=$c(ya)[0],S=oi().memoizedState;return[x,S]},useMutableSource:Yc,useSyncExternalStore:hf,useId:eu,unstable_isNewReconciler:!1};function _f(x,S){try{var R="",G=S;do R+=Cs(G),G=G.return;while(G);var X=R}catch(te){X=`
Error generating stack: `+te.message+`
`+te.stack}return{value:x,source:S,stack:X}}function Ku(x,S){try{console.error(S.value)}catch(R){setTimeout(function(){throw R})}}var td=typeof WeakMap=="function"?WeakMap:Map;function im(x,S,R){R=Lo(-1,R),R.tag=3,R.payload={element:null};var G=S.value;return R.callback=function(){Ro||(Ro=!0,Zi=G),Ku(x,S)},R}function yf(x,S,R){R=Lo(-1,R),R.tag=3;var G=x.type.getDerivedStateFromError;if(typeof G=="function"){var X=S.value;R.payload=function(){return G(X)},R.callback=function(){Ku(x,S)}}var te=x.stateNode;return te!==null&&typeof te.componentDidCatch=="function"&&(R.callback=function(){Ku(x,S),typeof G!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var Ve=S.stack;this.componentDidCatch(S.value,{componentStack:Ve!==null?Ve:""})}),R}function xf(x,S,R){var G=x.pingCache;if(G===null){G=x.pingCache=new td;var X=new Set;G.set(S,X)}else X=G.get(S),X===void 0&&(X=new Set,G.set(S,X));X.has(R)||(X.add(R),x=Xg.bind(null,x,S,R),S.then(x,x))}function rm(x){do{var S;if((S=x.tag===13)&&(S=x.memoizedState,S=S!==null?S.dehydrated!==null:!0),S)return x;x=x.return}while(x!==null);return null}function nd(x,S,R,G,X){return x.mode&1?(x.flags|=65536,x.lanes=X,x):(x===S?x.flags|=65536:(x.flags|=128,R.flags|=131072,R.flags&=-52805,R.tag===1&&(R.alternate===null?R.tag=17:(S=Lo(-1,1),S.tag=2,Ra(R,S))),R.lanes|=1),x)}function _s(x){x.flags|=4}function vf(x,S){if(x!==null&&x.child===S.child)return!0;if(S.flags&16)return!1;for(x=S.child;x!==null;){if(x.flags&12854||x.subtreeFlags&12854)return!1;x=x.sibling}return!0}var Ju,Qu,id,iu;if(Rn)Ju=function(x,S){for(var R=S.child;R!==null;){if(R.tag===5||R.tag===6)Ne(x,R.stateNode);else if(R.tag!==4&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===S)break;for(;R.sibling===null;){if(R.return===null||R.return===S)return;R=R.return}R.sibling.return=R.return,R=R.sibling}},Qu=function(){},id=function(x,S,R,G,X){if(x=x.memoizedProps,x!==G){var te=S.stateNode,Ve=yo(qo.current);R=ze(te,R,x,G,X,Ve),(S.updateQueue=R)&&_s(S)}},iu=function(x,S,R,G){R!==G&&_s(S)};else if(At){Ju=function(x,S,R,G){for(var X=S.child;X!==null;){if(X.tag===5){var te=X.stateNode;R&&G&&(te=Gi(te,X.type,X.memoizedProps,X)),Ne(x,te)}else if(X.tag===6)te=X.stateNode,R&&G&&(te=es(te,X.memoizedProps,X)),Ne(x,te);else if(X.tag!==4){if(X.tag===22&&X.memoizedState!==null)te=X.child,te!==null&&(te.return=X),Ju(x,X,!0,!0);else if(X.child!==null){X.child.return=X,X=X.child;continue}}if(X===S)break;for(;X.sibling===null;){if(X.return===null||X.return===S)return;X=X.return}X.sibling.return=X.return,X=X.sibling}};var sm=function(x,S,R,G){for(var X=S.child;X!==null;){if(X.tag===5){var te=X.stateNode;R&&G&&(te=Gi(te,X.type,X.memoizedProps,X)),hr(x,te)}else if(X.tag===6)te=X.stateNode,R&&G&&(te=es(te,X.memoizedProps,X)),hr(x,te);else if(X.tag!==4){if(X.tag===22&&X.memoizedState!==null)te=X.child,te!==null&&(te.return=X),sm(x,X,!0,!0);else if(X.child!==null){X.child.return=X,X=X.child;continue}}if(X===S)break;for(;X.sibling===null;){if(X.return===null||X.return===S)return;X=X.return}X.sibling.return=X.return,X=X.sibling}};Qu=function(x,S){var R=S.stateNode;if(!vf(x,S)){x=R.containerInfo;var G=Ri(x);sm(G,S,!1,!1),R.pendingChildren=G,_s(S),Fr(x,G)}},id=function(x,S,R,G,X){var te=x.stateNode,Ve=x.memoizedProps;if((x=vf(x,S))&&Ve===G)S.stateNode=te;else{var st=S.stateNode,pt=yo(qo.current),ln=null;Ve!==G&&(ln=ze(st,R,Ve,G,X,pt)),x&&ln===null?S.stateNode=te:(te=Ln(te,ln,R,Ve,G,S,x,st),nt(te,R,G,X,pt)&&_s(S),S.stateNode=te,x?_s(S):Ju(te,S,!1,!1))}},iu=function(x,S,R,G){R!==G?(x=yo(Zc.current),R=yo(qo.current),S.stateNode=Et(G,x,R,S),_s(S)):S.stateNode=x.stateNode}}else Qu=function(){},id=function(){},iu=function(){};function eh(x,S){if(!Ar)switch(x.tailMode){case"hidden":S=x.tail;for(var R=null;S!==null;)S.alternate!==null&&(R=S),S=S.sibling;R===null?x.tail=null:R.sibling=null;break;case"collapsed":R=x.tail;for(var G=null;R!==null;)R.alternate!==null&&(G=R),R=R.sibling;G===null?S||x.tail===null?x.tail=null:x.tail.sibling=null:G.sibling=null}}function Wi(x){var S=x.alternate!==null&&x.alternate.child===x.child,R=0,G=0;if(S)for(var X=x.child;X!==null;)R|=X.lanes|X.childLanes,G|=X.subtreeFlags&14680064,G|=X.flags&14680064,X.return=x,X=X.sibling;else for(X=x.child;X!==null;)R|=X.lanes|X.childLanes,G|=X.subtreeFlags,G|=X.flags,X.return=x,X=X.sibling;return x.subtreeFlags|=G,x.childLanes=R,S}function l0(x,S,R){var G=S.pendingProps;switch(Hh(S),S.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wi(S),null;case 1:return Kn(S.type)&&uo(),Wi(S),null;case 3:return G=S.stateNode,Xc(),zi(qi),zi(Ur),Jp(),G.pendingContext&&(G.context=G.pendingContext,G.pendingContext=null),(x===null||x.child===null)&&(Hc(S)?_s(S):x===null||x.memoizedState.isDehydrated&&!(S.flags&256)||(S.flags|=1024,Ns!==null&&(ud(Ns),Ns=null))),Qu(x,S),Wi(S),null;case 5:gl(S),R=yo(Zc.current);var X=S.type;if(x!==null&&S.stateNode!=null)id(x,S,X,G,R),x.ref!==S.ref&&(S.flags|=512,S.flags|=2097152);else{if(!G){if(S.stateNode===null)throw Error(l(166));return Wi(S),null}if(x=yo(qo.current),Hc(S)){if(!Ot)throw Error(l(175));x=ht(S.stateNode,S.type,S.memoizedProps,R,x,S,!fl),S.updateQueue=x,x!==null&&_s(S)}else{var te=Qe(X,G,R,x,S);Ju(te,S,!1,!1),S.stateNode=te,nt(te,X,G,R,x)&&_s(S)}S.ref!==null&&(S.flags|=512,S.flags|=2097152)}return Wi(S),null;case 6:if(x&&S.stateNode!=null)iu(x,S,x.memoizedProps,G);else{if(typeof G!="string"&&S.stateNode===null)throw Error(l(166));if(x=yo(Zc.current),R=yo(qo.current),Hc(S)){if(!Ot)throw Error(l(176));if(x=S.stateNode,G=S.memoizedProps,(R=zt(x,G,S,!fl))&&(X=go,X!==null))switch(te=(X.mode&1)!==0,X.tag){case 3:Sn(X.stateNode.containerInfo,x,G,te);break;case 5:Jn(X.type,X.memoizedProps,X.stateNode,x,G,te)}R&&_s(S)}else S.stateNode=Et(G,x,R,S)}return Wi(S),null;case 13:if(zi(Cr),G=S.memoizedState,Ar&&_o!==null&&S.mode&1&&!(S.flags&128)){for(x=_o;x;)x=Ae(x);return pl(),S.flags|=98560,S}if(G!==null&&G.dehydrated!==null){if(G=Hc(S),x===null){if(!G)throw Error(l(318));if(!Ot)throw Error(l(344));if(x=S.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(l(317));vt(x,S)}else pl(),!(S.flags&128)&&(S.memoizedState=null),S.flags|=4;return Wi(S),null}return Ns!==null&&(ud(Ns),Ns=null),S.flags&128?(S.lanes=R,S):(G=G!==null,R=!1,x===null?Hc(S):R=x.memoizedState!==null,G&&!R&&(S.child.flags|=8192,S.mode&1&&(x===null||Cr.current&1?zn===0&&(zn=3):Zg())),S.updateQueue!==null&&(S.flags|=4),Wi(S),null);case 4:return Xc(),Qu(x,S),x===null&&Cn(S.stateNode.containerInfo),Wi(S),null;case 10:return Vc(S.type._context),Wi(S),null;case 17:return Kn(S.type)&&uo(),Wi(S),null;case 19:if(zi(Cr),X=S.memoizedState,X===null)return Wi(S),null;if(G=(S.flags&128)!==0,te=X.rendering,te===null)if(G)eh(X,!1);else{if(zn!==0||x!==null&&x.flags&128)for(x=S.child;x!==null;){if(te=Yh(x),te!==null){for(S.flags|=128,eh(X,!1),x=te.updateQueue,x!==null&&(S.updateQueue=x,S.flags|=4),S.subtreeFlags=0,x=R,G=S.child;G!==null;)R=G,X=x,R.flags&=14680066,te=R.alternate,te===null?(R.childLanes=0,R.lanes=X,R.child=null,R.subtreeFlags=0,R.memoizedProps=null,R.memoizedState=null,R.updateQueue=null,R.dependencies=null,R.stateNode=null):(R.childLanes=te.childLanes,R.lanes=te.lanes,R.child=te.child,R.subtreeFlags=0,R.deletions=null,R.memoizedProps=te.memoizedProps,R.memoizedState=te.memoizedState,R.updateQueue=te.updateQueue,R.type=te.type,X=te.dependencies,R.dependencies=X===null?null:{lanes:X.lanes,firstContext:X.firstContext}),G=G.sibling;return ci(Cr,Cr.current&1|2),S.child}x=x.sibling}X.tail!==null&&wi()>Js&&(S.flags|=128,G=!0,eh(X,!1),S.lanes=4194304)}else{if(!G)if(x=Yh(te),x!==null){if(S.flags|=128,G=!0,x=x.updateQueue,x!==null&&(S.updateQueue=x,S.flags|=4),eh(X,!0),X.tail===null&&X.tailMode==="hidden"&&!te.alternate&&!Ar)return Wi(S),null}else 2*wi()-X.renderingStartTime>Js&&R!==1073741824&&(S.flags|=128,G=!0,eh(X,!1),S.lanes=4194304);X.isBackwards?(te.sibling=S.child,S.child=te):(x=X.last,x!==null?x.sibling=te:S.child=te,X.last=te)}return X.tail!==null?(S=X.tail,X.rendering=S,X.tail=S.sibling,X.renderingStartTime=wi(),S.sibling=null,x=Cr.current,ci(Cr,G?x&1|2:x&1),S):(Wi(S),null);case 22:case 23:return qg(),G=S.memoizedState!==null,x!==null&&x.memoizedState!==null!==G&&(S.flags|=8192),G&&S.mode&1?cn&1073741824&&(Wi(S),Rn&&S.subtreeFlags&6&&(S.flags|=8192)):Wi(S),null;case 24:return null;case 25:return null}throw Error(l(156,S.tag))}var om=s.ReactCurrentOwner,Do=!1;function Ks(x,S,R,G){S.child=x===null?Bg(S,null,R,G):ml(S,x.child,R,G)}function Na(x,S,R,G,X){R=R.render;var te=S.ref;return Gc(S,X),G=_l(x,S,R,G,te,X),R=yl(),x!==null&&!Do?(S.updateQueue=x.updateQueue,S.flags&=-2053,x.lanes&=~X,va(x,S,X)):(Ar&&R&&Wh(S),S.flags|=1,Ks(x,S,G,X),S.child)}function am(x,S,R,G,X){if(x===null){var te=R.type;return typeof te=="function"&&!m0(te)&&te.defaultProps===void 0&&R.compare===null&&R.defaultProps===void 0?(S.tag=15,S.type=te,ru(x,S,te,G,X)):(x=Af(R.type,null,G,S,S.mode,X),x.ref=S.ref,x.return=S,S.child=x)}if(te=x.child,!(x.lanes&X)){var Ve=te.memoizedProps;if(R=R.compare,R=R!==null?R:Nc,R(Ve,G)&&x.ref===S.ref)return va(x,S,X)}return S.flags|=1,x=ah(te,G),x.ref=S.ref,x.return=S,S.child=x}function ru(x,S,R,G,X){if(x!==null&&Nc(x.memoizedProps,G)&&x.ref===S.ref)if(Do=!1,(x.lanes&X)!==0)x.flags&131072&&(Do=!0);else return S.lanes=x.lanes,va(x,S,X);return dn(x,S,R,G,X)}function xa(x,S,R){var G=S.pendingProps,X=G.children,te=x!==null?x.memoizedState:null;if(G.mode==="hidden")if(!(S.mode&1))S.memoizedState={baseLanes:0,cachePool:null},ci(Fn,cn),cn|=R;else if(R&1073741824)S.memoizedState={baseLanes:0,cachePool:null},G=te!==null?te.baseLanes:R,ci(Fn,cn),cn|=G;else return x=te!==null?te.baseLanes|R:R,S.lanes=S.childLanes=1073741824,S.memoizedState={baseLanes:x,cachePool:null},S.updateQueue=null,ci(Fn,cn),cn|=x,null;else te!==null?(G=te.baseLanes|R,S.memoizedState=null):G=R,ci(Fn,cn),cn|=G;return Ks(x,S,X,R),S.child}function rd(x,S){var R=S.ref;(x===null&&R!==null||x!==null&&x.ref!==R)&&(S.flags|=512,S.flags|=2097152)}function dn(x,S,R,G,X){var te=Kn(R)?Kt:Ur.current;return te=ni(S,te),Gc(S,X),R=_l(x,S,R,G,te,X),G=yl(),x!==null&&!Do?(S.updateQueue=x.updateQueue,S.flags&=-2053,x.lanes&=~X,va(x,S,X)):(Ar&&G&&Wh(S),S.flags|=1,Ks(x,S,R,X),S.child)}function lm(x,S,R,G,X){if(Kn(R)){var te=!0;Hl(S)}else te=!1;if(Gc(S,X),S.stateNode===null)x!==null&&(x.alternate=null,S.alternate=null,S.flags|=2),Uh(S,R,G),Hu(S,R,G,X),G=!0;else if(x===null){var Ve=S.stateNode,st=S.memoizedProps;Ve.props=st;var pt=Ve.context,ln=R.contextType;typeof ln=="object"&&ln!==null?ln=Bs(ln):(ln=Kn(R)?Kt:Ur.current,ln=ni(S,ln));var Dn=R.getDerivedStateFromProps,Qn=typeof Dn=="function"||typeof Ve.getSnapshotBeforeUpdate=="function";Qn||typeof Ve.UNSAFE_componentWillReceiveProps!="function"&&typeof Ve.componentWillReceiveProps!="function"||(st!==G||pt!==ln)&&Wu(S,Ve,G,ln),po=!1;var Gn=S.memoizedState;Ve.state=Gn,Kl(S,G,Ve,X),pt=S.memoizedState,st!==G||Gn!==pt||qi.current||po?(typeof Dn=="function"&&(Gu(S,R,Dn,G),pt=S.memoizedState),(st=po||Wc(S,R,st,G,Gn,pt,ln))?(Qn||typeof Ve.UNSAFE_componentWillMount!="function"&&typeof Ve.componentWillMount!="function"||(typeof Ve.componentWillMount=="function"&&Ve.componentWillMount(),typeof Ve.UNSAFE_componentWillMount=="function"&&Ve.UNSAFE_componentWillMount()),typeof Ve.componentDidMount=="function"&&(S.flags|=4194308)):(typeof Ve.componentDidMount=="function"&&(S.flags|=4194308),S.memoizedProps=G,S.memoizedState=pt),Ve.props=G,Ve.state=pt,Ve.context=ln,G=st):(typeof Ve.componentDidMount=="function"&&(S.flags|=4194308),G=!1)}else{Ve=S.stateNode,Zp(x,S),st=S.memoizedProps,ln=S.type===S.elementType?st:fo(S.type,st),Ve.props=ln,Qn=S.pendingProps,Gn=Ve.context,pt=R.contextType,typeof pt=="object"&&pt!==null?pt=Bs(pt):(pt=Kn(R)?Kt:Ur.current,pt=ni(S,pt));var Ii=R.getDerivedStateFromProps;(Dn=typeof Ii=="function"||typeof Ve.getSnapshotBeforeUpdate=="function")||typeof Ve.UNSAFE_componentWillReceiveProps!="function"&&typeof Ve.componentWillReceiveProps!="function"||(st!==Qn||Gn!==pt)&&Wu(S,Ve,G,pt),po=!1,Gn=S.memoizedState,Ve.state=Gn,Kl(S,G,Ve,X);var Pn=S.memoizedState;st!==Qn||Gn!==Pn||qi.current||po?(typeof Ii=="function"&&(Gu(S,R,Ii,G),Pn=S.memoizedState),(ln=po||Wc(S,R,ln,G,Gn,Pn,pt)||!1)?(Dn||typeof Ve.UNSAFE_componentWillUpdate!="function"&&typeof Ve.componentWillUpdate!="function"||(typeof Ve.componentWillUpdate=="function"&&Ve.componentWillUpdate(G,Pn,pt),typeof Ve.UNSAFE_componentWillUpdate=="function"&&Ve.UNSAFE_componentWillUpdate(G,Pn,pt)),typeof Ve.componentDidUpdate=="function"&&(S.flags|=4),typeof Ve.getSnapshotBeforeUpdate=="function"&&(S.flags|=1024)):(typeof Ve.componentDidUpdate!="function"||st===x.memoizedProps&&Gn===x.memoizedState||(S.flags|=4),typeof Ve.getSnapshotBeforeUpdate!="function"||st===x.memoizedProps&&Gn===x.memoizedState||(S.flags|=1024),S.memoizedProps=G,S.memoizedState=Pn),Ve.props=G,Ve.state=Pn,Ve.context=pt,G=ln):(typeof Ve.componentDidUpdate!="function"||st===x.memoizedProps&&Gn===x.memoizedState||(S.flags|=4),typeof Ve.getSnapshotBeforeUpdate!="function"||st===x.memoizedProps&&Gn===x.memoizedState||(S.flags|=1024),G=!1)}return wf(x,S,R,G,te,X)}function wf(x,S,R,G,X,te){rd(x,S);var Ve=(S.flags&128)!==0;if(!G&&!Ve)return X&&Rc(S,R,!1),va(x,S,te);G=S.stateNode,om.current=S;var st=Ve&&typeof R.getDerivedStateFromError!="function"?null:G.render();return S.flags|=1,x!==null&&Ve?(S.child=ml(S,x.child,null,te),S.child=ml(S,null,st,te)):Ks(x,S,st,te),S.memoizedState=G.state,X&&Rc(S,R,!0),S.child}function wl(x){var S=x.stateNode;S.pendingContext?Wl(x,S.pendingContext,S.pendingContext!==S.context):S.context&&Wl(x,S.context,!1),Yp(x,S.containerInfo)}function th(x,S,R,G,X){return pl(),lf(X),S.flags|=256,Ks(x,S,R,G),S.child}var nh={dehydrated:null,treeContext:null,retryLane:0};function sd(x){return{baseLanes:x,cachePool:null}}function bf(x,S,R){var G=S.pendingProps,X=Cr.current,te=!1,Ve=(S.flags&128)!==0,st;if((st=Ve)||(st=x!==null&&x.memoizedState===null?!1:(X&2)!==0),st?(te=!0,S.flags&=-129):(x===null||x.memoizedState!==null)&&(X|=1),ci(Cr,X&1),x===null)return jo(S),x=S.memoizedState,x!==null&&(x=x.dehydrated,x!==null)?(S.mode&1?ee(x)?S.lanes=8:S.lanes=1073741824:S.lanes=1,null):(X=G.children,x=G.fallback,te?(G=S.mode,te=S.child,X={mode:"hidden",children:X},!(G&1)&&te!==null?(te.childLanes=0,te.pendingProps=X):te=au(X,G,0,null),x=Sl(x,G,R,null),te.return=S,x.return=S,te.sibling=x,S.child=te,S.child.memoizedState=sd(R),S.memoizedState=nh,x):od(S,X));if(X=x.memoizedState,X!==null){if(st=X.dehydrated,st!==null){if(Ve)return S.flags&256?(S.flags&=-257,bl(x,S,R,Error(l(422)))):S.memoizedState!==null?(S.child=x.child,S.flags|=128,null):(te=G.fallback,X=S.mode,G=au({mode:"visible",children:G.children},X,0,null),te=Sl(te,X,R,null),te.flags|=2,G.return=S,te.return=S,G.sibling=te,S.child=G,S.mode&1&&ml(S,x.child,null,R),S.child.memoizedState=sd(R),S.memoizedState=nh,te);if(!(S.mode&1))S=bl(x,S,R,null);else if(ee(st))S=bl(x,S,R,Error(l(419)));else if(G=(R&x.childLanes)!==0,Do||G){if(G=at,G!==null){switch(R&-R){case 4:te=2;break;case 16:te=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:te=32;break;case 536870912:te=268435456;break;default:te=0}G=te&(G.suspendedLanes|R)?0:te,G!==0&&G!==X.retryLane&&(X.retryLane=G,Vr(x,G,-1))}Zg(),S=bl(x,S,R,Error(l(421)))}else Ie(st)?(S.flags|=128,S.child=x.child,S=p0.bind(null,x),pe(st,S),S=null):(R=X.treeContext,Ot&&(_o=Ke(st),go=S,Ar=!0,Ns=null,fl=!1,R!==null&&(mo[$s++]=Oa,mo[$s++]=dl,mo[$s++]=Jl,Oa=R.id,dl=R.overflow,Jl=S)),S=od(S,S.pendingProps.children),S.flags|=4096);return S}return te?(G=Mf(x,S,G.children,G.fallback,R),te=S.child,X=x.child.memoizedState,te.memoizedState=X===null?sd(R):{baseLanes:X.baseLanes|R,cachePool:null},te.childLanes=x.childLanes&~R,S.memoizedState=nh,G):(R=Sf(x,S,G.children,R),S.memoizedState=null,R)}return te?(G=Mf(x,S,G.children,G.fallback,R),te=S.child,X=x.child.memoizedState,te.memoizedState=X===null?sd(R):{baseLanes:X.baseLanes|R,cachePool:null},te.childLanes=x.childLanes&~R,S.memoizedState=nh,G):(R=Sf(x,S,G.children,R),S.memoizedState=null,R)}function od(x,S){return S=au({mode:"visible",children:S},x.mode,0,null),S.return=x,x.child=S}function Sf(x,S,R,G){var X=x.child;return x=X.sibling,R=ah(X,{mode:"visible",children:R}),!(S.mode&1)&&(R.lanes=G),R.return=S,R.sibling=null,x!==null&&(G=S.deletions,G===null?(S.deletions=[x],S.flags|=16):G.push(x)),S.child=R}function Mf(x,S,R,G,X){var te=S.mode;x=x.child;var Ve=x.sibling,st={mode:"hidden",children:R};return!(te&1)&&S.child!==x?(R=S.child,R.childLanes=0,R.pendingProps=st,S.deletions=null):(R=ah(x,st),R.subtreeFlags=x.subtreeFlags&14680064),Ve!==null?G=ah(Ve,G):(G=Sl(G,te,X,null),G.flags|=2),G.return=S,R.return=S,R.sibling=G,S.child=R,G}function bl(x,S,R,G){return G!==null&&lf(G),ml(S,x.child,null,R),x=od(S,S.pendingProps.children),x.flags|=2,S.memoizedState=null,x}function ih(x,S,R){x.lanes|=S;var G=x.alternate;G!==null&&(G.lanes|=S),Fh(x.return,S,R)}function rh(x,S,R,G,X){var te=x.memoizedState;te===null?x.memoizedState={isBackwards:S,rendering:null,renderingStartTime:0,last:G,tail:R,tailMode:X}:(te.isBackwards=S,te.rendering=null,te.renderingStartTime=0,te.last=G,te.tail=R,te.tailMode=X)}function cm(x,S,R){var G=S.pendingProps,X=G.revealOrder,te=G.tail;if(Ks(x,S,G.children,R),G=Cr.current,G&2)G=G&1|2,S.flags|=128;else{if(x!==null&&x.flags&128)e:for(x=S.child;x!==null;){if(x.tag===13)x.memoizedState!==null&&ih(x,R,S);else if(x.tag===19)ih(x,R,S);else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===S)break e;for(;x.sibling===null;){if(x.return===null||x.return===S)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}G&=1}if(ci(Cr,G),!(S.mode&1))S.memoizedState=null;else switch(X){case"forwards":for(R=S.child,X=null;R!==null;)x=R.alternate,x!==null&&Yh(x)===null&&(X=R),R=R.sibling;R=X,R===null?(X=S.child,S.child=null):(X=R.sibling,R.sibling=null),rh(S,!1,X,R,te);break;case"backwards":for(R=null,X=S.child,S.child=null;X!==null;){if(x=X.alternate,x!==null&&Yh(x)===null){S.child=X;break}x=X.sibling,X.sibling=R,R=X,X=x}rh(S,!0,R,null,te);break;case"together":rh(S,!1,null,null,void 0);break;default:S.memoizedState=null}return S.child}function va(x,S,R){if(x!==null&&(S.dependencies=x.dependencies),an|=S.lanes,!(R&S.childLanes))return null;if(x!==null&&S.child!==x.child)throw Error(l(153));if(S.child!==null){for(x=S.child,R=ah(x,x.pendingProps),S.child=R,R.return=S;x.sibling!==null;)x=x.sibling,R=R.sibling=ah(x,x.pendingProps),R.return=S;R.sibling=null}return S.child}function Vg(x,S,R){switch(S.tag){case 3:wl(S),pl();break;case 5:Kp(S);break;case 1:Kn(S.type)&&Hl(S);break;case 4:Yp(S,S.stateNode.containerInfo);break;case 10:Oh(S,S.type._context,S.memoizedProps.value);break;case 13:var G=S.memoizedState;if(G!==null)return G.dehydrated!==null?(ci(Cr,Cr.current&1),S.flags|=128,null):R&S.child.childLanes?bf(x,S,R):(ci(Cr,Cr.current&1),x=va(x,S,R),x!==null?x.sibling:null);ci(Cr,Cr.current&1);break;case 19:if(G=(R&S.childLanes)!==0,x.flags&128){if(G)return cm(x,S,R);S.flags|=128}var X=S.memoizedState;if(X!==null&&(X.rendering=null,X.tail=null,X.lastEffect=null),ci(Cr,Cr.current),G)break;return null;case 22:case 23:return S.lanes=0,xa(x,S,R)}return va(x,S,R)}function Gg(x,S){switch(Hh(S),S.tag){case 1:return Kn(S.type)&&uo(),x=S.flags,x&65536?(S.flags=x&-65537|128,S):null;case 3:return Xc(),zi(qi),zi(Ur),Jp(),x=S.flags,x&65536&&!(x&128)?(S.flags=x&-65537|128,S):null;case 5:return gl(S),null;case 13:if(zi(Cr),x=S.memoizedState,x!==null&&x.dehydrated!==null){if(S.alternate===null)throw Error(l(340));pl()}return x=S.flags,x&65536?(S.flags=x&-65537|128,S):null;case 19:return zi(Cr),null;case 4:return Xc(),null;case 10:return Vc(S.type._context),null;case 22:case 23:return qg(),null;case 24:return null;default:return null}}var ad=!1,nc=!1,Wg=typeof WeakSet=="function"?WeakSet:Set,xn=null;function ld(x,S){var R=x.ref;if(R!==null)if(typeof R=="function")try{R(null)}catch(G){Ko(x,S,G)}else R.current=null}function Tf(x,S,R){try{R()}catch(G){Ko(x,S,G)}}var Ef=!1;function cd(x,S){for(Te(x.containerInfo),xn=S;xn!==null;)if(x=xn,S=x.child,(x.subtreeFlags&1028)!==0&&S!==null)S.return=x,xn=S;else for(;xn!==null;){x=xn;try{var R=x.alternate;if(x.flags&1024)switch(x.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var G=R.memoizedProps,X=R.memoizedState,te=x.stateNode,Ve=te.getSnapshotBeforeUpdate(x.elementType===x.type?G:fo(x.type,G),X);te.__reactInternalSnapshotBeforeUpdate=Ve}break;case 3:Rn&&bn(x.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(l(163))}}catch(st){Ko(x,x.return,st)}if(S=x.sibling,S!==null){S.return=x.return,xn=S;break}xn=x.return}return R=Ef,Ef=!1,R}function y(x,S,R){var G=S.updateQueue;if(G=G!==null?G.lastEffect:null,G!==null){var X=G=G.next;do{if((X.tag&x)===x){var te=X.destroy;X.destroy=void 0,te!==void 0&&Tf(S,R,te)}X=X.next}while(X!==G)}}function h(x,S){if(S=S.updateQueue,S=S!==null?S.lastEffect:null,S!==null){var R=S=S.next;do{if((R.tag&x)===x){var G=R.create;R.destroy=G()}R=R.next}while(R!==S)}}function m(x){var S=x.ref;if(S!==null){var R=x.stateNode;switch(x.tag){case 5:x=Oe(R);break;default:x=R}typeof S=="function"?S(x):S.current=x}}function b(x,S,R){if(Wo&&typeof Wo.onCommitFiberUnmount=="function")try{Wo.onCommitFiberUnmount(ol,S)}catch{}switch(S.tag){case 0:case 11:case 14:case 15:if(x=S.updateQueue,x!==null&&(x=x.lastEffect,x!==null)){var G=x=x.next;do{var X=G,te=X.destroy;X=X.tag,te!==void 0&&(X&2||X&4)&&Tf(S,R,te),G=G.next}while(G!==x)}break;case 1:if(ld(S,R),x=S.stateNode,typeof x.componentWillUnmount=="function")try{x.props=S.memoizedProps,x.state=S.memoizedState,x.componentWillUnmount()}catch(Ve){Ko(S,R,Ve)}break;case 5:ld(S,R);break;case 4:Rn?oe(x,S,R):At&&At&&(S=S.stateNode.containerInfo,R=Ri(S),Pr(S,R))}}function E(x,S,R){for(var G=S;;)if(b(x,G,R),G.child===null||Rn&&G.tag===4){if(G===S)break;for(;G.sibling===null;){if(G.return===null||G.return===S)return;G=G.return}G.sibling.return=G.return,G=G.sibling}else G.child.return=G,G=G.child}function I(x){var S=x.alternate;S!==null&&(x.alternate=null,I(S)),x.child=null,x.deletions=null,x.sibling=null,x.tag===5&&(S=x.stateNode,S!==null&&Vn(S)),x.stateNode=null,x.return=null,x.dependencies=null,x.memoizedProps=null,x.memoizedState=null,x.pendingProps=null,x.stateNode=null,x.updateQueue=null}function B(x){return x.tag===5||x.tag===3||x.tag===4}function U(x){e:for(;;){for(;x.sibling===null;){if(x.return===null||B(x.return))return null;x=x.return}for(x.sibling.return=x.return,x=x.sibling;x.tag!==5&&x.tag!==6&&x.tag!==18;){if(x.flags&2||x.child===null||x.tag===4)continue e;x.child.return=x,x=x.child}if(!(x.flags&2))return x.stateNode}}function H(x){if(Rn){e:{for(var S=x.return;S!==null;){if(B(S))break e;S=S.return}throw Error(l(160))}var R=S;switch(R.tag){case 5:S=R.stateNode,R.flags&32&&(li(S),R.flags&=-33),R=U(x),Y(x,R,S);break;case 3:case 4:S=R.stateNode.containerInfo,R=U(x),K(x,R,S);break;default:throw Error(l(161))}}}function K(x,S,R){var G=x.tag;if(G===5||G===6)x=x.stateNode,S?Zt(R,x,S):yn(R,x);else if(G!==4&&(x=x.child,x!==null))for(K(x,S,R),x=x.sibling;x!==null;)K(x,S,R),x=x.sibling}function Y(x,S,R){var G=x.tag;if(G===5||G===6)x=x.stateNode,S?It(R,x,S):Nn(R,x);else if(G!==4&&(x=x.child,x!==null))for(Y(x,S,R),x=x.sibling;x!==null;)Y(x,S,R),x=x.sibling}function oe(x,S,R){for(var G=S,X=!1,te,Ve;;){if(!X){X=G.return;e:for(;;){if(X===null)throw Error(l(160));switch(te=X.stateNode,X.tag){case 5:Ve=!1;break e;case 3:te=te.containerInfo,Ve=!0;break e;case 4:te=te.containerInfo,Ve=!0;break e}X=X.return}X=!0}if(G.tag===5||G.tag===6)E(x,G,R),Ve?Yn(te,G.stateNode):sn(te,G.stateNode);else if(G.tag===18)Ve?Xn(te,G.stateNode):gn(te,G.stateNode);else if(G.tag===4){if(G.child!==null){te=G.stateNode.containerInfo,Ve=!0,G.child.return=G,G=G.child;continue}}else if(b(x,G,R),G.child!==null){G.child.return=G,G=G.child;continue}if(G===S)break;for(;G.sibling===null;){if(G.return===null||G.return===S)return;G=G.return,G.tag===4&&(X=!1)}G.sibling.return=G.return,G=G.sibling}}function me(x,S){if(Rn){switch(S.tag){case 0:case 11:case 14:case 15:y(3,S,S.return),h(3,S),y(5,S,S.return);return;case 1:return;case 5:var R=S.stateNode;if(R!=null){var G=S.memoizedProps;x=x!==null?x.memoizedProps:G;var X=S.type,te=S.updateQueue;S.updateQueue=null,te!==null&&Je(R,te,X,x,G,S)}return;case 6:if(S.stateNode===null)throw Error(l(162));R=S.memoizedProps,Dt(S.stateNode,x!==null?x.memoizedProps:R,R);return;case 3:Ot&&x!==null&&x.memoizedState.isDehydrated&&Yt(S.stateNode.containerInfo);return;case 12:return;case 13:be(S);return;case 19:be(S);return;case 17:return}throw Error(l(163))}switch(S.tag){case 0:case 11:case 14:case 15:y(3,S,S.return),h(3,S),y(5,S,S.return);return;case 12:return;case 13:be(S);return;case 19:be(S);return;case 3:Ot&&x!==null&&x.memoizedState.isDehydrated&&Yt(S.stateNode.containerInfo);break;case 22:case 23:return}e:if(At){switch(S.tag){case 1:case 5:case 6:break e;case 3:case 4:S=S.stateNode,Pr(S.containerInfo,S.pendingChildren);break e}throw Error(l(163))}}function be(x){var S=x.updateQueue;if(S!==null){x.updateQueue=null;var R=x.stateNode;R===null&&(R=x.stateNode=new Wg),S.forEach(function(G){var X=$g.bind(null,x,G);R.has(G)||(R.add(G),G.then(X,X))})}}function we(x,S){for(xn=S;xn!==null;){S=xn;var R=S.deletions;if(R!==null)for(var G=0;G<R.length;G++){var X=R[G];try{var te=x;Rn?oe(te,X,S):E(te,X,S);var Ve=X.alternate;Ve!==null&&(Ve.return=null),X.return=null}catch(Hn){Ko(X,S,Hn)}}if(R=S.child,S.subtreeFlags&12854&&R!==null)R.return=S,xn=R;else for(;xn!==null;){S=xn;try{var st=S.flags;if(st&32&&Rn&&li(S.stateNode),st&512){var pt=S.alternate;if(pt!==null){var ln=pt.ref;ln!==null&&(typeof ln=="function"?ln(null):ln.current=null)}}if(st&8192)switch(S.tag){case 13:if(S.memoizedState!==null){var Dn=S.alternate;(Dn===null||Dn.memoizedState===null)&&(Us=wi())}break;case 22:var Qn=S.memoizedState!==null,Gn=S.alternate,Ii=Gn!==null&&Gn.memoizedState!==null;if(R=S,Rn){e:if(G=R,X=Qn,te=null,Rn)for(var Pn=G;;){if(Pn.tag===5){if(te===null){te=Pn;var Hi=Pn.stateNode;X?Bi(Hi):Ct(Pn.stateNode,Pn.memoizedProps)}}else if(Pn.tag===6){if(te===null){var Sa=Pn.stateNode;X?rt(Sa):Vt(Sa,Pn.memoizedProps)}}else if((Pn.tag!==22&&Pn.tag!==23||Pn.memoizedState===null||Pn===G)&&Pn.child!==null){Pn.child.return=Pn,Pn=Pn.child;continue}if(Pn===G)break;for(;Pn.sibling===null;){if(Pn.return===null||Pn.return===G)break e;te===Pn&&(te=null),Pn=Pn.return}te===Pn&&(te=null),Pn.sibling.return=Pn.return,Pn=Pn.sibling}}if(Qn&&!Ii&&R.mode&1){xn=R;for(var _t=R.child;_t!==null;){for(R=xn=_t;xn!==null;){G=xn;var ct=G.child;switch(G.tag){case 0:case 11:case 14:case 15:y(4,G,G.return);break;case 1:ld(G,G.return);var Mt=G.stateNode;if(typeof Mt.componentWillUnmount=="function"){var Mn=G.return;try{Mt.props=G.memoizedProps,Mt.state=G.memoizedState,Mt.componentWillUnmount()}catch(Hn){Ko(G,Mn,Hn)}}break;case 5:ld(G,G.return);break;case 22:if(G.memoizedState!==null){Le(R);continue}}ct!==null?(ct.return=G,xn=ct):Le(R)}_t=_t.sibling}}}switch(st&4102){case 2:H(S),S.flags&=-3;break;case 6:H(S),S.flags&=-3,me(S.alternate,S);break;case 4096:S.flags&=-4097;break;case 4100:S.flags&=-4097,me(S.alternate,S);break;case 4:me(S.alternate,S)}}catch(Hn){Ko(S,S.return,Hn)}if(R=S.sibling,R!==null){R.return=S.return,xn=R;break}xn=S.return}}}function Me(x,S,R){xn=x,_e(x)}function _e(x,S,R){for(var G=(x.mode&1)!==0;xn!==null;){var X=xn,te=X.child;if(X.tag===22&&G){var Ve=X.memoizedState!==null||ad;if(!Ve){var st=X.alternate,pt=st!==null&&st.memoizedState!==null||nc;st=ad;var ln=nc;if(ad=Ve,(nc=pt)&&!ln)for(xn=X;xn!==null;)Ve=xn,pt=Ve.child,Ve.tag===22&&Ve.memoizedState!==null?Ce(X):pt!==null?(pt.return=Ve,xn=pt):Ce(X);for(;te!==null;)xn=te,_e(te),te=te.sibling;xn=X,ad=st,nc=ln}xe(x)}else X.subtreeFlags&8772&&te!==null?(te.return=X,xn=te):xe(x)}}function xe(x){for(;xn!==null;){var S=xn;if(S.flags&8772){var R=S.alternate;try{if(S.flags&8772)switch(S.tag){case 0:case 11:case 15:nc||h(5,S);break;case 1:var G=S.stateNode;if(S.flags&4&&!nc)if(R===null)G.componentDidMount();else{var X=S.elementType===S.type?R.memoizedProps:fo(S.type,R.memoizedProps);G.componentDidUpdate(X,R.memoizedState,G.__reactInternalSnapshotBeforeUpdate)}var te=S.updateQueue;te!==null&&Nh(S,te,G);break;case 3:var Ve=S.updateQueue;if(Ve!==null){if(R=null,S.child!==null)switch(S.child.tag){case 5:R=Oe(S.child.stateNode);break;case 1:R=S.child.stateNode}Nh(S,Ve,R)}break;case 5:var st=S.stateNode;R===null&&S.flags&4&&Un(st,S.type,S.memoizedProps,S);break;case 6:break;case 4:break;case 12:break;case 13:if(Ot&&S.memoizedState===null){var pt=S.alternate;if(pt!==null){var ln=pt.memoizedState;if(ln!==null){var Dn=ln.dehydrated;Dn!==null&&Xt(Dn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(l(163))}nc||S.flags&512&&m(S)}catch(Qn){Ko(S,S.return,Qn)}}if(S===x){xn=null;break}if(R=S.sibling,R!==null){R.return=S.return,xn=R;break}xn=S.return}}function Le(x){for(;xn!==null;){var S=xn;if(S===x){xn=null;break}var R=S.sibling;if(R!==null){R.return=S.return,xn=R;break}xn=S.return}}function Ce(x){for(;xn!==null;){var S=xn;try{switch(S.tag){case 0:case 11:case 15:var R=S.return;try{h(4,S)}catch(pt){Ko(S,R,pt)}break;case 1:var G=S.stateNode;if(typeof G.componentDidMount=="function"){var X=S.return;try{G.componentDidMount()}catch(pt){Ko(S,X,pt)}}var te=S.return;try{m(S)}catch(pt){Ko(S,te,pt)}break;case 5:var Ve=S.return;try{m(S)}catch(pt){Ko(S,Ve,pt)}}}catch(pt){Ko(S,S.return,pt)}if(S===x){xn=null;break}var st=S.sibling;if(st!==null){st.return=S.return,xn=st;break}xn=S.return}}var Ue=0,Xe=1,Ze=2,tt=3,ft=4;if(typeof Symbol=="function"&&Symbol.for){var lt=Symbol.for;Ue=lt("selector.component"),Xe=lt("selector.has_pseudo_class"),Ze=lt("selector.role"),tt=lt("selector.test_id"),ft=lt("selector.text")}function it(x){var S=Ft(x);if(S!=null){if(typeof S.memoizedProps["data-testname"]!="string")throw Error(l(364));return S}if(x=Ei(x),x===null)throw Error(l(362));return x.stateNode.current}function Wt(x,S){switch(S.$$typeof){case Ue:if(x.type===S.value)return!0;break;case Xe:e:{S=S.value,x=[x,0];for(var R=0;R<x.length;){var G=x[R++],X=x[R++],te=S[X];if(G.tag!==5||!St(G)){for(;te!=null&&Wt(G,te);)X++,te=S[X];if(X===S.length){S=!0;break e}else for(G=G.child;G!==null;)x.push(G,X),G=G.sibling}}S=!1}return S;case Ze:if(x.tag===5&&tn(x.stateNode,S.value))return!0;break;case ft:if((x.tag===5||x.tag===6)&&(x=Se(x),x!==null&&0<=x.indexOf(S.value)))return!0;break;case tt:if(x.tag===5&&(x=x.memoizedProps["data-testname"],typeof x=="string"&&x.toLowerCase()===S.value.toLowerCase()))return!0;break;default:throw Error(l(365))}return!1}function ot(x){switch(x.$$typeof){case Ue:return"<"+(re(x.value)||"Unknown")+">";case Xe:return":has("+(ot(x)||"")+")";case Ze:return'[role="'+x.value+'"]';case ft:return'"'+x.value+'"';case tt:return'[data-testname="'+x.value+'"]';default:throw Error(l(365))}}function bt(x,S){var R=[];x=[x,0];for(var G=0;G<x.length;){var X=x[G++],te=x[G++],Ve=S[te];if(X.tag!==5||!St(X)){for(;Ve!=null&&Wt(X,Ve);)te++,Ve=S[te];if(te===S.length)R.push(X);else for(X=X.child;X!==null;)x.push(X,te),X=X.sibling}}return R}function mt(x,S){if(!ai)throw Error(l(363));x=it(x),x=bt(x,S),S=[],x=Array.from(x);for(var R=0;R<x.length;){var G=x[R++];if(G.tag===5)St(G)||S.push(G.stateNode);else for(G=G.child;G!==null;)x.push(G),G=G.sibling}return S}var Ut=Math.ceil,gt=s.ReactCurrentDispatcher,Lt=s.ReactCurrentOwner,kt=s.ReactCurrentBatchConfig,Ye=0,at=null,Qt=null,mn=0,cn=0,Fn=Ni(0),zn=0,In=null,an=0,Li=0,bi=0,ki=null,si=null,Us=0,Js=1/0;function Xr(){Js=wi()+500}var Ro=!1,Zi=null,Si=null,xi=!1,rr=null,is=0,Oi=0,Ls=null,ic=-1,$o=0;function Xi(){return Ye&6?wi():ic!==-1?ic:ic=wi()}function rs(x){return x.mode&1?Ye&2&&mn!==0?mn&-mn:$l.transition!==null?($o===0&&(x=jl,jl<<=1,!(jl&4194240)&&(jl=64),$o=x),$o):(x=Ai,x!==0?x:pn()):1}function Vr(x,S,R){if(50<Oi)throw Oi=0,Ls=null,Error(l(185));var G=zo(x,S);return G===null?null:(Oc(G,S,R),(!(Ye&2)||G!==at)&&(G===at&&(!(Ye&2)&&(Li|=S),zn===4&&ou(G,mn)),ys(G,R),S===1&&Ye===0&&!(x.mode&1)&&(Xr(),Uu&&Xs())),G)}function zo(x,S){x.lanes|=S;var R=x.alternate;for(R!==null&&(R.lanes|=S),R=x,x=x.return;x!==null;)x.childLanes|=S,R=x.alternate,R!==null&&(R.childLanes|=S),R=x,x=x.return;return R.tag===3?R.stateNode:null}function ys(x,S){var R=x.callbackNode;Xl(x,S);var G=Zl(x,x===at?mn:0);if(G===0)R!==null&&Io(R),x.callbackNode=null,x.callbackPriority=0;else if(S=G&-G,x.callbackPriority!==S){if(R!=null&&Io(R),S===1)x.tag===0?Fg(jg.bind(null,x)):Rh(jg.bind(null,x)),On?Zn(function(){Ye===0&&Xs()}):ts(Fc,Xs),R=null;else{switch(rf(G)){case 1:R=Fc;break;case 4:R=qp;break;case 16:R=Bc;break;case 536870912:R=gs;break;default:R=Bc}R=hm(R,su.bind(null,x))}x.callbackPriority=S,x.callbackNode=R}}function su(x,S){if(ic=-1,$o=0,Ye&6)throw Error(l(327));var R=x.callbackNode;if(oh()&&x.callbackNode!==R)return null;var G=Zl(x,x===at?mn:0);if(G===0)return null;if(G&30||G&x.expiredLanes||S)S=um(x,G);else{S=G;var X=Ye;Ye|=2;var te=h0();(at!==x||mn!==S)&&(Xr(),sh(x,S));do try{V1();break}catch(st){u0(x,st)}while(1);of(),gt.current=te,Ye=X,Qt!==null?S=0:(at=null,mn=0,S=zn)}if(S!==0){if(S===2&&(X=zc(x),X!==0&&(G=X,S=Yo(x,X))),S===1)throw R=In,sh(x,0),ou(x,G),ys(x,wi()),R;if(S===6)ou(x,G);else{if(X=x.current.alternate,!(G&30)&&!Hg(X)&&(S=um(x,G),S===2&&(te=zc(x),te!==0&&(G=te,S=Yo(x,te))),S===1))throw R=In,sh(x,0),ou(x,G),ys(x,wi()),R;switch(x.finishedWork=X,x.finishedLanes=G,S){case 0:case 1:throw Error(l(345));case 2:Ua(x,si);break;case 3:if(ou(x,G),(G&130023424)===G&&(S=Us+500-wi(),10<S)){if(Zl(x,0)!==0)break;if(X=x.suspendedLanes,(X&G)!==G){Xi(),x.pingedLanes|=x.suspendedLanes&X;break}x.timeoutHandle=Nt(Ua.bind(null,x,si),S);break}Ua(x,si);break;case 4:if(ou(x,G),(G&4194240)===G)break;for(S=x.eventTimes,X=-1;0<G;){var Ve=31-ms(G);te=1<<Ve,Ve=S[Ve],Ve>X&&(X=Ve),G&=~te}if(G=X,G=wi()-G,G=(120>G?120:480>G?480:1080>G?1080:1920>G?1920:3e3>G?3e3:4320>G?4320:1960*Ut(G/1960))-G,10<G){x.timeoutHandle=Nt(Ua.bind(null,x,si),G);break}Ua(x,si);break;case 5:Ua(x,si);break;default:throw Error(l(329))}}}return ys(x,wi()),x.callbackNode===R?su.bind(null,x):null}function Yo(x,S){var R=ki;return x.current.memoizedState.isDehydrated&&(sh(x,S).flags|=256),x=um(x,S),x!==2&&(S=si,si=R,S!==null&&ud(S)),x}function ud(x){si===null?si=x:si.push.apply(si,x)}function Hg(x){for(var S=x;;){if(S.flags&16384){var R=S.updateQueue;if(R!==null&&(R=R.stores,R!==null))for(var G=0;G<R.length;G++){var X=R[G],te=X.getSnapshot;X=X.value;try{if(!Po(te(),X))return!1}catch{return!1}}}if(R=S.child,S.subtreeFlags&16384&&R!==null)R.return=S,S=R;else{if(S===x)break;for(;S.sibling===null;){if(S.return===null||S.return===x)return!0;S=S.return}S.sibling.return=S.return,S=S.sibling}}return!0}function ou(x,S){for(S&=~bi,S&=~Li,x.suspendedLanes|=S,x.pingedLanes&=~S,x=x.expirationTimes;0<S;){var R=31-ms(S),G=1<<R;x[R]=-1,S&=~G}}function jg(x){if(Ye&6)throw Error(l(327));oh();var S=Zl(x,0);if(!(S&1))return ys(x,wi()),null;var R=um(x,S);if(x.tag!==0&&R===2){var G=zc(x);G!==0&&(S=G,R=Yo(x,G))}if(R===1)throw R=In,sh(x,0),ou(x,S),ys(x,wi()),R;if(R===6)throw Error(l(345));return x.finishedWork=x.current.alternate,x.finishedLanes=S,Ua(x,si),ys(x,wi()),null}function c0(x){rr!==null&&rr.tag===0&&!(Ye&6)&&oh();var S=Ye;Ye|=1;var R=kt.transition,G=Ai;try{if(kt.transition=null,Ai=1,x)return x()}finally{Ai=G,kt.transition=R,Ye=S,!(Ye&6)&&Xs()}}function qg(){cn=Fn.current,zi(Fn)}function sh(x,S){x.finishedWork=null,x.finishedLanes=0;var R=x.timeoutHandle;if(R!==wn&&(x.timeoutHandle=wn,qt(R)),Qt!==null)for(R=Qt.return;R!==null;){var G=R;switch(Hh(G),G.tag){case 1:G=G.type.childContextTypes,G!=null&&uo();break;case 3:Xc(),zi(qi),zi(Ur),Jp();break;case 5:gl(G);break;case 4:Xc();break;case 13:zi(Cr);break;case 19:zi(Cr);break;case 10:Vc(G.type._context);break;case 22:case 23:qg()}R=R.return}if(at=x,Qt=x=ah(x.current,null),mn=cn=S,zn=0,In=null,bi=Li=an=0,si=ki=null,Ho!==null){for(S=0;S<Ho.length;S++)if(R=Ho[S],G=R.interleaved,G!==null){R.interleaved=null;var X=G.next,te=R.pending;if(te!==null){var Ve=te.next;te.next=X,G.next=Ve}R.pending=G}Ho=null}return x}function u0(x,S){do{var R=Qt;try{if(of(),cf.current=ed,qu){for(var G=Ir.memoizedState;G!==null;){var X=G.queue;X!==null&&(X.pending=null),G=G.next}qu=!1}if(Ql=0,ns=Is=Ir=null,ec=!1,xo=0,Lt.current=null,R===null||R.return===null){zn=1,In=S,Qt=null;break}e:{var te=x,Ve=R.return,st=R,pt=S;if(S=mn,st.flags|=32768,pt!==null&&typeof pt=="object"&&typeof pt.then=="function"){var ln=pt,Dn=st,Qn=Dn.tag;if(!(Dn.mode&1)&&(Qn===0||Qn===11||Qn===15)){var Gn=Dn.alternate;Gn?(Dn.updateQueue=Gn.updateQueue,Dn.memoizedState=Gn.memoizedState,Dn.lanes=Gn.lanes):(Dn.updateQueue=null,Dn.memoizedState=null)}var Ii=rm(Ve);if(Ii!==null){Ii.flags&=-257,nd(Ii,Ve,st,te,S),Ii.mode&1&&xf(te,ln,S),S=Ii,pt=ln;var Pn=S.updateQueue;if(Pn===null){var Hi=new Set;Hi.add(pt),S.updateQueue=Hi}else Pn.add(pt);break e}else{if(!(S&1)){xf(te,ln,S),Zg();break e}pt=Error(l(426))}}else if(Ar&&st.mode&1){var Sa=rm(Ve);if(Sa!==null){!(Sa.flags&65536)&&(Sa.flags|=256),nd(Sa,Ve,st,te,S),lf(pt);break e}}te=pt,zn!==4&&(zn=2),ki===null?ki=[te]:ki.push(te),pt=_f(pt,st),st=Ve;do{switch(st.tag){case 3:st.flags|=65536,S&=-S,st.lanes|=S;var _t=im(st,pt,S);Bh(st,_t);break e;case 1:te=pt;var ct=st.type,Mt=st.stateNode;if(!(st.flags&128)&&(typeof ct.getDerivedStateFromError=="function"||Mt!==null&&typeof Mt.componentDidCatch=="function"&&(Si===null||!Si.has(Mt)))){st.flags|=65536,S&=-S,st.lanes|=S;var Mn=yf(st,te,S);Bh(st,Mn);break e}}st=st.return}while(st!==null)}W1(R)}catch(Hn){S=Hn,Qt===R&&R!==null&&(Qt=R=R.return);continue}break}while(1)}function h0(){var x=gt.current;return gt.current=ed,x===null?ed:x}function Zg(){(zn===0||zn===3||zn===2)&&(zn=4),at===null||!(an&268435455)&&!(Li&268435455)||ou(at,mn)}function um(x,S){var R=Ye;Ye|=2;var G=h0();at===x&&mn===S||sh(x,S);do try{U1();break}catch(X){u0(x,X)}while(1);if(of(),Ye=R,gt.current=G,Qt!==null)throw Error(l(261));return at=null,mn=0,zn}function U1(){for(;Qt!==null;)G1(Qt)}function V1(){for(;Qt!==null&&!Og();)G1(Qt)}function G1(x){var S=rc(x.alternate,x,cn);x.memoizedProps=x.pendingProps,S===null?W1(x):Qt=S,Lt.current=null}function W1(x){var S=x;do{var R=S.alternate;if(x=S.return,S.flags&32768){if(R=Gg(R,S),R!==null){R.flags&=32767,Qt=R;return}if(x!==null)x.flags|=32768,x.subtreeFlags=0,x.deletions=null;else{zn=6,Qt=null;return}}else if(R=l0(R,S,cn),R!==null){Qt=R;return}if(S=S.sibling,S!==null){Qt=S;return}Qt=S=x}while(S!==null);zn===0&&(zn=5)}function Ua(x,S){var R=Ai,G=kt.transition;try{kt.transition=null,Ai=1,H1(x,S,R)}finally{kt.transition=G,Ai=R}return null}function H1(x,S,R){do oh();while(rr!==null);if(Ye&6)throw Error(l(327));var G=x.finishedWork,X=x.finishedLanes;if(G===null)return null;if(x.finishedWork=null,x.finishedLanes=0,G===x.current)throw Error(l(177));x.callbackNode=null,x.callbackPriority=0;var te=G.lanes|G.childLanes;if(ho(x,te),x===at&&(Qt=at=null,mn=0),!(G.subtreeFlags&2064)&&!(G.flags&2064)||xi||(xi=!0,hm(Bc,function(){return oh(),null})),te=(G.flags&15990)!==0,G.subtreeFlags&15990||te){te=kt.transition,kt.transition=null;var Ve=Ai;Ai=1;var st=Ye;Ye|=4,Lt.current=null,cd(x,G),we(x,G),Pe(x.containerInfo),x.current=G,Me(G),sf(),Ye=st,Ai=Ve,kt.transition=te}else x.current=G;if(xi&&(xi=!1,rr=x,is=X),te=x.pendingLanes,te===0&&(Si=null),al(G.stateNode),ys(x,wi()),S!==null)for(R=x.onRecoverableError,G=0;G<S.length;G++)R(S[G]);if(Ro)throw Ro=!1,x=Zi,Zi=null,x;return is&1&&x.tag!==0&&oh(),te=x.pendingLanes,te&1?x===Ls?Oi++:(Oi=0,Ls=x):Oi=0,Xs(),null}function oh(){if(rr!==null){var x=rf(is),S=kt.transition,R=Ai;try{if(kt.transition=null,Ai=16>x?16:x,rr===null)var G=!1;else{if(x=rr,rr=null,is=0,Ye&6)throw Error(l(331));var X=Ye;for(Ye|=4,xn=x.current;xn!==null;){var te=xn,Ve=te.child;if(xn.flags&16){var st=te.deletions;if(st!==null){for(var pt=0;pt<st.length;pt++){var ln=st[pt];for(xn=ln;xn!==null;){var Dn=xn;switch(Dn.tag){case 0:case 11:case 15:y(8,Dn,te)}var Qn=Dn.child;if(Qn!==null)Qn.return=Dn,xn=Qn;else for(;xn!==null;){Dn=xn;var Gn=Dn.sibling,Ii=Dn.return;if(I(Dn),Dn===ln){xn=null;break}if(Gn!==null){Gn.return=Ii,xn=Gn;break}xn=Ii}}}var Pn=te.alternate;if(Pn!==null){var Hi=Pn.child;if(Hi!==null){Pn.child=null;do{var Sa=Hi.sibling;Hi.sibling=null,Hi=Sa}while(Hi!==null)}}xn=te}}if(te.subtreeFlags&2064&&Ve!==null)Ve.return=te,xn=Ve;else e:for(;xn!==null;){if(te=xn,te.flags&2048)switch(te.tag){case 0:case 11:case 15:y(9,te,te.return)}var _t=te.sibling;if(_t!==null){_t.return=te.return,xn=_t;break e}xn=te.return}}var ct=x.current;for(xn=ct;xn!==null;){Ve=xn;var Mt=Ve.child;if(Ve.subtreeFlags&2064&&Mt!==null)Mt.return=Ve,xn=Mt;else e:for(Ve=ct;xn!==null;){if(st=xn,st.flags&2048)try{switch(st.tag){case 0:case 11:case 15:h(9,st)}}catch(Hn){Ko(st,st.return,Hn)}if(st===Ve){xn=null;break e}var Mn=st.sibling;if(Mn!==null){Mn.return=st.return,xn=Mn;break e}xn=st.return}}if(Ye=X,Xs(),Wo&&typeof Wo.onPostCommitFiberRoot=="function")try{Wo.onPostCommitFiberRoot(ol,x)}catch{}G=!0}return G}finally{Ai=R,kt.transition=S}}return!1}function d0(x,S,R){S=_f(R,S),S=im(x,S,1),Ra(x,S),S=Xi(),x=zo(x,1),x!==null&&(Oc(x,1,S),ys(x,S))}function Ko(x,S,R){if(x.tag===3)d0(x,x,R);else for(;S!==null;){if(S.tag===3){d0(S,x,R);break}else if(S.tag===1){var G=S.stateNode;if(typeof S.type.getDerivedStateFromError=="function"||typeof G.componentDidCatch=="function"&&(Si===null||!Si.has(G))){x=_f(R,x),x=yf(S,x,1),Ra(S,x),x=Xi(),S=zo(S,1),S!==null&&(Oc(S,1,x),ys(S,x));break}}S=S.return}}function Xg(x,S,R){var G=x.pingCache;G!==null&&G.delete(S),S=Xi(),x.pingedLanes|=x.suspendedLanes&R,at===x&&(mn&R)===R&&(zn===4||zn===3&&(mn&130023424)===mn&&500>wi()-Us?sh(x,0):bi|=R),ys(x,S)}function f0(x,S){S===0&&(x.mode&1?(S=ql,ql<<=1,!(ql&130023424)&&(ql=4194304)):S=1);var R=Xi();x=zo(x,S),x!==null&&(Oc(x,S,R),ys(x,R))}function p0(x){var S=x.memoizedState,R=0;S!==null&&(R=S.retryLane),f0(x,R)}function $g(x,S){var R=0;switch(x.tag){case 13:var G=x.stateNode,X=x.memoizedState;X!==null&&(R=X.retryLane);break;case 19:G=x.stateNode;break;default:throw Error(l(314))}G!==null&&G.delete(S),f0(x,R)}var rc;rc=function(x,S,R){if(x!==null)if(x.memoizedProps!==S.pendingProps||qi.current)Do=!0;else{if(!(x.lanes&R)&&!(S.flags&128))return Do=!1,Vg(x,S,R);Do=!!(x.flags&131072)}else Do=!1,Ar&&S.flags&1048576&&Gh(S,Vh,S.index);switch(S.lanes=0,S.tag){case 2:var G=S.type;x!==null&&(x.alternate=null,S.alternate=null,S.flags|=2),x=S.pendingProps;var X=ni(S,Ur.current);Gc(S,R),X=_l(null,S,G,x,X,R);var te=yl();return S.flags|=1,typeof X=="object"&&X!==null&&typeof X.render=="function"&&X.$$typeof===void 0?(S.tag=1,S.memoizedState=null,S.updateQueue=null,Kn(G)?(te=!0,Hl(S)):te=!1,S.memoizedState=X.state!==null&&X.state!==void 0?X.state:null,Ci(S),X.updater=za,S.stateNode=X,X._reactInternals=S,Hu(S,G,x,R),S=wf(null,S,G,!0,te,R)):(S.tag=0,Ar&&te&&Wh(S),Ks(null,S,X,R),S=S.child),S;case 16:G=S.elementType;e:{switch(x!==null&&(x.alternate=null,S.alternate=null,S.flags|=2),x=S.pendingProps,X=G._init,G=X(G._payload),S.type=G,X=S.tag=_T(G),x=fo(G,x),X){case 0:S=dn(null,S,G,x,R);break e;case 1:S=lm(null,S,G,x,R);break e;case 11:S=Na(null,S,G,x,R);break e;case 14:S=am(null,S,G,fo(G.type,x),R);break e}throw Error(l(306,G,""))}return S;case 0:return G=S.type,X=S.pendingProps,X=S.elementType===G?X:fo(G,X),dn(x,S,G,X,R);case 1:return G=S.type,X=S.pendingProps,X=S.elementType===G?X:fo(G,X),lm(x,S,G,X,R);case 3:e:{if(wl(S),x===null)throw Error(l(387));G=S.pendingProps,te=S.memoizedState,X=te.element,Zp(x,S),Kl(S,G,null,R);var Ve=S.memoizedState;if(G=Ve.element,Ot&&te.isDehydrated)if(te={element:G,isDehydrated:!1,cache:Ve.cache,transitions:Ve.transitions},S.updateQueue.baseState=te,S.memoizedState=te,S.flags&256){X=Error(l(423)),S=th(x,S,G,R,X);break e}else if(G!==X){X=Error(l(424)),S=th(x,S,G,R,X);break e}else for(Ot&&(_o=ve(S.stateNode.containerInfo),go=S,Ar=!0,Ns=null,fl=!1),R=Bg(S,null,G,R),S.child=R;R;)R.flags=R.flags&-3|4096,R=R.sibling;else{if(pl(),G===X){S=va(x,S,R);break e}Ks(x,S,G,R)}S=S.child}return S;case 5:return Kp(S),x===null&&jo(S),G=S.type,X=S.pendingProps,te=x!==null?x.memoizedProps:null,Ve=X.children,et(G,X)?Ve=null:te!==null&&et(G,te)&&(S.flags|=32),rd(x,S),Ks(x,S,Ve,R),S.child;case 6:return x===null&&jo(S),null;case 13:return bf(x,S,R);case 4:return Yp(S,S.stateNode.containerInfo),G=S.pendingProps,x===null?S.child=ml(S,null,G,R):Ks(x,S,G,R),S.child;case 11:return G=S.type,X=S.pendingProps,X=S.elementType===G?X:fo(G,X),Na(x,S,G,X,R);case 7:return Ks(x,S,S.pendingProps,R),S.child;case 8:return Ks(x,S,S.pendingProps.children,R),S.child;case 12:return Ks(x,S,S.pendingProps.children,R),S.child;case 10:e:{if(G=S.type._context,X=S.pendingProps,te=S.memoizedProps,Ve=X.value,Oh(S,G,Ve),te!==null)if(Po(te.value,Ve)){if(te.children===X.children&&!qi.current){S=va(x,S,R);break e}}else for(te=S.child,te!==null&&(te.return=S);te!==null;){var st=te.dependencies;if(st!==null){Ve=te.child;for(var pt=st.firstContext;pt!==null;){if(pt.context===G){if(te.tag===1){pt=Lo(-1,R&-R),pt.tag=2;var ln=te.updateQueue;if(ln!==null){ln=ln.shared;var Dn=ln.pending;Dn===null?pt.next=pt:(pt.next=Dn.next,Dn.next=pt),ln.pending=pt}}te.lanes|=R,pt=te.alternate,pt!==null&&(pt.lanes|=R),Fh(te.return,R,S),st.lanes|=R;break}pt=pt.next}}else if(te.tag===10)Ve=te.type===S.type?null:te.child;else if(te.tag===18){if(Ve=te.return,Ve===null)throw Error(l(341));Ve.lanes|=R,st=Ve.alternate,st!==null&&(st.lanes|=R),Fh(Ve,R,S),Ve=te.sibling}else Ve=te.child;if(Ve!==null)Ve.return=te;else for(Ve=te;Ve!==null;){if(Ve===S){Ve=null;break}if(te=Ve.sibling,te!==null){te.return=Ve.return,Ve=te;break}Ve=Ve.return}te=Ve}Ks(x,S,X.children,R),S=S.child}return S;case 9:return X=S.type,G=S.pendingProps.children,Gc(S,R),X=Bs(X),G=G(X),S.flags|=1,Ks(x,S,G,R),S.child;case 14:return G=S.type,X=fo(G,S.pendingProps),X=fo(G.type,X),am(x,S,G,X,R);case 15:return ru(x,S,S.type,S.pendingProps,R);case 17:return G=S.type,X=S.pendingProps,X=S.elementType===G?X:fo(G,X),x!==null&&(x.alternate=null,S.alternate=null,S.flags|=2),S.tag=1,Kn(G)?(x=!0,Hl(S)):x=!1,Gc(S,R),Uh(S,G,X),Hu(S,G,X,R),wf(null,S,G,!0,x,R);case 19:return cm(x,S,R);case 22:return xa(x,S,R)}throw Error(l(156,S.tag))};function hm(x,S){return ts(x,S)}function j1(x,S,R,G){this.tag=x,this.key=R,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=S,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=G,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wa(x,S,R,G){return new j1(x,S,R,G)}function m0(x){return x=x.prototype,!(!x||!x.isReactComponent)}function _T(x){if(typeof x=="function")return m0(x)?1:0;if(x!=null){if(x=x.$$typeof,x===L)return 11;if(x===F)return 14}return 2}function ah(x,S){var R=x.alternate;return R===null?(R=wa(x.tag,S,x.key,x.mode),R.elementType=x.elementType,R.type=x.type,R.stateNode=x.stateNode,R.alternate=x,x.alternate=R):(R.pendingProps=S,R.type=x.type,R.flags=0,R.subtreeFlags=0,R.deletions=null),R.flags=x.flags&14680064,R.childLanes=x.childLanes,R.lanes=x.lanes,R.child=x.child,R.memoizedProps=x.memoizedProps,R.memoizedState=x.memoizedState,R.updateQueue=x.updateQueue,S=x.dependencies,R.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext},R.sibling=x.sibling,R.index=x.index,R.ref=x.ref,R}function Af(x,S,R,G,X,te){var Ve=2;if(G=x,typeof x=="function")m0(x)&&(Ve=1);else if(typeof x=="string")Ve=5;else e:switch(x){case _:return Sl(R.children,X,te,S);case w:Ve=8,X|=8;break;case M:return x=wa(12,R,S,X|2),x.elementType=M,x.lanes=te,x;case D:return x=wa(13,R,S,X),x.elementType=D,x.lanes=te,x;case z:return x=wa(19,R,S,X),x.elementType=z,x.lanes=te,x;case V:return au(R,X,te,S);default:if(typeof x=="object"&&x!==null)switch(x.$$typeof){case A:Ve=10;break e;case P:Ve=9;break e;case L:Ve=11;break e;case F:Ve=14;break e;case N:Ve=16,G=null;break e}throw Error(l(130,x==null?x:typeof x,""))}return S=wa(Ve,R,S,X),S.elementType=x,S.type=G,S.lanes=te,S}function Sl(x,S,R,G){return x=wa(7,x,G,S),x.lanes=R,x}function au(x,S,R,G){return x=wa(22,x,G,S),x.elementType=V,x.lanes=R,x.stateNode={},x}function Ml(x,S,R){return x=wa(6,x,null,S),x.lanes=R,x}function ba(x,S,R){return S=wa(4,x.children!==null?x.children:[],x.key,S),S.lanes=R,S.stateNode={containerInfo:x.containerInfo,pendingChildren:null,implementation:x.implementation},S}function lh(x,S,R,G,X){this.tag=S,this.containerInfo=x,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=wn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nu(0),this.expirationTimes=Nu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nu(0),this.identifierPrefix=G,this.onRecoverableError=X,Ot&&(this.mutableSourceEagerHydrationData=null)}function lu(x,S,R,G,X,te,Ve,st,pt){return x=new lh(x,S,R,st,pt),S===1?(S=1,te===!0&&(S|=8)):S=0,te=wa(3,null,null,S),x.current=te,te.stateNode=x,te.memoizedState={element:G,isDehydrated:R,cache:null,transitions:null},Ci(te),x}function ch(x){if(!x)return wr;x=x._reactInternals;e:{if(ne(x)!==x||x.tag!==1)throw Error(l(170));var S=x;do{switch(S.tag){case 3:S=S.stateNode.context;break e;case 1:if(Kn(S.type)){S=S.stateNode.__reactInternalMemoizedMergedChildContext;break e}}S=S.return}while(S!==null);throw Error(l(171))}if(x.tag===1){var R=x.type;if(Kn(R))return ri(x,R,S)}return S}function q1(x){var S=x._reactInternals;if(S===void 0)throw typeof x.render=="function"?Error(l(188)):(x=Object.keys(x).join(","),Error(l(268,x)));return x=He(S),x===null?null:x.stateNode}function Z1(x,S){if(x=x.memoizedState,x!==null&&x.dehydrated!==null){var R=x.retryLane;x.retryLane=R!==0&&R<S?R:S}}function g0(x,S){Z1(x,S),(x=x.alternate)&&Z1(x,S)}function yT(x){return x=He(x),x===null?null:x.stateNode}function X1(){return null}return t.attemptContinuousHydration=function(x){if(x.tag===13){var S=Xi();Vr(x,134217728,S),g0(x,134217728)}},t.attemptHydrationAtCurrentPriority=function(x){if(x.tag===13){var S=Xi(),R=rs(x);Vr(x,R,S),g0(x,R)}},t.attemptSynchronousHydration=function(x){switch(x.tag){case 3:var S=x.stateNode;if(S.current.memoizedState.isDehydrated){var R=sl(S.pendingLanes);R!==0&&(Sr(S,R|1),ys(S,wi()),!(Ye&6)&&(Xr(),Xs()))}break;case 13:var G=Xi();c0(function(){return Vr(x,1,G)}),g0(x,1)}},t.batchedUpdates=function(x,S){var R=Ye;Ye|=1;try{return x(S)}finally{Ye=R,Ye===0&&(Xr(),Uu&&Xs())}},t.createComponentSelector=function(x){return{$$typeof:Ue,value:x}},t.createContainer=function(x,S,R,G,X,te,Ve){return lu(x,S,!1,null,R,G,X,te,Ve)},t.createHasPseudoClassSelector=function(x){return{$$typeof:Xe,value:x}},t.createHydrationContainer=function(x,S,R,G,X,te,Ve,st,pt){return x=lu(R,G,!0,x,X,te,Ve,st,pt),x.context=ch(null),R=x.current,G=Xi(),X=rs(R),te=Lo(G,X),te.callback=S??null,Ra(R,te),x.current.lanes=X,Oc(x,X,G),ys(x,G),x},t.createPortal=function(x,S,R){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:G==null?null:""+G,children:x,containerInfo:S,implementation:R}},t.createRoleSelector=function(x){return{$$typeof:Ze,value:x}},t.createTestNameSelector=function(x){return{$$typeof:tt,value:x}},t.createTextSelector=function(x){return{$$typeof:ft,value:x}},t.deferredUpdates=function(x){var S=Ai,R=kt.transition;try{return kt.transition=null,Ai=16,x()}finally{Ai=S,kt.transition=R}},t.discreteUpdates=function(x,S,R,G,X){var te=Ai,Ve=kt.transition;try{return kt.transition=null,Ai=1,x(S,R,G,X)}finally{Ai=te,kt.transition=Ve,Ye===0&&Xr()}},t.findAllNodes=mt,t.findBoundingRects=function(x,S){if(!ai)throw Error(l(363));S=mt(x,S),x=[];for(var R=0;R<S.length;R++)x.push(Be(S[R]));for(S=x.length-1;0<S;S--){R=x[S];for(var G=R.x,X=G+R.width,te=R.y,Ve=te+R.height,st=S-1;0<=st;st--)if(S!==st){var pt=x[st],ln=pt.x,Dn=ln+pt.width,Qn=pt.y,Gn=Qn+pt.height;if(G>=ln&&te>=Qn&&X<=Dn&&Ve<=Gn){x.splice(S,1);break}else if(G!==ln||R.width!==pt.width||Gn<te||Qn>Ve){if(!(te!==Qn||R.height!==pt.height||Dn<G||ln>X)){ln>G&&(pt.width+=ln-G,pt.x=G),Dn<X&&(pt.width=X-ln),x.splice(S,1);break}}else{Qn>te&&(pt.height+=Qn-te,pt.y=te),Gn<Ve&&(pt.height=Ve-Qn),x.splice(S,1);break}}}return x},t.findHostInstance=q1,t.findHostInstanceWithNoPortals=function(x){return x=De(x),x=x!==null?le(x):null,x===null?null:x.stateNode},t.findHostInstanceWithWarning=function(x){return q1(x)},t.flushControlled=function(x){var S=Ye;Ye|=1;var R=kt.transition,G=Ai;try{kt.transition=null,Ai=1,x()}finally{Ai=G,kt.transition=R,Ye=S,Ye===0&&(Xr(),Xs())}},t.flushPassiveEffects=oh,t.flushSync=c0,t.focusWithin=function(x,S){if(!ai)throw Error(l(363));for(x=it(x),S=bt(x,S),S=Array.from(S),x=0;x<S.length;){var R=S[x++];if(!St(R)){if(R.tag===5&&nn(R.stateNode))return!0;for(R=R.child;R!==null;)S.push(R),R=R.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ai},t.getFindAllNodesFailureDescription=function(x,S){if(!ai)throw Error(l(363));var R=0,G=[];x=[it(x),0];for(var X=0;X<x.length;){var te=x[X++],Ve=x[X++],st=S[Ve];if((te.tag!==5||!St(te))&&(Wt(te,st)&&(G.push(ot(st)),Ve++,Ve>R&&(R=Ve)),Ve<S.length))for(te=te.child;te!==null;)x.push(te,Ve),te=te.sibling}if(R<S.length){for(x=[];R<S.length;R++)x.push(ot(S[R]));return`findAllNodes was able to match part of the selector:
  `+(G.join(" > ")+`

No matching component was found for:
  `)+x.join(" > ")}return null},t.getPublicRootInstance=function(x){if(x=x.current,!x.child)return null;switch(x.child.tag){case 5:return Oe(x.child.stateNode);default:return x.child.stateNode}},t.injectIntoDevTools=function(x){if(x={bundleType:x.bundleType,version:x.version,rendererPackageName:x.rendererPackageName,rendererConfig:x.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:s.ReactCurrentDispatcher,findHostInstanceByFiber:yT,findFiberByHostInstance:x.findFiberByHostInstance||X1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")x=!1;else{var S=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(S.isDisabled||!S.supportsFiber)x=!0;else{try{ol=S.inject(x),Wo=S}catch{}x=!!S.checkDCE}}return x},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(x,S,R,G){if(!ai)throw Error(l(363));x=mt(x,S);var X=fn(x,R,G).disconnect;return{disconnect:function(){X()}}},t.registerMutableSourceForHydration=function(x,S){var R=S._getVersion;R=R(S._source),x.mutableSourceEagerHydrationData==null?x.mutableSourceEagerHydrationData=[S,R]:x.mutableSourceEagerHydrationData.push(S,R)},t.runWithPriority=function(x,S){var R=Ai;try{return Ai=x,S()}finally{Ai=R}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(x,S,R,G){var X=S.current,te=Xi(),Ve=rs(X);return R=ch(R),S.context===null?S.context=R:S.pendingContext=R,S=Lo(te,Ve),S.payload={element:x},G=G===void 0?null:G,G!==null&&(S.callback=G),Ra(X,S),x=Vr(X,Ve,te),x!==null&&ul(x,X,Ve),Ve},t};(function(n){n.exports=oae})(nae);const aae=fB(TI);var wM={},lae={get exports(){return wM},set exports(n){wM=n}},wG={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(ce,Te){var Pe=ce.length;ce.push(Te);e:for(;0<Pe;){var Qe=Pe-1>>>1,Ne=ce[Qe];if(0<r(Ne,Te))ce[Qe]=Te,ce[Pe]=Ne,Pe=Qe;else break e}}function t(ce){return ce.length===0?null:ce[0]}function i(ce){if(ce.length===0)return null;var Te=ce[0],Pe=ce.pop();if(Pe!==Te){ce[0]=Pe;e:for(var Qe=0,Ne=ce.length,nt=Ne>>>1;Qe<nt;){var ze=2*(Qe+1)-1,et=ce[ze],Et=ze+1,Nt=ce[Et];if(0>r(et,Pe))Et<Ne&&0>r(Nt,et)?(ce[Qe]=Nt,ce[Et]=Pe,Qe=Et):(ce[Qe]=et,ce[ze]=Pe,Qe=ze);else if(Et<Ne&&0>r(Nt,Pe))ce[Qe]=Nt,ce[Et]=Pe,Qe=Et;else break e}}return Te}function r(ce,Te){var Pe=ce.sortIndex-Te.sortIndex;return Pe!==0?Pe:ce.id-Te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,s=l.now();n.unstable_now=function(){return l.now()-s}}var d=[],p=[],_=1,w=null,M=3,A=!1,P=!1,L=!1,D=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ce){for(var Te=t(p);Te!==null;){if(Te.callback===null)i(p);else if(Te.startTime<=ce)i(p),Te.sortIndex=Te.expirationTime,e(d,Te);else break;Te=t(p)}}function V(ce){if(L=!1,N(ce),!P)if(t(d)!==null)P=!0,Oe(j);else{var Te=t(p);Te!==null&&We(V,Te.startTime-ce)}}function j(ce,Te){P=!1,L&&(L=!1,z(Z),Z=-1),A=!0;var Pe=M;try{for(N(Te),w=t(d);w!==null&&(!(w.expirationTime>Te)||ce&&!De());){var Qe=w.callback;if(typeof Qe=="function"){w.callback=null,M=w.priorityLevel;var Ne=Qe(w.expirationTime<=Te);Te=n.unstable_now(),typeof Ne=="function"?w.callback=Ne:w===t(d)&&i(d),N(Te)}else i(d);w=t(d)}if(w!==null)var nt=!0;else{var ze=t(p);ze!==null&&We(V,ze.startTime-Te),nt=!1}return nt}finally{w=null,M=Pe,A=!1}}var Q=!1,re=null,Z=-1,ne=5,he=-1;function De(){return!(n.unstable_now()-he<ne)}function He(){if(re!==null){var ce=n.unstable_now();he=ce;var Te=!0;try{Te=re(!0,ce)}finally{Te?ae():(Q=!1,re=null)}}else Q=!1}var ae;if(typeof F=="function")ae=function(){F(He)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,fe=le.port2;le.port1.onmessage=He,ae=function(){fe.postMessage(null)}}else ae=function(){D(He,0)};function Oe(ce){re=ce,Q||(Q=!0,ae())}function We(ce,Te){Z=D(function(){ce(n.unstable_now())},Te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){P||A||(P=!0,Oe(j))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return M},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ce){switch(M){case 1:case 2:case 3:var Te=3;break;default:Te=M}var Pe=M;M=Te;try{return ce()}finally{M=Pe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Te){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Pe=M;M=ce;try{return Te()}finally{M=Pe}},n.unstable_scheduleCallback=function(ce,Te,Pe){var Qe=n.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?Qe+Pe:Qe):Pe=Qe,ce){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=Pe+Ne,ce={id:_++,callback:Te,priorityLevel:ce,startTime:Pe,expirationTime:Ne,sortIndex:-1},Pe>Qe?(ce.sortIndex=Pe,e(p,ce),t(d)===null&&ce===t(p)&&(L?(z(Z),Z=-1):L=!0,We(V,Pe-Qe))):(ce.sortIndex=Ne,e(d,ce),P||A||(P=!0,Oe(j))),ce},n.unstable_shouldYield=De,n.unstable_wrapCallback=function(ce){var Te=M;return function(){var Pe=M;M=Te;try{return ce.apply(this,arguments)}finally{M=Pe}}}})(wG);(function(n){n.exports=wG})(lae);function bG(n,e,t=(i,r)=>i===r){if(n===e)return!0;if(!n||!e)return!1;const i=n.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!t(n[r],e[r]))return!1;return!0}const Dd=[];function SG(n,e,t=!1,i={}){for(const o of Dd)if(bG(e,o.keys,o.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(o,"error"))throw o.error;if(Object.prototype.hasOwnProperty.call(o,"response"))return o.response;if(!t)throw o.promise}const r={keys:e,equal:i.equal,promise:n(...e).then(o=>r.response=o).then(()=>{i.lifespan&&i.lifespan>0&&setTimeout(()=>{const o=Dd.indexOf(r);o!==-1&&Dd.splice(o,1)},i.lifespan)}).catch(o=>r.error=o)};if(Dd.push(r),!t)throw r.promise}const cae=(n,e,t)=>SG(n,e,!1,t),uae=(n,e,t)=>void SG(n,e,!0,t),hae=n=>{if(n===void 0||n.length===0)Dd.splice(0,Dd.length);else{const e=Dd.find(t=>bG(n,t.keys,t.equal));if(e){const t=Dd.indexOf(e);t!==-1&&Dd.splice(t,1)}}},nk={},dae=n=>void Object.assign(nk,n);function fae(n,e){function t(_,{args:w=[],attach:M,...A},P){let L=`${_[0].toUpperCase()}${_.slice(1)}`,D;if(_==="primitive"){if(A.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const z=A.object;D=B_(z,{type:_,root:P,attach:M,primitive:!0})}else{const z=nk[L];if(!z)throw new Error(`R3F: ${L} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(w))throw new Error("R3F: The args prop must be an array!");D=B_(new z(...w),{type:_,root:P,attach:M,memoizedProps:{args:w}})}return D.__r3f.attach===void 0&&(D instanceof Ti?D.__r3f.attach="geometry":D instanceof Zs&&(D.__r3f.attach="material")),L!=="inject"&&Q2(D,A),D}function i(_,w){let M=!1;if(w){var A,P;(A=w.__r3f)!=null&&A.attach?J2(_,w,w.__r3f.attach):w.isObject3D&&_.isObject3D&&(_.add(w),M=!0),M||(P=_.__r3f)==null||P.objects.push(w),w.__r3f||B_(w,{}),w.__r3f.parent=_,AI(w),N_(w)}}function r(_,w,M){let A=!1;if(w){var P,L;if((P=w.__r3f)!=null&&P.attach)J2(_,w,w.__r3f.attach);else if(w.isObject3D&&_.isObject3D){w.parent=_,w.dispatchEvent({type:"added"});const D=_.children.filter(F=>F!==w),z=D.indexOf(M);_.children=[...D.slice(0,z),w,...D.slice(z)],A=!0}A||(L=_.__r3f)==null||L.objects.push(w),w.__r3f||B_(w,{}),w.__r3f.parent=_,AI(w),N_(w)}}function o(_,w,M=!1){_&&[..._].forEach(A=>l(w,A,M))}function l(_,w,M){if(w){var A,P,L;if(w.__r3f&&(w.__r3f.parent=null),(A=_.__r3f)!=null&&A.objects&&(_.__r3f.objects=_.__r3f.objects.filter(V=>V!==w)),(P=w.__r3f)!=null&&P.attach)KF(_,w,w.__r3f.attach);else if(w.isObject3D&&_.isObject3D){var D;_.remove(w),(D=w.__r3f)!=null&&D.root&&wae(w.__r3f.root,w)}const F=(L=w.__r3f)==null?void 0:L.primitive,N=M===void 0?w.dispose!==null&&!F:M;if(!F){var z;o((z=w.__r3f)==null?void 0:z.objects,w,N),o(w.children,w,N)}w.__r3f&&(delete w.__r3f.root,delete w.__r3f.objects,delete w.__r3f.handlers,delete w.__r3f.memoizedProps,F||delete w.__r3f),N&&w.dispose&&w.type!=="Scene"&&wM.unstable_scheduleCallback(wM.unstable_IdlePriority,()=>{try{w.dispose()}catch{}}),N_(_)}}function s(_,w,M,A){var P;const L=(P=_.__r3f)==null?void 0:P.parent;if(!L)return;const D=t(w,M,_.__r3f.root);if(_.children){for(const z of _.children)z.__r3f&&i(D,z);_.children=_.children.filter(z=>!z.__r3f)}_.__r3f.objects.forEach(z=>i(D,z)),_.__r3f.objects=[],_.__r3f.autoRemovedBeforeAppend||l(L,_),D.parent&&(D.__r3f.autoRemovedBeforeAppend=!0),i(L,D),D.raycast&&D.__r3f.eventCount&&D.__r3f.root.getState().internal.interaction.push(D),[A,A.alternate].forEach(z=>{z!==null&&(z.stateNode=D,z.ref&&(typeof z.ref=="function"?z.ref(D):z.ref.current=D))})}const d=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:aae({createInstance:t,removeChild:l,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(_,w)=>{if(!w)return;const M=_.getState().scene;M.__r3f&&(M.__r3f.root=_,i(M,w))},removeChildFromContainer:(_,w)=>{w&&l(_.getState().scene,w)},insertInContainerBefore:(_,w,M)=>{if(!w||!M)return;const A=_.getState().scene;A.__r3f&&r(A,w,M)},getRootHostContext:()=>null,getChildHostContext:_=>_,finalizeInitialChildren(_){var w;const M=(w=_==null?void 0:_.__r3f)!=null?w:{};return Boolean(M.handlers)},prepareUpdate(_,w,M,A){if(_.__r3f.primitive&&A.object&&A.object!==_)return[!0];{const{args:P=[],children:L,...D}=A,{args:z=[],children:F,...N}=M;if(!Array.isArray(P))throw new Error("R3F: the args prop must be an array!");if(P.some((j,Q)=>j!==z[Q]))return[!0];const V=PG(_,D,N,!0);return V.changes.length?[!1,V]:null}},commitUpdate(_,[w,M],A,P,L,D){w?s(_,A,L,D):Q2(_,M)},commitMount(_,w,M,A){var P;const L=(P=_.__r3f)!=null?P:{};_.raycast&&L.handlers&&L.eventCount&&_.__r3f.root.getState().internal.interaction.push(_)},getPublicInstance:_=>_,prepareForCommit:()=>null,preparePortalMount:_=>B_(_.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(_){var w;const{attach:M,parent:A}=(w=_.__r3f)!=null?w:{};M&&A&&KF(A,_,M),_.isObject3D&&(_.visible=!1),N_(_)},unhideInstance(_,w){var M;const{attach:A,parent:P}=(M=_.__r3f)!=null?M:{};A&&P&&J2(P,_,A),(_.isObject3D&&w.visible==null||w.visible)&&(_.visible=!0),N_(_)},createTextInstance:d,hideTextInstance:d,unhideTextInstance:d,getCurrentEventPriority:()=>e?e():hp.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Hr.fun(performance.now)?performance.now:Hr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Hr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Hr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Q2}}var ZF,XF;const MG=()=>{var n;return(n=nk.ColorManagement)!=null?n:null},TG=n=>n&&n.isOrthographicCamera,pae=n=>n&&n.hasOwnProperty("current"),N1=typeof window<"u"&&((ZF=window.document)!=null&&ZF.createElement||((XF=window.navigator)==null?void 0:XF.product)==="ReactNative")?$t.useLayoutEffect:$t.useEffect;function EG(n){const e=$t.useRef(n);return N1(()=>void(e.current=n),[n]),e}function mae({set:n}){return N1(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class AG extends $t.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}AG.getDerivedStateFromError=()=>({error:!0});const CG="__default",$F=new Map,gae=n=>n&&!!n.memoized&&!!n.changes;function IG(n){const e=typeof window<"u"?window.devicePixelRatio:1;return Array.isArray(n)?Math.min(Math.max(n[0],e),n[1]):n}const Ex=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},Hr={obj:n=>n===Object(n)&&!Hr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(Hr.str(n)||Hr.num(n))return n===e;const o=Hr.obj(n);if(o&&i==="reference")return n===e;const l=Hr.arr(n);if(l&&t==="reference")return n===e;if((l||o)&&n===e)return!0;let s;for(s in n)if(!(s in e))return!1;if(o&&t==="shallow"&&i==="shallow"){for(s in r?e:n)if(!Hr.equ(n[s],e[s],{strict:r,objects:"reference"}))return!1}else for(s in r?e:n)if(n[s]!==e[s])return!1;if(Hr.und(s)){if(l&&n.length===0&&e.length===0||o&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function _ae(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function yae(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function B_(n,e){const t=n;return(e!=null&&e.primitive||!t.__r3f)&&(t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),n}function EI(n,e){let t=n;if(e.includes("-")){const i=e.split("-"),r=i.pop();return t=i.reduce((o,l)=>o[l],n),{target:t,key:r}}else return{target:t,key:e}}const YF=/-\d+$/;function J2(n,e,t){if(Hr.str(t)){if(YF.test(t)){const o=t.replace(YF,""),{target:l,key:s}=EI(n,o);Array.isArray(l[s])||(l[s]=[])}const{target:i,key:r}=EI(n,t);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=t(n,e)}function KF(n,e,t){var i,r;if(Hr.str(t)){const{target:o,key:l}=EI(n,t),s=e.__r3f.previousAttach;s===void 0?delete o[l]:o[l]=s}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(n,e);(r=e.__r3f)==null||delete r.previousAttach}function PG(n,{children:e,key:t,ref:i,...r},{children:o,key:l,ref:s,...d}={},p=!1){var _;const w=(_=n==null?void 0:n.__r3f)!=null?_:{},M=Object.entries(r),A=[];if(p){const L=Object.keys(d);for(let D=0;D<L.length;D++)r.hasOwnProperty(L[D])||M.unshift([L[D],CG+"remove"])}M.forEach(([L,D])=>{var z;if((z=n.__r3f)!=null&&z.primitive&&L==="object"||Hr.equ(D,d[L]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(L))return A.push([L,D,!0,[]]);let F=[];L.includes("-")&&(F=L.split("-")),A.push([L,D,!1,F]);for(const N in r){const V=r[N];N.startsWith(`${L}-`)&&A.push([N,V,!1,N.split("-")])}});const P={...r};return w.memoizedProps&&w.memoizedProps.args&&(P.args=w.memoizedProps.args),w.memoizedProps&&w.memoizedProps.attach&&(P.attach=w.memoizedProps.attach),{memoized:P,changes:A}}function Q2(n,e){var t,i,r;const o=(t=n.__r3f)!=null?t:{},l=o.root,s=(i=l==null||l.getState==null?void 0:l.getState())!=null?i:{},{memoized:d,changes:p}=gae(e)?e:PG(n,e),_=o.eventCount;n.__r3f&&(n.__r3f.memoizedProps=d);for(let M=0;M<p.length;M++){let[A,P,L,D]=p[M],z=n,F=z[A];if(D.length&&(F=D.reduce((N,V)=>N[V],n),!(F&&F.set))){const[N,...V]=D.reverse();z=V.reverse().reduce((j,Q)=>j[Q],n),A=N}if(P===CG+"remove")if(z.constructor){let N=$F.get(z.constructor);N||(N=new z.constructor,$F.set(z.constructor,N)),P=N[A]}else P=0;if(L)P?o.handlers[A]=P:delete o.handlers[A],o.eventCount=Object.keys(o.handlers).length;else if(F&&F.set&&(F.copy||F instanceof dg)){if(Array.isArray(P))F.fromArray?F.fromArray(P):F.set(...P);else if(F.copy&&P&&P.constructor&&F.constructor===P.constructor)F.copy(P);else if(P!==void 0){const N=F instanceof An;!N&&F.setScalar?F.setScalar(P):F instanceof dg&&P instanceof dg?F.mask=P.mask:F.set(P),!MG()&&!s.linear&&N&&F.convertSRGBToLinear()}}else z[A]=P,!s.linear&&z[A]instanceof Jr&&z[A].format===$a&&z[A].type===Kd&&(z[A].encoding=ar);N_(n)}if(o.parent&&s.internal&&n.raycast&&_!==o.eventCount){const M=s.internal.interaction.indexOf(n);M>-1&&s.internal.interaction.splice(M,1),o.eventCount&&s.internal.interaction.push(n)}return!(p.length===1&&p[0][0]==="onUpdate")&&p.length&&(r=n.__r3f)!=null&&r.parent&&AI(n),n}function N_(n){var e,t;const i=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();i&&i.internal.frames===0&&i.invalidate()}function AI(n){n.onUpdate==null||n.onUpdate(n)}function xae(n,e){n.manual||(TG(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function $b(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function vae(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return hp.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return hp.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return hp.ContinuousEventPriority;default:return hp.DefaultEventPriority}}function LG(n,e,t,i){const r=t.get(e);r&&(t.delete(e),t.size===0&&(n.delete(i),r.target.releasePointerCapture(i)))}function wae(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{LG(t.capturedMap,e,i,r)})}function bae(n){function e(d){const{internal:p}=n.getState(),_=d.offsetX-p.initialClick[0],w=d.offsetY-p.initialClick[1];return Math.round(Math.sqrt(_*_+w*w))}function t(d){return d.filter(p=>["Move","Over","Enter","Out","Leave"].some(_=>{var w;return(w=p.__r3f)==null?void 0:w.handlers["onPointer"+_]}))}function i(d,p){const _=n.getState(),w=new Set,M=[],A=p?p(_.internal.interaction):_.internal.interaction;for(let z=0;z<A.length;z++){const F=Ex(A[z]);F&&(F.raycaster.camera=void 0)}_.previousRoot||_.events.compute==null||_.events.compute(d,_);function P(z){const F=Ex(z);if(!F||!F.events.enabled||F.raycaster.camera===null)return[];if(F.raycaster.camera===void 0){var N;F.events.compute==null||F.events.compute(d,F,(N=F.previousRoot)==null?void 0:N.getState()),F.raycaster.camera===void 0&&(F.raycaster.camera=null)}return F.raycaster.camera?F.raycaster.intersectObject(z,!0):[]}let L=A.flatMap(P).sort((z,F)=>{const N=Ex(z.object),V=Ex(F.object);return!N||!V?z.distance-F.distance:V.events.priority-N.events.priority||z.distance-F.distance}).filter(z=>{const F=$b(z);return w.has(F)?!1:(w.add(F),!0)});_.events.filter&&(L=_.events.filter(L,_));for(const z of L){let F=z.object;for(;F;){var D;(D=F.__r3f)!=null&&D.eventCount&&M.push({...z,eventObject:F}),F=F.parent}}if("pointerId"in d&&_.internal.capturedMap.has(d.pointerId))for(let z of _.internal.capturedMap.get(d.pointerId).values())w.has($b(z.intersection))||M.push(z.intersection);return M}function r(d,p,_,w){const M=n.getState();if(d.length){const A={stopped:!1};for(const P of d){const L=Ex(P.object)||M,{raycaster:D,pointer:z,camera:F,internal:N}=L,V=new Fe(z.x,z.y,0).unproject(F),j=he=>{var De,He;return(De=(He=N.capturedMap.get(he))==null?void 0:He.has(P.eventObject))!=null?De:!1},Q=he=>{const De={intersection:P,target:p.target};N.capturedMap.has(he)?N.capturedMap.get(he).set(P.eventObject,De):N.capturedMap.set(he,new Map([[P.eventObject,De]])),p.target.setPointerCapture(he)},re=he=>{const De=N.capturedMap.get(he);De&&LG(N.capturedMap,P.eventObject,De,he)};let Z={};for(let he in p){let De=p[he];typeof De!="function"&&(Z[he]=De)}let ne={...P,...Z,pointer:z,intersections:d,stopped:A.stopped,delta:_,unprojectedPoint:V,ray:D.ray,camera:F,stopPropagation(){const he="pointerId"in p&&N.capturedMap.get(p.pointerId);if((!he||he.has(P.eventObject))&&(ne.stopped=A.stopped=!0,N.hovered.size&&Array.from(N.hovered.values()).find(De=>De.eventObject===P.eventObject))){const De=d.slice(0,d.indexOf(P));o([...De,P])}},target:{hasPointerCapture:j,setPointerCapture:Q,releasePointerCapture:re},currentTarget:{hasPointerCapture:j,setPointerCapture:Q,releasePointerCapture:re},nativeEvent:p};if(w(ne),A.stopped===!0)break}}return d}function o(d){const{internal:p}=n.getState();for(const _ of p.hovered.values())if(!d.length||!d.find(w=>w.object===_.object&&w.index===_.index&&w.instanceId===_.instanceId)){const M=_.eventObject.__r3f,A=M==null?void 0:M.handlers;if(p.hovered.delete($b(_)),M!=null&&M.eventCount){const P={..._,intersections:d};A.onPointerOut==null||A.onPointerOut(P),A.onPointerLeave==null||A.onPointerLeave(P)}}}function l(d,p){for(let _=0;_<p.length;_++){const w=p[_].__r3f;w==null||w.handlers.onPointerMissed==null||w.handlers.onPointerMissed(d)}}function s(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return p=>{const{internal:_}=n.getState();"pointerId"in p&&_.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{_.capturedMap.has(p.pointerId)&&(_.capturedMap.delete(p.pointerId),o([]))})}}return function(_){const{onPointerMissed:w,internal:M}=n.getState();M.lastEvent.current=_;const A=d==="onPointerMove",P=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",D=i(_,A?t:void 0),z=P?e(_):0;d==="onPointerDown"&&(M.initialClick=[_.offsetX,_.offsetY],M.initialHits=D.map(N=>N.eventObject)),P&&!D.length&&z<=2&&(l(_,M.interaction),w&&w(_)),A&&o(D);function F(N){const V=N.eventObject,j=V.__r3f,Q=j==null?void 0:j.handlers;if(j!=null&&j.eventCount)if(A){if(Q.onPointerOver||Q.onPointerEnter||Q.onPointerOut||Q.onPointerLeave){const re=$b(N),Z=M.hovered.get(re);Z?Z.stopped&&N.stopPropagation():(M.hovered.set(re,N),Q.onPointerOver==null||Q.onPointerOver(N),Q.onPointerEnter==null||Q.onPointerEnter(N))}Q.onPointerMove==null||Q.onPointerMove(N)}else{const re=Q[d];re?(!P||M.initialHits.includes(V))&&(l(_,M.interaction.filter(Z=>!M.initialHits.includes(Z))),re(N)):P&&M.initialHits.includes(V)&&l(_,M.interaction.filter(Z=>!M.initialHits.includes(Z)))}}r(D,_,z,F)}}return{handlePointer:s}}const kG=n=>!!(n!=null&&n.render),DG=$t.createContext(null),Sae=(n,e)=>{const t=tae((s,d)=>{const p=new Fe,_=new Fe,w=new Fe;function M(z=d().camera,F=_,N=d().size){const{width:V,height:j,top:Q,left:re}=N,Z=V/j;F instanceof Fe?w.copy(F):w.set(...F);const ne=z.getWorldPosition(p).distanceTo(w);if(TG(z))return{width:V/z.zoom,height:j/z.zoom,top:Q,left:re,factor:1,distance:ne,aspect:Z};{const he=z.fov*Math.PI/180,De=2*Math.tan(he/2)*ne,He=De*(V/j);return{width:He,height:De,top:Q,left:re,factor:V/He,distance:ne,aspect:Z}}}let A;const P=z=>s(F=>({performance:{...F.performance,current:z}})),L=new Gt;return{set:s,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(z=1)=>n(d(),z),advance:(z,F)=>e(z,F,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new JL,pointer:L,mouse:L,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const z=d();A&&clearTimeout(A),z.performance.current!==z.performance.min&&P(z.performance.min),A=setTimeout(()=>P(d().performance.max),z.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:M},setEvents:z=>s(F=>({...F,events:{...F.events,...z}})),setSize:(z,F,N,V,j)=>{const Q=d().camera,re={width:z,height:F,top:V||0,left:j||0,updateStyle:N};s(Z=>({size:re,viewport:{...Z.viewport,...M(Q,_,re)}}))},setDpr:z=>s(F=>{const N=IG(z);return{viewport:{...F.viewport,dpr:N,initialDpr:F.viewport.initialDpr||N}}}),setFrameloop:(z="always")=>{const F=d().clock;F.stop(),F.elapsedTime=0,z!=="never"&&(F.start(),F.elapsedTime=0),s(()=>({frameloop:z}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:$t.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(z,F,N)=>{const V=d().internal;return V.priority=V.priority+(F>0?1:0),V.subscribers.push({ref:z,priority:F,store:N}),V.subscribers=V.subscribers.sort((j,Q)=>j.priority-Q.priority),()=>{const j=d().internal;j!=null&&j.subscribers&&(j.priority=j.priority-(F>0?1:0),j.subscribers=j.subscribers.filter(Q=>Q.ref!==z))}}}}}),i=t.getState();let r=i.size,o=i.viewport.dpr,l=i.camera;return t.subscribe(()=>{const{camera:s,size:d,viewport:p,gl:_,set:w}=t.getState();if(d!==r||p.dpr!==o){var M;r=d,o=p.dpr,xae(s,d),_.setPixelRatio(p.dpr);const A=(M=d.updateStyle)!=null?M:typeof HTMLCanvasElement<"u"&&_.domElement instanceof HTMLCanvasElement;_.setSize(d.width,d.height,A)}s!==l&&(l=s,w(A=>({viewport:{...A.viewport,...A.viewport.getCurrentViewport(s)}})))}),t.subscribe(s=>n(s)),t};let Yb,Mae=new Set,Tae=new Set,Eae=new Set;function eA(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function Ax(n,e){switch(n){case"before":return eA(Mae,e);case"after":return eA(Tae,e);case"tail":return eA(Eae,e)}}let tA,nA;function iA(n,e,t){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),tA=e.internal.subscribers,Yb=0;Yb<tA.length;Yb++)nA=tA[Yb],nA.ref.current(nA.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function Aae(n){let e=!1,t,i,r;function o(d){i=requestAnimationFrame(o),e=!0,t=0,Ax("before",d);for(const _ of n.values()){var p;r=_.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((p=r.gl.xr)!=null&&p.isPresenting)&&(t+=iA(d,r))}if(Ax("after",d),t===0)return Ax("tail",d),e=!1,cancelAnimationFrame(i)}function l(d,p=1){var _;if(!d)return n.forEach(w=>l(w.store.getState()),p);(_=d.gl.xr)!=null&&_.isPresenting||!d.internal.active||d.frameloop==="never"||(d.internal.frames=Math.min(60,d.internal.frames+p),e||(e=!0,requestAnimationFrame(o)))}function s(d,p=!0,_,w){if(p&&Ax("before",d),_)iA(d,_,w);else for(const M of n.values())iA(d,M.store.getState());p&&Ax("after",d)}return{loop:o,invalidate:l,advance:s}}function RG(){const n=$t.useContext(DG);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Hf(n=t=>t,e){return RG()(n,e)}function zG(n,e=0){const t=RG(),i=t.getState().internal.subscribe,r=EG(n);return N1(()=>i(r,e,t),[e,i,t]),null}function OG(n,e){return function(t,...i){const r=new t;return n&&n(r),Promise.all(i.map(o=>new Promise((l,s)=>r.load(o,d=>{d.scene&&Object.assign(d,_ae(d.scene)),l(d)},e,d=>s(new Error(`Could not load ${o}: ${d.message})`))))))}}function ik(n,e,t,i){const r=Array.isArray(e)?e:[e],o=cae(OG(t,i),[n,...r],{equal:Hr.equ});return Array.isArray(e)?o:o[0]}ik.preload=function(n,e,t){const i=Array.isArray(e)?e:[e];return uae(OG(t),[n,...i])};ik.clear=function(n,e){const t=Array.isArray(e)?e:[e];return hae([n,...t])};const qy=new Map,{invalidate:JF,advance:QF}=Aae(qy),{reconciler:bM,applyProps:Cx}=fae(qy,vae),F_={objects:"shallow",strict:!1},Cae=(n,e)=>{const t=typeof n=="function"?n(e):n;return kG(t)?t:new aT({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function Iae(n,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:i,top:r,left:o}=n.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:o}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function Pae(n){const e=qy.get(n),t=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,o=i||Sae(JF,QF),l=t||bM.createContainer(o,hp.ConcurrentRoot,null,!1,null,"",r,null);e||qy.set(n,{fiber:l,store:o});let s,d=!1,p;return{configure(_={}){let{gl:w,size:M,scene:A,events:P,onCreated:L,shadows:D=!1,linear:z=!1,flat:F=!1,legacy:N=!1,orthographic:V=!1,frameloop:j="always",dpr:Q=[1,2],performance:re,raycaster:Z,camera:ne,onPointerMissed:he}=_,De=o.getState(),He=De.gl;De.gl||De.set({gl:He=Cae(w,n)});let ae=De.raycaster;ae||De.set({raycaster:ae=new xG});const{params:le,...fe}=Z||{};if(Hr.equ(fe,ae,F_)||Cx(ae,{...fe}),Hr.equ(le,ae.params,F_)||Cx(ae,{params:{...ae.params,...le}}),!De.camera||De.camera===p&&!Hr.equ(p,ne,F_)){p=ne;const Qe=ne instanceof b1,Ne=Qe?ne:V?new Wd(0,0,0,0,.1,1e3):new qr(75,0,.1,1e3);Qe||(Ne.position.z=5,ne&&Cx(Ne,ne),!De.camera&&!(ne!=null&&ne.rotation)&&Ne.lookAt(0,0,0)),De.set({camera:Ne})}if(!De.scene){let Qe;A instanceof xM?Qe=A:(Qe=new xM,A&&Cx(Qe,A)),De.set({scene:B_(Qe)})}if(!De.xr){const Qe=(ze,et)=>{const Et=o.getState();Et.frameloop!=="never"&&QF(ze,!0,Et,et)},Ne=()=>{const ze=o.getState();ze.gl.xr.enabled=ze.gl.xr.isPresenting,ze.gl.xr.setAnimationLoop(ze.gl.xr.isPresenting?Qe:null),ze.gl.xr.isPresenting||JF(ze)},nt={connect(){const ze=o.getState().gl;ze.xr.addEventListener("sessionstart",Ne),ze.xr.addEventListener("sessionend",Ne)},disconnect(){const ze=o.getState().gl;ze.xr.removeEventListener("sessionstart",Ne),ze.xr.removeEventListener("sessionend",Ne)}};He.xr&&nt.connect(),De.set({xr:nt})}if(He.shadowMap){const Qe=He.shadowMap.enabled,Ne=He.shadowMap.type;if(He.shadowMap.enabled=!!D,Hr.boo(D))He.shadowMap.type=av;else if(Hr.str(D)){var Oe;const nt={basic:M6,percentage:eT,soft:av,variance:Ym};He.shadowMap.type=(Oe=nt[D])!=null?Oe:av}else Hr.obj(D)&&Object.assign(He.shadowMap,D);(Qe!==He.shadowMap.enabled||Ne!==He.shadowMap.type)&&(He.shadowMap.needsUpdate=!0)}const We=MG();We&&("enabled"in We?We.enabled=!N:"legacyMode"in We&&(We.legacyMode=N));const ce=z?Jd:ar,Te=F?Pu:_L;He.outputEncoding!==ce&&(He.outputEncoding=ce),He.toneMapping!==Te&&(He.toneMapping=Te),De.legacy!==N&&De.set(()=>({legacy:N})),De.linear!==z&&De.set(()=>({linear:z})),De.flat!==F&&De.set(()=>({flat:F})),w&&!Hr.fun(w)&&!kG(w)&&!Hr.equ(w,He,F_)&&Cx(He,w),P&&!De.events.handlers&&De.set({events:P(o)});const Pe=Iae(n,M);return Hr.equ(Pe,De.size,F_)||De.setSize(Pe.width,Pe.height,Pe.updateStyle,Pe.top,Pe.left),Q&&De.viewport.dpr!==IG(Q)&&De.setDpr(Q),De.frameloop!==j&&De.setFrameloop(j),De.onPointerMissed||De.set({onPointerMissed:he}),re&&!Hr.equ(re,De.performance,F_)&&De.set(Qe=>({performance:{...Qe.performance,...re}})),s=L,d=!0,this},render(_){return d||this.configure(),bM.updateContainer($t.createElement(Lae,{store:o,children:_,onCreated:s,rootElement:n}),l,null,()=>{}),o},unmount(){FG(n)}}}function Lae({store:n,children:e,onCreated:t,rootElement:i}){return N1(()=>{const r=n.getState();r.set(o=>({internal:{...o.internal,active:!0}})),t&&t(r),n.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),$t.createElement(DG.Provider,{value:n},e)}function FG(n,e){const t=qy.get(n),i=t==null?void 0:t.fiber;if(i){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),bM.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var o,l,s,d;r.events.disconnect==null||r.events.disconnect(),(o=r.gl)==null||(l=o.renderLists)==null||l.dispose==null||l.dispose(),(s=r.gl)==null||s.forceContextLoss==null||s.forceContextLoss(),(d=r.gl)!=null&&d.xr&&r.xr.disconnect(),yae(r),qy.delete(n),e&&e(n)}catch{}},500)})}}bM.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:$t.version});function Jv(){return Jv=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Jv.apply(this,arguments)}function CI(n,e,t){var i,r,o,l,s;e==null&&(e=100);function d(){var _=Date.now()-l;_<e&&_>=0?i=setTimeout(d,e-_):(i=null,t||(s=n.apply(o,r),o=r=null))}var p=function(){o=this,r=arguments,l=Date.now();var _=t&&!i;return i||(i=setTimeout(d,e)),_&&(s=n.apply(o,r),o=r=null),s};return p.clear=function(){i&&(clearTimeout(i),i=null)},p.flush=function(){i&&(s=n.apply(o,r),o=r=null,clearTimeout(i),i=null)},p}CI.debounce=CI;var eB=CI;function kae(n){let{debounce:e,scroll:t,polyfill:i,offsetSize:r}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const o=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!o)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[l,s]=$t.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=$t.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:l}),p=e?typeof e=="number"?e:e.scroll:null,_=e?typeof e=="number"?e:e.resize:null,w=$t.useRef(!1);$t.useEffect(()=>(w.current=!0,()=>void(w.current=!1)));const[M,A,P]=$t.useMemo(()=>{const F=()=>{if(!d.current.element)return;const{left:N,top:V,width:j,height:Q,bottom:re,right:Z,x:ne,y:he}=d.current.element.getBoundingClientRect(),De={left:N,top:V,width:j,height:Q,bottom:re,right:Z,x:ne,y:he};d.current.element instanceof HTMLElement&&r&&(De.height=d.current.element.offsetHeight,De.width=d.current.element.offsetWidth),Object.freeze(De),w.current&&!Oae(d.current.lastBounds,De)&&s(d.current.lastBounds=De)};return[F,_?eB(F,_):F,p?eB(F,p):F]},[s,r,p,_]);function L(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(F=>F.removeEventListener("scroll",P,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null)}function D(){d.current.element&&(d.current.resizeObserver=new o(P),d.current.resizeObserver.observe(d.current.element),t&&d.current.scrollContainers&&d.current.scrollContainers.forEach(F=>F.addEventListener("scroll",P,{capture:!0,passive:!0})))}const z=F=>{!F||F===d.current.element||(L(),d.current.element=F,d.current.scrollContainers=BG(F),D())};return Rae(P,Boolean(t)),Dae(A),$t.useEffect(()=>{L(),D()},[t,P,A]),$t.useEffect(()=>L,[]),[z,l,M]}function Dae(n){$t.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function Rae(n,e){$t.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function BG(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:r}=window.getComputedStyle(n);return[t,i,r].some(o=>o==="auto"||o==="scroll")&&e.push(n),[...e,...BG(n.parentElement)]}const zae=["x","y","top","bottom","left","right","width","height"],Oae=(n,e)=>zae.every(t=>n[t]===e[t]);var Fae=Object.defineProperty,Bae=Object.defineProperties,Nae=Object.getOwnPropertyDescriptors,tB=Object.getOwnPropertySymbols,Uae=Object.prototype.hasOwnProperty,Vae=Object.prototype.propertyIsEnumerable,nB=(n,e,t)=>e in n?Fae(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,iB=(n,e)=>{for(var t in e||(e={}))Uae.call(e,t)&&nB(n,t,e[t]);if(tB)for(var t of tB(e))Vae.call(e,t)&&nB(n,t,e[t]);return n},Gae=(n,e)=>Bae(n,Nae(e));function NG(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=e?n.return:n.child;for(;i;){const r=NG(i,e,t);if(r)return r;i=e?null:i.sibling}}function UG(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const rk=UG($t.createContext(null));class VG extends $t.Component{render(){return $t.createElement(rk.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:rB,ReactCurrentDispatcher:sB}=$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Wae(){const n=$t.useContext(rk);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=$t.useId();return $t.useMemo(()=>{var i;return(i=rB==null?void 0:rB.current)!=null?i:NG(n,!1,r=>{let o=r.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}})},[n,e])}function Hae(){var n,e;const t=Wae(),[i]=$t.useState(()=>new Map);i.clear();let r=t;for(;r;){const o=(n=r.type)==null?void 0:n._context;o&&o!==rk&&!i.has(o)&&i.set(o,(e=sB==null?void 0:sB.current)==null?void 0:e.readContext(UG(o))),r=r.return}return $t.useMemo(()=>Array.from(i.keys()).reduce((o,l)=>s=>$t.createElement(o,null,$t.createElement(l.Provider,Gae(iB({},s),{value:i.get(l)}))),o=>$t.createElement(VG,iB({},o))),[i])}const rA={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function jae(n){const{handlePointer:e}=bae(n);return{priority:1,enabled:!0,compute(t,i,r){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(rA).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:r}=n.getState();(t=r.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var i;const{set:r,events:o}=n.getState();o.disconnect==null||o.disconnect(),r(l=>({events:{...l.events,connected:t}})),Object.entries((i=o.handlers)!=null?i:[]).forEach(([l,s])=>{const[d,p]=rA[l];t.addEventListener(d,s,{passive:p})})},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([o,l])=>{if(i&&i.connected instanceof HTMLElement){const[s]=rA[o];i.connected.removeEventListener(s,l)}}),t(o=>({events:{...o.events,connected:void 0}}))}}}}const qae=$t.forwardRef(function({children:e,fallback:t,resize:i,style:r,gl:o,events:l=jae,eventSource:s,eventPrefix:d,shadows:p,linear:_,flat:w,legacy:M,orthographic:A,frameloop:P,dpr:L,performance:D,raycaster:z,camera:F,onPointerMissed:N,onCreated:V,...j},Q){$t.useMemo(()=>dae(Koe),[]);const re=Hae(),[Z,ne]=kae({scroll:!0,debounce:{scroll:50,resize:0},...i}),he=$t.useRef(null),De=$t.useRef(null);$t.useImperativeHandle(Q,()=>he.current);const He=EG(N),[ae,le]=$t.useState(!1),[fe,Oe]=$t.useState(!1);if(ae)throw ae;if(fe)throw fe;const We=$t.useRef(null);N1(()=>{const Te=he.current;ne.width>0&&ne.height>0&&Te&&(We.current||(We.current=Pae(Te)),We.current.configure({gl:o,events:l,shadows:p,linear:_,flat:w,legacy:M,orthographic:A,frameloop:P,dpr:L,performance:D,raycaster:z,camera:F,size:ne,onPointerMissed:(...Pe)=>He.current==null?void 0:He.current(...Pe),onCreated:Pe=>{Pe.events.connect==null||Pe.events.connect(s?pae(s)?s.current:s:De.current),d&&Pe.setEvents({compute:(Qe,Ne)=>{const nt=Qe[d+"X"],ze=Qe[d+"Y"];Ne.pointer.set(nt/Ne.size.width*2-1,-(ze/Ne.size.height)*2+1),Ne.raycaster.setFromCamera(Ne.pointer,Ne.camera)}}),V==null||V(Pe)}}),We.current.render($t.createElement(re,null,$t.createElement(AG,{set:Oe},$t.createElement($t.Suspense,{fallback:$t.createElement(mae,{set:le})},e)))))}),$t.useEffect(()=>{const Te=he.current;if(Te)return()=>FG(Te)},[]);const ce=s?"none":"auto";return $t.createElement("div",Jv({ref:De,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ce,...r}},j),$t.createElement("div",{ref:Z,style:{width:"100%",height:"100%"}},$t.createElement("canvas",{ref:he,style:{display:"block"}},t)))}),Zae=$t.forwardRef(function(e,t){return $t.createElement(VG,null,$t.createElement(qae,Jv({},e,{ref:t})))});function Qv(n){return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qv(n)}function Xae(n,e){if(Qv(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(Qv(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function $ae(n){var e=Xae(n,"string");return Qv(e)==="symbol"?e:String(e)}function vi(n,e,t){return e=$ae(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}const oB=(n,e)=>(n%e+e)%e;let Yae=class extends kh{constructor(e,t){super(),vi(this,"object",void 0),vi(this,"domElement",void 0),vi(this,"enabled",!0),vi(this,"target",new Fe),vi(this,"minDistance",0),vi(this,"maxDistance",1/0),vi(this,"minZoom",0),vi(this,"maxZoom",1/0),vi(this,"minPolarAngle",0),vi(this,"maxPolarAngle",Math.PI),vi(this,"minAzimuthAngle",-1/0),vi(this,"maxAzimuthAngle",1/0),vi(this,"enableDamping",!1),vi(this,"dampingFactor",.05),vi(this,"enableZoom",!0),vi(this,"zoomSpeed",1),vi(this,"enableRotate",!0),vi(this,"rotateSpeed",1),vi(this,"enablePan",!0),vi(this,"panSpeed",1),vi(this,"screenSpacePanning",!0),vi(this,"keyPanSpeed",7),vi(this,"autoRotate",!1),vi(this,"autoRotateSpeed",2),vi(this,"reverseOrbit",!1),vi(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),vi(this,"mouseButtons",{LEFT:Um.ROTATE,MIDDLE:Um.DOLLY,RIGHT:Um.PAN}),vi(this,"touches",{ONE:Vm.ROTATE,TWO:Vm.DOLLY_PAN}),vi(this,"target0",void 0),vi(this,"position0",void 0),vi(this,"zoom0",void 0),vi(this,"_domElementKeyEvents",null),vi(this,"getPolarAngle",void 0),vi(this,"getAzimuthalAngle",void 0),vi(this,"setPolarAngle",void 0),vi(this,"setAzimuthalAngle",void 0),vi(this,"getDistance",void 0),vi(this,"listenToKeyEvents",void 0),vi(this,"saveState",void 0),vi(this,"reset",void 0),vi(this,"update",void 0),vi(this,"connect",void 0),vi(this,"dispose",void 0),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object instanceof qr?this.object.zoom:1,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=Je=>{let It=oB(Je,2*Math.PI),Zt=_.phi;Zt<0&&(Zt+=2*Math.PI),It<0&&(It+=2*Math.PI);let sn=Math.abs(It-Zt);2*Math.PI-sn<sn&&(It<Zt?It+=2*Math.PI:Zt+=2*Math.PI),w.phi=It-Zt,i.update()},this.setAzimuthalAngle=Je=>{let It=oB(Je,2*Math.PI),Zt=_.theta;Zt<0&&(Zt+=2*Math.PI),It<0&&(It+=2*Math.PI);let sn=Math.abs(It-Zt);2*Math.PI-sn<sn&&(It<Zt?It+=2*Math.PI:Zt+=2*Math.PI),w.theta=It-Zt,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=Je=>{Je.addEventListener("keydown",St),this._domElementKeyEvents=Je},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object instanceof qr?i.object.zoom:1},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object instanceof qr&&(i.object.zoom=i.zoom0,i.object.updateProjectionMatrix()),i.dispatchEvent(r),i.update(),d=s.NONE},this.update=(()=>{const Je=new Fe,It=new Ao().setFromUnitVectors(e.up,new Fe(0,1,0)),Zt=It.clone().invert(),sn=new Fe,Yn=new Ao,li=2*Math.PI;return function(){const rt=i.object.position;Je.copy(rt).sub(i.target),Je.applyQuaternion(It),_.setFromVector3(Je),i.autoRotate&&d===s.NONE&&He(he()),i.enableDamping?(_.theta+=w.theta*i.dampingFactor,_.phi+=w.phi*i.dampingFactor):(_.theta+=w.theta,_.phi+=w.phi);let Ct=i.minAzimuthAngle,Vt=i.maxAzimuthAngle;return isFinite(Ct)&&isFinite(Vt)&&(Ct<-Math.PI?Ct+=li:Ct>Math.PI&&(Ct-=li),Vt<-Math.PI?Vt+=li:Vt>Math.PI&&(Vt-=li),Ct<=Vt?_.theta=Math.max(Ct,Math.min(Vt,_.theta)):_.theta=_.theta>(Ct+Vt)/2?Math.max(Ct,_.theta):Math.min(Vt,_.theta)),_.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,_.phi)),_.makeSafe(),_.radius*=M,_.radius=Math.max(i.minDistance,Math.min(i.maxDistance,_.radius)),i.enableDamping===!0?i.target.addScaledVector(A,i.dampingFactor):i.target.add(A),Je.setFromSpherical(_),Je.applyQuaternion(Zt),rt.copy(i.target).add(Je),i.object.lookAt(i.target),i.enableDamping===!0?(w.theta*=1-i.dampingFactor,w.phi*=1-i.dampingFactor,A.multiplyScalar(1-i.dampingFactor)):(w.set(0,0,0),A.set(0,0,0)),M=1,P||sn.distanceToSquared(i.object.position)>p||8*(1-Yn.dot(i.object.quaternion))>p?(i.dispatchEvent(r),sn.copy(i.object.position),Yn.copy(i.object.quaternion),P=!1,!0):!1}})(),this.connect=Je=>{Je===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.domElement=Je,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",fn),i.domElement.addEventListener("pointerdown",Vn),i.domElement.addEventListener("pointercancel",ai),i.domElement.addEventListener("wheel",Se)},this.dispose=()=>{var Je,It,Zt,sn,Yn,li;(Je=i.domElement)===null||Je===void 0||Je.removeEventListener("contextmenu",fn),(It=i.domElement)===null||It===void 0||It.removeEventListener("pointerdown",Vn),(Zt=i.domElement)===null||Zt===void 0||Zt.removeEventListener("pointercancel",ai),(sn=i.domElement)===null||sn===void 0||sn.removeEventListener("wheel",Se),(Yn=i.domElement)===null||Yn===void 0||Yn.ownerDocument.removeEventListener("pointermove",On),(li=i.domElement)===null||li===void 0||li.ownerDocument.removeEventListener("pointerup",Zn),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",St)};const i=this,r={type:"change"},o={type:"start"},l={type:"end"},s={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=s.NONE;const p=1e-6,_=new MI,w=new MI;let M=1;const A=new Fe;let P=!1;const L=new Gt,D=new Gt,z=new Gt,F=new Gt,N=new Gt,V=new Gt,j=new Gt,Q=new Gt,re=new Gt,Z=[],ne={};function he(){return 2*Math.PI/60/60*i.autoRotateSpeed}function De(){return Math.pow(.95,i.zoomSpeed)}function He(Je){i.reverseOrbit?w.theta+=Je:w.theta-=Je}function ae(Je){i.reverseOrbit?w.phi+=Je:w.phi-=Je}const le=(()=>{const Je=new Fe;return function(Zt,sn){Je.setFromMatrixColumn(sn,0),Je.multiplyScalar(-Zt),A.add(Je)}})(),fe=(()=>{const Je=new Fe;return function(Zt,sn){i.screenSpacePanning===!0?Je.setFromMatrixColumn(sn,1):(Je.setFromMatrixColumn(sn,0),Je.crossVectors(i.object.up,Je)),Je.multiplyScalar(Zt),A.add(Je)}})(),Oe=(()=>{const Je=new Fe;return function(Zt,sn){const Yn=i.domElement;if(Yn&&i.object instanceof qr&&i.object.isPerspectiveCamera){const li=i.object.position;Je.copy(li).sub(i.target);let Bi=Je.length();Bi*=Math.tan(i.object.fov/2*Math.PI/180),le(2*Zt*Bi/Yn.clientHeight,i.object.matrix),fe(2*sn*Bi/Yn.clientHeight,i.object.matrix)}else Yn&&i.object instanceof Wd&&i.object.isOrthographicCamera?(le(Zt*(i.object.right-i.object.left)/i.object.zoom/Yn.clientWidth,i.object.matrix),fe(sn*(i.object.top-i.object.bottom)/i.object.zoom/Yn.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function We(Je){i.object instanceof qr&&i.object.isPerspectiveCamera?M/=Je:i.object instanceof Wd&&i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*Je)),i.object.updateProjectionMatrix(),P=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ce(Je){i.object instanceof qr&&i.object.isPerspectiveCamera?M*=Je:i.object instanceof Wd&&i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/Je)),i.object.updateProjectionMatrix(),P=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function Te(Je){L.set(Je.clientX,Je.clientY)}function Pe(Je){j.set(Je.clientX,Je.clientY)}function Qe(Je){F.set(Je.clientX,Je.clientY)}function Ne(Je){D.set(Je.clientX,Je.clientY),z.subVectors(D,L).multiplyScalar(i.rotateSpeed);const It=i.domElement;It&&(He(2*Math.PI*z.x/It.clientHeight),ae(2*Math.PI*z.y/It.clientHeight)),L.copy(D),i.update()}function nt(Je){Q.set(Je.clientX,Je.clientY),re.subVectors(Q,j),re.y>0?We(De()):re.y<0&&ce(De()),j.copy(Q),i.update()}function ze(Je){N.set(Je.clientX,Je.clientY),V.subVectors(N,F).multiplyScalar(i.panSpeed),Oe(V.x,V.y),F.copy(N),i.update()}function et(Je){Je.deltaY<0?ce(De()):Je.deltaY>0&&We(De()),i.update()}function Et(Je){let It=!1;switch(Je.code){case i.keys.UP:Oe(0,i.keyPanSpeed),It=!0;break;case i.keys.BOTTOM:Oe(0,-i.keyPanSpeed),It=!0;break;case i.keys.LEFT:Oe(i.keyPanSpeed,0),It=!0;break;case i.keys.RIGHT:Oe(-i.keyPanSpeed,0),It=!0;break}It&&(Je.preventDefault(),i.update())}function Nt(){if(Z.length==1)L.set(Z[0].pageX,Z[0].pageY);else{const Je=.5*(Z[0].pageX+Z[1].pageX),It=.5*(Z[0].pageY+Z[1].pageY);L.set(Je,It)}}function qt(){if(Z.length==1)F.set(Z[0].pageX,Z[0].pageY);else{const Je=.5*(Z[0].pageX+Z[1].pageX),It=.5*(Z[0].pageY+Z[1].pageY);F.set(Je,It)}}function wn(){const Je=Z[0].pageX-Z[1].pageX,It=Z[0].pageY-Z[1].pageY,Zt=Math.sqrt(Je*Je+It*It);j.set(0,Zt)}function _n(){i.enableZoom&&wn(),i.enablePan&&qt()}function Rn(){i.enableZoom&&wn(),i.enableRotate&&Nt()}function At(Je){if(Z.length==1)D.set(Je.pageX,Je.pageY);else{const Zt=Un(Je),sn=.5*(Je.pageX+Zt.x),Yn=.5*(Je.pageY+Zt.y);D.set(sn,Yn)}z.subVectors(D,L).multiplyScalar(i.rotateSpeed);const It=i.domElement;It&&(He(2*Math.PI*z.x/It.clientHeight),ae(2*Math.PI*z.y/It.clientHeight)),L.copy(D)}function Ot(Je){if(Z.length==1)N.set(Je.pageX,Je.pageY);else{const It=Un(Je),Zt=.5*(Je.pageX+It.x),sn=.5*(Je.pageY+It.y);N.set(Zt,sn)}V.subVectors(N,F).multiplyScalar(i.panSpeed),Oe(V.x,V.y),F.copy(N)}function Ft(Je){const It=Un(Je),Zt=Je.pageX-It.x,sn=Je.pageY-It.y,Yn=Math.sqrt(Zt*Zt+sn*sn);Q.set(0,Yn),re.set(0,Math.pow(Q.y/j.y,i.zoomSpeed)),We(re.y),j.copy(Q)}function Cn(Je){i.enableZoom&&Ft(Je),i.enablePan&&Ot(Je)}function pn(Je){i.enableZoom&&Ft(Je),i.enableRotate&&At(Je)}function Vn(Je){if(i.enabled!==!1){if(Z.length===0){var It,Zt;(It=i.domElement)===null||It===void 0||It.ownerDocument.addEventListener("pointermove",On),(Zt=i.domElement)===null||Zt===void 0||Zt.ownerDocument.addEventListener("pointerup",Zn)}Nn(Je),Je.pointerType==="touch"?tn(Je):Ei(Je)}}function On(Je){i.enabled!==!1&&(Je.pointerType==="touch"?nn(Je):Be(Je))}function Zn(Je){if(yn(Je),Z.length===0){var It,Zt,sn;(It=i.domElement)===null||It===void 0||It.releasePointerCapture(Je.pointerId),(Zt=i.domElement)===null||Zt===void 0||Zt.ownerDocument.removeEventListener("pointermove",On),(sn=i.domElement)===null||sn===void 0||sn.ownerDocument.removeEventListener("pointerup",Zn)}i.dispatchEvent(l),d=s.NONE}function ai(Je){yn(Je)}function Ei(Je){let It;switch(Je.button){case 0:It=i.mouseButtons.LEFT;break;case 1:It=i.mouseButtons.MIDDLE;break;case 2:It=i.mouseButtons.RIGHT;break;default:It=-1}switch(It){case Um.DOLLY:if(i.enableZoom===!1)return;Pe(Je),d=s.DOLLY;break;case Um.ROTATE:if(Je.ctrlKey||Je.metaKey||Je.shiftKey){if(i.enablePan===!1)return;Qe(Je),d=s.PAN}else{if(i.enableRotate===!1)return;Te(Je),d=s.ROTATE}break;case Um.PAN:if(Je.ctrlKey||Je.metaKey||Je.shiftKey){if(i.enableRotate===!1)return;Te(Je),d=s.ROTATE}else{if(i.enablePan===!1)return;Qe(Je),d=s.PAN}break;default:d=s.NONE}d!==s.NONE&&i.dispatchEvent(o)}function Be(Je){if(i.enabled!==!1)switch(d){case s.ROTATE:if(i.enableRotate===!1)return;Ne(Je);break;case s.DOLLY:if(i.enableZoom===!1)return;nt(Je);break;case s.PAN:if(i.enablePan===!1)return;ze(Je);break}}function Se(Je){i.enabled===!1||i.enableZoom===!1||d!==s.NONE&&d!==s.ROTATE||(Je.preventDefault(),i.dispatchEvent(o),et(Je),i.dispatchEvent(l))}function St(Je){i.enabled===!1||i.enablePan===!1||Et(Je)}function tn(Je){switch(Dt(Je),Z.length){case 1:switch(i.touches.ONE){case Vm.ROTATE:if(i.enableRotate===!1)return;Nt(),d=s.TOUCH_ROTATE;break;case Vm.PAN:if(i.enablePan===!1)return;qt(),d=s.TOUCH_PAN;break;default:d=s.NONE}break;case 2:switch(i.touches.TWO){case Vm.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;_n(),d=s.TOUCH_DOLLY_PAN;break;case Vm.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Rn(),d=s.TOUCH_DOLLY_ROTATE;break;default:d=s.NONE}break;default:d=s.NONE}d!==s.NONE&&i.dispatchEvent(o)}function nn(Je){switch(Dt(Je),d){case s.TOUCH_ROTATE:if(i.enableRotate===!1)return;At(Je),i.update();break;case s.TOUCH_PAN:if(i.enablePan===!1)return;Ot(Je),i.update();break;case s.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Cn(Je),i.update();break;case s.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;pn(Je),i.update();break;default:d=s.NONE}}function fn(Je){i.enabled!==!1&&Je.preventDefault()}function Nn(Je){Z.push(Je)}function yn(Je){delete ne[Je.pointerId];for(let It=0;It<Z.length;It++)if(Z[It].pointerId==Je.pointerId){Z.splice(It,1);return}}function Dt(Je){let It=ne[Je.pointerId];It===void 0&&(It=new Gt,ne[Je.pointerId]=It),It.set(Je.pageX,Je.pageY)}function Un(Je){const It=Je.pointerId===Z[0].pointerId?Z[1]:Z[0];return ne[It.pointerId]}t!==void 0&&this.connect(t),this.update()}};const Kae=$t.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:i,enableDamping:r=!0,onChange:o,onStart:l,onEnd:s,...d},p)=>{const _=Hf(j=>j.invalidate),w=Hf(j=>j.camera),M=Hf(j=>j.gl),A=Hf(j=>j.events),P=Hf(j=>j.setEvents),L=Hf(j=>j.set),D=Hf(j=>j.get),z=Hf(j=>j.performance),F=e||w,N=i||A.connected||M.domElement,V=$t.useMemo(()=>new Yae(F),[F]);return zG(()=>{V.enabled&&V.update()},-1),$t.useEffect(()=>(V.connect(N),()=>void V.dispose()),[N,t,V,_]),$t.useEffect(()=>{const j=Z=>{_(),t&&z.regress(),o&&o(Z)},Q=Z=>{l&&l(Z)},re=Z=>{s&&s(Z)};return V.addEventListener("change",j),V.addEventListener("start",Q),V.addEventListener("end",re),()=>{V.removeEventListener("start",Q),V.removeEventListener("end",re),V.removeEventListener("change",j)}},[o,l,s,V,_,P]),$t.useEffect(()=>{if(n){const j=D().controls;return L({controls:V}),()=>L({controls:j})}},[n,V]),$t.createElement("primitive",Jv({ref:p,object:V,enableDamping:r},d))});function aB(n,e){if(e===pV)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===_M||e===vL){let t=n.getIndex();if(t===null){const l=[],s=n.getAttribute("position");if(s!==void 0){for(let d=0;d<s.count;d++)l.push(d);n.setIndex(l),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const i=t.count-2,r=[];if(e===_M)for(let l=1;l<=i;l++)r.push(t.getX(0)),r.push(t.getX(l)),r.push(t.getX(l+1));else for(let l=0;l<i;l++)l%2===0?(r.push(t.getX(l)),r.push(t.getX(l+1)),r.push(t.getX(l+2))):(r.push(t.getX(l+2)),r.push(t.getX(l+1)),r.push(t.getX(l)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const o=n.clone();return o.setIndex(r),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}class Jae extends rl{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new ile(t)}),this.register(function(t){return new ule(t)}),this.register(function(t){return new hle(t)}),this.register(function(t){return new dle(t)}),this.register(function(t){return new sle(t)}),this.register(function(t){return new ole(t)}),this.register(function(t){return new ale(t)}),this.register(function(t){return new lle(t)}),this.register(function(t){return new nle(t)}),this.register(function(t){return new cle(t)}),this.register(function(t){return new rle(t)}),this.register(function(t){return new ele(t)}),this.register(function(t){return new fle(t)}),this.register(function(t){return new ple(t)})}load(e,t,i,r){const o=this;let l;this.resourcePath!==""?l=this.resourcePath:this.path!==""?l=this.path:l=jy.extractUrlBase(e),this.manager.itemStart(e);const s=function(p){r?r(p):console.error(p),o.manager.itemError(e),o.manager.itemEnd(e)},d=new Ru(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(p){try{o.parse(p,l,function(_){t(_),o.manager.itemEnd(e)},s)}catch(_){s(_)}},i,s)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let o;const l={},s={},d=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(d.decode(new Uint8Array(e,0,4))===GG){try{l[er.KHR_BINARY_GLTF]=new mle(e)}catch(w){r&&r(w);return}o=JSON.parse(l[er.KHR_BINARY_GLTF].content)}else o=JSON.parse(d.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const p=new Cle(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(let _=0;_<this.pluginCallbacks.length;_++){const w=this.pluginCallbacks[_](p);s[w.name]=w,l[w.name]=!0}if(o.extensionsUsed)for(let _=0;_<o.extensionsUsed.length;++_){const w=o.extensionsUsed[_],M=o.extensionsRequired||[];switch(w){case er.KHR_MATERIALS_UNLIT:l[w]=new tle;break;case er.KHR_DRACO_MESH_COMPRESSION:l[w]=new gle(o,this.dracoLoader);break;case er.KHR_TEXTURE_TRANSFORM:l[w]=new _le;break;case er.KHR_MESH_QUANTIZATION:l[w]=new yle;break;default:M.indexOf(w)>=0&&s[w]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+w+'".')}}p.setExtensions(l),p.setPlugins(s),p.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,o){i.parse(e,t,r,o)})}}function Qae(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const er={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ele{constructor(e){this.parser=e,this.name=er.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const o=t[i];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const o=t.json,d=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e];let p;const _=new An(16777215);d.color!==void 0&&_.fromArray(d.color);const w=d.range!==void 0?d.range:0;switch(d.type){case"directional":p=new YL(_),p.target.position.set(0,0,-1),p.add(p.target);break;case"point":p=new $L(_),p.distance=w;break;case"spot":p=new XL(_),p.distance=w,d.spot=d.spot||{},d.spot.innerConeAngle=d.spot.innerConeAngle!==void 0?d.spot.innerConeAngle:0,d.spot.outerConeAngle=d.spot.outerConeAngle!==void 0?d.spot.outerConeAngle:Math.PI/4,p.angle=d.spot.outerConeAngle,p.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,p.target.position.set(0,0,-1),p.add(p.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return p.position.set(0,0,0),p.decay=2,Kf(p,d),d.intensity!==void 0&&(p.intensity=d.intensity),p.name=t.createUniqueName(d.name||"light_"+e),r=Promise.resolve(p),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,o=i.json.nodes[e],s=(o.extensions&&o.extensions[this.name]||{}).light;return s===void 0?null:this._loadLight(s).then(function(d){return i._getNodeRef(t.cache,s,d)})}}class tle{constructor(){this.name=er.KHR_MATERIALS_UNLIT}getMaterialType(){return Dl}extendParams(e,t,i){const r=[];e.color=new An(1,1,1),e.opacity=1;const o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const l=o.baseColorFactor;e.color.fromArray(l),e.opacity=l[3]}o.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",o.baseColorTexture,ar))}return Promise.all(r)}}class nle{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}}class ile{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];if(l.clearcoatFactor!==void 0&&(t.clearcoat=l.clearcoatFactor),l.clearcoatTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),l.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),l.clearcoatRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),l.clearcoatNormalTexture!==void 0&&(o.push(i.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),l.clearcoatNormalTexture.scale!==void 0)){const s=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Gt(s,s)}return Promise.all(o)}}class rle{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];return l.iridescenceFactor!==void 0&&(t.iridescence=l.iridescenceFactor),l.iridescenceTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceMap",l.iridescenceTexture)),l.iridescenceIor!==void 0&&(t.iridescenceIOR=l.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),l.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=l.iridescenceThicknessMinimum),l.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=l.iridescenceThicknessMaximum),l.iridescenceThicknessTexture!==void 0&&o.push(i.assignTexture(t,"iridescenceThicknessMap",l.iridescenceThicknessTexture)),Promise.all(o)}}class sle{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[];t.sheenColor=new An(0,0,0),t.sheenRoughness=0,t.sheen=1;const l=r.extensions[this.name];return l.sheenColorFactor!==void 0&&t.sheenColor.fromArray(l.sheenColorFactor),l.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=l.sheenRoughnessFactor),l.sheenColorTexture!==void 0&&o.push(i.assignTexture(t,"sheenColorMap",l.sheenColorTexture,ar)),l.sheenRoughnessTexture!==void 0&&o.push(i.assignTexture(t,"sheenRoughnessMap",l.sheenRoughnessTexture)),Promise.all(o)}}class ole{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];return l.transmissionFactor!==void 0&&(t.transmission=l.transmissionFactor),l.transmissionTexture!==void 0&&o.push(i.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(o)}}class ale{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];t.thickness=l.thicknessFactor!==void 0?l.thicknessFactor:0,l.thicknessTexture!==void 0&&o.push(i.assignTexture(t,"thicknessMap",l.thicknessTexture)),t.attenuationDistance=l.attenuationDistance||1/0;const s=l.attenuationColor||[1,1,1];return t.attenuationColor=new An(s[0],s[1],s[2]),Promise.all(o)}}class lle{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=r.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}}class cle{constructor(e){this.parser=e,this.name=er.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:nf}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],l=r.extensions[this.name];t.specularIntensity=l.specularFactor!==void 0?l.specularFactor:1,l.specularTexture!==void 0&&o.push(i.assignTexture(t,"specularIntensityMap",l.specularTexture));const s=l.specularColorFactor||[1,1,1];return t.specularColor=new An(s[0],s[1],s[2]),l.specularColorTexture!==void 0&&o.push(i.assignTexture(t,"specularColorMap",l.specularColorTexture,ar)),Promise.all(o)}}class ule{constructor(e){this.parser=e,this.name=er.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=r.extensions[this.name],l=t.options.ktx2Loader;if(!l){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,l)}}class hle{constructor(e){this.parser=e,this.name=er.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],s=r.images[l.source];let d=i.textureLoader;if(s.uri){const p=i.options.manager.getHandler(s.uri);p!==null&&(d=p)}return this.detectSupport().then(function(p){if(p)return i.loadTextureImage(e,l.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class dle{constructor(e){this.parser=e,this.name=er.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const l=o.extensions[t],s=r.images[l.source];let d=i.textureLoader;if(s.uri){const p=i.options.manager.getHandler(s.uri);p!==null&&(d=p)}return this.detectSupport().then(function(p){if(p)return i.loadTextureImage(e,l.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class fle{constructor(e){this.name=er.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(s){const d=r.byteOffset||0,p=r.byteLength||0,_=r.count,w=r.byteStride,M=new Uint8Array(s,d,p);return l.decodeGltfBufferAsync?l.decodeGltfBufferAsync(_,w,M,r.mode,r.filter).then(function(A){return A.buffer}):l.ready.then(function(){const A=new ArrayBuffer(_*w);return l.decodeGltfBuffer(new Uint8Array(A),_,w,M,r.mode,r.filter),A})})}else return null}}class ple{constructor(e){this.name=er.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const p of r.primitives)if(p.mode!==mc.TRIANGLES&&p.mode!==mc.TRIANGLE_STRIP&&p.mode!==mc.TRIANGLE_FAN&&p.mode!==void 0)return null;const l=i.extensions[this.name].attributes,s=[],d={};for(const p in l)s.push(this.parser.getDependency("accessor",l[p]).then(_=>(d[p]=_,d[p])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(p=>{const _=p.pop(),w=_.isGroup?_.children:[_],M=p[0].count,A=[];for(const P of w){const L=new hi,D=new Fe,z=new Ao,F=new Fe(1,1,1),N=new kL(P.geometry,P.material,M);for(let V=0;V<M;V++)d.TRANSLATION&&D.fromBufferAttribute(d.TRANSLATION,V),d.ROTATION&&z.fromBufferAttribute(d.ROTATION,V),d.SCALE&&F.fromBufferAttribute(d.SCALE,V),N.setMatrixAt(V,L.compose(D,z,F));for(const V in d)V!=="TRANSLATION"&&V!=="ROTATION"&&V!=="SCALE"&&P.geometry.setAttribute(V,d[V]);tr.prototype.copy.call(N,P),N.frustumCulled=!1,this.parser.assignFinalMaterial(N),A.push(N)}return _.isGroup?(_.clear(),_.add(...A),_):A[0]}))}}const GG="glTF",Ix=12,lB={JSON:1313821514,BIN:5130562};class mle{constructor(e){this.name=er.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Ix),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==GG)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-Ix,o=new DataView(e,Ix);let l=0;for(;l<r;){const s=o.getUint32(l,!0);l+=4;const d=o.getUint32(l,!0);if(l+=4,d===lB.JSON){const p=new Uint8Array(e,Ix+l,s);this.content=i.decode(p)}else if(d===lB.BIN){const p=Ix+l;this.body=e.slice(p,p+s)}l+=s}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class gle{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=er.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,s={},d={},p={};for(const _ in l){const w=II[_]||_.toLowerCase();s[w]=l[_]}for(const _ in e.attributes){const w=II[_]||_.toLowerCase();if(l[_]!==void 0){const M=i.accessors[e.attributes[_]],A=yy[M.componentType];p[w]=A.name,d[w]=M.normalized===!0}}return t.getDependency("bufferView",o).then(function(_){return new Promise(function(w){r.decodeDracoFile(_,function(M){for(const A in M.attributes){const P=M.attributes[A],L=d[A];L!==void 0&&(P.normalized=L)}w(M)},s,p)})})}}class _le{constructor(){this.name=er.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class yle{constructor(){this.name=er.KHR_MESH_QUANTIZATION}}class WG extends a0{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let l=0;l!==r;l++)t[l]=i[o+l];return t}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,s=this.valueSize,d=s*2,p=s*3,_=r-t,w=(i-t)/_,M=w*w,A=M*w,P=e*p,L=P-p,D=-2*A+3*M,z=A-M,F=1-D,N=z-M+w;for(let V=0;V!==s;V++){const j=l[L+V+s],Q=l[L+V+d]*_,re=l[P+V+s],Z=l[P+V]*_;o[V]=F*j+N*Q+D*re+z*Z}return o}}const xle=new Ao;class vle extends WG{interpolate_(e,t,i,r){const o=super.interpolate_(e,t,i,r);return xle.fromArray(o).normalize().toArray(o),o}}const mc={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},yy={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},cB={9728:Ss,9729:cs,9984:Gv,9985:nT,9986:my,9987:Ph},uB={33071:No,33648:Oy,10497:kp},sA={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},II={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},jf={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},wle={CUBICSPLINE:void 0,LINEAR:Mg,STEP:By},oA={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ble(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new B1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ih})),n.DefaultMaterial}function Px(n,e,t){for(const i in t.extensions)n[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Kf(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Sle(n,e,t){let i=!1,r=!1,o=!1;for(let p=0,_=e.length;p<_;p++){const w=e[p];if(w.POSITION!==void 0&&(i=!0),w.NORMAL!==void 0&&(r=!0),w.COLOR_0!==void 0&&(o=!0),i&&r&&o)break}if(!i&&!r&&!o)return Promise.resolve(n);const l=[],s=[],d=[];for(let p=0,_=e.length;p<_;p++){const w=e[p];if(i){const M=w.POSITION!==void 0?t.getDependency("accessor",w.POSITION):n.attributes.position;l.push(M)}if(r){const M=w.NORMAL!==void 0?t.getDependency("accessor",w.NORMAL):n.attributes.normal;s.push(M)}if(o){const M=w.COLOR_0!==void 0?t.getDependency("accessor",w.COLOR_0):n.attributes.color;d.push(M)}}return Promise.all([Promise.all(l),Promise.all(s),Promise.all(d)]).then(function(p){const _=p[0],w=p[1],M=p[2];return i&&(n.morphAttributes.position=_),r&&(n.morphAttributes.normal=w),o&&(n.morphAttributes.color=M),n.morphTargetsRelative=!0,n})}function Mle(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)n.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Tle(n){const e=n.extensions&&n.extensions[er.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+hB(e.attributes):t=n.indices+":"+hB(n.attributes)+":"+n.mode,t}function hB(n){let e="";const t=Object.keys(n).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+n[t[i]]+";";return e}function PI(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Ele(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Ale=new hi;class Cle{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Qae,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,o=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,o=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&o<98?this.textureLoader=new cG(this.options.manager):this.textureLoader=new gG(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ru(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(l){return l._markDefs&&l._markDefs()}),Promise.all(this._invokeAll(function(l){return l.beforeRoot&&l.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(l){const s={scene:l[0][r.scene||0],scenes:l[0],animations:l[1],cameras:l[2],asset:r.asset,parser:i,userData:{}};Px(o,s,r),Kf(s,r),Promise.all(i._invokeAll(function(d){return d.afterRoot&&d.afterRoot(s)})).then(function(){e(s)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){const l=t[r].joints;for(let s=0,d=l.length;s<d;s++)e[l[s]].isBone=!0}for(let r=0,o=e.length;r<o;r++){const l=e[r];l.mesh!==void 0&&(this._addNodeRef(this.meshCache,l.mesh),l.skin!==void 0&&(i[l.mesh].isSkinnedMesh=!0)),l.camera!==void 0&&this._addNodeRef(this.cameraCache,l.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),o=(l,s)=>{const d=this.associations.get(l);d!=null&&this.associations.set(s,d);for(const[p,_]of l.children.entries())o(_,s.children[p])};return o(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&i.push(o)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":r=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(o,l){return i.getDependency(e,l)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[er.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(o,l){i.load(jy.resolveURL(t.uri,r.path),o,void 0,function(){l(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,o=t.byteOffset||0;return i.slice(o,o+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const l=sA[r.type],s=yy[r.componentType],d=r.normalized===!0,p=new s(r.count*l);return Promise.resolve(new vr(p,l,d))}const o=[];return r.bufferView!==void 0?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),r.sparse!==void 0&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then(function(l){const s=l[0],d=sA[r.type],p=yy[r.componentType],_=p.BYTES_PER_ELEMENT,w=_*d,M=r.byteOffset||0,A=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,P=r.normalized===!0;let L,D;if(A&&A!==w){const z=Math.floor(M/A),F="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+z+":"+r.count;let N=t.cache.get(F);N||(L=new p(s,z*A,r.count*A/_),N=new M1(L,A/_),t.cache.add(F,N)),D=new Dp(N,d,M%A/_,P)}else s===null?L=new p(r.count*d):L=new p(s,M,r.count*d),D=new vr(L,d,P);if(r.sparse!==void 0){const z=sA.SCALAR,F=yy[r.sparse.indices.componentType],N=r.sparse.indices.byteOffset||0,V=r.sparse.values.byteOffset||0,j=new F(l[1],N,r.sparse.count*z),Q=new p(l[2],V,r.sparse.count*d);s!==null&&(D=new vr(D.array.slice(),D.itemSize,D.normalized));for(let re=0,Z=j.length;re<Z;re++){const ne=j[re];if(D.setX(ne,Q[re*d]),d>=2&&D.setY(ne,Q[re*d+1]),d>=3&&D.setZ(ne,Q[re*d+2]),d>=4&&D.setW(ne,Q[re*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return D})}loadTexture(e){const t=this.json,i=this.options,o=t.textures[e].source,l=t.images[o];let s=this.textureLoader;if(l.uri){const d=i.manager.getHandler(l.uri);d!==null&&(s=d)}return this.loadTextureImage(e,o,s)}loadTextureImage(e,t,i){const r=this,o=this.json,l=o.textures[e],s=o.images[t],d=(s.uri||s.bufferView)+":"+l.sampler;if(this.textureCache[d])return this.textureCache[d];const p=this.loadImageSource(t,i).then(function(_){_.flipY=!1,_.name=l.name||s.name||"";const M=(o.samplers||{})[l.sampler]||{};return _.magFilter=cB[M.magFilter]||cs,_.minFilter=cB[M.minFilter]||Ph,_.wrapS=uB[M.wrapS]||kp,_.wrapT=uB[M.wrapT]||kp,r.associations.set(_,{textures:e}),_}).catch(function(){return null});return this.textureCache[d]=p,p}loadImageSource(e,t){const i=this,r=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(w=>w.clone());const l=r.images[e],s=self.URL||self.webkitURL;let d=l.uri||"",p=!1;if(l.bufferView!==void 0)d=i.getDependency("bufferView",l.bufferView).then(function(w){p=!0;const M=new Blob([w],{type:l.mimeType});return d=s.createObjectURL(M),d});else if(l.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const _=Promise.resolve(d).then(function(w){return new Promise(function(M,A){let P=M;t.isImageBitmapLoader===!0&&(P=function(L){const D=new Jr(L);D.needsUpdate=!0,M(D)}),t.load(jy.resolveURL(w,o.path),P,void 0,A)})}).then(function(w){return p===!0&&s.revokeObjectURL(d),w.userData.mimeType=l.mimeType||Ele(l.uri),w}).catch(function(w){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),w});return this.sourceCache[e]=_,_}assignTexture(e,t,i,r){const o=this;return this.getDependency("texture",i.index).then(function(l){if(!l)return null;if(i.texCoord!==void 0&&i.texCoord!=0&&!(t==="aoMap"&&i.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),o.extensions[er.KHR_TEXTURE_TRANSFORM]){const s=i.extensions!==void 0?i.extensions[er.KHR_TEXTURE_TRANSFORM]:void 0;if(s){const d=o.associations.get(l);l=o.extensions[er.KHR_TEXTURE_TRANSFORM].extendTexture(l,s),o.associations.set(l,d)}}return r!==void 0&&(l.encoding=r),e[t]=l,l})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,l=t.attributes.normal===void 0;if(e.isPoints){const s="PointsMaterial:"+i.uuid;let d=this.cache.get(s);d||(d=new hT,Zs.prototype.copy.call(d,i),d.color.copy(i.color),d.map=i.map,d.sizeAttenuation=!1,this.cache.add(s,d)),i=d}else if(e.isLine){const s="LineBasicMaterial:"+i.uuid;let d=this.cache.get(s);d||(d=new ga,Zs.prototype.copy.call(d,i),d.color.copy(i.color),this.cache.add(s,d)),i=d}if(r||o||l){let s="ClonedMaterial:"+i.uuid+":";r&&(s+="derivative-tangents:"),o&&(s+="vertex-colors:"),l&&(s+="flat-shading:");let d=this.cache.get(s);d||(d=i.clone(),o&&(d.vertexColors=!0),l&&(d.flatShading=!0),r&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(s,d),this.associations.set(d,this.associations.get(i))),i=d}i.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return B1}loadMaterial(e){const t=this,i=this.json,r=this.extensions,o=i.materials[e];let l;const s={},d=o.extensions||{},p=[];if(d[er.KHR_MATERIALS_UNLIT]){const w=r[er.KHR_MATERIALS_UNLIT];l=w.getMaterialType(),p.push(w.extendParams(s,o,t))}else{const w=o.pbrMetallicRoughness||{};if(s.color=new An(1,1,1),s.opacity=1,Array.isArray(w.baseColorFactor)){const M=w.baseColorFactor;s.color.fromArray(M),s.opacity=M[3]}w.baseColorTexture!==void 0&&p.push(t.assignTexture(s,"map",w.baseColorTexture,ar)),s.metalness=w.metallicFactor!==void 0?w.metallicFactor:1,s.roughness=w.roughnessFactor!==void 0?w.roughnessFactor:1,w.metallicRoughnessTexture!==void 0&&(p.push(t.assignTexture(s,"metalnessMap",w.metallicRoughnessTexture)),p.push(t.assignTexture(s,"roughnessMap",w.metallicRoughnessTexture))),l=this._invokeOne(function(M){return M.getMaterialType&&M.getMaterialType(e)}),p.push(Promise.all(this._invokeAll(function(M){return M.extendMaterialParams&&M.extendMaterialParams(e,s)})))}o.doubleSided===!0&&(s.side=bh);const _=o.alphaMode||oA.OPAQUE;if(_===oA.BLEND?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,_===oA.MASK&&(s.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&l!==Dl&&(p.push(t.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new Gt(1,1),o.normalTexture.scale!==void 0)){const w=o.normalTexture.scale;s.normalScale.set(w,w)}return o.occlusionTexture!==void 0&&l!==Dl&&(p.push(t.assignTexture(s,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(s.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&l!==Dl&&(s.emissive=new An().fromArray(o.emissiveFactor)),o.emissiveTexture!==void 0&&l!==Dl&&p.push(t.assignTexture(s,"emissiveMap",o.emissiveTexture,ar)),Promise.all(p).then(function(){const w=new l(s);return o.name&&(w.name=o.name),Kf(w,o),t.associations.set(w,{materials:e}),o.extensions&&Px(r,w,o),w})}createUniqueName(e){const t=Qi.sanitizeNodeName(e||"");let i=t;for(let r=1;this.nodeNamesUsed[i];++r)i=t+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function o(s){return i[er.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(s,t).then(function(d){return dB(d,s,t)})}const l=[];for(let s=0,d=e.length;s<d;s++){const p=e[s],_=Tle(p),w=r[_];if(w)l.push(w.promise);else{let M;p.extensions&&p.extensions[er.KHR_DRACO_MESH_COMPRESSION]?M=o(p):M=dB(new Ti,p,t),r[_]={primitive:p,promise:M},l.push(M)}}return Promise.all(l)}loadMesh(e){const t=this,i=this.json,r=this.extensions,o=i.meshes[e],l=o.primitives,s=[];for(let d=0,p=l.length;d<p;d++){const _=l[d].material===void 0?ble(this.cache):this.getDependency("material",l[d].material);s.push(_)}return s.push(t.loadGeometries(l)),Promise.all(s).then(function(d){const p=d.slice(0,d.length-1),_=d[d.length-1],w=[];for(let A=0,P=_.length;A<P;A++){const L=_[A],D=l[A];let z;const F=p[A];if(D.mode===mc.TRIANGLES||D.mode===mc.TRIANGLE_STRIP||D.mode===mc.TRIANGLE_FAN||D.mode===void 0)z=o.isSkinnedMesh===!0?new LL(L,F):new To(L,F),z.isSkinnedMesh===!0&&z.normalizeSkinWeights(),D.mode===mc.TRIANGLE_STRIP?z.geometry=aB(z.geometry,vL):D.mode===mc.TRIANGLE_FAN&&(z.geometry=aB(z.geometry,_M));else if(D.mode===mc.LINES)z=new Ou(L,F);else if(D.mode===mc.LINE_STRIP)z=new Qd(L,F);else if(D.mode===mc.LINE_LOOP)z=new DL(L,F);else if(D.mode===mc.POINTS)z=new RL(L,F);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+D.mode);Object.keys(z.geometry.morphAttributes).length>0&&Mle(z,o),z.name=t.createUniqueName(o.name||"mesh_"+e),Kf(z,o),D.extensions&&Px(r,z,D),t.assignFinalMaterial(z),w.push(z)}for(let A=0,P=w.length;A<P;A++)t.associations.set(w[A],{meshes:e,primitives:A});if(w.length===1)return w[0];const M=new Ud;t.associations.set(M,{meshes:e});for(let A=0,P=w.length;A<P;A++)M.add(w[A]);return M})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new qr(wV.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new Wd(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Kf(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,o=t.joints.length;r<o;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const o=r.pop(),l=r,s=[],d=[];for(let p=0,_=l.length;p<_;p++){const w=l[p];if(w){s.push(w);const M=new hi;o!==null&&M.fromArray(o.array,p*16),d.push(M)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[p])}return new T1(s,d)})}loadAnimation(e){const i=this.json.animations[e],r=[],o=[],l=[],s=[],d=[];for(let p=0,_=i.channels.length;p<_;p++){const w=i.channels[p],M=i.samplers[w.sampler],A=w.target,P=A.node,L=i.parameters!==void 0?i.parameters[M.input]:M.input,D=i.parameters!==void 0?i.parameters[M.output]:M.output;r.push(this.getDependency("node",P)),o.push(this.getDependency("accessor",L)),l.push(this.getDependency("accessor",D)),s.push(M),d.push(A)}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(l),Promise.all(s),Promise.all(d)]).then(function(p){const _=p[0],w=p[1],M=p[2],A=p[3],P=p[4],L=[];for(let z=0,F=_.length;z<F;z++){const N=_[z],V=w[z],j=M[z],Q=A[z],re=P[z];if(N===void 0)continue;N.updateMatrix();let Z;switch(jf[re.path]){case jf.weights:Z=Gy;break;case jf.rotation:Z=Rp;break;case jf.position:case jf.scale:default:Z=Wy;break}const ne=N.name?N.name:N.uuid,he=Q.interpolation!==void 0?wle[Q.interpolation]:Mg,De=[];jf[re.path]===jf.weights?N.traverse(function(ae){ae.morphTargetInfluences&&De.push(ae.name?ae.name:ae.uuid)}):De.push(ne);let He=j.array;if(j.normalized){const ae=PI(He.constructor),le=new Float32Array(He.length);for(let fe=0,Oe=He.length;fe<Oe;fe++)le[fe]=He[fe]*ae;He=le}for(let ae=0,le=De.length;ae<le;ae++){const fe=new Z(De[ae]+"."+jf[re.path],V.array,He,he);Q.interpolation==="CUBICSPLINE"&&(fe.createInterpolant=function(We){const ce=this instanceof Rp?vle:WG;return new ce(this.times,this.values,this.getValueSize()/3,We)},fe.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),L.push(fe)}}const D=i.name?i.name:"animation_"+e;return new Hy(D,void 0,L)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(o){const l=i._getNodeRef(i.meshCache,r.mesh,o);return r.weights!==void 0&&l.traverse(function(s){if(s.isMesh)for(let d=0,p=r.weights.length;d<p;d++)s.morphTargetInfluences[d]=r.weights[d]}),l})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],o=i._loadNodeShallow(e),l=[],s=r.children||[];for(let p=0,_=s.length;p<_;p++)l.push(i.getDependency("node",s[p]));const d=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([o,Promise.all(l),d]).then(function(p){const _=p[0],w=p[1],M=p[2];M!==null&&_.traverse(function(A){A.isSkinnedMesh&&A.bind(M,Ale)});for(let A=0,P=w.length;A<P;A++)_.add(w[A]);return _})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const o=t.nodes[e],l=o.name?r.createUniqueName(o.name):"",s=[],d=r._invokeOne(function(p){return p.createNodeMesh&&p.createNodeMesh(e)});return d&&s.push(d),o.camera!==void 0&&s.push(r.getDependency("camera",o.camera).then(function(p){return r._getNodeRef(r.cameraCache,o.camera,p)})),r._invokeAll(function(p){return p.createNodeAttachment&&p.createNodeAttachment(e)}).forEach(function(p){s.push(p)}),this.nodeCache[e]=Promise.all(s).then(function(p){let _;if(o.isBone===!0?_=new uT:p.length>1?_=new Ud:p.length===1?_=p[0]:_=new tr,_!==p[0])for(let w=0,M=p.length;w<M;w++)_.add(p[w]);if(o.name&&(_.userData.name=o.name,_.name=l),Kf(_,o),o.extensions&&Px(i,_,o),o.matrix!==void 0){const w=new hi;w.fromArray(o.matrix),_.applyMatrix4(w)}else o.translation!==void 0&&_.position.fromArray(o.translation),o.rotation!==void 0&&_.quaternion.fromArray(o.rotation),o.scale!==void 0&&_.scale.fromArray(o.scale);return r.associations.has(_)||r.associations.set(_,{}),r.associations.get(_).nodes=e,_}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,o=new Ud;i.name&&(o.name=r.createUniqueName(i.name)),Kf(o,i),i.extensions&&Px(t,o,i);const l=i.nodes||[],s=[];for(let d=0,p=l.length;d<p;d++)s.push(r.getDependency("node",l[d]));return Promise.all(s).then(function(d){for(let _=0,w=d.length;_<w;_++)o.add(d[_]);const p=_=>{const w=new Map;for(const[M,A]of r.associations)(M instanceof Zs||M instanceof Jr)&&w.set(M,A);return _.traverse(M=>{const A=r.associations.get(M);A!=null&&w.set(M,A)}),w};return r.associations=p(o),o})}}function Ile(n,e,t){const i=e.attributes,r=new Vp;if(i.POSITION!==void 0){const s=t.json.accessors[i.POSITION],d=s.min,p=s.max;if(d!==void 0&&p!==void 0){if(r.set(new Fe(d[0],d[1],d[2]),new Fe(p[0],p[1],p[2])),s.normalized){const _=PI(yy[s.componentType]);r.min.multiplyScalar(_),r.max.multiplyScalar(_)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const o=e.targets;if(o!==void 0){const s=new Fe,d=new Fe;for(let p=0,_=o.length;p<_;p++){const w=o[p];if(w.POSITION!==void 0){const M=t.json.accessors[w.POSITION],A=M.min,P=M.max;if(A!==void 0&&P!==void 0){if(d.setX(Math.max(Math.abs(A[0]),Math.abs(P[0]))),d.setY(Math.max(Math.abs(A[1]),Math.abs(P[1]))),d.setZ(Math.max(Math.abs(A[2]),Math.abs(P[2]))),M.normalized){const L=PI(yy[M.componentType]);d.multiplyScalar(L)}s.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(s)}n.boundingBox=r;const l=new Gp;r.getCenter(l.center),l.radius=r.min.distanceTo(r.max)/2,n.boundingSphere=l}function dB(n,e,t){const i=e.attributes,r=[];function o(l,s){return t.getDependency("accessor",l).then(function(d){n.setAttribute(s,d)})}for(const l in i){const s=II[l]||l.toLowerCase();s in n.attributes||r.push(o(i[l],s))}if(e.indices!==void 0&&!n.index){const l=t.getDependency("accessor",e.indices).then(function(s){n.setIndex(s)});r.push(l)}return Kf(n,e),Ile(n,e,t),Promise.all(r).then(function(){return e.targets!==void 0?Sle(n,e.targets,t):n})}function Ple(n){const e=ik(Jae,"./Rocket_Airframe.glb"),t=$t.useRef();return zG((i,r)=>(t.current.rotation.x=n.x,t.current.rotation.y=n.y,t.current.rotation.z=n.z)),Ea("mesh",{...n,ref:t,children:[yr("primitive",{object:e.scene,scale:.2}),yr("meshStandardMaterial",{})]})}function Lle(n){return Ea("div",{className:"contents",children:[yr("div",{className:"inline"}),Ea(Zae,{children:[yr("ambientLight",{intensity:.5}),yr("spotLight",{position:[10,10,10],angle:.15,penumbra:1}),yr("pointLight",{position:[-10,-10,-10]}),yr(Ple,{x:n.x,y:n.y,z:n.z,position:[0,0,0]}),yr(Kae,{})]}),yr("div",{})]})}function kle(){let n=$t.useRef(),e=$t.useRef(),t=$t.useRef(),[i,r]=$t.useState(0),[o,l]=$t.useState(0),[s,d]=$t.useState(0),[p,_]=$t.useState(0),[w,M]=$t.useState(0),[A,P]=$t.useState(0),[L,D]=$t.useState(0);$t.useState(0);let[z,F]=$t.useState("disconnected"),N=new k9.Client("127.0.0.1",1885,"dashboard"),V=re=>{re.errorCode!==0&&console.log("onConnectionLost:"+re.errorMessage)},j=re=>{console.log("onMessageArrived:");let Z=re.payloadString.split(",");console.log(Z);let ne=Date.now();r(Z[1]),l(Z[5]),d(Z[6]),_(Z[7]),n.current.data.datasets[0].data.push({x:ne,y:Z[10]}),n.current.data.datasets[1].data.push({x:ne,y:Z[1]}),n.current.update("quiet"),e.current.data.datasets[0].data.push({x:ne,y:Z[9]}),e.current.update("quiet"),t.current.data.datasets[0].data.push({x:ne,y:Z[10]}),t.current.data.datasets[1].data.push({x:ne,y:Z[3]}),t.current.data.datasets[2].data.push({x:ne,y:Z[4]}),t.current.data.datasets[3].data.push({x:ne,y:Z[5]}),t.current.update("quiet")},Q=()=>{console.log("connected"),N.subscribe("ESP32/Connect/Success")};return N.onConnectionLost=V,N.onMessageArrived=j,N.connect({onSuccess:Q,keepAliveInterval:3600}),yr("div",{className:"lg:max-h-screen max-w-screen overflow-hidden",children:Ea("main",{className:"p-2",children:[Ea("div",{className:"text-sm lg:text-base text-center",children:["The WebSocket is currently ",z]}),Ea("div",{className:"text-xs lg:text-base md:w-2/3 mx-auto font-bold flex flex-wrap justify-between",children:[Ea("span",{children:["Timestamp:"," "]}),Ea("span",{children:["State:",L," "]}),Ea("span",{children:["Altitude: ",i]}),Ea("span",{children:["Longitude:",A," "]}),Ea("span",{children:["Latitude: ",w," "]})]}),Ea("div",{className:"grid grid-cols-1 lg:grid-cols-3",children:[yr("div",{children:yr(ZJ,{url:"http://192.168.0.103:81/stream"})}),yr("div",{className:"lg:order-first w-full lg:w-10/12 lg:col-span-2",children:yr(Lle,{x:o,y:s,z:p})})]}),Ea("div",{className:"grid grid-cols-1 lg:grid-cols-3",children:[yr("div",{className:"w-full lg:w-11/12",children:yr(l2,{ref:n,type:"altitude"})}),yr("div",{className:"w-full lg:w-11/12",children:yr(l2,{ref:e,type:"velocity"})}),yr("div",{className:"w-full lg:w-11/12",children:yr(l2,{ref:t,type:"acceleration"})})]})]})})}aA.createRoot(document.getElementById("root")).render(yr(zI.StrictMode,{children:yr(kle,{})}));
